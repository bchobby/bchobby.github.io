<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>threejs多种方式封装飞线组件（几何、贴图、着色器） - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="threejs多种方式封装飞线组件（几何、贴图、着色器）" />
<meta property="og:description" content="文章目录 前言飞线实现效果核心思路几何体实现纹理贴图体实现着色器实现 代码实现基类引入组件飞线封装 总结 前言 之前在研究threejs时，尝试了通过线几何体、通过纹理贴图、通过着色器等几种方式实现飞线效果，现在将这几种方式使用 typescript， 采用面向对象的方式封装整理并记录下来，思路供大家参考。
飞线实现效果 几何体实现
贴图实现
着色器实现
核心思路 几何体实现 通过 TubeBufferGeometry 创建轨迹线模型采用相同的方式，从轨迹线的点集合中截取一段创建移动的飞线，通过 THREE.Line —— lerp 实现渐变色通过tween操作动画，每次重新设置线几何体的点坐标，实现动画效果 采用这种方式在思路上不难理解，但是需要使用者清楚 THREE.BufferGeometry 的使用。
纹理贴图体实现 通过 THREE.CatmullRomCurve3 创建轨迹线，从上面截取点创建 THREE.Line 几何体作为轨迹线使用 THREE.TextureLoader 给模型表面贴图通过tween操作动画，每次操作纹理的 offset，实现动画 在网上找了个简单的纹理图，照理来说应该把它的背景色挖空：
着色器实现 着色器的实现相比复杂很多，主要指出关键部分：
创建点集
仍然通过THREE.CatmullRomCurve3拾取点，数量为 nsetAttribute 给每个点传递一个索引属性，这个属性通过 attribute 变量传到着色器中，在实现飞线效果时有重要作用 创建着色器
通过THREE.ShaderMaterial自定义着色器,通过tween向其传入 [0, n] 范围内不断变化的时间 uTime 点集的范围和时间循环的范围都是 [0, n]，uTime 是不断变化的，给点索引值范围为 [uTime - m, uTime &#43; m] 的粒子群们赋予着色器效果：粒子的大小由其索引值确定，索引值大的方向为头部，size更大 ； [uTime - m, uTime &#43; m] 外的粒子们设置透明。随着uTime的不断变化，上述过程将会反复实现，形成飞线动画
代码实现 基类 import * as THREE from &#39;three&#39;; interface flyLineBegin2End { begin: number[]; end: number[]; height: number; } export default abstract class FlyBase { // 必须声明的属性 abstract scene: THREE." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/08970e063209c06a459b3257040c60fc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-07T19:42:31+08:00" />
<meta property="article:modified_time" content="2023-02-07T19:42:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">threejs多种方式封装飞线组件（几何、贴图、着色器）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_5" rel="nofollow">前言</a></li><li><a href="#_11" rel="nofollow">飞线实现效果</a></li><li><a href="#_32" rel="nofollow">核心思路</a></li><li><ul><li><a href="#_33" rel="nofollow">几何体实现</a></li><li><a href="#_41" rel="nofollow">纹理贴图体实现</a></li><li><a href="#_49" rel="nofollow">着色器实现</a></li></ul> 
  </li><li><a href="#_64" rel="nofollow">代码实现</a></li><li><ul><li><a href="#_65" rel="nofollow">基类</a></li><li><a href="#_88" rel="nofollow">引入组件</a></li><li><a href="#_100" rel="nofollow">飞线封装</a></li></ul> 
  </li><li><a href="#_488" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_5"></a>前言</h2> 
<p>之前在研究threejs时，尝试了通过<strong>线几何体</strong>、通过<strong>纹理贴图</strong>、通过<strong>着色器</strong>等几种方式实现飞线效果，现在将这几种方式使用 typescript， 采用面向对象的方式封装整理并记录下来，思路供大家参考。</p> 
<hr> 
<h2><a id="_11"></a>飞线实现效果</h2> 
<p><strong>几何体实现</strong></p> 
<p><img src="https://images2.imgbox.com/db/c9/IJb0FrpA_o.gif" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>贴图实现</strong></p> 
<p><img src="https://images2.imgbox.com/38/98/X2n0Z5BL_o.gif" alt="在这里插入图片描述"></p> 
<hr> 
<p><strong>着色器实现</strong><br> <img src="https://images2.imgbox.com/ec/85/UVK6rNdZ_o.gif" alt="在这里插入图片描述"></p> 
<h2><a id="_32"></a>核心思路</h2> 
<h3><a id="_33"></a>几何体实现</h3> 
<blockquote> 
 <ul><li>通过 <strong>TubeBufferGeometry</strong> 创建轨迹线模型</li><li>采用相同的方式，从轨迹线的点集合中截取一段创建移动的飞线，通过 <strong>THREE.Line —— lerp</strong> 实现渐变色</li><li>通过tween操作动画，每次重新设置线几何体的点坐标，实现动画效果</li></ul> 
</blockquote> 
<p>采用这种方式在思路上不难理解，但是需要使用者清楚 <strong>THREE.BufferGeometry</strong> 的使用。</p> 
<h3><a id="_41"></a>纹理贴图体实现</h3> 
<blockquote> 
 <ul><li>通过 <strong>THREE.CatmullRomCurve3</strong> 创建轨迹线，从上面截取点创建 <strong>THREE.Line</strong> 几何体作为轨迹线</li><li>使用 <strong>THREE.TextureLoader</strong> 给模型表面贴图</li><li>通过tween操作动画，每次操作纹理的 offset，实现动画</li></ul> 
</blockquote> 
<p>在网上找了个简单的纹理图，照理来说应该把它的背景色挖空：<br> <img src="https://images2.imgbox.com/14/c2/Hdmqx1cR_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="_49"></a>着色器实现</h3> 
<p>着色器的实现相比复杂很多，主要指出关键部分：</p> 
<p><strong>创建点集</strong></p> 
<ul><li>仍然通过<strong>THREE.CatmullRomCurve3</strong>拾取点，数量为 <strong>n</strong></li><li><strong>setAttribute</strong> 给每个点传递一个索引属性，这个属性通过 <strong>attribute</strong> 变量传到着色器中，在实现飞线效果时有重要作用</li></ul> 
<p><strong>创建着色器</strong></p> 
<ul><li>通过<strong>THREE.ShaderMaterial</strong>自定义着色器,通过tween向其传入 <strong>[0, n]</strong> 范围内不断变化的时间 <strong>uTime</strong></li></ul> 
<blockquote> 
 <p>点集的范围和时间循环的范围都是 <strong>[0, n]</strong>，<strong>uTime</strong> 是不断变化的，给点索引值范围为 <strong>[uTime - m, uTime + m]</strong> 的粒子群们赋予着色器效果：粒子的大小由其索引值确定，索引值大的方向为头部，size更大 ； <strong>[uTime - m, uTime + m]</strong> 外的粒子们设置透明。随着uTime的不断变化，上述过程将会反复实现，形成飞线动画</p> 
</blockquote> 
<h2><a id="_64"></a>代码实现</h2> 
<h3><a id="_65"></a>基类</h3> 
<pre><code class="prism language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">THREE</span> <span class="token keyword">from</span> <span class="token string">'three'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">flyLineBegin2End</span> <span class="token punctuation">{<!-- --></span>
  begin<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  end<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">FlyBase</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 必须声明的属性</span>
  <span class="token keyword">abstract</span> scene<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Scene <span class="token comment">// 场景</span>
  <span class="token keyword">abstract</span> data<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>flyLineBegin2End<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// 传入的数据</span>
  <span class="token keyword">abstract</span> ThreeGroup<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Group<span class="token punctuation">;</span> <span class="token comment">// 存放实体</span>

  <span class="token comment">// 实现的方法</span>
  <span class="token keyword">abstract</span> <span class="token function">_draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Group<span class="token punctuation">;</span> <span class="token comment">// 添加场景</span>
  <span class="token keyword">abstract</span> <span class="token function">_remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span> <span class="token comment">// 移除实体</span>
  <span class="token keyword">abstract</span> <span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span> <span class="token comment">// 开启动画</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_88"></a>引入组件</h3> 
<pre><code class="prism language-ts">  <span class="token keyword">function</span> <span class="token function">createFlyLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> data <span class="token operator">=</span><span class="token punctuation">[</span>
      <span class="token punctuation">{<!-- --></span> begin<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{<!-- --></span> begin<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{<!-- --></span> begin<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
    flyRef<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FlyLine</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_100"></a>飞线封装</h3> 
<ul><li><strong>几何体</strong></li></ul> 
<pre><code class="prism language-ts">
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">THREE</span> <span class="token keyword">from</span> <span class="token string">'three'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FlyBase <span class="token keyword">from</span> <span class="token string">'./FlyBase'</span>
<span class="token keyword">import</span> <span class="token constant">TWEEN</span> <span class="token keyword">from</span> <span class="token string">'@tweenjs/tween.js'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">flyLineBegin2End</span> <span class="token punctuation">{<!-- --></span>
  begin<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  end<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">optionsInterface</span> <span class="token punctuation">{<!-- --></span>
  routeColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  flyColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  cycle<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">FlyLine</span> <span class="token keyword">extends</span> <span class="token class-name">FlyBase</span> <span class="token punctuation">{<!-- --></span>
  data<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>flyLineBegin2End<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  cycle<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  routeColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  flyColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  ThreeGroup<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Group<span class="token punctuation">;</span>
  scene<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Scene 
  <span class="token comment">/**
   * 
   * @param data 数据配置
   * @param options 可选项
   */</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>scene<span class="token operator">:</span><span class="token constant">THREE</span><span class="token punctuation">.</span>Scene<span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>flyLineBegin2End<span class="token operator">&gt;</span><span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> optionsInterface<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scene <span class="token operator">=</span> scene<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>routeColor <span class="token operator">=</span> options<span class="token operator">?.</span>routeColor <span class="token operator">||</span> <span class="token string">'#00FFFF'</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>flyColor <span class="token operator">=</span> options<span class="token operator">?.</span>flyColor <span class="token operator">||</span> <span class="token string">'#FFFF00'</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cycle <span class="token operator">=</span> options<span class="token operator">?.</span>cycle <span class="token operator">||</span> <span class="token number">2000</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">_draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> points <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getPoints</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> fixedLine <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_createFixedLine</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> movedLine <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_createMovedLine</span><span class="token punctuation">(</span>points<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fixedLine<span class="token punctuation">,</span> movedLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 创建动画</span>
      <span class="token keyword">let</span> tween <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">TWEEN</span></span><span class="token punctuation">.</span><span class="token function">Tween</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> index<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> index<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cycle<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">onUpdate</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">let</span> movedLineGeom <span class="token operator">=</span> movedLine<span class="token punctuation">.</span>geometry
          <span class="token keyword">let</span> id <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> pointsList <span class="token operator">=</span> points<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> id <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从曲线上获取一段</span>
          movedLineGeom <span class="token operator">&amp;&amp;</span> movedLineGeom<span class="token punctuation">.</span><span class="token function">setFromPoints</span><span class="token punctuation">(</span>pointsList<span class="token punctuation">)</span><span class="token punctuation">;</span>
          movedLineGeom<span class="token punctuation">.</span>attributes<span class="token punctuation">.</span>position<span class="token punctuation">.</span>needsUpdate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     tween<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token constant">TWEEN</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">_getPoints</span><span class="token punctuation">(</span>data<span class="token operator">:</span> flyLineBegin2End<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> startPoint <span class="token operator">=</span> data<span class="token punctuation">.</span>begin<span class="token punctuation">;</span> <span class="token comment">// 起始点</span>
    <span class="token keyword">const</span> endPoint <span class="token operator">=</span> data<span class="token punctuation">.</span>end<span class="token punctuation">;</span> <span class="token comment">// 终点</span>
    <span class="token keyword">const</span> curveH <span class="token operator">=</span> data<span class="token punctuation">.</span>height<span class="token punctuation">;</span> <span class="token comment">// 飞线最大高</span>

    <span class="token comment">// 三点创建弧线几何体</span>
    <span class="token keyword">const</span> pointInLine <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> endPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
        curveH<span class="token punctuation">,</span>
        <span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> endPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>endPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> endPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> curve <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">CatmullRomCurve3</span><span class="token punctuation">(</span>pointInLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> points <span class="token operator">=</span> curve<span class="token punctuation">.</span><span class="token function">getSpacedPoints</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> points
  <span class="token punctuation">}</span>

  <span class="token comment">// 创建轨迹的线</span>
  <span class="token function">_createFixedLine</span><span class="token punctuation">(</span>points<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Vector3<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Line</span><span class="token punctuation">(</span>
      <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">BufferGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFromPoints</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">LineBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> color<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>routeColor <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 创建飞线</span>
  <span class="token function">_createMovedLine</span><span class="token punctuation">(</span>points<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Vector3<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> pointsOnLine <span class="token operator">=</span> points<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从曲线上获取一段</span>
    <span class="token keyword">const</span> flyLineGeom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">BufferGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    flyLineGeom<span class="token punctuation">.</span><span class="token function">setFromPoints</span><span class="token punctuation">(</span>pointsOnLine<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 操作颜色</span>
    <span class="token keyword">const</span> colorArr<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pointsOnLine<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> color1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Color</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>routeColor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 线颜色</span>
      <span class="token keyword">const</span> color2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Color</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>flyColor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 飞痕颜色</span>
      <span class="token comment">// 飞痕渐变色</span>
      <span class="token keyword">let</span> color <span class="token operator">=</span> color1<span class="token punctuation">.</span><span class="token function">lerp</span><span class="token punctuation">(</span>color2<span class="token punctuation">,</span> i <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      colorArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>color<span class="token punctuation">.</span>r<span class="token punctuation">,</span> color<span class="token punctuation">.</span>g<span class="token punctuation">,</span> color<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 设置几何体顶点颜色数据</span>
    flyLineGeom<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span> <span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">BufferAttribute</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span>colorArr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    flyLineGeom<span class="token punctuation">.</span>attributes<span class="token punctuation">.</span>position<span class="token punctuation">.</span>needsUpdate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">LineBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      vertexColors<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//使用顶点本身颜色</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Line</span><span class="token punctuation">(</span>flyLineGeom<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 修改显隐</span>
  <span class="token function">setVisible</span><span class="token punctuation">(</span>visible<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">.</span>visible <span class="token operator">=</span> visible<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">_remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      l<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      l<span class="token punctuation">.</span>material<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li><strong>纹理贴图</strong></li></ul> 
<pre><code class="prism language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">THREE</span> <span class="token keyword">from</span> <span class="token string">"three"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FlyBase <span class="token keyword">from</span> <span class="token string">'./FlyBase'</span>
<span class="token keyword">import</span> <span class="token constant">TWEEN</span> <span class="token keyword">from</span> <span class="token string">'@tweenjs/tween.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> texture_img <span class="token keyword">from</span> <span class="token string">'../../../assets/textures/arr.png'</span>

<span class="token keyword">interface</span> <span class="token class-name">flyLineBegin2End</span> <span class="token punctuation">{<!-- --></span>
  begin<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  end<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">optionsInterface</span> <span class="token punctuation">{<!-- --></span>
  cycle<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">FlyLine</span> <span class="token keyword">extends</span> <span class="token class-name">FlyBase</span> <span class="token punctuation">{<!-- --></span>
  scene<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Scene 
  data<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>flyLineBegin2End<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  cycle<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  ThreeGroup<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Group<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>scene<span class="token operator">:</span><span class="token constant">THREE</span><span class="token punctuation">.</span>Scene<span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>flyLineBegin2End<span class="token operator">&gt;</span><span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> optionsInterface<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scene <span class="token operator">=</span> scene<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cycle <span class="token operator">=</span> options<span class="token operator">?.</span>cycle <span class="token operator">||</span> <span class="token number">2000</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token constant">TWEEN</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">_draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> startPoint <span class="token operator">=</span> data<span class="token punctuation">.</span>begin<span class="token punctuation">;</span> <span class="token comment">// 起始点</span>
      <span class="token keyword">const</span> endPoint <span class="token operator">=</span> data<span class="token punctuation">.</span>end<span class="token punctuation">;</span> <span class="token comment">// 终点</span>
      <span class="token keyword">const</span> curveH <span class="token operator">=</span> data<span class="token punctuation">.</span>height<span class="token punctuation">;</span> <span class="token comment">// 飞线最大高</span>
  
      <span class="token comment">// 创建管道</span>
      <span class="token keyword">const</span> pointInLine <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> endPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
          curveH<span class="token punctuation">,</span>
          <span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> endPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>endPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> endPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
  
      <span class="token keyword">const</span> lineCurve <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">CatmullRomCurve3</span><span class="token punctuation">(</span>pointInLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">TubeBufferGeometry</span><span class="token punctuation">(</span>
        lineCurve<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">false</span> 
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
  
      <span class="token comment">// 设置纹理</span>
      <span class="token keyword">const</span> textloader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> texture <span class="token operator">=</span> textloader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>texture_img<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
      texture<span class="token punctuation">.</span>repeat<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      texture<span class="token punctuation">.</span>needsUpdate <span class="token operator">=</span> <span class="token boolean">true</span>
      texture<span class="token punctuation">.</span>wrapS <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping<span class="token punctuation">;</span>
      texture<span class="token punctuation">.</span>wrapT <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>RepeatWrapping<span class="token punctuation">;</span>
  
      <span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// color: 0xfff000,</span>
        map<span class="token operator">:</span> texture<span class="token punctuation">,</span>
        transparent<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
      <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
      <span class="token keyword">let</span> tween <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">TWEEN</span></span><span class="token punctuation">.</span><span class="token function">Tween</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> x<span class="token operator">:</span><span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> x<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cycle<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">onUpdate</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            texture<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>x <span class="token operator">-=</span> <span class="token number">0.01</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       tween<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">_remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      l<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      l<span class="token punctuation">.</span>material<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<ul><li><strong>着色器</strong></li></ul> 
<pre><code class="prism language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">THREE</span> <span class="token keyword">from</span> <span class="token string">"three"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FlyBase <span class="token keyword">from</span> <span class="token string">'./FlyBase'</span>
<span class="token keyword">import</span> <span class="token constant">TWEEN</span> <span class="token keyword">from</span> <span class="token string">'@tweenjs/tween.js'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">flyLineBegin2End</span> <span class="token punctuation">{<!-- --></span>
  begin<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  end<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">optionsInterface</span> <span class="token punctuation">{<!-- --></span>
  routeColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  flyColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  cycle<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">FlyLine</span> <span class="token keyword">extends</span> <span class="token class-name">FlyBase</span> <span class="token punctuation">{<!-- --></span>
  scene<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Scene
  data<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>flyLineBegin2End<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  cycle<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  routeColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  flyColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  ThreeGroup<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Group<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>scene<span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>Scene<span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>flyLineBegin2End<span class="token operator">&gt;</span><span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> optionsInterface<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scene <span class="token operator">=</span> scene<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cycle <span class="token operator">=</span> options<span class="token operator">?.</span>cycle <span class="token operator">||</span> <span class="token number">2000</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>routeColor <span class="token operator">=</span> options<span class="token operator">?.</span>routeColor <span class="token operator">||</span> <span class="token string">'#00FFFF'</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>flyColor <span class="token operator">=</span> options<span class="token operator">?.</span>flyColor <span class="token operator">||</span> <span class="token string">'#FFFF00'</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token constant">TWEEN</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">_draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> startPoint <span class="token operator">=</span> data<span class="token punctuation">.</span>begin<span class="token punctuation">;</span> <span class="token comment">// 起始点</span>
      <span class="token keyword">const</span> endPoint <span class="token operator">=</span> data<span class="token punctuation">.</span>end<span class="token punctuation">;</span> <span class="token comment">// 终点</span>
      <span class="token keyword">const</span> curveH <span class="token operator">=</span> data<span class="token punctuation">.</span>height<span class="token punctuation">;</span> <span class="token comment">// 飞线最大高</span>

      <span class="token keyword">const</span> begin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> end <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>endPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> endPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> len <span class="token operator">=</span> begin<span class="token punctuation">.</span><span class="token function">distanceTo</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 创建管道</span>
      <span class="token keyword">const</span> pointInLine <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> endPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
          curveH<span class="token punctuation">,</span>
          <span class="token punctuation">(</span>startPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> endPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Vector3</span><span class="token punctuation">(</span>endPoint<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> endPoint<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>


      <span class="token keyword">const</span> lineCurve <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">CatmullRomCurve3</span><span class="token punctuation">(</span>pointInLine<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> points <span class="token operator">=</span> lineCurve<span class="token punctuation">.</span><span class="token function">getPoints</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> indexList<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> positionList<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      points<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        indexList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword">const</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">BufferGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFromPoints</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">;</span>
      geometry<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'aIndex'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Float32BufferAttribute</span><span class="token punctuation">(</span>indexList<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

      <span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">ShaderMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        uniforms<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          uColor<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            value<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Color</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>flyColor<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          uTime<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            value<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          uLength<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            value<span class="token operator">:</span> points<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        vertexShader<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        attribute float aIndex;

        uniform float uTime;
        uniform vec3 uColor;

        varying float vSize;

        void main(){
            vec4 viewPosition = viewMatrix * modelMatrix *vec4(position,1);
            gl_Position = projectionMatrix * viewPosition;

            if(aIndex &lt; uTime + 100.0 &amp;&amp; aIndex &gt; uTime - 100.0){
              vSize = (aIndex + 100.0 - uTime) / 60.0;
            } 
            gl_PointSize =vSize;
        }
      </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        fragmentShader<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        varying float vSize;
        uniform vec3 uColor;
        void main(){

            if(vSize&lt;=0.0){
                gl_FragColor = vec4(1,0,0,0);
            }else{
                gl_FragColor = vec4(uColor,1);
            }
            
        }
      </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        transparent<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token constant">THREE</span></span><span class="token punctuation">.</span><span class="token function">Points</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> tween <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">TWEEN</span></span><span class="token punctuation">.</span><span class="token function">Tween</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> index<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> index<span class="token operator">:</span> <span class="token number">1000</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cycle<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">onUpdate</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">let</span> id <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
          material<span class="token punctuation">.</span>uniforms<span class="token punctuation">.</span>uTime<span class="token punctuation">.</span>value <span class="token operator">=</span> id
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      tween<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">_remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ThreeGroup<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>l<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      l<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      l<span class="token punctuation">.</span>material<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_488"></a>总结</h2> 
<p>实现飞线的三种方式，思路可借鉴在其它三维效果上</p> 
<ul><li>几何体实现</li><li>纹理贴图体实现</li><li>着色器实现</li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bec906a58c6943a5430ee9242820f1ad/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C语言编程题】给你一个整数数组 nums ，请计算数组的中心下标 。数组中心下标是数组的一个下标，其左侧所有元素相加的和等于右侧所有元素相加的和。求数组中心下标 寻找数组中心下标 python</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1f9b06d8541f9b402e3371681b2c3572/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">jQuery库的基本使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>