<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Qt扫盲-QString使用总结 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Qt扫盲-QString使用总结" />
<meta property="og:description" content="QString使用总结 一、概述二、初始化字符串1、极速版2、原理版 三、操作字符串1、极速版1. 增加2. 删除3. 修改4. 插入5. 转换 2、原理版 四、查询字符串五、字符串格式转换六、Null 字符串和 Empty 字符串的区别七、字符串参数格式化八、更高效的字符串构造九、最大大小和出现内存不足的情况 这里是我对帮助文档的一些理解，再复习复习一下之前的知识点。 我把文字分成了两部分，一半是给喜欢了解一下原理的，一部分是直接上手就行的。 一、概述 QString 是Qt 的一种基础数据类型，也是对字符串的一个封装。其实他的操作和标准库的std::string字符串的基本是一致的。但是还是有些区别。
QString 存储以数据长度为16位2字节 QChar类型的字符串，也是说每个字符类型是 QChar ，其中每个 QChar 对应于一个UTF-16 代码。(如果代码值高于 65535 的 Unicode 字符使用两个连续的 QChar来存储)这其实和 c&#43;&#43;标准库的std::string使用一致，但是std::string的字符是char类型，8位一字节长度(用的Utf-8)。这里我们知道QString 和 std::string编码格式不一样，不能直接相互操作，得转码后才能用哦
Unicode 是一种国际标准，支持当今使用的大多数书写系统。是一种可变长度字符编码。它可以用来表示Unicode标准中的任何字符。会将一个码位编码为 1 到 4 个字节。它是 US-ASCII (ANSI X3.4-1986) 和 Latin-1 (ISO 8859-1) 的超集，所有 US-ASCII/Latin-1 字符都位于相同的代码位置。也就是说Unicode包括了 上述位置的编码
QString在内部实现的时候 使用隐式共享(写入时复制)来减少内存使用并避免不必要的数据复制。这也有助于减少存储 16 位字符而不是 8 位字符的固有开销(QChar 比 char 空间大)。
隐式共享可以参考我之前的博文: Qt扫盲–隐式共享基本原理
除了QString，Qt还提供了QByteArray类来存储原始字节和传统的8位“0”终止字符串(也即是char类型字符串)。在大多数情况下，QString 是您想要使用的类。它在整个Qt API中使用，Unicode支持确保您的应用程序易于翻译，如果您想在某个时候扩展应用程序市场。QByteArray 适合的两种主要情况是需要存储原始二进制数据时，以及内存保护至关重要时(在嵌入式系统中)。
二、初始化字符串 1、极速版 //不带参构造 QString str; //从const char * 字面量字符串构造 QString str_1 = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/1fdc4596da983bbca876250eca297f72/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-09T13:17:46+08:00" />
<meta property="article:modified_time" content="2022-12-09T13:17:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Qt扫盲-QString使用总结</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>QString使用总结</h4> 
 <ul><li><a href="#_3" rel="nofollow">一、概述</a></li><li><a href="#_15" rel="nofollow">二、初始化字符串</a></li><li><ul><li><a href="#1_16" rel="nofollow">1、极速版</a></li><li><a href="#2_47" rel="nofollow">2、原理版</a></li></ul> 
  </li><li><a href="#_75" rel="nofollow">三、操作字符串</a></li><li><ul><li><a href="#1_76" rel="nofollow">1、极速版</a></li><li><ul><li><a href="#1__77" rel="nofollow">1. 增加</a></li><li><a href="#2__87" rel="nofollow">2. 删除</a></li><li><a href="#3__108" rel="nofollow">3. 修改</a></li><li><a href="#4__125" rel="nofollow">4. 插入</a></li><li><a href="#5__141" rel="nofollow">5. 转换</a></li></ul> 
   </li><li><a href="#2_163" rel="nofollow">2、原理版</a></li></ul> 
  </li><li><a href="#_205" rel="nofollow">四、查询字符串</a></li><li><a href="#_258" rel="nofollow">五、字符串格式转换</a></li><li><a href="#Null__Empty__284" rel="nofollow">六、Null 字符串和 Empty 字符串的区别</a></li><li><a href="#_297" rel="nofollow">七、字符串参数格式化</a></li><li><a href="#_309" rel="nofollow">八、更高效的字符串构造</a></li><li><a href="#_342" rel="nofollow">九、最大大小和出现内存不足的情况</a></li></ul> 
</div> 
<br> 这里是我对帮助文档的一些理解，再复习复习一下之前的知识点。 
<br> 我把文字分成了两部分，一半是给喜欢了解一下原理的，一部分是直接上手就行的。 
<p></p> 
<h2><a id="_3"></a>一、概述</h2> 
<p>QString 是Qt 的一种基础数据类型，也是对字符串的一个封装。其实他的操作和标准库的std::string字符串的基本是一致的。但是还是有些区别。</p> 
<p>QString 存储以数据长度为16位2字节 QChar类型的字符串，也是说每个字符类型是 QChar ，其中每个 QChar 对应于一个<strong>UTF-16</strong> 代码。(如果代码值高于 65535 的 Unicode 字符使用两个连续的 QChar来存储)这其实和 c++标准库的std::string使用一致，但是std::string的字符是char类型，8位一字节长度(用的Utf-8)。<strong>这里我们知道QString 和 std::string编码格式不一样，不能直接相互操作，得转码后才能用哦</strong></p> 
<p>Unicode 是一种国际标准，支持当今使用的大多数书写系统。是一种可变长度字符编码。它可以用来表示Unicode标准中的任何字符。会将一个码位编码为 1 到 4 个字节。它是 US-ASCII (ANSI X3.4-1986) 和 Latin-1 (ISO 8859-1) 的超集，所有 US-ASCII/Latin-1 字符都位于相同的代码位置。<strong>也就是说Unicode包括了 上述位置的编码</strong></p> 
<p>QString在内部实现的时候 使用隐式共享(写入时复制)来减少内存使用并避免不必要的数据复制。这也有助于减少存储 16 位字符而不是 8 位字符的固有开销(QChar 比 char 空间大)。<br> 隐式共享可以参考我之前的博文: <a href="https://blog.csdn.net/qq_43680827/article/details/123443466"><strong>Qt扫盲–隐式共享基本原理</strong></a></p> 
<p>除了QString，Qt还提供了QByteArray类来存储原始字节和传统的8位“0”终止字符串(也即是char类型字符串)。在大多数情况下，QString 是您想要使用的类。它在整个Qt API中使用，Unicode支持确保您的应用程序易于翻译，如果您想在某个时候扩展应用程序市场。QByteArray 适合的两种主要情况是需要存储原始二进制数据时，以及内存保护至关重要时(在嵌入式系统中)。</p> 
<h2><a id="_15"></a>二、初始化字符串</h2> 
<h3><a id="1_16"></a>1、极速版</h3> 
<pre><code class="prism language-cpp">    <span class="token comment">//不带参构造</span>
    QString str<span class="token punctuation">;</span>
    
    <span class="token comment">//从const char * 字面量字符串构造</span>
    QString str_1 <span class="token operator">=</span> <span class="token string">"dfdsfsd"</span><span class="token punctuation">;</span>
    
    <span class="token comment">//拷贝</span>
    QString str_2 <span class="token operator">=</span> str_1<span class="token punctuation">;</span>

    <span class="token comment">//带参构造</span>
    QString <span class="token function">str_3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//从const char * 字面量字符串构造</span>
    QString <span class="token function">str_4</span><span class="token punctuation">(</span><span class="token string">"fdfsfs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//从QChar 数组构造</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> QChar data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token char">'u'</span><span class="token punctuation">,</span> <span class="token char">'y'</span><span class="token punctuation">,</span> <span class="token number">0x10e3</span><span class="token punctuation">,</span> <span class="token char">'d'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    QString <span class="token function">str_5</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//从QCahr构造</span>
    QString <span class="token function">str_6</span><span class="token punctuation">(</span><span class="token function">QChar</span><span class="token punctuation">(</span><span class="token char">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>str<span class="token operator">&lt;&lt;</span>str_1<span class="token operator">&lt;&lt;</span>str_2<span class="token operator">&lt;&lt;</span>str_3<span class="token operator">&lt;&lt;</span>str_4<span class="token operator">&lt;&lt;</span>str_5<span class="token operator">&lt;&lt;</span>str_6<span class="token punctuation">;</span>

<span class="token comment">// 输出</span>
<span class="token comment">// "" "dfdsfsd" "dfdsfsd" true "fdfsfs" "uy?d" "&amp;"</span>
</code></pre> 
<h3><a id="2_47"></a>2、原理版</h3> 
<p>初始化字符串有些方式？<br> 当然看构造函数，QString 是类，那肯定就是构造函数初始化啦<br> <img src="https://images2.imgbox.com/bd/97/ZaQXmlCJ_o.png" alt="在这里插入图片描述"><br> 帮助文档的推荐的三种写法</p> 
<ul><li> 
  <ol><li>用常量字符串初始化 const char *</li></ol> </li></ul> 
<pre><code class="prism language-cpp">QString str <span class="token operator">=</span> <span class="token string">"Hello"</span><span class="token punctuation">;</span>
QString str1 <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">fromUtf8</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//显然一般情况不用，第一种更简单</span>
</code></pre> 
<p>我们把 const char * 转成 QString 就可以用 fromUtf8() 方法。在所有采用 const char * 参数的 QString 函数中，const char * 被解释为以 UTF-8 编码的经典 C 样式“\0”结尾字符串。const char * 参数为 nullptr(空) 是合法的。但是尽量别用空指针。</p> 
<ul><li> 
  <ol start="2"><li>QChar 数组初始化</li></ol> </li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">static</span> <span class="token keyword">const</span> QChar data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0x0055</span><span class="token punctuation">,</span> <span class="token number">0x006e</span><span class="token punctuation">,</span> <span class="token number">0x10e3</span><span class="token punctuation">,</span> <span class="token number">0x03a3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
QString <span class="token function">str</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>QString 会用 QChar 数组的深拷贝,也就是说str和data没有共享内存(如果出于性能原因，您不想创建字符数据的深拷贝，请改用 <strong>QString::fromRawData()</strong> )</p> 
<ul><li> 
  <ol start="3"><li>先分配再改值</li></ol> </li></ul> 
<pre><code class="prism language-cpp">QString str<span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">QChar</span><span class="token punctuation">(</span><span class="token char">'U'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">QChar</span><span class="token punctuation">(</span><span class="token char">'n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
str<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">QChar</span><span class="token punctuation">(</span><span class="token number">0x10e3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
str<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">QChar</span><span class="token punctuation">(</span><span class="token number">0x03a3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这种方法是使用 <strong>resize()</strong> 设置字符串的大小，并初始化每个字符的数据字符。QString 使用从 0 开始的索引，就像C++数组一样。要访问特定索引位置的字符，可以使用运算符 <strong>[ ]</strong> 在非常量字符串上。</p> 
<h2><a id="_75"></a>三、操作字符串</h2> 
<h3><a id="1_76"></a>1、极速版</h3> 
<h4><a id="1__77"></a>1. 增加</h4> 
<p>对字符串的进行增操作，主要有下面这些</p> 
<pre><code class="prism language-cpp">QString str <span class="token operator">=</span> <span class="token string">"and"</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token string">"rock "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     	<span class="token comment">// str == "rock and"</span>
str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" roll"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// str == "rock and roll"</span>
str <span class="token operator">+=</span> <span class="token string">" dsfsd"</span><span class="token punctuation">;</span>				<span class="token comment">// str == "rock and roll dsfsd"</span>
str <span class="token operator">=</span> str <span class="token operator">+</span> <span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">" fdsffsd"</span><span class="token punctuation">)</span> <span class="token comment">// str == "rock and roll dsfsd" fdsffsd</span>
</code></pre> 
<h4><a id="2__87"></a>2. 删除</h4> 
<p>remove 函数还有好几种，支持正则表达式移除，下面是常用的几种</p> 
<pre><code class="prism language-cpp">QString str <span class="token operator">=</span> <span class="token string">"AAA BBB CCC DDD AABBCC"</span><span class="token punctuation">;</span>
str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"AA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     	<span class="token comment">// str == "A BBB CCC DDD BBCC"</span>
str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// str == "A BBC DDD BBCC"</span>
str<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">// str == ""</span>
str <span class="token operator">=</span> <span class="token string">"ccs"</span><span class="token punctuation">;</span>
str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>						<span class="token comment">//重置为空字符串</span>
str<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>					<span class="token comment">// str == "" 重置长度为0的字符串</span>

<span class="token comment">//去除首尾所有空白字符，空白字符包括'\t', '\n', '\v', '\f', '\r', ' '.</span>
QString str <span class="token operator">=</span> <span class="token string">"  lots\t of\nwhitespace\r\n "</span><span class="token punctuation">;</span>
str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">trimmed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// str == "lots\t of\nwhitespace"</span>

<span class="token comment">//去除 多余空白字符，首尾全部去掉，每个序列的内部空格多余空白符替换为一个空格号。</span>
QString str <span class="token operator">=</span> <span class="token string">"  lots\t of\nwhitespace\r\n "</span><span class="token punctuation">;</span>
str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">simplified</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// str == "lots of whitespace";</span>
</code></pre> 
<h4><a id="3__108"></a>3. 修改</h4> 
<p>常用的就是替换，也是支持正则匹配替换的</p> 
<pre><code class="prism language-cpp">QString str <span class="token operator">=</span> <span class="token string">"AAA BBB CCC DDD AABBCC"</span><span class="token punctuation">;</span>

<span class="token comment">//replace 方法</span>
str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"AA"</span><span class="token punctuation">,</span> <span class="token string">"哈哈哈"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     	<span class="token comment">// str == "哈哈哈A BBB CCC DDD 哈哈哈BBCC"</span>
str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token char">'B'</span><span class="token punctuation">,</span><span class="token char">'~'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// str == "哈哈哈A ~~~ CCC DDD 哈哈哈~~CC"</span>

<span class="token comment">//索引修改</span>
str<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'+'</span>				<span class="token comment">// str = "哈哈+A ~~~ CCC DDD 哈哈哈~~CC"</span>

<span class="token comment">//大小写转换</span>
QString str <span class="token operator">=</span> <span class="token string">"TeXt"</span><span class="token punctuation">;</span>
str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toUpper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// str == "TEXT"</span>
str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// str == "text"</span>
</code></pre> 
<h4><a id="4__125"></a>4. 插入</h4> 
<pre><code class="prism language-cpp">QString str <span class="token operator">=</span> <span class="token string">"Meal"</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"ontr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// str == "Montreal"</span>

QString str<span class="token punctuation">;</span>
str <span class="token operator">=</span> <span class="token string">"%1 %2"</span><span class="token punctuation">;</span>

str<span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">"%1f"</span><span class="token punctuation">,</span> <span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// returns "%1f Hello"</span>
str<span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">"%1f"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// returns "Hellof %2"</span>

str <span class="token operator">=</span> <span class="token string">"%1%2%3"</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns "Hello5020"</span>
</code></pre> 
<h4><a id="5__141"></a>5. 转换</h4> 
<pre><code class="prism language-cpp"><span class="token comment">//数字转字符串</span>
QString str<span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// str == "1234"</span>

<span class="token keyword">long</span> a <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">;</span>
QString s <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// s == "3f"</span>
QString t <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// t == "3F"</span>

<span class="token comment">//字符串转数字格式</span>
QString str <span class="token operator">=</span> <span class="token string">"1234.56"</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> val <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// val == 1234.56</span>

<span class="token keyword">bool</span> ok<span class="token punctuation">;</span>
<span class="token keyword">double</span> d<span class="token punctuation">;</span>

d <span class="token operator">=</span> <span class="token function">QString</span><span class="token punctuation">(</span> <span class="token string">"1234.56e-02"</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ok<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok == true, d == 12.3456</span>
d <span class="token operator">=</span> <span class="token function">QString</span><span class="token punctuation">(</span> <span class="token string">"1234.56e-02 Volt"</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ok<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok == false, d == 0</span>
</code></pre> 
<h3><a id="2_163"></a>2、原理版</h3> 
<p>如果你事先知道一个 QString 将包含多少个字符，你可以调用 <strong>reserve()</strong> 函数来预先分配一定量的内存。我们可以也可以调用 <strong>capacity()</strong> 来找出 QString 实际分配了多少内存。</p> 
<p><strong>replace()</strong> 和 <strong>remove()</strong> 函数的前两个参数是开始擦除的位置和应该擦除的字符数。如果要将特定子字符串的所有匹配项替换为另一个子字符串，请使用双参数 <strong>replace()</strong> 的重载函数。</p> 
<p>如果要删除 QString 两端的空格，请使用 <strong>trimmed()</strong> 函数。<br> 如果要删除两端的空格，并将字符串中的多个连续空格替换为单个空格字符，请使用 <strong>simplified()</strong> 。</p> 
<p>如果要查找 QString 中特定字符或子字符串的所有匹配项，请使用 <strong>indexOf()</strong> 或 <strong>lastIndexOf()</strong> 函数。前者从给定的索引位置开始向前搜索，后者向后搜索。如果找到字符或子字符串，两者都返回它的索引位置;否则，它们返回 -1。例如，下面是一个典型的循环，用于查找特定子字符串的所有匹配项：</p> 
<pre><code class="prism language-cpp">  QString str <span class="token operator">=</span> <span class="token string">"We must be &lt;b&gt;bold&lt;/b&gt;, very &lt;b&gt;bold&lt;/b&gt;"</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>j <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"&lt;b&gt;"</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Found &lt;b&gt; tag at index position"</span> <span class="token operator">&lt;&lt;</span> j<span class="token punctuation">;</span>
      <span class="token operator">++</span>j<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> 
<p>QString 提供了许多函数，用于将数字转换为字符串和字符串转换为数字。<strong>setNum()</strong> 函数、<strong>number()</strong> 静态函数和 <strong>toInt()</strong>、<strong>toDouble()</strong> 和类似函数<strong>toDouble() 这类转换函数还有校验是否检验成功的功能</strong>。</p> 
<p>要获取字符串的大写或小写形式，请使用 <strong>toUpper()</strong> 或 <strong>toLower()</strong>。</p> 
<p>我们可以使用 <strong>split()</strong> 函数将字符串拆分为字符串列表 QStringList 形式，<strong>这个split函数还可以选择是否过滤空字符串之类的</strong>。并使用 <strong>QStringList::join()</strong> 将字符串列表连接到带有可选分隔符的单个字符串中。可以使用 <strong>QStringList::filter()</strong> 函数从包含特定子字符串或与特定 <strong>QRegExp</strong> 匹配的字符串列表中获取字符串列表。</p> 
<pre><code class="prism language-cpp">  QString str <span class="token operator">=</span> <span class="token string">"a,,b,c"</span><span class="token punctuation">;</span>

  QStringList list1 <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token char">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// list1: [ "a", "", "b", "c" ]</span>

  QStringList list2 <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token char">','</span><span class="token punctuation">,</span> QString<span class="token double-colon punctuation">::</span>SkipEmptyParts<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// list2: [ "a", "b", "c" ]</span>

  QStringList list<span class="token punctuation">;</span>
  list <span class="token operator">&lt;&lt;</span> <span class="token string">"Bill Murray"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"John Doe"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Bill Clinton"</span><span class="token punctuation">;</span>

  QStringList result<span class="token punctuation">;</span>
  result <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">"Bill"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// result: ["Bill Murray", "Bill Clinton"]</span>
</code></pre> 
<h2><a id="_205"></a>四、查询字符串</h2> 
<p>对于只是读取字符串的话，用 <strong>at() 方法 比 [] 更快</strong>，因为 [] 是深拷贝，at只是浅拷贝或者，使用 <strong>left()、right() 或 mid()</strong> 函数一次提取多个字符。</p> 
<pre><code class="prism language-cpp">QString str<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> 
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token function">QChar</span><span class="token punctuation">(</span><span class="token char">'a'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token function">QChar</span><span class="token punctuation">(</span><span class="token char">'f'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Found character in range [a-f]"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

  QString x <span class="token operator">=</span> <span class="token string">"Pineapple"</span><span class="token punctuation">;</span>
  QString y <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// y == "Pine"</span>
  
  QString x <span class="token operator">=</span> <span class="token string">"Pineapple"</span><span class="token punctuation">;</span>
  QString y <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">right</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// y == "apple"</span>

  QString x <span class="token operator">=</span> <span class="token string">"Nine pineapples"</span><span class="token punctuation">;</span>
  QString y <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// y == "pine"</span>
  QString z <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">mid</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// z == "pineapples"</span>
</code></pre> 
<p>QString 可以嵌入“0”字符 （QChar：：Null）。size() 函数始终返回整个字符串的大小，包括嵌入的“0”字符。<br> 调用 resize() 函数后，新分配的字符具有未定义的值。要将字符串中的所有字符设置为特定值，请使用 fill() 函数。<br> QString 提供了数十种重载，旨在简化字符串的使用。例如，如果要将 QString 与字符串文本进行比较，则可以编写如下代码，它将按预期工作：</p> 
<pre><code class="prism language-cpp">QString str<span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token string">"auto"</span> <span class="token operator">||</span> str <span class="token operator">==</span> <span class="token string">"extern"</span>
	<span class="token operator">||</span> str <span class="token operator">==</span> <span class="token string">"static"</span> <span class="token operator">||</span> str <span class="token operator">==</span> <span class="token string">"register"</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// ...</span>
<span class="token punctuation">}</span>

QString str <span class="token operator">=</span> <span class="token string">"World"</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// n == 5</span>
str<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>              <span class="token comment">// returns 'W'</span>
str<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>              <span class="token comment">// returns 'd'</span>
</code></pre> 
<ul><li>用 <strong>startsWith()</strong> 或 <strong>endsWith()</strong> 查看 字符串是不是以特定的子字符串开始还是结束。</li><li>用 <strong>contains()</strong> 函数来检查 字符串 是否包含特定字符或子字符串。用 count()来统计特定字符或子字符串在字符串中出现的次数。</li><li>可以使用重载运算符(如运算符 &lt; 、&lt;= 、== 、&gt;= 等来比较 字符串大小。请注意，<strong>比较基于字符的数字 Unicode 值大小</strong>。它非常快，但不是人类所期望的。</li><li>用 <strong>QString::localeAwareCompare()</strong> 静态函数来 <strong>排序用户界面字符串</strong> 其实就是本地字符串比较。</li><li>用 <strong>data()</strong> 或 <strong>constData()</strong>。这些函数返回指向 QChar 数据开头的指针。但是指针是保证仍然有效,除非非 const QString函数被调用。这个就失效了。</li></ul> 
<pre><code class="prism language-cpp">QString str <span class="token operator">=</span> <span class="token string">"Bananas"</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"Ban"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// returns true</span>
str<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"Car"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// returns false</span>
</code></pre> 
<h2><a id="_258"></a>五、字符串格式转换</h2> 
<p>QString 提供了以下三个函数，这些函数将字符串的 const char * 版本作为 QByteArray：<strong>toUtf8()</strong>、<strong>toLatin1()</strong> 和 <strong>toLocal8Bit()</strong>。</p> 
<ul><li><strong>toLatin1()</strong> 返回一个拉丁语-1 (ISO 8859-1) 编码的 8 位字符串。</li><li><strong>toUtf8()</strong> 返回一个 UTF-8 编码的 8 位字符串。UTF-8 是 US-ASCII (ANSI X3.4-1986) 的超集，它通过多字节序列支持整个 Unicode 字符集。</li><li><strong>toLocal8Bit()</strong> 使用系统的本地编码返回一个 8 位字符串。</li></ul> 
<p>要从这些编码之一进行转换，QString 提供了 <strong>fromLatin1()、fromUtf8() 和 fromLocal8Bit()</strong>。其他编码通过 QTextCodec 类受支持。</p> 
<p>如上所述，QString 提供了许多函数和运算符，使得与 const char * 字符串的互操作变得容易。但此功能是一把双刃剑：如果所有字符串都是 US-ASCII 或 Latin-1，它会使 QString 更方便使用，但始终存在使用错误的 8 位编码完成从 const char * 到const char * 的隐式转换的风险。若要最大程度地降低这些风险，可以通过定义以下两个预处理器符号来关闭这些隐式转换：</p> 
<ul><li>QT_NO_CAST_FROM_ASCII：禁用从 C 字符串文本和指针到 Unicode 的自动转换。</li><li>QT_RESTRICTED_CAST_FROM_ASCII： 允许从 C 字符和字符数组自动转换，但禁用从字符指针到 Unicode 的自动转换。</li><li>QT_NO_CAST_TO_ASCII：禁用从 QString 到 C 字符串的自动转换。</li></ul> 
<p>为应用程序全局定义这些预处理器符号的一种方法是将以下条目添加到 qmake 项目文件中：</p> 
<pre><code class="prism language-bash">DEFINES <span class="token operator">+=</span> QT_NO_CAST_FROM_ASCII <span class="token punctuation">\</span>
             QT_NO_CAST_TO_ASCII
</code></pre> 
<p>然后，您需要显式调用 fromUtf8()、fromLatin1() 或 fromLocal8Bit() 来从 8 位字符串构造 QString，或使用轻量级 QLatin1String 类，例如：</p> 
<pre><code class="prism language-cpp">QString url <span class="token operator">=</span> <span class="token function">QLatin1String</span><span class="token punctuation">(</span>“http<span class="token operator">:</span><span class="token comment">//www.unicode.org/”);</span>
</code></pre> 
<p>同样，您必须显式调用 toLatin1()、toUtf8() 或 toLocal8Bit() 才能将 QString 转换为 8 位字符串。(其他编码通过 QText编解码器类受支持。</p> 
<h2><a id="Null__Empty__284"></a>六、Null 字符串和 Empty 字符串的区别</h2> 
<p>由于历史原因,QString区分一个空字符串和一个空字符串。一个空字符串的字符串初始化使用QString默认的构造函数或通过构造函数(const char *) 0。一个空字符串是任何字符串大小为0。 <strong>一个空字符串总是空的,但一个空字符串不一定是零</strong>:</p> 
<pre><code class="prism language-cpp">  <span class="token function">QString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// returns true</span>
  <span class="token function">QString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// returns true</span>

  <span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// returns false</span>
  <span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// returns true</span>

  <span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// returns false</span>
  <span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// returns false</span>
</code></pre> 
<p>所有的功能除了 <strong>isNull()</strong> 把null字符串一样空字符串。例如, <strong>toUtf8 () 、constData()</strong> 返回一个有效的指针(不是nullptr) ’ \ 0 '字符为空字符串。<strong>建议始终使用 isEmpty() 函数，避免 isNull ()</strong> 。</p> 
<h2><a id="_297"></a>七、字符串参数格式化</h2> 
<p>在QString的成员函数里面，有很多需要字符串参数格式化 比如(<strong>arg(), number()</strong>)函数，其实是就是把这些数字转字符串，有科学计数法的形式和浮点数那种形式。</p> 
<table><thead><tr><th>格式化</th><th>含义</th></tr></thead><tbody><tr><td>e</td><td>format as [-]9.9e[±]999</td></tr><tr><td>E</td><td>format as [-]9.9E[±]999</td></tr><tr><td>f</td><td>把数字±9.9 转换成 ±9.9</td></tr><tr><td>g</td><td>use <strong>e</strong> or <strong>f</strong> format, 看哪种更简洁</td></tr><tr><td>G</td><td>use <strong>E</strong> or <strong>f</strong> format, 看哪种更简洁</td></tr></tbody></table> 
<p>精度也是指定的参数格式。的“e”、“e”和“f”格式,精度表示小数点后的位数数。‘g’和‘g’格式、精度表示有效数字的最大数量。其实就是科学计数法那种形式。</p> 
<h2><a id="_309"></a>八、更高效的字符串构造</h2> 
<p>许多字符串在编译时是已知的。但是琐碎的构造函数 QString(“Hello”)将复制字符串的内容，将内容视为 Latin-1。为了避免这种情况，可以使用QStringLiteral宏在编译时直接创建所需的数据。从文本构造 QString 不会在运行时产生任何开销。<br> 效率稍低的方法是使用 QLatin1String。此类包装 C 字符串文本，在编译时预先计算其长度，然后可用于与 QString 进行比较并转换为 QString，而不是常规 C 字符串文本。使用 QString ‘+’ 运算符，可以轻松地从多个子字符串构造复杂的字符串。<br> 你经常会写这样的代码：</p> 
<pre><code class="prism language-cpp">QString foo<span class="token punctuation">;</span>
QString type <span class="token operator">=</span> <span class="token string">"long"</span><span class="token punctuation">;</span>

foo<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token function">QLatin1String</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>foo<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"("</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">") dd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p>这两种字符串结构都没有错，但存在一些隐藏的低效率。从Qt 4.6开始，您可以消除它们。<br> 首先，多次使用“+”运算符通常意味着多个内存分配。连接 n 个子字符串(其中 n &gt; 2)时，可以有多达 n - 1 次对内存分配器的调用。<br> 在Qt 4.6 中，添加了内部模板类 QStringBuilder 以及一些帮助程序函数。此类标记为内部，不会出现在文档中，因为您不应该在代码中实例化它。它的使用将是自动的，如下所述。该类可以在src/corelib/tools/qstringbuilder中找到.cpp如果你想看看它的话。QStringBuilder 使用表达式模板并重新实现“%”运算符，以便当您使用“%”而不是“+”进行字符串串联时，多个子字符串连接将被推迟，直到最终结果即将分配给 QString。此时，已知最终结果所需的内存量。然后调用一次内存分配器以获取所需的空间，并将子字符串逐个复制到其中。通过内联和减少引用计数来获得额外的效率(从 QStringBuilder 创建的 QString 通常具有 ref 计数 1，而 QString::append() 需要额外的测试)。有两种方法可以访问这种改进的字符串构造方法。简单的方法是在您想要使用它的任何位置包含 QStringBuilder，<strong>并在连接字符串时使用 ‘%’ 运算符而不是 ‘+’</strong>：就是推荐下面这种写法，用 % 代替 +</p> 
<pre><code class="prism language-cpp"> <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QStringBuilder&gt;</span></span>

QString <span class="token function">hello</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
QStringRef <span class="token function">el</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hello<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
QLatin1String <span class="token function">world</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
QString message <span class="token operator">=</span>  hello <span class="token operator">%</span> el <span class="token operator">%</span> world <span class="token operator">%</span> <span class="token function">QChar</span><span class="token punctuation">(</span><span class="token char">'!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>一种更全局的方法，也是最方便但不完全兼容源代码的方法，是在 .pro 文件中定义：</p> 
<p>DEFINES *= QT_USE_QSTRINGBUILDER</p> 
<p>并且“+”将在任何地方自动执行为QStringBuilder 的 “%”。</p> 
<h2><a id="_342"></a>九、最大大小和出现内存不足的情况</h2> 
<p>这个了解了解就好。</p> 
<p>QString 的当前版本的大小限制为略低于 2 GB(2<sup>31</sup> 字节)。确切的值取决于体系结构，因为它取决于管理数据块所需的开销，但不超过 32 个字节。原始数据块还受到当前版本中使用 int 类型的限制为 2 GB 减去 1 字节。由于 QString 每个字符使用两个字节，因此在一个 QString 中转换为不到 2^30 个字符。<br> 如果内存分配失败，QString 将抛出 std：：bad_alloc 异常。Qt容器中的内存不足情况是Qt抛出异常的唯一情况。<br> 请注意，操作系统可能会对持有大量已分配内存的应用程序施加进一步限制，尤其是大型连续块。此类注意事项、此类行为的配置或任何缓解措施都不在Qt API的范围之内。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f2ac2172b788f34362121706288bbed7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spark-SQL连接Hive 的五种方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7d6ef0461655ac536a467676f3fef6fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java异常(比较全)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>