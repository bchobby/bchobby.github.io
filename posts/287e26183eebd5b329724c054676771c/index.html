<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>IIS 漏洞工具解析 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="IIS 漏洞工具解析" />
<meta property="og:description" content="1. 概述通过学习文档内容。 熟悉并掌握 IIS 写入漏洞利用工具的利用方法，了解具体的功能内 容，亲自实践操作，并根据课程需求完成相关任务。
2. 工具功能说明 IIS 写入漏洞利用工具是由桂林老兵写的一款漏洞利用工具，专门针对 IIS 写入漏洞。 接下来我们具体介绍一下相关的使用。
2.1.第一部分 数据包格式 该功能模块默认的数据包传输方法有 7 种，分别是：
OPTIONS 返回服务器的各种信息
PUT 生成上传文件数据包的。
POST 用来提交表单
MOVE 是改名数据包。
COPY 是复制数据包。
DELETE 是删除数据包。
PROPFIND 是生成返回有浏览目录权限的目录内容的数据包。 最后点提交数据包把生成的数据包提交到服务器。域名在此处填写被检测网站的主机名或者 IP 地址请求文件 此处自定义被上传文件名 2.2.第二部分 该处是 HTTP 请求信息的回显区域，用于显示数据的请求状态。
2.3.第三部分 该处是 HTTP 响应信息的回显区域，用于显示服务响应结果内容。
3. 工具使用说明
例如 www.pig.com 根目录有可写权限。 选择本地一文件/填上他的域名/输入上传后存放的文件相对路径/点 PUT 生成数据包提 交即可把文件传到服务器。  改名输入域名/要改的文件名/点 MOVE 生成数据包。提交数据包后即可将指定文件改为 /shell.asp  删除文件 输入域名/输入要删除的文件相对路径/点 DELETE 生成数据包。检查无误后 提交数据包。这个文件就被删除了。
4. 案例演示
接下来以一个演示案例来说明一下 IIS 写入漏洞利用工具。首先我们需要确认目标网站 确实存在 IIS 可写入的漏洞，这个可以通过 AWVS 或者其他的扫描器辅助进行漏洞识别。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/287e26183eebd5b329724c054676771c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-09-16T22:11:01+08:00" />
<meta property="article:modified_time" content="2020-09-16T22:11:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">IIS 漏洞工具解析</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1__0"></a>1. 概述通过学习文档内容。</h3> 
<p>熟悉并掌握 IIS 写入漏洞利用工具的利用方法，了解具体的功能内 容，亲自实践操作，并根据课程需求完成相关任务。</p> 
<h3><a id="2__4"></a>2. 工具功能说明</h3> 
<p>IIS 写入漏洞利用工具是由桂林老兵写的一款漏洞利用工具，专门针对 IIS 写入漏洞。 接下来我们具体介绍一下相关的使用。<br> <img src="https://images2.imgbox.com/75/0c/wDLrFKM5_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="21_9"></a>2.1.第一部分</h3> 
<ol><li>数据包格式 该功能模块默认的数据包传输方法有 7 种，分别是：<br> OPTIONS 返回服务器的各种信息<br> PUT 生成上传文件数据包的。<br> POST 用来提交表单<br> MOVE 是改名数据包。<br> COPY 是复制数据包。<br> DELETE 是删除数据包。<br> PROPFIND 是生成返回有浏览目录权限的目录内容的数据包。 最后点提交数据包把生成的数据包提交到服务器。</li><li>域名在此处填写被检测网站的主机名或者 IP 地址</li><li>请求文件 此处自定义被上传文件名</li></ol> 
<h3><a id="22_22"></a>2.2.第二部分</h3> 
<p>该处是 HTTP 请求信息的回显区域，用于显示数据的请求状态。</p> 
<h3><a id="23_26"></a>2.3.第三部分</h3> 
<p>该处是 HTTP 响应信息的回显区域，用于显示服务响应结果内容。<br> <strong>3. 工具使用说明</strong><br> 例如 www.pig.com 根目录有可写权限。 选择本地一文件/填上他的域名/输入上传后存放的文件相对路径/点 PUT 生成数据包提 交即可把文件传到服务器。  改名输入域名/要改的文件名/点 MOVE 生成数据包。提交数据包后即可将指定文件改为 /shell.asp  删除文件 输入域名/输入要删除的文件相对路径/点 DELETE 生成数据包。检查无误后 提交数据包。这个文件就被删除了。<br> <strong>4. 案例演示</strong><br> 接下来以一个演示案例来说明一下 IIS 写入漏洞利用工具。首先我们需要确认目标网站 确实存在 IIS 可写入的漏洞，这个可以通过 AWVS 或者其他的扫描器辅助进行漏洞识别。<br> 打开IIS写入漏洞利用工具，首先得填写好存在漏洞的域名，数据包格式选择修改为PUT， 请求文件可以自定义修改，或者默认为 test.txt 均可。然后上传一个已经写好测试内容的 txt 文件，我们可以看到数据显示出来了关于请求的一些信息以及文件的内容。点击提交数据包， 即可完成请求。<br> <img src="https://images2.imgbox.com/02/33/8XWiJDVT_o.png" alt="在这里插入图片描述"></p> 
<p>数据被提交后返回响应信息，HTTP 的状态为 201 Created，说明已经写入成功。<img src="https://images2.imgbox.com/eb/4d/l1qSpw0Q_o.png" alt="在这里插入图片描述"></p> 
<p>利用浏览器访问 Location 中的 URL 地址，也就是被写入文件的访问路径，可以看到测 试信息，验证说明了文件被写入，整个实验过程完成。<br> <img src="https://images2.imgbox.com/2e/e8/3ZR8LJLw_o.png" alt="在这里插入图片描述"></p> 
<p>这次我们写入一个 ASP 的一句话木马，利用写入漏洞以及其中的 MOVE 命令完成文件 名的修改，从而获取网站权限。<br> <img src="https://images2.imgbox.com/92/c3/jMWmzWIq_o.png" alt="在这里插入图片描述"><br> 点击“提交数据包”进行数据请求<br> <img src="https://images2.imgbox.com/2c/a2/bnwyXtPl_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/26/dc/acQMgJEX_o.png" alt="在这里插入图片描述"></p> 
<p>访问上传的文件路径，可以看到确实已经上传，想要获取 webshell 需要将文件修改为 asp 的文件才能解析，接下来利用 MOVE 命令对文件名进行重命名。 <img src="https://images2.imgbox.com/c2/af/7hUDvTlf_o.png" alt="在这里插入图片描述"></p> 
<p>访问 shell.asp 我们可以发现已经成功解析了文件，利用中国菜刀这款 webshell 管理工 具即可连接，获取到网站权限。<br> <img src="https://images2.imgbox.com/c3/71/qPK050nS_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c536e6900f19207733af83871b72df18/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Idea Java 快捷键整理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f0bc5e7f80ecc5953c00d9fb1d06323e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Fashion-MNIST数据集下载失败的解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>