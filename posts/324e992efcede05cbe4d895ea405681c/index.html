<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ubuntu22.04地震数据处理软件Madagascar安装 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ubuntu22.04地震数据处理软件Madagascar安装" />
<meta property="og:description" content="目录 前言的前言前言安装之前的准备系统版本：Ubuntu22.04建议的软件目录软件下载环境（依赖库）安装（重要） 编译和安装环境变量配置安装结束结语安装过程可能遇到的问题1.epydoc2.Make过程中的_byte2tif.c编译错误（2023年4月1日版本）（后续已修复） 前言的前言 考虑到该平台每况愈下的博客环境，我将这篇文章转移到了cplusv的个人博客，目前内容在CSDN平台上依旧保留，但可能在未来某个时间我会将这个平台上的内容撤下。
前言 Madagascar 是一款开源的地震数据处理软件，其不仅提供了地震数据处理所需要的各类软件包，还为数据处理提供了有力的编程环境。更多关于Madagascar 的介绍和使用方法，可以参考官方wiki页面：
Madagascar Main Page(ahay.org)
下面是摘自官方wiki介绍：
Madagascar is an open-source software package for multidimensional data analysis and reproducible computational experiments. Its mission is to provide:
a convenient and powerful environmenta convenient technology transfer tool for researchers working with digital image and data processing in geophysics and related fields. Technology developed using the Madagascar project management system is transferred in the form of recorded processing histories, which become “computational recipes” to be verified, exchanged, and modified by users of the system." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/324e992efcede05cbe4d895ea405681c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-05T17:32:44+08:00" />
<meta property="article:modified_time" content="2023-12-05T17:32:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ubuntu22.04地震数据处理软件Madagascar安装</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">前言的前言</a></li><li><a href="#_6" rel="nofollow">前言</a></li><li><a href="#_24" rel="nofollow">安装之前的准备</a></li><li><ul><li><a href="#Ubuntu2204_25" rel="nofollow">系统版本：Ubuntu22.04</a></li><li><a href="#_30" rel="nofollow">建议的软件目录</a></li><li><a href="#_43" rel="nofollow">软件下载</a></li><li><a href="#_58" rel="nofollow">环境（依赖库）安装（重要）</a></li></ul> 
  </li><li><a href="#_182" rel="nofollow">编译和安装</a></li><li><a href="#_209" rel="nofollow">环境变量配置</a></li><li><a href="#_227" rel="nofollow">安装结束</a></li><li><a href="#_241" rel="nofollow">结语</a></li><li><a href="#_244" rel="nofollow">安装过程可能遇到的问题</a></li><li><ul><li><a href="#1epydoc_246" rel="nofollow">1.epydoc</a></li><li><a href="#2Make_byte2tifc202341_252" rel="nofollow">2.Make过程中的_byte2tif.c编译错误（2023年4月1日版本）（后续已修复）</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>前言的前言</h2> 
<p><strong>考虑到该平台每况愈下的博客环境，我将这篇文章转移到了<a href="https://cplusv2023.github.io/cplusv/2023/05/15/mada_install/" rel="nofollow">cplusv的个人博客</a>，目前内容在CSDN平台上依旧保留，但可能在未来某个时间我会将这个平台上的内容撤下。</strong><br> <img src="https://images2.imgbox.com/16/04/qH9OBUPU_o.png" alt="封面"></p> 
<h2><a id="_6"></a>前言</h2> 
<p><strong>Madagascar</strong> 是一款开源的地震数据处理软件，其不仅提供了地震数据处理所需要的各类软件包，还为数据处理提供了有力的编程环境。更多关于<strong>Madagascar</strong> 的介绍和使用方法，可以参考官方wiki页面：<br> <a href="https://www.reproducibility.org/wiki/Main_Page" rel="nofollow"><strong>Madagascar</strong> Main Page(ahay.org)</a><br> 下面是摘自官方wiki介绍：</p> 
<blockquote> 
 <p><strong>Madagascar</strong> is an open-source software package for multidimensional data analysis and reproducible computational experiments. Its mission is to provide:</p> 
 <ol><li>a convenient and powerful environment</li><li>a convenient technology transfer tool</li></ol> 
 <p>for researchers working with digital image and data processing in geophysics and related fields. Technology developed using the Madagascar project management system is transferred in the form of recorded processing histories, which become “computational recipes” to be verified, exchanged, and modified by users of the system.</p> 
</blockquote> 
<p>下面是Prof. Yang Liu 在<a href="https://www.reproducibility.org/wiki/Hefei_2020" rel="nofollow">Madagascar School on Open-Source Geophysics in Hefei 2020</a>*为<strong>Madagascar</strong>做的介绍PPT：<br> <a href="https://reproducibility.org/wikilocal/docs/school2020-introduction.pdf" rel="nofollow">Introduction to Madagascar Software Project - Yang Liu</a><br> <img src="https://images2.imgbox.com/a9/f7/dfNYpncq_o.png" alt="ppt"></p> 
<p><strong>Madagascar</strong>软件github页面：<a href="https://github.com/ahay/src">https://github.com/ahay/src</a>，你可以在这里找到软件的最新release。如果你的网络访问github存在问题，可以考虑使用gitee，具体使用方法此处不展开，放上一个gitee搜索页面：<a href="https://search.gitee.com/?skin=rec&amp;type=repository&amp;q=Madagascar" rel="nofollow">Gitee搜索:Madagascar</a>。</p> 
<p><em>*注：不定期会有<strong>Madagascar</strong>相关的活动在高校之间举办，可以参考<a href="https://www.reproducibility.org/wiki/Conferences" rel="nofollow">Madagascar Conferences</a>页面寻找更多信息。</em></p> 
<h2><a id="_24"></a>安装之前的准备</h2> 
<h3><a id="Ubuntu2204_25"></a>系统版本：Ubuntu22.04</h3> 
<p>这里使用Ubuntu版本为<strong>22.04</strong>，不同的操作系统版本可能存在细微的差别，下面的教程可以提供一个参考，同时，不同Linux发行版本的安装教程可以参考官方提供的安装教程<a href="https://www.reproducibility.org/wiki/Installation" rel="nofollow"><strong>Madagascar</strong> Installation</a>和<a href="https://www.reproducibility.org/wiki/Advanced_Installation#Platform-specific_installation_advice" rel="nofollow"><strong>Madagascar</strong> Advanced Installation(针对不同Linux发行版本)</a>，我在去年写过一篇Windows下Ubuntu WSL环境的Madagascar安装教程，有需求也可以参考<a href="https://blog.csdn.net/qq_45317164/article/details/121972078">Windows11/10 环境下安装Madagascar (WSL Ubuntu)</a>。</p> 
<p>如果你使用的是Vmware虚拟机，你需要提前安装好操作系统。关于Ubuntu-22.04操作系统的安装（包括虚拟机安装）网上有许多详尽的教程，此处不做赘述。</p> 
<h3><a id="_30"></a>建议的软件目录</h3> 
<p><strong>如果你精通linux或者对其有一定的了解，这一步可以略过。</strong><br> 在下载软件源文件之前，建议提前规划好软件的源文件存放目录和软件安装目录，由于Linux存在用户权限的问题，建议将软件所有文件放在用户目录下，以免产生不必要的麻烦。如果你对linux的使用并不熟悉，请使用下面给出的推荐的软件源文件和软件安装目录：/home/用户名/Madagascar/，或者相对目录~/Madagascar/：</p> 
<pre><code class="prism language-bash">/home/用户名/Madagascar/
├── RSFSRC
│   ├── 这里存放Madagascar软件的源文件
├── RSFROOT
│   ├── 这里为Madagascar软件（使用configure prefix参数设置，下文会讲到）
</code></pre> 
<p>如下图所示，源文件RSFSRC和软件目录RSFROOT均存放在用户文件夹的Madagascar目录下：<br> <img src="https://images2.imgbox.com/df/b7/ZRbXwndR_o.png" alt="Madagascar目录位置"></p> 
<h3><a id="_43"></a>软件下载</h3> 
<p>你需要提前准备好<strong>Madagascar</strong>源文件，推荐使用如下命令(包含了构建和进入推荐的目录文件夹)：</p> 
<pre><code class="prism language-bash"><span class="token comment">#构建和进入目录</span>
<span class="token builtin class-name">cd</span> ~ <span class="token operator">&amp;</span> <span class="token function">mkdir</span> madagascar 
<span class="token builtin class-name">cd</span> madagascar
<span class="token comment">#使用git命令clone源文件</span>
<span class="token function">git</span> clone https://github.com/ahay/src RSFSRC
</code></pre> 
<p>等待git命令clone结束即可进入下一步。如果git命令提示无法访问（经常会出现的问题）可以多尝试几次，也可以考虑使用gitee，相关的教程网上有很多也很详细，此处不再赘述。<br> 还可以通过github下载压缩包，解压到对应的RSFSRC目录下(/home/用户名/madagascar/RSFSRC/)：<a href="https://github.com/ahay/src">https://github.com/ahay/src</a></p> 
<p><img src="https://images2.imgbox.com/f0/d0/O0nL0l3F_o.png" alt="Madagascar github页面"></p> 
<h3><a id="_58"></a>环境（依赖库）安装（重要）</h3> 
<p>环境安装是<strong>Madagascar</strong>安装中最重要也是最容易忽略的一环，这一步关乎<strong>Madagascar</strong>中许多模块是否能够正确安装启用。<strong>注意：除了安装依赖库以外（该用sudo的时候会提到），请不要使用root用户或者管理员权限(sudo)。</strong><br> 首先进入克隆或者下载好的源文件目录（如果在上一步的软件下载中你没有按照推荐的目录下载或克隆，请使用你自己下载的目录而并非下面给出的目录，后面许多步骤也一样，读者请自行进行替换）。使用configure进行配置，prefix参数指定安装文件夹，如果你对linux使用不是很熟悉，建议使用下面的目录。</p> 
<pre><code class="prism language-bash"><span class="token comment">#进入目录</span>
<span class="token builtin class-name">cd</span> ~/madagascar/RSFSRC
<span class="token comment">#使用configure查看环境(prefix=后面是你想安装Madagascar的位置，建议使用下面的目录)</span>
./configure <span class="token parameter variable">--prefix</span><span class="token operator">=~</span>/madagascar/RSFROOT
</code></pre> 
<p>一般来说，直接使用configure会出现错误，而且这个报错信息会比较迷惑，如下图所示。参考下面的步骤可以解决这个问题。<br> <img src="https://images2.imgbox.com/e6/05/Ky0Xn4rJ_o.png" alt="第一次configure报错"></p> 
<p>首先，Ubuntu22.04虽然自带Python3.10，但是无法直接使用python命令，而只能使用python3命令。<s>所以我们首先给python创建一个软链接（其实是复制）</s> 所以我们使用Ubuntu的APT来配置python3环境sudo apt install python-is-python3：</p> 
<pre><code class="prism language-bash"><span class="token comment">#查看python命令是否合法</span>
<span class="token function">which</span> python
<span class="token comment">#一般来说（如果是刚刚安装好的ubuntu22.04系统），这个命令没有输出</span>
<span class="token comment">#或者使用下面的命令，一般来说会提示找不到命令“python”:</span>
python <span class="token parameter variable">--version</span>
<span class="token comment">#如果没有出现“找不到命令'python'”，而是输出了对应的3.10版本号的话，下面这一步可以跳过</span>
<span class="token comment">## 我一开始没有意识到复制这个操作是比较不好的</span>
<span class="token comment">#需要管理员权限(sudo)</span>
<span class="token comment">######### 最好不要这样： sudo cp /usr/bin/python3 /usr/bin/python</span>
<span class="token comment"># Ubuntu 有自带的配置Python3的方法：</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python-is-python3
</code></pre> 
<p><strong>注：如果你有更完善的python环境配置（例如anaconda），这一步请注意自行调整。</strong><br> 创建完python3到python的软连接之后，再使用which python或者python --version命令的话应该是有输出的，如下图所示：<br> <img src="https://images2.imgbox.com/ce/a9/LKhHibJE_o.png" alt="python软连接"><br> 建立完软连接之后，再使用configure依旧会报错，如下图所示，不过这个报错提示比较有针对性：没有安装pip。</p> 
<pre><code class="prism language-bash"><span class="token comment">#第二次configure</span>
./configure <span class="token parameter variable">--prefix</span><span class="token operator">=~</span>/madagascar/RSFROOT
</code></pre> 
<p><img src="https://images2.imgbox.com/1b/97/nl70WDts_o.png" alt="第二次configure报错"><br> 包括pip在内的其他依赖库可以参考官方页面的依赖库安装教程<a href="https://www.reproducibility.org/wiki/Advanced_Installation#Platform-specific_installation_advice" rel="nofollow"><strong>Madagascar</strong> Advanced Installation</a>解决，下面给出Ubuntu22.04版本的解决方案（依然是参考官方的教程）。</p> 
<pre><code class="prism language-bash"><span class="token comment">#安装python pip 和必要的numpy包</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> pip
<span class="token comment">#虽然不推荐使用sudo安装numpy，但是只有这样才能在软件configure的时候识别到。</span>
<span class="token comment">#使用sudo安装一般会有如下WARNING：</span>
<span class="token comment">#WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv</span>
<span class="token function">sudo</span> python <span class="token parameter variable">-m</span> pip <span class="token function">install</span> numpy
<span class="token comment">#安装有关依赖(必要）</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python3 python-is-python3 python3-dev python-dev-is-python3 python3-pip <span class="token punctuation">\</span>
python3-numpy libxaw7-dev 
<span class="token comment">##########################################################################################</span>
<span class="token comment">#安装有关依赖(可选项）</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python3 python-is-python3 python3-dev python-dev-is-python3 python3-pip <span class="token punctuation">\</span>
python3-numpy libxaw7-dev freeglut3-dev libnetpbm10-dev libgd-dev libplplot-dev <span class="token punctuation">\</span>
libcairo2-dev libjpeg-dev swig g++ gfortran libopenmpi-dev libfftw3-dev <span class="token punctuation">\</span>
libavcodec-dev libsuitesparse-dev <span class="token function">git</span>
</code></pre> 
<p>上面的安装结束之后，再使用configure便可以合理的输出了。当然，可以再对各项输出进行检验。例如，如果你的电脑有支持cuda的显卡并且有意使用的话，可以在进行下一步的安装之前将cuda环境配置好，由于这一部分并不通用且网上相应的教程也很多也比较详细，此处不多赘述。</p> 
<p><strong>注意：如果你的系统下安装了cuda(nvcc --version可查看cuda版本)，最好确认其版本不过高，目前已知cuda-12.0在下面的make过程会报错而cuda-11.0不会，如果你在make过程中遇到了与cuda相关的(编译器为nvcc而不是gcc)问题，可以考虑降低系统的cuda版本。</strong></p> 
<pre><code class="prism language-bash"><span class="token comment">#第三次configure</span>
./configure <span class="token parameter variable">--prefix</span><span class="token operator">=~</span>/madagascar/RSFROOT
</code></pre> 
<p>按理来说，输出应该是下面这样：</p> 
<pre><code class="prism language-bash">checking <span class="token keyword">for</span> Python <span class="token punctuation">..</span>. /usr/bin/python
checking Python version <span class="token punctuation">..</span>. <span class="token number">3.10</span>.4
checking <span class="token keyword">for</span> RSFROOT <span class="token punctuation">..</span>. ~/madagascar/RSFROOT
checking <span class="token keyword">for</span> SCons <span class="token punctuation">..</span>. /usr/bin/scons
checking SCons version <span class="token punctuation">..</span>. v4.0.1.c289977f8b34786ab6c334311e232886da7e8df1
Running <span class="token assign-left variable">RSFROOT</span><span class="token operator">=~</span>/madagascar/RSFROOT /usr/bin/scons  config <span class="token punctuation">..</span>.
------------------------
scons: Reading SConscript files <span class="token punctuation">..</span>.
checking platform <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> linux <span class="token punctuation">[</span>ubuntu<span class="token punctuation">]</span>
checking <span class="token keyword">for</span> C compiler <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> gcc
checking <span class="token keyword">if</span> gcc works <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">if</span> gcc accepts <span class="token string">'-x c -std=gnu17 -Wall -pedantic'</span> <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> ar <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> ar
checking <span class="token keyword">for</span> rpc <span class="token punctuation">..</span>. no
checking complex support <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> X11 headers <span class="token punctuation">..</span>. /usr/include
checking <span class="token keyword">for</span> X11 libraries <span class="token punctuation">..</span>. /usr/lib/X11
checking <span class="token keyword">for</span> OpenGL <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> sfpen <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> xtpen
checking <span class="token keyword">for</span> ppm <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> tiff <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> GD <span class="token punctuation">(</span>PNG<span class="token punctuation">)</span> <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> GD <span class="token punctuation">(</span>GIF<span class="token punctuation">)</span> <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> plplot <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> ffmpeg <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> cairo <span class="token punctuation">(</span>PNG<span class="token punctuation">)</span> <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> cairo <span class="token punctuation">(</span>SVG<span class="token punctuation">)</span> <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> cairo <span class="token punctuation">(</span>PDF<span class="token punctuation">)</span> <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> jpeg <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> BLAS <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> LAPACK <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> SWIG <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> /usr/bin/swig
checking <span class="token keyword">for</span> numpy <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> <span class="token function">yes</span>
checking API options <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
checking <span class="token keyword">for</span> C++ compiler <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> g++
checking <span class="token keyword">if</span> g++ works <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">if</span> g++ accepts <span class="token string">'-std=gnu++17 -U__STRICT_ANSI__ -Wall -pedantic'</span> <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> MPICC <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> /usr/bin/mpicc
checking <span class="token keyword">if</span> /usr/bin/mpicc works <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> MPICXX <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> /usr/bin/mpicxx
checking <span class="token keyword">if</span> /usr/bin/mpicxx works <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> MPIRUN <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> /usr/bin/mpirun
checking <span class="token keyword">for</span> Posix threads <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> OpenMP <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> CUDA <span class="token punctuation">..</span>. <span class="token punctuation">(</span>cached<span class="token punctuation">)</span> no
checking <span class="token keyword">for</span> FFTW <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">if</span> FFTW supports threads <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> SuiteSparse <span class="token punctuation">..</span>. <span class="token function">yes</span>
checking <span class="token keyword">for</span> pfft <span class="token punctuation">..</span>. no
scons: <span class="token keyword">done</span> reading SConscript files.
scons: Building targets <span class="token punctuation">..</span>.
shell_script<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"env.sh"</span><span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
shell_script<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"env.csh"</span><span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
scons: <span class="token keyword">done</span> building targets.
------------------------
Done with configuration.
</code></pre> 
<p>参考上面的输出，如果你和上面所展示的一样，大部分需要的条目都是’yes’，便可以继续下一步的安装。</p> 
<h2><a id="_182"></a>编译和安装</h2> 
<p>在configure没有问题之后，便可以开始编译和安装。只需要一个简单的make命令(当然，可能会有点慢，可以使用scons -j来加快编译速度)：</p> 
<pre><code class="prism language-bash"><span class="token comment">#以防万一（如果你在这个目录下，可以忽略这个cd命令）。</span>
<span class="token comment">#当然，如果你自定了源文件目录，请使用你的自定目录。</span>
<span class="token builtin class-name">cd</span> ~/madagascar/RSFSRC
<span class="token comment">#编译和安装</span>
<span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
<span class="token comment"># 或者使用</span>
<span class="token comment"># scons -j 4 &amp;&amp; make install</span>
<span class="token comment"># 如果你的处理器支持更多线程，这个4可以换成更大的数字</span>
</code></pre> 
<p>由于相关的源文件比较多，编译时间通常会比较长。编译结束之后，你会看到如下图所示的输出（就是在提示你已经编译安装完成要配置环境变量）。接下来便可以进行环境变量的配置。<br> <img src="https://images2.imgbox.com/81/b7/Yz3jeN8d_o.png" alt="编译安装完成"></p> 
<pre><code class="prism language-bash">---------------------------------------------------------
To start using madagascar, <span class="token builtin class-name">source</span> env.sh or env.csh from:
    /home/用户名/madagascar/RSFROOT/share/madagascar/etc/
Local documentation center at:
    /home/用户名/madagascar/RSFROOT/share/doc/madagascar/
Documentation wiki at http://www.ahay.org
---------------------------------------------------------
</code></pre> 
<h2><a id="_209"></a>环境变量配置</h2> 
<p>最后一步，配置环境变量。参考上面的提示，打开你的终端配置文件 ~/.bashrc。Ubuntu22.04默认的终端是bash，所以这里用 ~/.bashrc做参考。当然，如果你在使用其他的shell如zsh等，打开相应的配置文件即可。<br> 如果你使用的带有图形界面的Ubuntu，你可以使用Ubuntu自带的gedit打开：</p> 
<pre><code class="prism language-bash">gedit ~/.bashrc
</code></pre> 
<p>当然，你也可以使用vim（Ubuntu22.04应该是不自带vim的）或者其他文本编辑软件。<br> 然后使用图形界面进行文本编辑。在文件的最后追加一行：</p> 
<pre><code class="prism language-bash"><span class="token comment">#下面使用的是上面推荐的RSFROOT的目录地址，如果你在安装时自定了安装目录，请使用你的自定安装目录</span>
<span class="token builtin class-name">source</span> ~/madagascar/RSFROOT/share/madagascar/etc/env.sh
</code></pre> 
<p>你甚至可以用echo命令完成上面的步骤：</p> 
<pre><code class="prism language-bash"><span class="token comment">#下面使用的是上面推荐的RSFROOT的目录地址，如果你在安装时自定了安装目录，请使用你的自定安装目录</span>
<span class="token builtin class-name">echo</span> <span class="token string">'source ~/madagascar/RSFROOT/share/madagascar/etc/env.sh'</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
</code></pre> 
<p><img src="https://images2.imgbox.com/12/35/J38Hs4Om_o.png" alt="使用gedit编辑bashrc"></p> 
<h2><a id="_227"></a>安装结束</h2> 
<p>环境配置结束之后，你便完成了<strong>Madagascar</strong>的安装工作。打开一个新的终端，或者在旧的终端使用source ~/.bashrc 命令，你便可以调用<strong>Madagascar</strong>相关的软件模块了。以sfin为例：</p> 
<pre><code class="prism language-bash">sfin
</code></pre> 
<p>会输出对应的模块说明文档(键入q可以退出该页面)：<br> <img src="https://images2.imgbox.com/b7/16/MCwYoEBg_o.png" alt="sfin说明文档"><br> 你可以使用下面的命令查看图像输出：</p> 
<pre><code class="prism language-bash">sfspike <span class="token assign-left variable">n1</span><span class="token operator">=</span><span class="token number">1000</span> <span class="token assign-left variable">k1</span><span class="token operator">=</span><span class="token number">300</span> <span class="token operator">|</span> sfbandpass <span class="token assign-left variable">fhi</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">phase</span><span class="token operator">=</span>y <span class="token operator">|</span> <span class="token punctuation">\</span>
sfwiggle <span class="token assign-left variable">clip</span><span class="token operator">=</span><span class="token number">0.02</span> <span class="token assign-left variable">title</span><span class="token operator">=</span><span class="token string">"Welcome to Madagascar"</span> <span class="token operator">|</span> sfpen
</code></pre> 
<p>其输出应该为：<br> <img src="https://images2.imgbox.com/8d/9f/6Rv2pKZt_o.png" alt="Welcome to Madagascar"></p> 
<h2><a id="_241"></a>结语</h2> 
<p>Madagascar是一款强大的开源数据处理软件，不仅仅限制于地震数据处理，其多样的软件模块为包括地震数据处理和图像处理在内的许多问题的解决提供了很好的软件环境。更多的Madagascar使用方法和教程可以参考官方网站<a href="https://www.reproducibility.org/wiki/Main_Page" rel="nofollow"><strong>Madagascar</strong> Main Page(ahay.org)</a>。不定期会有相应的会议或者教学活动举办，可以关注<a href="https://www.reproducibility.org/wiki/Conferences" rel="nofollow">Madagascar Conferences</a>，还可以关注开发者博客。以上这些内容在Main Page里面都可以找到。后续还会有更多更丰富的内容，尽情期待！</p> 
<h2><a id="_244"></a>安装过程可能遇到的问题</h2> 
<p>我的邮箱：cplusv_official@qq.com</p> 
<h3><a id="1epydoc_246"></a>1.epydoc</h3> 
<p>2023年1月4日更新：<br> <img src="https://images2.imgbox.com/a6/e2/QXESkYaq_o.png" alt="在这里插入图片描述"><br> 由于系统中存在python2.x版本的epydoc，导致在make过程中使用的基于python3的scons和python2的语法不兼容而报错，<br> 解决方法：<br> 使用sudo pip uninstall epydoc移除epydoc</p> 
<h3><a id="2Make_byte2tifc202341_252"></a>2.Make过程中的_byte2tif.c编译错误（2023年4月1日版本）（后续已修复）</h3> 
<p><strong>2023年4月8日2e4cf60已修复</strong><br> 由于当前版本的Madagascar存在bug，导致在make&amp;make install这一步中会出现如下错误：</p> 
<pre><code class="prism language-bash">$ gcc <span class="token parameter variable">-o</span> build/user/fomels/sfbyte2tif <span class="token parameter variable">-pthread</span> <span class="token parameter variable">-fopemp</span> build/user/fonels/_byte2tif.o -lbuild/lib <span class="token parameter variable">-lrsf</span> <span class="token parameter variable">-ln</span> <span class="token parameter variable">-lblas</span> <span class="token parameter variable">-llapack</span> <span class="token parameter variable">-lblas</span> -lgonmp-lfftw3f <span class="token parameter variable">-lfftw3</span> <span class="token parameter variable">-lfftw3f_threads</span> <span class="token parameter variable">-lfftw3_threads</span> <span class="token parameter variable">-ltiff</span> 
/usr/bin/ld: build/user/fomels/_byte2tif.o: <span class="token keyword">in</span> <span class="token keyword">function</span> <span class="token string">'main'</span> <span class="token builtin class-name">:</span>
_byte2tif.c: <span class="token punctuation">(</span>.text.startup+0x109<span class="token punctuation">)</span>: undefined reference to <span class="token string">'write_JPEG_file'</span>
collect2 <span class="token builtin class-name">:</span> error: ld returned <span class="token number">1</span> <span class="token builtin class-name">exit</span> status
</code></pre> 
<p>可以参考Github这篇issue：<br> <a href="https://github.com/ahay/src/issues/287">[BUG] Fatal error while gcc building src/user/fomel/_byte2tif.c (A immature solution is suggested.) #287</a><br> <strong>解决方法（2种）：</strong></p> 
<ol><li>下载前一个稳定版本的Madagascar进行安装。</li><li>如果采用当前版本，进入源文件目录下的user/fomel/（如果你按照我的推荐方案来的话应该是/home/你的用户名/madagascar/RSFSRC/user/fomel/）,打开该目录下的SConstruct文件，将其种的第129行的：</li></ol> 
<pre><code class="prism language-python">    prog <span class="token operator">=</span> env<span class="token punctuation">.</span>Program<span class="token punctuation">(</span><span class="token string">'sf'</span><span class="token operator">+</span>conv<span class="token punctuation">,</span><span class="token string">'_%s.c'</span> <span class="token operator">%</span> conv<span class="token punctuation">,</span>LIBS<span class="token operator">=</span>libs<span class="token operator">+</span><span class="token punctuation">[</span>tiff<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>       改成：</p> 
<pre><code class="prism language-python">    prog <span class="token operator">=</span> env<span class="token punctuation">.</span>Program<span class="token punctuation">(</span><span class="token string">'sf'</span><span class="token operator">+</span>conv<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'_%s.c'</span> <span class="token operator">%</span> conv<span class="token punctuation">,</span>jpeg_o<span class="token punctuation">]</span> <span class="token punctuation">,</span>LIBS<span class="token operator">=</span>libs<span class="token operator">+</span><span class="token punctuation">[</span>tiff<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span>jpeg<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>       即可正常make &amp; make install。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e521d2a37275fe8b29d9884ee29064c2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Mabatis处理异常屏蔽SQL返回前端全局异常捕获处理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/499533fc144a9401875c27ad024620f2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android.mk转Android.bp及介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>