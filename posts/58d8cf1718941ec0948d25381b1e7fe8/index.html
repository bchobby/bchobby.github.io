<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>系统学习 Zabbix 系统监控（二） - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="系统学习 Zabbix 系统监控（二）" />
<meta property="og:description" content="本系列文章介绍了zabbix 基本概念及其特点，阐述 zabbix 系统环境搭建与基础安装，如何实现对各类操作系统、硬件设备、应用软件监控告警。本文为系列第二篇，内容包括Windows 系统硬件信息获取、Linux 系统监控、Linux 系统硬件信息获取。前文点此：系统学习 Zabbix 系统监控（一）
5 windows 系统硬件信息获取 本文通过在 OS 操作系统层面上，主要获取 windows 服务器下 CPU 信息、内存信息、硬盘信息、操作系统、服务器信息。信息获取的实现方式是通过在 windows 系统下部署自定义 bat 脚本，执行脚本获取数据，再将获取的信息发送给 zabbix 服务端， zabbix 界面创建相应的监控项，触发器等，最终将信息展示出来。监控项内容如下：
CPU 信息：型号、个数、内核数、逻辑核、 CPU 健康状态，及状态告警。
内存信息：容量、个数、厂商、型号、序列号；主板支持内存最大容量和个数。
硬盘信息：厂商、个数、容量、序列号、接口类型、硬盘健康状态，及状态告警。
操作系统信息：主机名、操作系统版本、运行时长、统线程数、系统时间。
服务器信息：品牌、型号、序列号。
说明：一些特殊数据需要实现监控，例如 CPU 温度、硬盘状态、 Raid 卡状态、风扇转速等， windows 没有提供检测硬件温度组件，需要借助第三方工具如 IPMI tools ， fan-speed 等，也可以使用 IPMI 协议等其他方法来丰富 windows 系统硬件监控项，对于虚拟机并不适用，此时，推荐使用服务器的管理口，如 HPE 服务器的 iLO 、 DEll 服务器的 iDRAC ，联想服务器 XCC 等开启 snmp 功能，再进行 zabbix 配置，实现对服务器硬件全面监控。如果服务器未配置管理口，当然不能适用。
5.1 CPU 信息获取 应用集：CPU 硬件" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/58d8cf1718941ec0948d25381b1e7fe8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-26T14:15:27+08:00" />
<meta property="article:modified_time" content="2021-01-26T14:15:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">系统学习 Zabbix 系统监控（二）</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/5e/b2/C1cmxWu0_o.png" alt="image">本系列文章介绍了zabbix 基本概念及其特点，阐述 zabbix 系统环境搭建与基础安装，如何实现对各类操作系统、硬件设备、应用软件监控告警。本文为系列第二篇，内容包括Windows 系统硬件信息获取、Linux 系统监控、Linux 系统硬件信息获取。前文点此：<a href="https://blog.csdn.net/weixin_54750412/article/details/113112948">系统学习 Zabbix 系统监控（一）</a></p> 
<h3><a id="5_windows__3"></a><strong>5 windows 系统硬件信息获取</strong></h3> 
<p>本文通过在 OS 操作系统层面上，主要获取 windows 服务器下 CPU 信息、内存信息、硬盘信息、操作系统、服务器信息。信息获取的实现方式是通过在 windows 系统下部署自定义 bat 脚本，执行脚本获取数据，再将获取的信息发送给 zabbix 服务端， zabbix 界面创建相应的监控项，触发器等，最终将信息展示出来。监控项内容如下：</p> 
<p>CPU 信息：型号、个数、内核数、逻辑核、 CPU 健康状态，及状态告警。</p> 
<p>内存信息：容量、个数、厂商、型号、序列号；主板支持内存最大容量和个数。</p> 
<p>硬盘信息：厂商、个数、容量、序列号、接口类型、硬盘健康状态，及状态告警。</p> 
<p>操作系统信息：主机名、操作系统版本、运行时长、统线程数、系统时间。</p> 
<p>服务器信息：品牌、型号、序列号。</p> 
<p>说明：一些特殊数据需要实现监控，例如 CPU 温度、硬盘状态、 Raid 卡状态、风扇转速等， windows 没有提供检测硬件温度组件，需要借助第三方工具如 IPMI tools ， fan-speed 等，也可以使用 IPMI 协议等其他方法来丰富 windows 系统硬件监控项，对于虚拟机并不适用，此时，推荐使用服务器的管理口，如 HPE 服务器的 iLO 、 DEll 服务器的 iDRAC ，联想服务器 XCC 等开启 snmp 功能，再进行 zabbix 配置，实现对服务器硬件全面监控。如果服务器未配置管理口，当然不能适用。</p> 
<h3><a id="51_CPU__20"></a><strong>5.1 CPU 信息获取</strong></h3> 
<p>应用集：CPU 硬件</p> 
<p>cpu 信息主要有：CPU 型号、 CPU 颗数、 CPU 核数、 CPU 逻辑核与线程（超线程，一般是核心数的 2 倍）</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/3c/cd/7npodhEl_o.png" alt=""></p> 
<h4><a id="511_CPU__31"></a><strong>5.1.1 CPU 型号</strong></h4> 
<p>需要编写程序对 CPU 型号进行提取，相关配置如下：</p> 
<p>1 、在 C:zabbixconfzabbix_agentd.win.conf 文件中：自定义程序开关设置为开启， UnsafeUserParameters=1 并添加监控项：</p> 
<p>CPU 型号<br> UserParameter=cpu_hardware_model,C:zabbixscriptcpu_hardware_model.bat</p> 
<p>Zabbix 界面添加监控项：</p> 
<p>监控 key 值：</p> 
<p>cpu_hardware_model</p> 
<p>2、程序目录为</p> 
<p>C:zabbixscriptcpu_hardware_model.bat</p> 
<p><img src="https://images2.imgbox.com/b9/50/8XipIPui_o.png" alt=""></p> 
<p>3 、监控项配置：</p> 
<p><img src="https://images2.imgbox.com/80/80/ZxcRb8OJ_o.png" alt=""></p> 
<h4><a id="512_CPU__56"></a><strong>5.1.2 CPU 颗数</strong></h4> 
<p>需要编写程序对 CPU 型号进行提取，相关配置如下：</p> 
<p>1 、在 C:zabbixconfzabbix_agentd.win.conf 文件中：自定义程序开关设置为开启， UnsafeUserParameters=1 并添加监控项：</p> 
<p>CPU 型号<br> UserParameter=cpu_hardware_number,C:zabbixscriptcpu_hardware_number.bat</p> 
<p>2 、程序目录为：</p> 
<p>C:zabbixscriptcpu_hardware_number.bat</p> 
<p><img src="https://images2.imgbox.com/13/fb/WATh7PmR_o.png" alt=""></p> 
<p>3 、监控项配置：</p> 
<p><img src="https://images2.imgbox.com/a0/09/qWm2021p_o.png" alt=""></p> 
<h4><a id="513_CPU__75"></a><strong>5.1.3 CPU 核数</strong></h4> 
<p>需要编写程序对 CPU 核数进行提取，相关配置如下：</p> 
<p>1 、在 C:zabbixconfzabbix_agentd.win.conf 文件中：自定义程序开关设置为开启， UnsafeUserParameters=1 并添加监控项：</p> 
<p>CPU 核数 一颗 CPU 的核心数<br> UserParameter=cpu_hardware_core,C:zabbixscriptcpu_hardware_core.bat</p> 
<p>2 、程序目录为：</p> 
<p>C:zabbixscriptcpu_hardware_core.bat</p> 
<p><img src="https://images2.imgbox.com/96/98/479I98RL_o.png" alt=""></p> 
<p>3 、监控项配置：</p> 
<p><img src="https://images2.imgbox.com/a4/7b/rIi17lap_o.png" alt=""></p> 
<h4><a id="514_CPU__94"></a><strong>5.1.4 CPU 逻辑核与线程</strong></h4> 
<p>使用 zabbix 自带 key ，监控 key 值：system.cpu.num[]</p> 
<p>说明：type 可用值， online ( 默认值 ), max 范例 : system.cpu.num</p> 
<p>经实践检查此处的 key 值为逻辑核心， CPU 逻辑核心、线程（超线程，一般是核心数的 2 倍） windows 系统下管理处理器，看到的数量。</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/fb/18/7Jf2r5Eb_o.png" alt=""></p> 
<h4><a id="515__106"></a><strong>5.1.5 监控结果</strong></h4> 
<p><img src="https://images2.imgbox.com/bf/47/z3URCNTg_o.png" alt=""></p> 
<h3><a id="52__110"></a><strong>5.2 内存信息获取</strong></h3> 
<p>memery 内存信息：包括序号、制造商、容量、序列号、型号、速率</p> 
<p>memery 内存主板支持：最大容量 , 最大槽位数</p> 
<h4><a id="521__117"></a><strong>5.2.1 创建监控项</strong></h4> 
<p><img src="https://images2.imgbox.com/3a/76/RB8No5QL_o.png" alt=""></p> 
<p>创建：memery 内存信息、 memery 内存主板支持</p> 
<p>键值：memory_biso_support_info 、 memory_hardware_info</p> 
<p>应用集：Memory 内存硬件</p> 
<h4><a id="522__127"></a><strong>5.2.2 监控结果</strong></h4> 
<p>1 、监测中 &gt; 最新数据 &gt;Memory 内存硬件 &gt;memery 内存信息</p> 
<p><img src="https://images2.imgbox.com/62/ec/iG8tIQR9_o.png" alt=""></p> 
<p>可以看到，序列依次为：内存序号、容量、制造商、型号、序列号、速率。</p> 
<p>2、监测中 &gt; 最新数据 &gt;Memory 内存硬件 &gt;memery 内存主板支持</p> 
<p><img src="https://images2.imgbox.com/15/31/fqOvr7NE_o.png" alt=""></p> 
<p>第一列为主板支持最大容量，第二列为主板支持最大槽位数。</p> 
<h3><a id="53__141"></a><strong>5.3 操作系统信息</strong></h3> 
<p>OS 操作系统信息：主机名、操作系统版本、运行时长、统线程数、系统时间。</p> 
<p>其中操作系统版本是自定义程序获取，主机名、运行时长、统线程数、系统时间是 zabbix 自带监控模板，自带模板直接套用。</p> 
<h4><a id="531__148"></a><strong>5.3.1 创建监控项</strong></h4> 
<p><img src="https://images2.imgbox.com/ed/e4/lNeK2lrq_o.png" alt=""></p> 
<p>创建：系统时间、操作系统版本、绝对秒、系统线程数、系统运行时长、主机名</p> 
<p>键值：system.localtime[local] 、 os_version 、 system.localtime[] 、 perf_counter[2250] 、 system.uptime 、 system.hostname[]</p> 
<p>应用集：OS 操作系统</p> 
<h4><a id="532__158"></a><strong>5.3.2 监控结果</strong></h4> 
<p>监测中 &gt; 最新数据 &gt;OS 操作系统</p> 
<p><img src="https://images2.imgbox.com/81/e0/gxMUi8wH_o.png" alt=""></p> 
<h3><a id="54__164"></a><strong>5.4 服务器信息</strong></h3> 
<p>监控服务器信息：品牌、型号、序列号。</p> 
<h4><a id="541__169"></a><strong>5.4.1 创建监控项</strong></h4> 
<p><img src="https://images2.imgbox.com/90/a6/Onnzj3a9_o.png" alt=""></p> 
<p>创建：OS 服务器序列号、 OS 服务器型号、 OS 服务器品牌</p> 
<p>键值：os_device_serialnumber 、 os_device_mode 、 os_device_manufacturer</p> 
<p>应用集：OS 服务器信息</p> 
<h4><a id="542__179"></a><strong>5.4.2 监控结果</strong></h4> 
<p>监测中 &gt; 最新数据 &gt;OS 服务器信息</p> 
<p><img src="https://images2.imgbox.com/ff/68/8nUEGLev_o.png" alt=""></p> 
<h3><a id="6_Linux__185"></a><strong>6 Linux 系统状态监控</strong></h3> 
<p>Linux 系统监控，监控项原则上能利用 zabbix 提供模板就尽量使用， zabbix 提供不了的就编写 shell 脚本，这样就省去大部分代码编写时间，减少工作量。状态信息原则上已使用率为主要观察点，不需要再监控剩余率， Linux 系统监控模板，与 window 系统监控应用集、监控项命名保持统一，监控模板如下所示：</p> 
<p>应用集：CPU 状态、 CPU 硬件、 Disk 硬盘、 Disk 磁盘状态、 Memory 内存状态、 Memory 内存硬件、 OS 操作系统、 OS 服务器信息、 agent 模板链接。</p> 
<p><img src="https://images2.imgbox.com/d8/45/EdyhCcOQ_o.png" alt=""></p> 
<h3><a id="61_Linux__zabbix_agent_194"></a><strong>6.1 Linux 部署 zabbix_agent</strong></h3> 
<p>说明：为了支持批量安装，一键化安装 linux 5 、 6 、 7 不同版本安装，需要有脚本程序支撑，自己编写的一建安装脚本，易于批量部署，至于 zabbix agent 安装配置也很简单，网上搜索很多，这里就给读者讲一些我的实践过程。</p> 
<p>zabbix_agent_linux_install 脚本目录，上传至被监控 linux 主机，执行 sh install.sh IP</p> 
<p>IP 为 zabbix 服务 IP ，当前环境为 192.168.9.123 ，该脚本一键化安装，无需配置 /etc/zabbix/ 下配置，自动识别 linux 版本，脚本内安装选项可以调整。</p> 
<p><img src="https://images2.imgbox.com/8a/26/lfPZZzeQ_o.png" alt=""></p> 
<p>安装完毕后， zabbix 界面添加主机，并关联模板。当然可以配置 IP 范围使用自动发现主机。</p> 
<h3><a id="62_Linux__CPU__207"></a><strong>6.2 Linux 系统 CPU 监控</strong></h3> 
<p>应用集：CPU 状态<br> CPU 状态：CPU 使用率、 CPU 负载 1 分钟、 5 分钟、 15 分钟。<br> linux 系统 CPU 状态监控，官方已提供监控项，可以直接使用，无需自行编写脚本。具体参考官方链接：<a href="https://link.zhihu.com/?target=https%3A//www.zabbix.com/documentation/3.4/zh/manual/appendix/items/supported_by_platform%3Fs" rel="nofollow">https://www.zabbix.com/documentation/3.4/zh/manual/appendix/items/supported_by_platform?s</a>[]=system&amp;s[]=hw&amp;s[]=cpu&amp;s[]=info ，支持 linux 与 windows 系统。</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/d7/44/NHzRM8i8_o.png" alt=""></p> 
<p>注意：实际环境采用 user 系统使用率代替 cpu 整体使用率，因 linux 系统占用的 cpu 资源比较少 1% 。此处 cpu load 负载监控的值为 top 命令下看到的数值。</p> 
<h3><a id="63_Linux__220"></a><strong>6.3 Linux 系统内存监控</strong></h3> 
<p>应用集：Memory 内存状态</p> 
<p>Memory 内存状态主要监控项有：Memory 内存使用率、 Memory 内存使用量、 Memory 内存总量（带上 Memory 方便了排序归类）。Swap 交换分区使用率、 Swap 交换分区使用量、 Swap 交换分区总量。</p> 
<p>注意：此处的内存使用率为真实使用，会计算上缓存里占用的内存空间。不使用 zabbix 系统提供的 vm.memory.size[pused] （会将缓存计算进去），而使用通过 shell 脚本计算的真实内存。</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/a0/22/x6gtDhPf_o.png" alt=""></p> 
<p>说明：配置与 windows 下内存监控方法一样不在详述。</p> 
<p>1 、提供计算真实内存脚本 /etc/zabbix/script/memory_fact_used.sh ：</p> 
<p><img src="https://images2.imgbox.com/6b/78/izXH4GnY_o.png" alt=""></p> 
<p>2 、在 /etc/zabbix/zabbix_agentd.d/ 目录下创建规范文件名 .conf 结尾，添加如下内容:</p> 
<p>UserParameter=mem.fact.used, /etc/zabbix/script/memory_fact_used.sh</p> 
<p>3 、监控项配置：</p> 
<p><img src="https://images2.imgbox.com/ac/44/2Vvq8JnF_o.png" alt=""></p> 
<h4><a id="64_Linux__247"></a><strong>6.4 Linux 磁盘使用监控</strong></h4> 
<p>应用集：Disk 磁盘使用</p> 
<p>Linux 磁盘使用监控主要信息是：磁盘目录的使用情况，包括容量与索引。</p> 
<p>监控方式：采用 zabbix 自动发现，将信息批量获取。</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/08/64/hpWsvRm5_o.png" alt=""></p> 
<p>监控项原型配置：</p> 
<p><img src="https://images2.imgbox.com/7b/3e/d1yY89gL_o.png" alt=""></p> 
<h3><a id="65_Linux__263"></a><strong>6.5 Linux 磁盘读写监控</strong></h3> 
<p>应用集：Disk 磁盘读写</p> 
<p>Disk 磁盘读写主要监控的信息有：读写速率、 IO 使用率、 IO 响应时间等</p> 
<p>1、采用 zabbix 自发现，编写代码生成含有 sda 磁盘信息的 json 文件</p> 
<p>Shell 代码：discovery_disk.sh</p> 
<p><img src="https://images2.imgbox.com/8d/35/TbyeC8MT_o.png" alt=""></p> 
<p>或 Python 代码：discovery_disk.py</p> 
<p><img src="https://images2.imgbox.com/1d/1c/gItzRjxY_o.png" alt=""></p> 
<p>2、编写代码获取 IO 信息：iocheck.sh ，脚本使用了 iostat 命令进行数据获取，关于 iostat 获取的数据信息解释，可翻阅资查看。主要对读写速率、 IO 使用率、 IO 响应时间关键指标进行监控。</p> 
<p><img src="https://images2.imgbox.com/86/7d/kR6AX2Mm_o.png" alt=""></p> 
<p>3 、创建自发现规则</p> 
<p><img src="https://images2.imgbox.com/65/08/uWWc3HUx_o.png" alt=""></p> 
<p>4 、创建监控项原型，如下图所示，在 zabbix 界面的最新数据可查看监控信息。</p> 
<p><img src="https://images2.imgbox.com/a8/ca/rBnuXe4q_o.png" alt=""></p> 
<h3><a id="65_Linux__292"></a><strong>6.5 Linux 网卡状态监控</strong></h3> 
<p>使用 zabbix 已有自发现规则进行监控，方法比较简单，配置截图如下：</p> 
<p>1 、自发现规则配置</p> 
<p><img src="https://images2.imgbox.com/3d/ec/U14bktxI_o.png" alt=""></p> 
<p>2 、过滤器配置 此项是为了过滤不需要监控的网卡，采用正则匹配</p> 
<p><img src="https://images2.imgbox.com/02/61/eYMBngQ8_o.png" alt=""></p> 
<p>3 、监控项原型配置</p> 
<p><img src="https://images2.imgbox.com/71/de/llHzuY1b_o.png" alt=""></p> 
<h3><a id="7_Linux__309"></a><strong>7 Linux 系统硬件信息获取</strong></h3> 
<p>这里 linux 硬件信息获取，类比 windows 硬件信息获取，都是在 OS 操作系统层面，如果想监控更多硬件，推荐使用服务器的管理口。</p> 
<p>实践过程中，原则是尽可能使用 zabbix 系统已有监控项，直接使用效率高。</p> 
<h3><a id="71_CPU__316"></a><strong>7.1 CPU 信息获取</strong></h3> 
<p>应用集：CPU 硬件</p> 
<p>cpu 信息主要有：CPU 型号、 CPU 颗数、 CPU 核数、 CPU 逻辑核与线程（超线程，一般是核心数的 2 倍）</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/cf/71/TbPmuqjT_o.png" alt=""></p> 
<h4><a id="711_CPU__327"></a><strong>7.1.1 CPU 型号</strong></h4> 
<p>使用 zabbix 自带 key ：</p> 
<p>监控 key 值：<br> system.hw.cpu[,]</p> 
<p>说明：cpu 为数量或是默认 all ， info ：full ( 默认 ), curfreq, maxfreq, model 或者 vendor 。</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/4a/bd/teUqotII_o.png" alt=""></p> 
<h4><a id="712_CPU__340"></a><strong>7.1.2 CPU 颗数</strong></h4> 
<p>此处的 CPU 颗数指的是物理个数，如果是虚拟机则不具备参考依据。</p> 
<p>使用编写的命令获取 CPU 物理个数：</p> 
<p>监控 key 值：<br> UserParameter=server.cpu.num,cat /proc/cpuinfo |grep -E ‘physical[ t]+id’ |sort |uniq |wc -l</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/01/56/UNfXlWl2_o.png" alt=""></p> 
<h4><a id="713_CPU__353"></a><strong>7.1.3 CPU 核数</strong></h4> 
<p>使用编写的命令获取 CPU 核数，此处的核数为单个 CPU 的核心数，总核数为：CPU 颗数 * 单个 CPU 的核数。</p> 
<p>在 /etc/zabbix/zabbix_agentd.d/ 目录下创建规范文件名 .conf 结尾，添加如下内容：</p> 
<p>UserParameter=server.cpu.corenum,echo “$(cat /proc/cpuinfo |grep -E ‘cpu[ t]+cores’ |sort |uniq |awk ‘{print $NF}’)”</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/a9/7c/TWupAwZu_o.png" alt=""></p> 
<h4><a id="714_CPU__365"></a><strong>7.1.4 CPU 逻辑核与线程</strong></h4> 
<p>使用 zabbix 自带 key ：</p> 
<p>监控 key 值：</p> 
<p>system.cpu.num[]</p> 
<p>说明：type 可用值， online ( 默认值 ), max 范例 : system.cpu.num</p> 
<p>经实践检查此处的 key 值为逻辑核心， CPU 逻辑核心、线程（超线程，一般是核心数的 2 倍） Linux 系统下 top 命令输入 1 ，看到的 cpu 数量。</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/c5/91/Ajx1l8MG_o.png" alt=""></p> 
<h4><a id="715__381"></a><strong>7.1.5 监控结果</strong></h4> 
<p><img src="https://images2.imgbox.com/3e/b9/VXpIDzdL_o.png" alt=""></p> 
<h3><a id="72_Memory__385"></a><strong>7.2 Memory 内存信息获取</strong></h3> 
<p>应用集：Memory 内存硬件</p> 
<p>Memory 内存硬件信息主要有：主板支持情况、每个内存条硬件信息。</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/7c/23/aAqm6uCz_o.png" alt=""></p> 
<h4><a id="721_Memory__396"></a><strong>7.2.1 Memory 内存主板支持</strong></h4> 
<p>编写的命令获取内存主板支持情况：</p> 
<p>在 /etc/zabbix/zabbix_agentd.d/ 目录下创建规范文件名 .conf 结尾，添加如下内容：</p> 
<p>UserParameter=server.memory.info,dmidecode -t 16 | grep -E ‘Maximum|Devices’|sed -e ‘s/<sup class="footnote-ref"><a href="#fn1" rel="nofollow" id="fnref1">1</a></sup>//g;s/[ t]$//g;s/[t]//g;s/Maximum Capacity/ 支持容量 /g;s/Number Of Devices/ 支持槽位 /g’</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/dc/af/9OKpNcgH_o.png" alt=""></p> 
<p>最新数据：</p> 
<p><img src="https://images2.imgbox.com/92/55/mzL6B8Wz_o.png" alt=""></p> 
<h4><a id="722_Memory__412"></a><strong>7.2.2 Memory 内存信息</strong></h4> 
<p>编写的命令获取每个内存条硬件信息：</p> 
<p>在 /etc/zabbix/zabbix_agentd.d/ 目录下创建规范文件名 .conf 结尾，添加如下内容：</p> 
<p>UserParameter=server.memory.info.num,dmidecode -t 17|grep -E “Size: [0-9]” -A12 |grep -E ‘Locator:|Size:|Manufacturer:|Part Number|Speed:|Type:’ |sed -e ‘s/<sup class="footnote-ref"><a href="#fn2" rel="nofollow" id="fnref2">2</a></sup>//g;s/[ t]$//g;s/[t]//g;s/Size/ 容量 /g;s/Locator/ 槽位 /g;s/Type/ 类型 /g;s/Speed/ 速率 /g;s/Manufacturer/ 制造商 /g;s/Part Number/ 序列号 /g’|grep -v ‘Bank’|awk ‘{if (NR%6==0){print $0} else {printf"%st",$0}}’</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/c5/78/mTiuerfP_o.png" alt=""></p> 
<p>最新数据：</p> 
<p><img src="https://images2.imgbox.com/ce/d3/UweCxHs6_o.png" alt=""></p> 
<h3><a id="73_Disk__428"></a><strong>7.3 Disk 硬盘信息获取</strong></h3> 
<p>因有的服务器安装了 RAID 卡或是连接了 EMC 等 SAN 存储设备，而且企业里大量使用了虚拟机 , 增加了硬盘信息获取的难度。对于 linux 与 windows 系统服务器获取硬盘信息，将在后续文章中详细介绍，下面介绍的方法，最适用于服务器安装 linux 系统的场景，可简单了解。</p> 
<p>应用集：Disk 硬盘</p> 
<p>Disk 硬盘主要获取两类信息 : 硬盘的硬件信息、硬盘的状态（包括只读）：</p> 
<p>1 、直通硬盘</p> 
<p>直通硬盘使用 hdparm -i /dev/sda 命令获取硬盘信息</p> 
<p>直通硬盘使用 smartctl -H /dev/sda 命令获取硬盘健康状态</p> 
<p>编写脚本，读写 /dev/sdX 硬盘，获取硬盘读写检查</p> 
<p>2 、 RAID 硬盘</p> 
<p>需要安装 MegaCli 等软件，使用软件命令来实现</p> 
<p>监控结果：</p> 
<p><img src="https://images2.imgbox.com/9c/57/4K6PH727_o.png" alt=""></p> 
<h3><a id="74_OS__453"></a><strong>7.4 OS 操作系统信息获取</strong></h3> 
<p>应用集：OS 操作系统</p> 
<p>OS 操作系统信息主要有：主机名、操作系统版本、登录用户数量、系统时间、系统运行时长。除过操作系统版本需要编写脚本外，其他都是 zabbix 系统已有监控项，可以直接使用。</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/59/7c/3Hw8GWEM_o.png" alt=""></p> 
<p>监控结果：</p> 
<p><img src="https://images2.imgbox.com/7e/2e/Gv3xcXNm_o.png" alt=""></p> 
<h3><a id="75_OS__468"></a><strong>7.5 OS 服务器信息获取</strong></h3> 
<p>应用集：OS 服务器信息</p> 
<p>OS 服务器信息主要有：服务器品牌、型号、序列号。</p> 
<p>注意：如果是虚拟机则反应的是虚拟化平台的厂家。如：VMware, Inc.</p> 
<p>监控项配置：</p> 
<p><img src="https://images2.imgbox.com/cf/c5/U5AfAHyo_o.png" alt=""></p> 
<p>脚本命令：</p> 
<p>在 /etc/zabbix/zabbix_agentd.d/ 目录下创建规范文件名 .conf 结尾，添加如下内容：</p> 
<p>UserParameter=server.company,dmidecode -s system-manufacturer |grep -v ^#<br> UserParameter=server.product.name,dmidecode -s system-product-name |grep -v ^#<br> UserParameter=server.serial.number,dmidecode -s system-serial-number |grep -v ^#|tr -d " "</p> 
<p>监控结果：</p> 
<p><img src="https://images2.imgbox.com/88/01/I51tGOnz_o.png" alt=""></p> 
<hr class="footnotes-sep"> 
<section class="footnotes"> 
 <ol class="footnotes-list"><li id="fn1" class="footnote-item"><p> t <a href="#fnref1" rel="nofollow" class="footnote-backref">↩︎</a></p> </li><li id="fn2" class="footnote-item"><p> t <a href="#fnref2" rel="nofollow" class="footnote-backref">↩︎</a></p> </li></ol> 
</section>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5ab147a05e25d3fd2602618808b6114b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Shader的基础知识</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1ba103528be213ba27ad51939346f4b2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">wia驱动程序正在使用中 无法安装_如果Windows无法加载驱动程序，请关闭“内存完整性”设置...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>