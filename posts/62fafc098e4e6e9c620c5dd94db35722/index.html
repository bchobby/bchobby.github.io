<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sysbench数据库压测工具详解与实战 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sysbench数据库压测工具详解与实战" />
<meta property="og:description" content="sysbench是一个基于LuaJIT脚本的多线程基准测试工具。2004年由Peter Zaitsev（Percona公司创始人）开发，在其0.5版本中可以使用Lua脚本实现OLTP测试。2016年重构了sysbench代码，并在2017年2月针对新的硬件环境发布了1.0版本，优化了测试性能（是0.5版本的6倍，可以压测60万TPS）和可扩展性（无Mutex、无共享计数器、多线程扩展性更强）。
sysbench不仅可用于数据库基准测试，也可用于服务器的其他工作负载基准测试。本文主要以1.0版本为例介绍sysbench。在新的Release版本下，sysbench新增与优化了如下一些特性。
可以收集有关速率和延迟时间的统计数据，包括延迟百分比和直方图。低开销，可以执行数以千计的并发线程，能够每秒产生和跟踪数亿个事件。通过Lua脚本轻松实现了预定义的钩子，以创建新的测试基准。可以用作通用的Lua脚本解释器，只需在Lua脚本中将“#!/usr/bin/lua”替换为“#!/usr/bin/sysbench”即可。 1　安装sysbench 1.1　yum安装 执行如下命令，设置yum repo仓库/etc/yum.repos.d/akopytov_sysbench.repo，并直接使用yum安装。
# RHEL/CentOS
[root@localhost~]# curl -s https://packagecloud.io/install/repositories/akopytov/ sysbench/script.rpm.sh | sudo bash
[root@localhost~]# sudo yum -y install sysbench
1.2　RPM包安装 手动下载RPM包来安装（仅限RHEL/CentOS），但是在安装sysbench前需要先安装依赖包，然后再安装该RPM包。
[root@localhost~]# yum install mysql-libs postgresql-libs -y
[root@localhost~]# rpm -Uvh sysbench-1.0.7-13.el6.x86_64.rpm --nodeps
由于sysbench编译时依赖libmysqlclient动态链接库，所以要选择对应版本的sysbench，或者使用软链接： [root@localhost~]# ln -s /usr/lib64/mysql/libmysqlclient.so.18 /usr/lib64/ libmysqlclient_r.\ so.16
1.3　编译安装 安装依赖的编译环境：
# RHEL/CentOS
[root@localhost~]# yum -y install make automake libtool pkgconfig libaio-devel vim-\
common git
## For MySQL support, replace with mysql-devel on RHEL/CentOS 5" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/62fafc098e4e6e9c620c5dd94db35722/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-29T10:51:18+08:00" />
<meta property="article:modified_time" content="2022-06-29T10:51:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sysbench数据库压测工具详解与实战</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0px;"><span style="color:#0d0d0d;">sysbench是一个基于LuaJIT脚本的多线程基准测试工具。2004年由Peter Zaitsev（Percona公司创始人）开发，在其0.5版本中可以使用Lua脚本实现OLTP测试。2016年重构了sysbench代码，并在2017年2月针对新的硬件环境发布了1.0版本，优化了测试性能（是0.5版本的6倍，可以压测60万TPS）和可扩展性（无Mutex、无共享计数器、多线程扩展性更强）。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">sysbench</span><span style="color:#0d0d0d;">不仅可用于数据库基准测试，也可用于服务器的其他工作负载基准测试。本文主要以1.0版本为例介绍sysbench。在新的Release版本下，sysbench新增与优化了如下一些特性。</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">可以收集有关速率和延迟时间的统计数据，包括延迟百分比和直方图。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">低开销，可以执行数以千计的并发线程，能够每秒产生和跟踪数亿个事件。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">通过</span><span style="color:#0d0d0d;">Lua</span><span style="color:#0d0d0d;">脚本轻松实现了预定义的钩子，以创建新的测试基准。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">可以用作通用的</span><span style="color:#0d0d0d;">Lua</span><span style="color:#0d0d0d;">脚本解释器，只需在</span><span style="color:#0d0d0d;">Lua</span><span style="color:#0d0d0d;">脚本中将</span><span style="color:#0d0d0d;">“#!/usr/bin/lua”</span><span style="color:#0d0d0d;">替换为</span><span style="color:#0d0d0d;">“#!/usr/bin/sysbench”</span><span style="color:#0d0d0d;">即可。</span></li></ol> 
<h2 style="margin-left:0px;text-align:justify;"><a name="_Toc34082293"></a><a name="_Toc17818605"></a><a name="_Toc535180120"><strong>1</strong></a><strong>　安装</strong><strong>sysbench</strong></h2> 
<h3 style="margin-left:0px;"><a name="_Toc535180121"></a><a name="_Toc17818606">1.1</a>　yum安装</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">执行如下命令，设置yum repo仓库/etc/yum.repos.d/akopytov_sysbench.repo，并直接使用yum安装。</span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;"># RHEL/CentOS</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>curl -s https://packagecloud.io/install/repositories/akopytov/ sysbench/script.rpm.sh | sudo bash</strong></span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sudo yum -y install sysbench</strong></span></span></p> 
<p style="margin-left:.0001pt;"></p> 
<h3 style="margin-left:0px;"><a name="_Toc535180122"></a><a name="_Toc17818607">1.2</a>　RPM包安装</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">手动下载RPM包来安装（仅限RHEL/CentOS），但是在安装sysbench前需要先安装依赖包，然后再安装该RPM包。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>yum install mysql-libs postgresql-libs -y</strong></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>rpm -Uvh sysbench-1.0.7-13.el6.x86_64.rpm --nodeps</strong></span></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">由于sysbench编译时依赖libmysqlclient动态链接库，所以要选择对应版本的sysbench，或者使用软链接： </span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]#<strong> ln -s /usr/lib64/mysql/libmysqlclient.so.18 /usr/lib64/ libmysqlclient_r.</strong></span><strong><span style="color:#0d0d0d;">\ so.16</span></strong></span></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:left;"><a name="_Toc17818608"></a><a name="_Toc535180123"></a></p> 
<h3 style="margin-left:0px;">1.3　编译安装</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">安装依赖的编译环境：</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;"># RHEL/CentOS</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>yum -y install make automake libtool pkgconfig libaio-devel vim-\<br> common git</strong></span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">## For MySQL support, replace with mysql-devel on RHEL/CentOS 5</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>yum -y install mariadb-devel</strong></span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">## For PostgreSQL support</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>yum -y install postgresql-devel</strong></span></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">最新的sysbench程序包地址为</span><a href="https://github.com/akopytov/sysbench/releases" title="https://github.com/akopytov/sysbench/releases">https://github.com/akopytov/sysbench/releases</a><span style="color:#0d0d0d;">，直接下载并解压缩程序包：</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>wget </strong></span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><strong><span style="color:#0d0d0d;"> https://github.com/akopytov/sysbench/archive/1.0.13.tar.gz</span></strong></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>tar zxf sysbench-1.0.13.tar.gz</strong></span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#0d0d0d;">编译安装：</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>cd sysbbench-1.0.13</strong></span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>./autogen.sh</strong></span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">## Add --with-pgsql to build with PostgreSQL support</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>./configure</strong></span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>make</strong></span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>make install</strong></span></span></p> 
<h3 style="margin-left:0px;"><a name="_Toc17818609"></a><a name="_Toc535180124">1.4</a>　验证安装是否成功</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">查看版本信息，如果可以正常查看到版本信息而不报错，则说明sysbench安装成功。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>sysbench --version  </strong></span></span></p> 
<p style="margin-left:0;text-align:left;"></p> 
<h2 style="margin-left:0px;text-align:justify;"><a name="_Toc535180125"></a><a name="_Toc17818610"><strong>2</strong></a><strong>　测试案例</strong></h2> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">本节通过几个测试案例简单介绍如何使用sysbench对MySQL数据库进行压力测试。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">sysbench</span><span style="color:#0d0d0d;">除能压测数据库性能之外，还能对其他一些测试对象进行性能测试，包括CPU、内存、线程等的压测，限于篇幅，这里不详细介绍，读者可以参考链接：</span><a href="https://wiki.gentoo.org/wiki/Sysbench" rel="nofollow" title="Sysbench - Gentoo Wiki">Sysbench - Gentoo Wiki</a><span style="color:#0d0d0d;">来进一步了解。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">在测试前，请先创建好MySQL账户qbench@127.0.0.1（密码为qbench），确保该账户可以正常连接到数据库，并且拥有sbtest库的所有权限。下面就利用4个并发线程，对一个MySQL实例上的32个500万行数据的表（sbtest1, sbtest2, … ,sbtest32）进行180s的压力测试，以查看MySQL数据库在压力下的表现。</span></p> 
<h3 style="margin-left:0px;"><a name="_Toc535180126"></a><a name="_Toc17818611">2.1</a>　造数</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">可以直接使用Lua脚本前缀作为testname，使用prepare命令造数。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=180 --threads=4 --report-interval=1</strong></span><strong><span style="color:#0d0d0d;">\ --mysql-host =127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qbench\ --mysql-db= sbtest --tables=32 --table-size=5000000 oltp_read_write --db-ps-mode=disable\ prepare</span></strong></span></p> 
<h3 style="margin-left:0px;"><a name="_Toc535180127"></a><a name="_Toc17818612">2.2</a>　数据库读写测试</h3> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">1</span><span style="color:#0d0d0d;">．oltp_read_write</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该测试案例对应sysbench 0.5版本的oltp.lua脚本，用于测试数据库的TPS性能。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=180 --threads=4 --report-interval=1</strong></span><strong><span style="color:#0d0d0d;"> --mysql-host =127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qbench –mysql -db =sbtest --tables=32 --table-size=5000000 oltp_read_write --db-ps-mode=disable run</span></strong></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">2</span><span style="color:#0d0d0d;">．oltp_read_only</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该测试案例对应sysbench 0.5版本的select.lua脚本，用于测试数据库的只读性能。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=180 --threads=4 --report-interval=1 --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qbench --mysql-db=sbtest --tables=32 --table-size=5000000 oltp_read_only --db-ps-mode=disable run</strong></span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">3</span><span style="color:#0d0d0d;">．oltp_delete</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该测试案例对应sysbench 0.5版本的delete.lua脚本，用于测试数据库的删除性能。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=180 --threads=4 --report-interval=1 --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qbench --mysql-db=sbtest --tables=32 --table-size=5000000 oltp_delete --db-ps-mode=disable run</strong></span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">4</span><span style="color:#0d0d0d;">．oltp_update_index</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该测试案例对应sysbench 0.5版本的update_index.lua脚本，用于测试数据库的更新索引性能。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=180 --threads=4 --report-interval=1 --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qbench --mysql-db=sbtest --tables=32 --table-size=5000000 oltp_update_index --db-ps-mode=disable run</strong></span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">5</span><span style="color:#0d0d0d;">．oltp_update_non_index</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该测试案例对应sysbench 0.5版本的update_non_index.lua脚本，用于测试数据库的更新非索引字段性能。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=180 --threads=4 --report-interval=1 --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qbench --mysql-db=sbtest --tables=32 --table-size=5000000 oltp_update_non_index --db-ps-mode=disable run</strong></span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">6</span><span style="color:#0d0d0d;">．oltp_insert</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该测试案例对应sysbench 0.5版本的insert.lua脚本，用于测试数据库的插入性能。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=180 --threads=4 --report-interval=1 --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qbench --mysql-db=sbtest --tables=32 --table-size=5000000 oltp_insert --db-ps-mode=disable run</strong></span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">7</span><span style="color:#0d0d0d;">．oltp_write_only</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该测试案例是sysbench 1.0.x版本新增的，与原来的oltp.lua相比，少了select部分。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=180 --threads=4 --report-interval=1 –mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qbench –mysql-db=sbtest --tables=32 --table-size=5000000 oltp_write_only --db-ps-mode=disable run</strong></span></span></p> 
<h3 style="margin-left:0px;"><a name="_Toc535180128"></a><a name="_Toc17818613">2.3</a>　清理</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">使用cleanup命令清理prepare和run产生的数据，实际上是删除对应的表。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=180 --threads=4 --report-interval=1 --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qbench --mysql-db=sbtest --tables=32 --table-size=5000000 oltp_read_write --db-ps-mode=disable cleanup</strong></span></span></p> 
<p style="margin-left:0;text-align:left;"></p> 
<h2 style="margin-left:0px;text-align:justify;"><a name="_Toc535180129"></a><a name="_Toc34082295"></a><a name="_Toc17818614"><strong>3</strong></a><strong>　sysbench 参数详解</strong></h2> 
<h3 style="margin-left:0px;"><a name="_Toc17818615"></a><a name="_Toc535180130">3.1</a>　sysbench命令语法</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">sysbench</span><span style="color:#0d0d0d;">命令语法如下：</span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">sysbench [options]... [testname] [command]</span></span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">o</span><span style="color:#0d0d0d;">ptions</span><span style="color:#0d0d0d;">（</span><span style="color:#0d0d0d;">参数选项</span><span style="color:#0d0d0d;">）：</span><span style="color:#0d0d0d;">用于指定</span><span style="color:#0d0d0d;">sysbench</span><span style="color:#0d0d0d;">的并发度、压测时长等参数</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">t</span><span style="color:#0d0d0d;">estname</span><span style="color:#0d0d0d;">（</span><span style="color:#0d0d0d;">测试</span><span style="color:#0d0d0d;">名称）：</span><span style="color:#0d0d0d;">用于指定</span><span style="color:#0d0d0d;">sysbench</span><span style="color:#0d0d0d;">的基准</span><span style="color:#0d0d0d;">测试</span><span style="color:#0d0d0d;">名称，可选项包括</span><span style="color:#0d0d0d;">oltp_read_</span> <span style="color:#0d0d0d;">write</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">oltp_read_only</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">oltp</span><span style="color:#0d0d0d;">_write_only</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">oltp</span><span style="color:#0d0d0d;">_insert</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">oltp</span><span style="color:#0d0d0d;">_delete</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">oltp</span><span style="color:#0d0d0d;">_update_index</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">oltp</span><span style="color:#0d0d0d;">_update_non_index</span><span style="color:#0d0d0d;">等</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">c</span><span style="color:#0d0d0d;">ommand</span><span style="color:#0d0d0d;">（</span><span style="color:#0d0d0d;">测试命令</span><span style="color:#0d0d0d;">）：</span><span style="color:#0d0d0d;">用于指定</span><span style="color:#0d0d0d;">sysbench</span><span style="color:#0d0d0d;">执行什么测试命令，可选项包括</span><span style="color:#0d0d0d;">prepare</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">run</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">cleanup</span><span style="color:#0d0d0d;">等。</span></li></ol> 
<h3 style="margin-left:0px;"><a name="_Toc535180131"></a><a name="_Toc17818616">3.2</a>　options</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">下面逐一介绍相关选项。</span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">1</span><span style="color:#0d0d0d;">．常规选项</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">--threads=N</span><span style="color:#0d0d0d;">：指定线程数，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">1</span><span style="color:#0d0d0d;">，相当于</span><span style="color:#0d0d0d;">sysbendh </span><span style="color:#0d0d0d;">0.5</span><span style="color:#0d0d0d;">及之前</span><span style="color:#0d0d0d;">版</span><span style="color:#0d0d0d;">本中</span><span style="color:#0d0d0d;">的</span><span style="color:#0d0d0d;">--num-threads=N</span><span style="color:#0d0d0d;">选项</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--events=N</span><span style="color:#0d0d0d;">：指定总的请求数，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">，表示不限制请求数，相当于</span><span style="color:#0d0d0d;">sysbench </span><span style="color:#0d0d0d;">0.5</span><span style="color:#0d0d0d;">及之前版</span><span style="color:#0d0d0d;">本中</span><span style="color:#0d0d0d;">的</span><span style="color:#0d0d0d;">--max-requests</span><span style="color:#0d0d0d;">选项</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--time=N</span><span style="color:#0d0d0d;">：指定压测时长，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">10</span><span style="color:#0d0d0d;">s</span><span style="color:#0d0d0d;">，相当于</span><span style="color:#0d0d0d;">sysbench </span><span style="color:#0d0d0d;">0.5</span><span style="color:#0d0d0d;">及之前版</span><span style="color:#0d0d0d;">本中</span><span style="color:#0d0d0d;">的</span><span style="color:#0d0d0d;">--max-time=N</span><span style="color:#0d0d0d;">选项</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--forced-shutdown=STRING</span><span style="color:#0d0d0d;">：有效值为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">N</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">N%</span><span style="color:#0d0d0d;">（</span><span style="color:#0d0d0d;">默认值为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">）。</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">表示不启用强制关机功能</span><span style="color:#0d0d0d;">；</span><span style="color:#0d0d0d;">N</span><span style="color:#0d0d0d;">表示在</span><span style="color:#0d0d0d;">--</span><span style="color:#0d0d0d;">time</span><span style="color:#0d0d0d;">选项</span><span style="color:#0d0d0d;">指定的时间到期后，再过</span><span style="color:#0d0d0d;">N</span><span style="color:#0d0d0d;">秒强制关机</span><span style="color:#0d0d0d;">；</span><span style="color:#0d0d0d;">N%</span><span style="color:#0d0d0d;">表示在</span><span style="color:#0d0d0d;">--</span><span style="color:#0d0d0d;">time</span><span style="color:#0d0d0d;">选项</span><span style="color:#0d0d0d;">指定的时间到期后，再过</span><span style="color:#0d0d0d;">--time*N%</span><span style="color:#0d0d0d;">时间强制关机</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--thread-stack-size=SIZE</span><span style="color:#0d0d0d;">：指定每个线程的堆栈大小，默认值为</span><span style="color:#0d0d0d;">64K</span><span style="color:#0d0d0d;">B</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--rate=N</span><span style="color:#0d0d0d;">：限定事务速率</span><span style="color:#0d0d0d;">（</span><span style="color:#0d0d0d;">tps</span><span style="color:#0d0d0d;">）</span><span style="color:#0d0d0d;">，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">，表示不限制，相当于</span><span style="color:#0d0d0d;">sysbench </span><span style="color:#0d0d0d;">0.5</span><span style="color:#0d0d0d;">及之前版</span><span style="color:#0d0d0d;">本中</span><span style="color:#0d0d0d;">的</span><span style="color:#0d0d0d;">--tx-rate=N</span><span style="color:#0d0d0d;">选项</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--report-interval=N</span><span style="color:#0d0d0d;">：指定中间统计结果报告</span><span style="color:#0d0d0d;">的</span><span style="color:#0d0d0d;">间隔时间，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">表示关闭中间</span><span style="color:#0d0d0d;">统计结果</span><span style="color:#0d0d0d;">报告输出</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--report-checkpoints=[LIST,...]</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">用</span><span style="color:#0d0d0d;">逗号分</span><span style="color:#0d0d0d;">隔</span><span style="color:#0d0d0d;">的一组列表值，这些值在执行</span><span style="color:#0d0d0d;">sysbench</span><span style="color:#0d0d0d;">压测时</span><span style="color:#0d0d0d;">被</span><span style="color:#0d0d0d;">依次读取，表示执行多少秒就打印一次统计报告</span><span style="color:#0d0d0d;">（</span><span style="color:#0d0d0d;">例如</span><span style="color:#0d0d0d;">--report-</span> <span style="color:#0d0d0d;">checkpoints=10,20,30</span><span style="color:#0d0d0d;">，表示当执行</span><span style="color:#0d0d0d;">1</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">s</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">2</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">s</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">3</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">s</span><span style="color:#0d0d0d;">时分别打印一次</span><span style="color:#0d0d0d;">统计</span><span style="color:#0d0d0d;">报告</span><span style="color:#0d0d0d;">。</span><span style="color:#0d0d0d;">注意，该数值是</span><span style="color:#0d0d0d;">指</span><span style="color:#0d0d0d;">从执行</span><span style="color:#0d0d0d;">sysbench</span><span style="color:#0d0d0d;">开始到现在的时间</span><span style="color:#0d0d0d;">）</span><span style="color:#0d0d0d;">，默认值为空，表示在</span><span style="color:#0d0d0d;">--time</span><span style="color:#0d0d0d;">选项指定的时间到期后才打印统计报告</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--debug[=on|off]</span><span style="color:#0d0d0d;">：是否打印</span><span style="color:#0d0d0d;">调试</span><span style="color:#0d0d0d;">信息，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--help[=on|off]</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">是否</span><span style="color:#0d0d0d;">打印帮助信息，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--version[=on|off]</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">是否</span><span style="color:#0d0d0d;">打印版本信息，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">。</span></li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">2</span><span style="color:#0d0d0d;">．伪随机数创建选项</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">-</span><span style="color:#0d0d0d;">-rand-type=STRING</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">随机数分布类型，可选项包括</span><span style="color:#0d0d0d;">uniform</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">gaussian</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">special</span><span style="color:#0d0d0d;">、</span><span style="color:#0d0d0d;">pareto</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">默认值为</span><span style="color:#0d0d0d;">special</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--rand-spec-iter=</span><span style="color:#0d0d0d;">N</span><span style="color:#0d0d0d;">：随机数生成的迭代次数，默认值为</span><span style="color:#0d0d0d;">1</span><span style="color:#0d0d0d;">2</span><span style="color:#0d0d0d;">次。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--rand-spec-pct=</span><span style="color:#0d0d0d;">N</span><span style="color:#0d0d0d;">：对特定随机数分布来说被视为“特殊”值的百分比，默认值为</span><span style="color:#0d0d0d;">1</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--rand-spec-res=</span><span style="color:#0d0d0d;">N</span><span style="color:#0d0d0d;">：对特定随机数分布来说“特殊”值的百分比，默认值为</span><span style="color:#0d0d0d;">7</span><span style="color:#0d0d0d;">5</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--rand-seed=</span><span style="color:#0d0d0d;">N</span><span style="color:#0d0d0d;">：随机数发生器的种子。当该选项设置为</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">时，表示使用当前时间作为</span><span style="color:#0d0d0d;">RNG</span><span style="color:#0d0d0d;">种子。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--rand-pareto-h=</span><span style="color:#0d0d0d;">N</span><span style="color:#0d0d0d;">：用于指定</span><span style="color:#0d0d0d;">pareto</span><span style="color:#0d0d0d;">随机分布的</span><span style="color:#0d0d0d;">h</span><span style="color:#0d0d0d;">参数，默认值为</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">.2</span><span style="color:#0d0d0d;">。</span></li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">3</span><span style="color:#0d0d0d;">．日志选项</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">--verbosity=</span><em><span style="color:#0d0d0d;">N</span></em><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">日志打印的详细程度，</span><span style="color:#0d0d0d;">5</span><span style="color:#0d0d0d;">表示打印</span><span style="color:#0d0d0d;">debug</span><span style="color:#0d0d0d;">级别以上的日志，</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">表示只打印</span><span style="color:#0d0d0d;">c</span><span style="color:#0d0d0d;">ritical</span><span style="color:#0d0d0d;">级别以上的日志。默认值为</span><span style="color:#0d0d0d;">3</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--percentile=</span><em><span style="color:#0d0d0d;">N</span></em><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">在延迟时间统计中选择哪个百分位数，可选范围为</span><span style="color:#0d0d0d;">(</span><span style="color:#0d0d0d;">1</span><span style="color:#0d0d0d;">～</span><span style="color:#0d0d0d;">100</span><span style="color:#0d0d0d;">)</span><span style="color:#0d0d0d;">，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">95</span><span style="color:#0d0d0d;">。</span><span style="color:#0d0d0d;">如果设置为</span><span style="color:#0d0d0d;">0</span><span style="color:#0d0d0d;">，则</span><span style="color:#0d0d0d;">表示禁用延迟时间统计功能</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--histogram[=on|off]</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">是否</span><span style="color:#0d0d0d;">打印延迟时间直方图报告，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">。</span></li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">4</span><span style="color:#0d0d0d;">．常规数据库选项</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">--db-driver=STRING</span><span style="color:#0d0d0d;">：指定数据库驱动程序</span><span style="color:#0d0d0d;">（</span><span style="color:#0d0d0d;">即指定数据库类型</span><span style="color:#0d0d0d;">）</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">当前</span><span style="color:#0d0d0d;">版本支持</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">和</span><span style="color:#0d0d0d;">Post</span><span style="color:#0d0d0d;">greSQL</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--db-ps-mode=STRING</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">prepare</span><span style="color:#0d0d0d;">命令</span><span style="color:#0d0d0d;">使用模式，有效值为</span><span style="color:#0d0d0d;">auto</span><span style="color:#0d0d0d;">和</span><span style="color:#0d0d0d;">disable</span><span style="color:#0d0d0d;">，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">auto</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">在</span><span style="color:#0d0d0d;">高并发压力下建议使用</span><span style="color:#0d0d0d;">disable</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--db-debug[=on|off]</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">是否</span><span style="color:#0d0d0d;">打印数据库的</span><span style="color:#0d0d0d;">调试</span><span style="color:#0d0d0d;">信息，默认</span><span style="color:#0d0d0d;">值</span><span style="color:#0d0d0d;">为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">。</span></li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">5</span><span style="color:#0d0d0d;">．MySQL选项</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-host=</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器主机，默认值为</span><span style="color:#0d0d0d;">localhost</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-port=</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器端口号，默认值为</span><span style="color:#0d0d0d;">3306</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-socket=</span><span style="color:#0d0d0d;"> MySQL</span><span style="color:#0d0d0d;">服务器</span><span style="color:#0d0d0d;">Socket</span><span style="color:#0d0d0d;">文件目录。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-user=</span><span style="color:#0d0d0d;">连接</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器的用户名，默认值为</span><span style="color:#0d0d0d;">sbtest</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-password=</span><span style="color:#0d0d0d;">连接</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器的密码。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-db=</span><span style="color:#0d0d0d;">连接</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器的数据库名，默认值为</span><span style="color:#0d0d0d;">sbtest</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-ssl[=on|off]</span><span style="color:#0d0d0d;">：连接</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器是否使用</span><span style="color:#0d0d0d;">SSL</span><span style="color:#0d0d0d;">，默认值为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-ssl-cipher=</span><span style="color:#0d0d0d;">连接</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器使用</span><span style="color:#0d0d0d;">SSL</span><span style="color:#0d0d0d;">时的</span><span style="color:#0d0d0d;">C</span><span style="color:#0d0d0d;">ipher</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-compression[=on|off]</span><span style="color:#0d0d0d;">：连接</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器是否使用压缩，默认值为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-debug[=on|off]</span><span style="color:#0d0d0d;">：连接</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器是否跟踪所有的客户端库调用，默认值为</span><span style="color:#0d0d0d;">off</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-ignore-errors=</span><span style="color:#0d0d0d;">是否忽略</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">返回的错误，默认值为</span><span style="color:#0d0d0d;">[1213,1020,1205]</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--mysql-dry-run[=on|off]</span><span style="color:#0d0d0d;">：是否空跑，只是调用</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">客户端</span><span style="color:#0d0d0d;">API</span><span style="color:#0d0d0d;">，但是不真正执行。</span></li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">6</span><span style="color:#0d0d0d;">．pgsql选项</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">--pgsql-host=</span> <span style="color:#0d0d0d;">PostgreSQL</span><span style="color:#0d0d0d;">服务器主机，默认值为</span><span style="color:#0d0d0d;">localhost</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--pgsql-port= PostgreSQL</span><span style="color:#0d0d0d;">服务器端口，默认值为</span><span style="color:#0d0d0d;">5432</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--pgsql-user=</span><span style="color:#0d0d0d;">连接</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器的用户名，默认值为</span><span style="color:#0d0d0d;">sbtest</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">--pgsql-password=</span><span style="color:#0d0d0d;">连接</span><span style="color:#0d0d0d;">MySQL</span><span style="color:#0d0d0d;">服务器的密码。</span></li><li><span style="color:#0d0d0d;">--pgsql-db=</span><span style="color:#0d0d0d;">连接MySQL服务器的数据库名，默认值为sbtest。</span></li></ol> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">7</span><span style="color:#0d0d0d;">．其他选项</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">通过使用如下命令来查看额外的关于测试名称（事务模型）命令选项，只需要任意指定一个测试名称即可。</span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;"># </span><span style="color:#0d0d0d;">指定oltp_read_write测试名称来查看额外的帮助选项</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost ]#<strong> sysbench oltp_read_write help  </strong></span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">......</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">oltp_read_write options:</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">  --distinct_ranges=N Number of SELECT DISTINCT queries per transaction [1]</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">  --sum_ranges=N Number of SELECT SUM() queries per transaction [1]</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">  --skip_trx[=on|off] Don't start explicit transactions and execute all queries in the AUTOCOMMIT mode [off]</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">……</span></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">各选项解释如下。</span></p> 
<ol><li><span style="color:#0d0d0d;">--distinct_ranges=<em>N</em></span><span style="color:#0d0d0d;">：指定在每个事务中SELECT DISTINCT查询的执行次数，默认值为1。</span></li><li><span style="color:#0d0d0d;">-sum_ranges=<em>N</em></span><span style="color:#0d0d0d;">：指定在每个事务中SELECT SUM()查询的执行次数，默认值为1。</span></li><li><span style="color:#0d0d0d;">--skip_trx[=on|off]</span><span style="color:#0d0d0d;">：指定在AUTOCOMMIT（自动提交）模式下是否需要跳过启动显式事务（使用START语句显式启动一个事务），默认值为off。</span></li><li><span style="color:#0d0d0d;">--secondary[=on|off]</span><span style="color:#0d0d0d;">：指定是否需要使用一个二级索引来代替主键索引，默认值为off。</span></li><li><span style="color:#0d0d0d;">--create_secondary[=on|off]</span><span style="color:#0d0d0d;">：指定除主键之外，是否还需要创建一个二级索引，默认值为on。</span></li><li><span style="color:#0d0d0d;">--index_updates=<em>N</em></span><span style="color:#0d0d0d;">：指定在每个事务中使用索引执行UPDATE语句的次数，默认值为1。</span></li><li><span style="color:#0d0d0d;">--range_size=<em>N</em></span><span style="color:#0d0d0d;">：指定在每个事务中范围SELECT查询的条件值，默认值为100。</span></li><li><span style="color:#0d0d0d;">--auto_inc[=on|off]</span><span style="color:#0d0d0d;">：指定是否需要使用自增列的自增值作为主键值，如果不使用自增值，则使用sysbench自动生成的ID值作为主键值，默认值为on。</span></li><li><span style="color:#0d0d0d;">--delete_inserts=<em>N</em></span><span style="color:#0d0d0d;">：指定在每个事务中DELETE/INSERT组合语句的数量，默认值为1。</span></li><li><span style="color:#0d0d0d;">--tables=<em>N</em></span><span style="color:#0d0d0d;">：指定并行压测的表数量。</span></li><li><span style="color:#0d0d0d;">--mysql_storage_engine=STRING</span><span style="color:#0d0d0d;">：指定表的存储引擎，默认值为InnoDB。</span></li><li><span style="color:#0d0d0d;">--non_index_updates=N</span><span style="color:#0d0d0d;">：指定在每个事务中不使用索引执行UPDATE语句的次数，默认值为1。</span></li><li><span style="color:#0d0d0d;">--table_size=<em>N</em></span><span style="color:#0d0d0d;">：指定每个表的数据总量，默认值为10 000。</span></li><li><span style="color:#0d0d0d;">--pgsql_variant=STRING</span><span style="color:#0d0d0d;">：当用PostgreSQL驱动程序运行时使用此PostgreSQL变体。目前唯一支持的变体是“redshift”。启用后，将自动禁用create_secondary，并将--delete_inserts选项设置为0。</span></li><li><span style="color:#0d0d0d;">--simple_ranges=<em>N</em></span><span style="color:#0d0d0d;">：指定在每个事务中简单范围SELECT查询（这里指的是BETWEEN范围查询）的次数，默认值为1。</span></li><li><span style="color:#0d0d0d;">--order_ranges=<em>N</em></span><span style="color:#0d0d0d;">：指定在每个事务中SELECT ORDER BY查询的次数，默认值为1。</span></li><li><span style="color:#0d0d0d;">--range_selects[=on|off]</span><span style="color:#0d0d0d;">：指定是否需要打开或关闭所有的范围SELECT查询，默认值为on。</span></li><li><span style="color:#0d0d0d;">--point_selects=<em>N</em></span><span style="color:#0d0d0d;">：指定在每个事务中单行SELECT查询的次数，默认值为10。</span></li></ol> 
<p style="margin-left:20.8pt;"><span style="color:#0d0d0d;">提示</span><span style="color:#0d0d0d;">：</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">每一种测试名称对应的Lua脚本中都定义了需要使用的DML测试语句类型，每一种DML语句类型都可以通过选项单独指定在每一个事务中需要执行多少次。例如，在oltp_read_write测试名称中，一共有9种DML语句类型，按照默认的每一种语句的执行次数计算，在每一个事务中一共有18条语句，每一种DML语句类型的默认执行次数如下：<br> * 简单等值SELECT语句：默认为10次。<br> * 范围SELECT（BETWEEN）语句：默认为1次。<br> * SELECT SUM()语句：默认为1次。<br> * SELECT ORDER BY：默认为1次。<br> * SELECT DISTINCT语句：默认为1次。<br> * DELETE和INSERT组合语句：默认为1次。<br> * 使用索引的UPDATE语句：默认为1次。<br> * 不使用索引的UPDATE语句：默认为1次。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">在</span><span style="color:#0d0d0d;">执行oltp_read_write测试时，从MySQL的general_log中抓取的每个事务的语句数量也证实了，在默认的配置下一个事务中的语句数量为18条，如下图所示。</span></li></ol> 
<p style="margin-left:0;text-align:center;"></p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" height="125" src="https://images2.imgbox.com/f4/f3/Gxbzd5vg_o.png" width="394"></p> 
<p> </p> 
<h3 style="margin-left:0px;"><a name="_Toc535180132"></a><a name="_Toc17818617">3.3</a>　testname</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">testname</span><span style="color:#0d0d0d;">用于指定sysbench的基准测试名称。基准测试包括：</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">oltp _*.lua</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">数据库基准测试</span><span style="color:#0d0d0d;">Lua</span><span style="color:#0d0d0d;">脚本集合。这是</span><span style="color:#0d0d0d;">DBA</span><span style="color:#0d0d0d;">日常经常需要用到的测试脚本</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">fileio</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">文件系统级基准测试</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">cpu</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">简单的</span><span style="color:#0d0d0d;">CPU</span><span style="color:#0d0d0d;">基准测试</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">memory</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">内存访问基准测试</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">threads</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">基于线程的调度器基准测试</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">mutex</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">POSIX</span><span style="color:#0d0d0d;">互斥基准测试</span><span style="color:#0d0d0d;">。</span></li></ol> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">提示：在实际执行时，对于Lua新格式脚本，可以只写脚本名称（不写.lua后缀），如oltp_read_only，不再需要像sysbench 0.5及之前版本那样使用--test选项来指定。</span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">1</span><span style="color:#0d0d0d;">．</span><span style="color:#0d0d0d;">sysbench Lua</span><span style="color:#0d0d0d;">脚本介绍</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">Sysbench 1.0.x</span><span style="color:#0d0d0d;">版本中的</span><span style="color:#0d0d0d;">Lua</span><span style="color:#0d0d0d;">脚本代码比</span><span style="color:#0d0d0d;">0.5.x</span><span style="color:#0d0d0d;">版本工整得多</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">并且对结构进行了重新设计</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">大部分</span><span style="color:#0d0d0d;">SQL</span><span style="color:#0d0d0d;">语句都被整合到了</span><span style="color:#0d0d0d;">oltp_common.lua</span><span style="color:#0d0d0d;">脚本中集中定义</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">其他</span><span style="color:#0d0d0d;">Lua</span><span style="color:#0d0d0d;">脚本只需要加载这个脚本进行调用即可</span><span style="color:#0d0d0d;">。</span><span style="color:#0d0d0d;">另外</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">还对原来的</span><span style="color:#0d0d0d;">delete.lua</span><span style="color:#0d0d0d;">、select.lua、update*.lua、insert.lua</span><span style="color:#0d0d0d;">脚本中的</span><span style="color:#0d0d0d;">SQL</span><span style="color:#0d0d0d;">语句</span><span style="color:#0d0d0d;">进行了改进</span><span style="color:#0d0d0d;">，将其</span><span style="color:#0d0d0d;">嵌套到</span><span style="color:#0d0d0d;">begin</span><span style="color:#0d0d0d;">和</span><span style="color:#0d0d0d;">commit</span><span style="color:#0d0d0d;">语句中。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">通过RPM</span><span style="color:#0d0d0d;">包安装的sysbench </span><span style="color:#0d0d0d;">1.0.x</span><span style="color:#0d0d0d;">版本中的</span><span style="color:#0d0d0d;">Lua</span><span style="color:#0d0d0d;">脚本有两个目录</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">如下</span><span style="color:#0d0d0d;">所示。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# </span><strong><span style="color:#0d0d0d;">ls -lh /usr/share/sysbench/ /usr/share/sysbench/tests/include/\ oltp_legacy</span></strong></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">/usr/share/sysbench/:  #</span><span style="color:#0d0d0d;">对于</span><span style="color:#0d0d0d;">sysbench 1.0.x</span><span style="color:#0d0d0d;">版本</span><span style="color:#0d0d0d;">,</span><span style="color:#0d0d0d;">建议使用这个目录下的最新的</span><span style="color:#0d0d0d;">Lua</span><span style="color:#0d0d0d;">脚本</span><span style="color:#0d0d0d;">。</span><span style="color:#0d0d0d;">不过该脚本使用</span><span style="color:#0d0d0d;">prepare</span><span style="color:#0d0d0d;">命令执行语句</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">需要创建大量的</span><span style="color:#0d0d0d;">prepare</span><span style="color:#0d0d0d;">命令对象</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">调整参数的值</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">total 64K</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 1.5K May 15 22:14 bulk_insert.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root  14K May 15 22:14 oltp_common.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 1.1K May 15 22:14 oltp_delete.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 2.0K May 15 22:14 oltp_insert.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 1.3K May 15 22:14 oltp_point_select.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 1.7K May 15 22:14 oltp_read_only.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 1.8K May 15 22:14 oltp_read_write.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 1.1K May 15 22:14 oltp_update_index.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 1.2K May 15 22:14 oltp_update_non_index.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 1.5K May 15 22:14 oltp_write_only.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 1.9K May 15 22:14 select_random_points.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rwxr-xr-x 1 root root 2.1K May 15 22:14 select_random_ranges.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">drwxr-xr-x 4 root root 4.0K Jun 15 15:53 tests</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">​</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">/usr/share/sysbench/tests/include/oltp_legacy: </span><span style="color:#0d0d0d;"># </span><span style="color:#0d0d0d;">对于sysbench </span><span style="color:#0d0d0d;">1.0.x</span><span style="color:#0d0d0d;">版本，在这个目录下保留了一些兼容之前版本写法的Lua脚本</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">total 52K</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root 1.2K May 15 22:14 bulk_insert.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root 4.6K May 15 22:14 common.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root  366 May 15 22:14 delete.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root 1.2K May 15 22:14 insert.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root 3.0K May 15 22:14 oltp.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root  368 May 15 22:14 oltp_simple.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root  527 May 15 22:14 parallel_prepare.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root  369 May 15 22:14 select.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root 1.5K May 15 22:14 select_random_points.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root 1.6K May 15 22:14 select_random_ranges.lua</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root  369 May 15 22:14 update_index.lua</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">-rw-r--r-- 1 root root  578 May 15 22:14 update_non_index.lua</span></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">关于Lua语法请参考：http://www.runoob.com/lua/lua-tutorial.html。</span></p> 
<p style="margin-left:0;text-align:justify;"><span style="color:#0d0d0d;">2</span><span style="color:#0d0d0d;">．自定义Lua脚本</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">为了实现自定义测试，读者也可以自定义Lua脚本，使用sysbench进行测试。 </span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">下面是一个简单的示例。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">function prepare()</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    db_query("CREATE TABLE t (a INT)")</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    db_query("INSERT INTO t VALUES (1)")</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">end</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">​</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">function event()</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    db_query("UPDATE t SET a = a + " .. sb_rand(1, 1000))</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">end</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">​</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">function cleanup()</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    db_query("DROP TABLE t")</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">end</span></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">使用sysbench测试如下：</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;"># calls prepare()</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>sysbench --test=test.lua prepare</strong></span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;"># calls event() in a loop</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost</span><span style="color:#0d0d0d;">~]# <strong>sysbench --test=test.lua --num-threads=16 --report-interval=1 run </strong></span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 1s] threads: 16, tps: 0.00, reads: 0.00, writes: 13788.65, response time: 1.43ms (95%)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 2s] threads: 16, tps: 0.00, reads: 0.00, writes: 14067.56, response time: 1.40ms (95%)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">...</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">$ sysbench --test=test.lua cleanup # calls cleanup()</span></span></p> 
<h3 style="margin-left:0px;"><a name="_Toc17818618"></a><a name="_Toc535180133">3.4</a>　command</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">command</span><span style="color:#0d0d0d;">将由sysbench传递给内置的testname或testname指定的Lua脚本。该命令指定testname需要执行的操作。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">以下是典型的测试命令及其描述。</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">prepare</span><span style="color:#0d0d0d;">：执行准备工作</span><span style="color:#0d0d0d;">。</span><span style="color:#0d0d0d;">例如</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">在磁盘上创建必要的测试文件以进行</span><span style="color:#0d0d0d;">fileio</span><span style="color:#0d0d0d;">测试，或</span><span style="color:#0d0d0d;">者在</span><span style="color:#0d0d0d;">测试数据库</span><span style="color:#0d0d0d;">上新建</span><span style="color:#0d0d0d;">100</span><span style="color:#0d0d0d;">万行数据</span><span style="color:#0d0d0d;">以执行数据库基准测试</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">run</span><span style="color:#0d0d0d;">：使用</span><span style="color:#0d0d0d;">testname</span><span style="color:#0d0d0d;">参数指定的</span><span style="color:#0d0d0d;">压测脚本</span><span style="color:#0d0d0d;">执行</span><span style="color:#0d0d0d;">对应的</span><span style="color:#0d0d0d;">测试</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">cleanup</span><span style="color:#0d0d0d;">：在测试结束后删除临时数据或文件</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">help</span><span style="color:#0d0d0d;">：显示使用</span><span style="color:#0d0d0d;">testname</span><span style="color:#0d0d0d;">参数指定的</span><span style="color:#0d0d0d;">压测脚本</span><span style="color:#0d0d0d;">的相关帮助信息</span><span style="color:#0d0d0d;">，</span><span style="color:#0d0d0d;">包括</span><span style="color:#0d0d0d;">该压测脚本参数</span><span style="color:#0d0d0d;">的完整列表</span><span style="color:#0d0d0d;">。例如</span><span style="color:#0d0d0d;">sysbench </span><span style="color:#0d0d0d;">oltp</span><span style="color:#0d0d0d;">_write_only help</span><span style="color:#0d0d0d;">，可以查看</span><span style="color:#0d0d0d;">oltp</span><span style="color:#0d0d0d;">_write_only</span><span style="color:#0d0d0d;">压测脚本支持的所有可选参数。</span></li></ol> 
<h2 style="margin-left:0px;text-align:justify;"><a name="_Toc17818619"></a><a name="_Toc535180134"></a><a name="_Toc34082296"><strong>4</strong></a><strong>　数据库测试输出信息详解</strong></h2> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">下面详细介绍使用sysbench测试MySQL数据库的输出结果。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[root@localhost~]# <strong>sysbench --db-driver=mysql --time=10 --threads=4 --report-interval=1</strong></span><strong><span style="color:#0d0d0d;">\ --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=qbench --mysql-password=qb</span></strong></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[14/480]</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">ysql-db=sbtest --tables=32 --table-size=50000 oltp_read_write --db-ps-mode=disable run</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">sysbench 1.0.7 (using bundled LuaJIT 2.1.0-beta2)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Running the test with following options:</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Number of threads: 4</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Report intermediate results every 1 second(s)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Initializing random number generator from current time</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Initializing worker threads...</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Threads started!</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">​</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 1s ] thds: 4 tps: 374.23 qps: 7533.43 (r/w/o: 5280.08/977.98/1275.36) lat (ms,95%): 17.95 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 2s ] thds: 4 tps: 329.07 qps: 6604.49 (r/w/o: 4622.04/880.20/1102.25) lat (ms,95%): 21.11 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 3s ] thds: 4 tps: 362.00 qps: 7225.05 (r/w/o: 5054.04/943.01/1228.01) lat (ms,95%): 18.61 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 4s ] thds: 4 tps: 392.00 qps: 7847.05 (r/w/o: 5494.04/1069.01/1284.01) lat (ms,95%): 17.63 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 5s ] thds: 4 tps: 331.01 qps: 6602.18 (r/w/o: 4625.12/894.02/1083.03) lat (ms,95%): 20.37 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 6s ] thds: 4 tps: 334.99 qps: 6712.77 (r/w/o: 4698.84/929.97/1083.96) lat (ms,95%): 19.65 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 7s ] thds: 4 tps: 356.97 qps: 7149.40 (r/w/o: 5002.58/985.92/1160.90) lat (ms,95%): 19.29 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 8s ] thds: 4 tps: 333.01 qps: 6657.20 (r/w/o: 4663.14/926.03/1068.03) lat (ms,95%): 20.37 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 9s ] thds: 4 tps: 347.03 qps: 6950.59 (r/w/o: 4860.41/972.08/1118.09) lat (ms,95%): 20.37 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 10s ] thds: 4 tps: 342.97 qps: 6821.44 (r/w/o: 4773.61/932.92/1114.91) lat (ms,95%): 19.29 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">SQL statistics:</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    queries performed:</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">        read: 49084</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">        write: 9513</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">        other: 11523</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">        total: 70120</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    transactions: 3506 (350.33 per sec.)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    queries: 70120 (7006.63 per sec.)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    ignored errors: 0 (0.00 per sec.)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    reconnects: 0 (0.00 per sec.)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">​</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">General statistics:</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    total time: 10.0062s</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    total number of events: 3506</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">​</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Latency (ms):</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         min: 4.56</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         avg: 11.41</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         max: 39.24</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         95th percentile: 19.65</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         sum: 39997.58</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">​</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Threads fairness:</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    events (avg/stddev): 876.5000/5.22</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    execution time (avg/stddev): 9.9994/0.00</span></span></p> 
<p style="margin-left:.0001pt;"></p> 
<h3 style="margin-left:0px;"><a name="_Toc17818620"></a><a name="_Toc535180135">4.1</a>　输出结果概述</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">Sysbench</span><span style="color:#0d0d0d;">测试输出结果主要分为三部分：</span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">版本及</span><span style="color:#0d0d0d;">关键</span><span style="color:#0d0d0d;">测试参数输出</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">中间统计结果输出</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">整体统计结果输出</span><span style="color:#0d0d0d;">。</span></li></ol> 
<h3 style="margin-left:0px;"><a name="_Toc17818621"></a><a name="_Toc535180136">4.2</a>　版本及关键测试参数输出</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">在sysbench测试正常开始以后，首先输出的是sysbench的版本、压测线程个数、每隔几秒输出一次中间结果、随机数初始化等相关信息。</span></p> 
<h3 style="margin-left:0px;"><a name="_Toc17818622"></a><a name="_Toc535180137">4.3</a>　中间统计结果输出</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">在指定了--report-interval参数以后，每隔report-interval时间输出一次中间统计结果，如下所示。</span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">[ 6s ] thds: 4 tps: 334.99 qps: 6712.77 (r/w/o: 4698.84/929.97/1083.96) lat (ms,95%): 19.65 err/s: 0.00 reconn/s: 0.00</span></span></p> 
<ol><li style="text-align:justify;"><span style="color:#0d0d0d;">[ 6s ]</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">表示当前已经压测</span><span style="color:#0d0d0d;">6</span><span style="color:#0d0d0d;">s</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">thds: 4</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">表示</span><span style="color:#0d0d0d;">4</span><span style="color:#0d0d0d;">个线程并发压测。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">tps: 334.99</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">表示</span><span style="color:#0d0d0d;">在</span><span style="color:#0d0d0d;">report-interval</span><span style="color:#0d0d0d;">时间间隔内的每秒事务数。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">qps: 6712.77</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">表示</span><span style="color:#0d0d0d;">在</span><span style="color:#0d0d0d;">report-interval</span><span style="color:#0d0d0d;">时间间隔内的每秒查询数。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">(r/w/o: 4698.84/929.97/1083.96)</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">表示</span><span style="color:#0d0d0d;">在</span><span style="color:#0d0d0d;">report-interval</span><span style="color:#0d0d0d;">时间间隔内的每秒读</span><span style="color:#0d0d0d;">/</span><span style="color:#0d0d0d;">写</span><span style="color:#0d0d0d;">/</span><span style="color:#0d0d0d;">其他请求数，用于补充说明</span><span style="color:#0d0d0d;">qps</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">lat (ms,95%):19.65</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">表示</span><span style="color:#0d0d0d;">在</span><span style="color:#0d0d0d;">report-interval</span><span style="color:#0d0d0d;">时间间隔内的请求</span><span style="color:#0d0d0d;">95%</span><span style="color:#0d0d0d;">的延迟</span><span style="color:#0d0d0d;">时间</span><span style="color:#0d0d0d;">在</span><span style="color:#0d0d0d;">19.65ms</span><span style="color:#0d0d0d;">以下</span><span style="color:#0d0d0d;">。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">err/s: 0.00</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">表示</span><span style="color:#0d0d0d;">在</span><span style="color:#0d0d0d;">report-interval</span><span style="color:#0d0d0d;">时间间隔内的每秒失败请求数。</span></li><li style="text-align:justify;"><span style="color:#0d0d0d;">reconn/s: 0.00</span><span style="color:#0d0d0d;">：</span><span style="color:#0d0d0d;">表示</span><span style="color:#0d0d0d;">在</span><span style="color:#0d0d0d;">report-interval</span><span style="color:#0d0d0d;">时间间隔内的每秒重连</span><span style="color:#0d0d0d;">接</span><span style="color:#0d0d0d;">数。</span></li></ol> 
<h3 style="margin-left:0px;"><a name="_Toc17818623"></a><a name="_Toc535180138">4.4</a>　整体统计结果输出</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">在sysbench全部测试完成以后，将输出整体压测的统计结果。主要分为四部分：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">（1）SQL统计结果</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该项输出结果包括sysbench发起的读/写/其他/总计SQL查询数量、总计事务数及每秒事务数、总计请求数及每秒请求数、总计错误数及每秒错误数、总计重连接数及每秒重连接数。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">SQL statistics:</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    queries performed:</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">        read: 49084</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">        write: 9513</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">        other: 11523</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">        total: 70120</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    transactions: 3506 (350.33 per sec.)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    queries: 70120 (7006.63 per sec.)</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    ignored errors: 0 (0.00 per sec.)</span></span></p> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    reconnects: 0 (0.00 per sec.)</span></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">（2）通用统计值 </span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该项输出结果包括总计执行的时间、所有的事件数量（这里对应的是发起的MySQL事务数）。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">General statistics:</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    total time: 10.0062s</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    total number of events: 3506</span></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">（3）延迟时间统计结果</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该项输出结果包括延迟时间最低值、平均值、最高值、第95%位值、总计值。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Latency (ms):</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         min: 4.56</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         avg: 11.41</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         max: 39.24</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         95th percentile: 19.65</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">         sum: 39997.58</span></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">（4）压测线程统计结果 </span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">该项输出结果包括每个压测线程的平均事件数及标准差、每个事务的平均执行时间及标准差。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">Threads fairness:</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ebebeb;"><span style="color:#0d0d0d;">    events (avg/stddev): 876.5000/5.22</span></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0d0d;">    execution time (avg/stddev): 9.9994/0.00</span></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d7e88d4ddfbfc262060101d120597fe1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">gitlab开机启动|启动 停止 重启</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/50a50e614d0261a57579d6ba2fd55dc9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">WinSCP 连接 Ubuntu，显示拒绝访问。</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>