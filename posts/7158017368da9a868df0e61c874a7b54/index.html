<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring从入门到精通 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Spring从入门到精通" />
<meta property="og:description" content="第一章、Spring简介（给软件行业带来春天）（是个全家桶，有很多单独的框架） 1、什么是spring？（解决企业开发的难度，减轻对项目模块之间的管理，类和类之间的管理，帮助开发人员创建对象，管理对象之间的关系）（核心功能是IOC和AOP，能够实现模块之间，类之间的解耦合） Spring是一个引擎，是一个开源容器框架，可以接管web层，业务层，dao层，持久层的组件，并且可以配置各种bean,和维护bean与bean之间的关系。其核心就是控制翻转（IOC），和面向切面（AOP），简单的说就是一个分层的轻量级开源框架。
Spring原理和组成：Spring为简化我们的开发工作，封装了一系列的开箱即用的组件功能模块，包括：Spring JDBC 、Spring MVC 、Spring Security、 Spring AOP 、Spring ORM 、Spring Test等。
理念（目的）：解决企业应用开发的复杂性，使现有的技术更加容易使用，本身是一个大杂烩整合了现有的框架。
优点：
1、Spring是一个免费开源的框架（容器）！
2、Spring是一个轻量级的非入侵的框架！
3、控制反转（IOC），面向切面编程（AOP）
4、支持事务的处理，对框架整合的支持！
总结：Spring就是一个轻量级的控制反转（IOC）和面向切面编程的框架！
Spring包含了SpringMVC，而SpringBoot又包含了Spring或者说是在Spring的基础上做得一个扩展。
spring mvc &lt; spring &lt; springboot
Spring Boot只是Spring本身的扩展，使开发，测试和部署更加方便。
SSM框架：Spring&#43;SpringMVC&#43;MyBatis
Spring MVC：属于SpringFrameWork的后续产品，已经融合在Spring Web Flow里面。Spring MVC 分离了控制器、模型对象、分派器以及处理程序对象的角色，这种分离让它们更容易进行定制。
MyBatis： 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以对配置和原生Map使用简单的 XML 或注解，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。
Rod Johnson:Spring Framework的创始人，音乐学的博士学位，轮子理论：就是不要重复发明轮子
2、什么是框架？ 框架可以类比如造房子的框架和造桥梁的框架，类库可以类比如为钢材，类库更加通用。
3、为什么使用框架？ 软件系统日趋复杂
重用度高，开发效率和质量高
软件设计人员要专注于对领域的了解，使需求更充分易于上手、快速解决问题。
4、Sping IOC容器 面向接口编程的例子：
接口：
实现类：
调用：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/7158017368da9a868df0e61c874a7b54/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-22T13:09:57+08:00" />
<meta property="article:modified_time" content="2022-05-22T13:09:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring从入门到精通</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Spring_0"></a>第一章、Spring简介（给软件行业带来春天）（是个全家桶，有很多单独的框架）</h2> 
<h3><a id="1springIOCAOP_1"></a>1、什么是spring？（解决企业开发的难度，减轻对项目模块之间的管理，类和类之间的管理，帮助开发人员创建对象，管理对象之间的关系）（核心功能是IOC和AOP，能够实现模块之间，类之间的解耦合）</h3> 
<p>Spring是一个引擎，是一个开源容器框架，可以接管web层，业务层，dao层，持久层的组件，并且可以配置各种bean,和维护bean与bean之间的关系。其核心就是控制翻转（IOC），和面向切面（AOP），简单的说就是一个分层的轻量级开源框架。<br> Spring原理和组成：Spring为简化我们的开发工作，封装了一系列的开箱即用的组件功能模块，包括：Spring JDBC 、Spring MVC 、Spring Security、 Spring AOP 、Spring ORM 、Spring Test等。<br> 理念（目的）：解决企业应用开发的复杂性，使现有的技术更加容易使用，本身是一个大杂烩整合了现有的框架。<br> 优点：<br> 1、Spring是一个免费开源的框架（容器）！<br> 2、Spring是一个轻量级的非入侵的框架！<br> 3、<strong>控制反转（IOC），面向切面编程（AOP）</strong><br> 4、支持事务的处理，对框架整合的支持！<br> 总结：Spring就是一个轻量级的控制反转（IOC）和面向切面编程的框架！</p> 
<p><img src="https://images2.imgbox.com/14/10/FWrNdqEM_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7e/2e/ajjbnv0l_o.jpg" alt="在这里插入图片描述"><br> Spring包含了SpringMVC，而SpringBoot又包含了Spring或者说是在Spring的基础上做得一个扩展。<br> <img src="https://images2.imgbox.com/e9/29/L8o9J0fO_o.jpg" alt="在这里插入图片描述"><br> spring mvc &lt; spring &lt; springboot<br> Spring Boot只是Spring本身的扩展，使开发，测试和部署更加方便。<br> SSM框架：Spring+SpringMVC+MyBatis</p> 
<p>Spring MVC：属于SpringFrameWork的后续产品，已经融合在Spring Web Flow里面。Spring MVC 分离了控制器、模型对象、分派器以及处理程序对象的角色，这种分离让它们更容易进行定制。<br> MyBatis： 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以对配置和原生Map使用简单的 XML 或注解，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。<br> Rod Johnson:Spring Framework的创始人，音乐学的博士学位，轮子理论：就是不要重复发明轮子</p> 
<h3><a id="2_24"></a>2、什么是框架？</h3> 
<p><img src="https://images2.imgbox.com/6e/c5/DvY0Ka7j_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/57/bc/lWUYqajd_o.png" alt="在这里插入图片描述"><br> 框架可以类比如造房子的框架和造桥梁的框架，类库可以类比如为钢材，类库更加通用。</p> 
<h3><a id="3_28"></a>3、为什么使用框架？</h3> 
<p>软件系统日趋复杂<br> 重用度高，开发效率和质量高<br> 软件设计人员要专注于对领域的了解，使需求更充分易于上手、快速解决问题。</p> 
<h3><a id="4Sping_IOC_33"></a>4、Sping IOC容器</h3> 
<p><img src="https://images2.imgbox.com/a4/5d/WGvGnpC0_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c7/1a/0oSlMkz3_o.png" alt="在这里插入图片描述"><br> 面向接口编程的例子：<br> 接口：<br> <img src="https://images2.imgbox.com/5e/8e/W00gE4eg_o.png" alt="在这里插入图片描述"><br> 实现类：<br> <img src="https://images2.imgbox.com/95/d3/zxx1e0Rk_o.png" alt="在这里插入图片描述"><br> 调用：<br> <img src="https://images2.imgbox.com/98/c7/Qc6HkOuQ_o.png" alt="在这里插入图片描述"><br> 什么是IOC？<br> <img src="https://images2.imgbox.com/ed/ec/JDRruI7L_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0d/c4/ENJ6oohH_o.png" alt="在这里插入图片描述"><br> 依赖：ClassA中使用ClassB的属性或者方法，叫做ClassA依赖于ClassB</p> 
<h3><a id="5Spring_48"></a>5、Spring官网浏览</h3> 
<p><img src="https://images2.imgbox.com/87/a5/M3Fe7fIa_o.png" alt="在这里插入图片描述"><br> 每一行是一个单独的框架，所做的工作是不同的<br> 主要学习Spring Framework</p> 
<h3><a id="6_53"></a>6、框架的优点</h3> 
<p>1、轻量，Spring框架使用的Jar都比较小，一般在1M以下或者几百kb，Spring核心功能所需的jar总共在3M左右。<br> 2、针对接口编程，解耦合，Spring提供了IOC控制反转。由容器管理对象，对象的依赖关系。原来在程序代码中的对象创建方式，现在由容器完成，对象之间依赖解耦合。<br> 3、AOP编程的支持，通过提供的AOP功能，方便进行面向切面的编程，许多不容易用传统OOP实现的功能可以通过AOP轻松应付，在Spring中，开发人员可以从繁杂的事物管理代码中解脱出来，通过声明式方式灵活地进行事务的管理，提高开发效率和质量。<br> 4、方便集成各种优秀的框架，spring不排斥各种优秀的开源框架，相反Spring可以降低各种框架的使用难度，Spring提供了对各种优秀框架等的直接支持。简化框架的使用，Spring像插线板一样，其他框架是插头，可以容易的组合到一起。需要使用哪个框架就把这个插头放入插线板。不需要可因轻易移除。</p> 
<h3><a id="7Spring_59"></a>7、Spring框架模块</h3> 
<p>Spring由20多个模块组成，他们可以分为数据访问/集成、web、面向切面编程（AOP、Aspects）、集成功能模块（JVM代理（instrumentation）、消息返送（Messaging））、核心容器（Core Container）和测试（Test）。<br> <img src="https://images2.imgbox.com/23/60/NndWi9cu_o.jpg" alt="在这里插入图片描述"></p> 
<h2><a id="IOC_62"></a>第二章、IOC控制反转</h2> 
<p><img src="https://images2.imgbox.com/13/8c/Xl6qXkMa_o.png" alt="在这里插入图片描述"><br> <strong>IOC</strong>：控制反转，是一个理论，概念，思想。<br> 描述：把对象的创建，赋值，管理工作都交给代码之外的容器实现，也就是对象的创建是在其他外部资源完成<br> 控制：创建对象，对象的属性赋值对象之间关系管理。<br> 反转：把原来的开发管理，创建对象的权限转移给代码之外的容器实现。由容器代替开发人员管理对象。创建对象，给属性赋值。<br> 正转：由开发人员在代码中，使用new构造方法创建对象，开发人员主动管理对象。<br> 容器：是一个服务器软件，一个框架（Spring）<br> 为什么要使用IOC：目的是减少对代码的改动，也能实现不同的功能，实现解耦合。<br> <strong>java中创建对象有哪些方式：</strong></p> 
<ol><li>构造方法 ， new Student（）</li><li>反射</li><li>序列化</li><li>克隆</li><li>ioc ：容器创建对象</li><li>动态代理<br> <strong>IOC的技术体现</strong>：<br> servlet<br> <strong>1</strong>： 创建类继承HttpServelt<br> <strong>2</strong>: 在web.xml 注册servlet ， 使用 myservlet <br> com.bjpwernode.controller.MyServlet1<br> <strong>3</strong>. 没有创建 Servlet对象， 没有 MyServlet myservlet = new MyServlet()<br> <strong>4</strong>. Servlet 是Tomcat服务器它能你创建的。 Tomcat也称为容器<br> Tomcat作为容器：里面存放的有Servlet对象， Listener ， Filter对象<br> <strong>IOC的技术实现</strong>：DI（依赖注入）是IOC的技术实现，<br> <strong>依赖注入</strong>：DI，程序代码不做定位查询，这些工作由容器自行完成。只需要在程序中提供要使用的对象名称就可以， 至于对象如何在容器中创建， 赋值，查找都由容器内部实现。</li></ol> 
<p>Spring是使用的DI实现了IOC的功能，spring底层创建对象，使用的是反射机制。<br> Spring是一个容器，管理对象，给属性赋值，底层是反射创建对象。</p> 
<h3><a id="Spring_91"></a>Spring的第一个程序</h3> 
<p>步骤：<br> <img src="https://images2.imgbox.com/43/e2/i0O7qiOR_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="maven_95"></a>创建一个maven项目</h4> 
<p>使用maven骨架quickstart来创建一个maven项目</p> 
<h5><a id="maven_97"></a>加入maven依赖</h5> 
<p>修改pom.xml文件<br> <img src="https://images2.imgbox.com/61/00/jaH4zII5_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_100"></a>创建类接口和它的实现类</h5> 
<p><img src="https://images2.imgbox.com/65/ec/VWAhiUo3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4d/52/rJfiNeJv_o.png" alt="在这里插入图片描述"><br> 正传：（测试代码）<br> <img src="https://images2.imgbox.com/0b/f2/j9T1IefR_o.png" alt="在这里插入图片描述"><br> 创建Spring配置文件<br> 在resource文件中创建spring配置文件beans.xml文件<br> <img src="https://images2.imgbox.com/61/5c/jMftiM1O_o.png" alt="在这里插入图片描述"></p> 
<p>创建容器，使用容器来创建对象， ApplicationContext就是表示spring容器，通过容器获取对象<br> 从容器中获取某个对象，调用对象的方法,getBean(“配置文件中的id值”);<br> <img src="https://images2.imgbox.com/e8/44/1FERwE6D_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c7/5f/pNKSp742_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="spring_114"></a>spring创建对象的时机</h5> 
<p>对象是在执行语句时所创建的：<br> ApplicationContext appCon = new ClassPathXmlApplicationContext(config);</p> 
<p>创建对象的时间是：在创建Spring的容器时，它会创建配置文件中所有的对象。<br> spring创建对象：默认调用的是无参构造方法</p> 
<h5><a id="_121"></a>获取容器中对象的信息</h5> 
<p><img src="https://images2.imgbox.com/fa/17/fEnYXkMF_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="spring_123"></a>让spring创建一个非自定义类的对象吗，创建一个存在的某个类的对象</h5> 
<p><img src="https://images2.imgbox.com/b1/22/0vtlZe9l_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/e5/27/kWtHV8xc_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="XMLDI_127"></a>基于XML的DI</h3> 
<h4><a id="DI_129"></a>DI的实现方式</h4> 
<p>1、在spring的配置文件中，使用标签和属性完成，叫做基于XML的di实现<br> 2、使用spring中的注解，完成属性赋值，叫做基于注解的di实现</p> 
<h4><a id="DI_132"></a>DI的分类</h4> 
<p><strong>1、set注入（设值注入）：spring调用类的set方法，在set方法可以实现属性的赋值。</strong><br> 大部分使用set注入<br> 实现步骤：<br> 1）创建maven项目<br> 2）加入maven的依赖，spring的依赖，版本5.2.5版本，junit依赖<br> 3）创建类（接口和他的实现类）<br> 和没有使用框架一样，就是普通的类。<br> 4）创建spring需要使用的配置文件<br> 声明类的信息，这些类由spring创建和管理<br> 通过spring的语法，完成属性的赋值<br> 5）测试属性的创建。<br> <img src="https://images2.imgbox.com/02/b5/K7x8t56M_o.png" alt="在这里插入图片描述"><br> <strong>注入：就是赋值的意思</strong><br> 简单类型：spring中规定java的基本数据类型和string都是简单类型。<br> 1）简单类型的set注入<br> <br> <br> <br> <br> 一个property只能给一个属性赋值<br> set注入调用了set方法：<br> <img src="https://images2.imgbox.com/33/2f/cj2jVcBm_o.png" alt="在这里插入图片描述"><br> 设值注入的注意事项：<br> 1、如果类中没有set方法，就会报错，说明如果类没有set方法不可以set注入。<br> 2、set注入首先是调用类的无参构造方法创建对象<br> 3、set注入只要有set方法就可以注入，和创建的属性无关，set注入只是使用set方法<br> <img src="https://images2.imgbox.com/02/85/eIKW2jEj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/30/fc/F4d5XJDO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/97/7a/6RC0It0q_o.png" alt="在这里插入图片描述"><br> 2）引用类型的设置注入<br> 引用类型的set注入：spring调用类的set方法</p> 
<blockquote> 
 <pre><code>&lt;bean id="类对象的取一个名称" class="类的路径"&gt;
  &lt;property name="属性名称l" ref="bean的id（对象的名称）"&gt;&lt;/property&gt;
&lt;/bean&gt;
</code></pre> 
</blockquote> 
<p><img src="https://images2.imgbox.com/d3/d8/YdAHaEyv_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fd/34/QOfW0WOY_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3c/7a/xhvDawVx_o.png" alt="在这里插入图片描述"></p> 
<p><strong>2、构造注入，spring调用类的有参数构造方法，创建对象，在构造方法中完成赋值。</strong><br> 构造注入使用标签<br> 标签：一个表示构造方法的一个参数<br> 标签属性：<br> name:表示构造方法的参数的位置，参数从左往右位置是0,1，2的顺序<br> value：构造方法的形参类型是简单类型，使用value<br> ref:构造方法的形参类型是引用类型，使用ref<br> <em>使用name属性实现构造方法注入：</em>（先后顺序可以变）<br> <img src="https://images2.imgbox.com/43/59/MWjEguFj_o.png" alt="在这里插入图片描述"><br> <em>使用index属性实现注入：</em>（先后顺序可以变）<br> <img src="https://images2.imgbox.com/59/a1/EKdSY9F3_o.png" alt="在这里插入图片描述"><br> <em>使用非自定义的类进行构造注入：</em><br> <img src="https://images2.imgbox.com/ea/f7/iBm2q2Wy_o.png" alt="在这里插入图片描述"><br> <strong>单元测试：</strong><br> main方法测试的话不方便，每个方法单独测试就使用单元测试<br> 使用单元测试：<br> 1、需要在pom.xml文件中加入junit依赖<br> <br> junit<br> junit<br> 4.11<br> test<br> <br> 2、创建测试用的类：叫做测试类<br> src/test/java目录中创建类</p> 
<p>3、创建测试方法<br> 1）public方法<br> 2）没有返回值void<br> 3）方法名称自定义、建议名称是test+你要测试方法的名称<br> 4）方法没有参数<br> 5）方法的上面加入@Test，这样的方法是可以单独执行的。不用使用main方法。</p> 
<h4><a id="_205"></a>引用类型属性自动注入</h4> 
<h5><a id="1byName_206"></a>1、byName方式自动注入</h5> 
<p>引用类型的自动注入：spring框架根据某些规则可以给引用类型赋值。不用自己再给引用类型赋值了<br> 使用的规则常用的是byName，byType.<br> 1、byName（按照名称注入）：java类中引用类型的属性名和spring容器中（配置文件的id名称一样，且数据类型是一致的，这样的容器中的bean，spring能够赋值给引用类型。<br> 语法：<br> <br> 简单类型属性赋值<br> <br> 定义student类：三个set方法，两个简单类型一个引用类型<br> <img src="https://images2.imgbox.com/fc/74/B6HB37pf_o.png" alt="在这里插入图片描述"><br> spring配置文件：在student对象中申明autowire属性，赋值byName，对简单类型进行赋值，引用对象的id设置为类中引用属性的属性名<br> <img src="https://images2.imgbox.com/72/c3/Y6HEwMJc_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2byType_219"></a>2、byType方式自动注入（按照类型注入）</h5> 
<p>java类中引用类型的数据类型和spring容器中（配置文件）的class属性是同源关系的，这样bean能够赋值给引用类型<br> 同源就是一类的意思：<br> 1、java类引用类型的数据类型和bean的class的值是一样的。<br> 2、java类中引用类型的数据类型和bean的class的值父子类关系的。<br> 3、java类中引用类型的数据类型和bean的class值接口和实现类关系的<br> 语法：<br> <br> 简单类型属性赋值<br> <br> 注意：在byType中，在xml配置文件中声明bean只能有一个符合条件的，多余一个是错误的。</p> 
<h4><a id="spring_230"></a>为应用指定多个spring配置文件</h4> 
<p>实际开发中使用多个配置文件<br> 优势是：<br> 1、每个文件的大小比一个文件要小很多，效率高<br> 2、避免多人竞争带来冲突。（多个模块相关功能在一起）<br> 如果你的项目有多个模块（相关的功能在一起），一个模块一个配置文件。<br> 学生考勤模块，一个配置文件， 张三<br> 学生成绩一个配置文件， 李四<br> 多文件的分配方式：<br> 1、按照功能的模块，一个模块一个配置文件<br> 2、按类的功能，数据库相关的配置一个配置文件，做事务的功能的一个配置文件，做service功能的一个配置文件</p> 
<blockquote> 
 <p>包含关系的配置文件：<br> spring-total表示配置文件：包含其他的配置文件，主配置文件一般是不定义对象的。<br> 语法：<br> 关键字：“classpath:”表示类路劲（class文件所在的目录），<br> 在spring的配置文件中要指定其他文件的位置，需要使用classpath，告诉spring到哪去加载读取<br> 例如：(在包含关系的配置文件中，可以使用通配符如：*表示任意字符)<br> 注意：主的配置文件名称不能包含在通配符的范围内（不能叫做spring-total.xml）<br> <br> 这里是引用</p> 
</blockquote> 
<p>例如：总的文件（包含关系的配置文件）<br> <img src="https://images2.imgbox.com/de/b7/elZllD4s_o.png" alt="在这里插入图片描述"><br> 分文件：<br> <img src="https://images2.imgbox.com/85/e8/XO15V1RE_o.png" alt="在这里插入图片描述"><br> 分文件：<br> <img src="https://images2.imgbox.com/3c/cb/XLhRvaGj_o.png" alt="在这里插入图片描述"><br> 调用总的文件：<br> <img src="https://images2.imgbox.com/17/4a/vFkqm2AG_o.png" alt="在这里插入图片描述"><br> 在包含关系的配置文件中可以使用配置符（*：表示任意字符），下面这个例子，使用通配符注意不能将主文件包含在内，所以需要修改主文件的文件名称。<br> 注意：主的配置文件不能包含在通配符的范围内（不能叫做spring-total.xml）<br> <img src="https://images2.imgbox.com/34/f8/H78BAik6_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="DI_263"></a>基于注解的DI</h3> 
<p>通过注解来完成java对象的创建，属性赋值。<br> 1、加入maven的依赖 spring-context,在你加入spring-context的同时，间接加入spring-aop的依赖。<br> 使用注解必须使用spring-aop依赖<br> <img src="https://images2.imgbox.com/83/00/lUaGvqkG_o.png" alt="在这里插入图片描述"><br> 2、在类中加入spring的注解（多个不同功能的注解）<br> 3、在spring的配置文件中，加入一个组件扫描器的标签，说明注解在你的项目中的位置<br> 学习注解：@Component、@Respotory、@Service、@Controller、@Value、@Autowired、@Resource<br> 重新创建项目：<br> <img src="https://images2.imgbox.com/cb/e9/W4ItX1zS_o.png" alt="在这里插入图片描述"><br> 可以设置为1.8版本<br> <img src="https://images2.imgbox.com/21/ad/NSYMGUFo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/45/ee/e0Bx6uXB_o.png" alt="在这里插入图片描述"><br> component注解的使用：</p> 
<pre><code class="prism language-java"><span class="token comment">/*
* @Component:创建对象的，等同于&lt;bean&gt;的功能
* 属性：value就是对象的名称，也就是bean的id值，
* value的值是唯一的，创建的对象在整个spring容器中就一个
* 位置：在类的上面
* @Component(value = "mystudent")等同于
* &lt;bean id="mystudent" class = "com.springtest.bao01.Student"&gt;
但是还需要一个功能，使用spring的配置文件声明扫描器，告诉注解的位置
* */</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/65/4e/vx0ty2C4_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/78/29/9FjkJ19W_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/cb/fa/GMtDOYhl_o.png" alt="在这里插入图片描述"><br> 这里是调用的无参构造方法来创建对象<br> <img src="https://images2.imgbox.com/f7/42/m8MtdpwS_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_294"></a>多注解项目分层</h4> 
<p>spring中和@Component功能一致，创建对象的注解还有：<br> 1、@Repository（用在持久层的上面）：放在dao的实现类上面，表示创建dao对象，dao对象是能访问数据库的<br> 2、@Service（用在业务层类的上面）：放在service的实现类上面，创建service对象，service对象是做业务处理，可以有事务等功能的。<br> 3、@Controller（用在控制器的上面）：放在控制器（处理器）类的上面，创建控制器对象的。<br> 控制器对象，能够接受用户提交的参数，显示请求处理结果。<br> 以上三个注解的使用语法和@Component一样的。都能够创建对象，但是这三个注解还有额外的功能。<br> <strong>@Repository、@Service、@Controller是用来给对象分层的</strong>用法一样角色不同<br> 当所创建的类不是上面三种类型，使用@Component</p> 
<h4><a id="_303"></a>扫描多个包的三种方式</h4> 
<p><img src="https://images2.imgbox.com/3e/65/cOzYDy0U_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_305"></a>简单类型属性赋值</h4> 
<p>@value：简单类型的属性赋值<br> /*<br> * @Value：简单类型的属性赋值<br> * 属性：value是string类型的，表示简单类型的属性<br> * 位置：<br> * 1、在属性定义的上面，无需set方法，推荐使用。<br> * 2、在set方法上面，用的不比较少<br> * */<br> <img src="https://images2.imgbox.com/ee/bc/7pdOTpwB_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/35/fc/KTOxtIG9_o.png" alt="用的少"></p> 
<h4><a id="_316"></a>引用类型的属性赋值</h4> 
<h5><a id="Autowired_317"></a>引用类型Autowired</h5> 
<pre><code>/*
* 引用类型
* @Autowired：spring框架提供的注解，实现引用类型的赋值。
* spring中通过注解给引用类型赋值，使用的是自动注入原理，支持byName，byType
* @Autowired:默认使用的是byType自动注入
* 位置：
* 1）在属性定义的上面，无需set方法，推荐使用
* 2）在set方法的上面
* */
</code></pre> 
<p><img src="https://images2.imgbox.com/97/17/N73hj2Tn_o.png" alt="在这里插入图片描述"><br> 使用byName方式：需要做的是<br> 1、在属性上面加入@Autowired<br> 2、在属性上面加入@Qualified(value=“bean的id”)：表示使用指定名称的bean完成赋值<br> <img src="https://images2.imgbox.com/9e/4f/LlahEUUF_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="AutoWiredrequired_332"></a>引用类型AutoWired的required属性</h5> 
<p>属性：required，是一个boolean类型的，默认true<br> required=true：表示如果引用类型赋值失败，程序报错，并终止执行。<br> required=false：表示如果引用类型赋值失败，引用类型是null，程序不报错<br> <img src="https://images2.imgbox.com/c7/09/3Cxdpsns_o.png" alt="在这里插入图片描述"><br> 引用类型引用类型 AutoWired 的required属性值推荐使用 ture</p> 
<h4><a id="JDKResource_339"></a>JDK注解@Resource自动注入</h4> 
<p>Spring提供了对jdk中@Resource注解的支持。@Resource注解既可以按名称匹配Bean，也可以按类型匹配Bean。默认是按名称注入，使用该注解，要求jdk必须是6及以上版本。</p> 
<h5><a id="byType_341"></a>byType注入引用类型属性</h5> 
<p>@Resource注解若不带任何参数，采用默认名称的方式注入，按名称不能注入bean，则会按照类型进行Bean的匹配注入。<br> 下面例子首先使用byName，来赋值，但是byName不能行，左移最后使用byType方式<br> <img src="https://images2.imgbox.com/37/71/yPNKxVem_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2a/48/RGO48f7n_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="byName_346"></a>byName注入引用类型属性</h5> 
<p>@Resource只使用byName方式，需要增加一个属性name<br> name的值是bean的id（名称）<br> <img src="https://images2.imgbox.com/20/bd/IhMLjrey_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bd/5e/eErIz7G5_o.png" alt="在这里插入图片描述"><br> 如果不能byName赋值，那么就会报错</p> 
<h4><a id="xml_353"></a>xml和注解的对比</h4> 
<p>xml配置文件（适用于经常修改）<br> 优点：<br> 1、可以方便修改值，<br> 2、对象之间的关系一目了然；<br> 3、基于xml配置的时候，只需要修改xml即可，不需要对现有的程序进行修改。</p> 
<p>缺点：<br> 1、使用配置文件代码量就多，用起来费事费力。<br> 2、解析xml的时候必然会占用资源，势必会影响到应用程序的性能；<br> 3、xml配置文件过多，会导致维护变得困难<br> 4、开发的时候，既要维护代码又要维护配置文件，使得开发的效率降低；<br> 注解（适用于不经常修改）<br> 优点：<br> 1：注解的解析可以不依赖于第三方库，可以之间使用Java自带的反射<br> 2：注解和代码在一起的，之间在类上，降低了维护两个地方的成本<br> 3：注解如果有问题，在编译期间，就可以验证正确性，如果出错更容易找<br> 4：使用注解开发能够提高开发效率。不用多个地方维护，不用考虑是否存在“潜规则”<br> 缺点：<br> 1：修改的话比较麻烦。如果需要对注解进行修改的话，就需要对整个项目重新编译<br> 2：处理业务类之间的复杂关系，不然xml那样容易修改，也不及xml那样明了<br> 3：在程序中注解太多的话，会影响代码质量，代码简洁会有影响<br> 4：如果后来的人对注解不了解，会给维护带来成本<br> 5：注解功能没有xml配置齐全</p> 
<h2><a id="AOP_378"></a>第三章、AOP面向切面编程</h2> 
<h3><a id="_379"></a>动态代理</h3> 
<p>可以在程序的执行过程中，创建代理对象。通过代理对象执行方法，给目标类的方法增加额外的功能（功能增强）</p> 
<h4><a id="JDK_381"></a>JDK动态代理</h4> 
<p>jdk动态代理实现步骤：<br> 1、创建目标类，SomeServiceImpl目标类，给它的doSome，doOther增加输出时间，事务。<br> 2、创建InvotationHandler接口的实现类，在这个类实现给目标方法增加功能。<br> 3、使用jdk中类Proxy，创建代理对象。实现创建对象的能力。</p> 
<h4><a id="CGLIB_386"></a>CGLIB动态代理（了解）</h4> 
<h3><a id="AOP_388"></a>不使用AOP的开发方式（理解）</h3> 
<h3><a id="AOP_391"></a>AOP概述（将动态代理的技术规范化，让大家在掌握和使用中更加容易）</h3> 
<p>AOP（Aspect Orient Programming），面向切面编程。面向切面编程是从动态角度考虑程序运行过程。<br> AOP底层，就是采用动态代理模式实现的。采用两种代理：jdk动态代理，与CGLIB动态代理。<br> AOP意为面向切面编程，可通过运行期间动态代理实现程序功能的统一维护的一种技术。AOP是Spring框架中的一个重要内容。利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高开发效率。<br> <strong>1.动态代理</strong><br> 实现方式：jdk动态代理，使用jdk中的Proxy，Method，InvocaitonHanderl创建代理对象。<br> jdk动态代理要求目标类必须实现接口</p> 
<p>cglib动态代理：第三方的工具库，创建代理对象，原理是继承。 通过继承目标类，创建子类。<br> 子类就是代理对象。 要求目标类不能是final的， 方法也不能是final的</p> 
<p><strong>2.动态代理的作用：</strong><br> 1）在目标类源代码不改变的情况下，增加功能。<br> 2）减少代码的重复<br> 3）专注业务逻辑代码<br> 4）解耦合，让你的业务功能和日志，事务非业务功能分离。</p> 
<p><strong>3.Aop:面向切面编程</strong>， 基于动态代理的，可以使用jdk，cglib两种代理方式。<br> Aop就是动态代理的规范化， 把动态代理的实现步骤，方式都定义好了，<br> 让开发人员用一种统一的方式，使用动态代理。</p> 
<p><strong>4、AOP</strong>（Aspect Orient Programming）面向切面编程<br> Aspect: 切面，给你的目标类增加的功能，就是切面。 像上面用的日志，事务都是切面。<br> 切面的特点： 一般都是非业务方法，独立使用的。<br> Orient：面向， 对着。<br> Programming：编程<br> OOP：即面向对象编程，本质上是一种编程思想，通过把我们编程中遇到的事物来抽象成对象来编程；<br> 怎么理解面向切面编程 ？<br> 1）需要在分析项目功能时，找出切面。<br> 2）合理的安排切面的执行时间（在目标方法前， 还是目标方法后）<br> 3）合理的安全切面执行的位置，在哪个类，哪个方法增加增强功能<br> 术语：<br> 1）Aspect:切面，表示增强的功能， 就是一堆代码，完成某个一个功能。非业务功能，<br> 常见的切面功能有日志， 事务， 统计信息， 参数检查， 权限验证。</p> 
<p>2）JoinPoint:连接点 ，连接业务方法和切面的位置。 就某类中的业务方法<br> 3）Pointcut : 切入点 ，指多个连接点方法的集合。多个方法<br> 4）目标对象： 给哪个类的方法增加功能， 这个类就是目标对象<br> 5）Advice:通知，通知表示切面功能执行的时间。<br> 说一个切面有三个关键的要素：<br> 1）切面的功能代码，切面干什么<br> 2）切面的执行位置，使用Pointcut表示切面执行的位置<br> 3）切面的执行时间，使用Advice表示时间，在目标方法之前，还是目标方法之后。<br> <strong>5.aop的实现</strong>（主要使用aspectJ）<br> aop是一个规范，是动态的一个规范化，一个标准<br> aop的技术实现框架：<br> 1.spring：spring在内部实现了aop规范，能做aop的工作。<br> spring主要在事务处理时使用aop。<br> 我们项目开发中很少使用spring的aop实现。 因为spring的aop比较笨重。</p> 
<p>2.aspectJ: 一个开源的专门做aop的框架。spring框架中集成了aspectj框架，通过spring就能使用aspectj的功能。<br> aspectJ框架实现aop有两种方式：<br> 1.使用xml的配置文件 ： 配置全局事务<br> 2.使用注解，我们在项目中要做aop功能，一般都使用注解， aspectj有5个注解。<br> <strong>6.学习aspectj框架的使用。</strong><br> 1）切面的执行时间， 这个执行时间在规范中叫做Advice(通知，增强)<br> 在aspectj框架中使用注解表示的。也可以使用xml配置文件中的标签<br> 1）@Before<br> 2）@AfterReturning<br> 3）@Around<br> 4）@AfterThrowing<br> 5）@After<br> <strong>@Before前置通知注解-方法有JoinPoint参数()也就是切面表达式</strong><br> 在目标方法执行之前执行。背注解为前置通知方法，可以包含一个JoinPoint类型参数。该类型对象本身就是切入点表达式。通过该参数，可以获取切入点表达式、方法签名、目标对象。<br> 2）表示切面执行的位置，使用的是切入点表达式。</p> 
<pre><code>	AspectJ定义了专门的表达式用于指定切入点。表达式的原型是：
</code></pre> 
<p><img src="https://images2.imgbox.com/6d/1d/IT1OOjQb_o.png" alt="在这里插入图片描述"><br> modifiers-pattern 访问权限类型<br> ret-type-pattern 返回值类型<br> declaring-type-pattern 包名类名<br> name-pattern（param-pattern）方法名（参数类型和参数个数）<br> throws-patern抛出异常类型<br> ？表示可选的部分<br> 以上表达式共四个部分。<br> execution（访问权限 方法返回值 方发声明 （参数）异常类型）</p> 
<pre><code>	切入点表达式要匹配的对象就是目标方法的方法名。所以，execution表达式中明显就是方法的签名。注意，表达式中黑色文字表示省略部分，各部分间用空格分开。在其中使用以下符号
</code></pre> 
<p><img src="https://images2.imgbox.com/ae/65/4OOWMja6_o.png" alt="在这里插入图片描述"><br> 举例：</p> 
<blockquote> 
 <p>execution（public * <em>(…)）<br> 指定切入点：任意公共方法。<br> execution（</em> set*(…)）<br> 指定切入点为：任何一个以“set”开始的方法。<br> execution(* com.xyz.service.<em>.</em>(…))<br> 指定切入点为：com.xyz.service包中的任意类的任意方法<br> execution(* com.xyz.service…<em>.</em>(…))<br> 指定切入点为：定义在service包或者子包里的任意类的任意方法。“…”出现在类名中时，后面必须跟“<em>”，表示包、子包下的所有类。<br> execution(</em> <em>…service.</em>.<em>(…))<br> 指定所有包下所有类（接口）中所有方法为切入点<br> execution(</em> <em>.service.</em>.<em>(…))<br> 指定只有一级包下的service子包下的所有类（接口）中所有方法为切入点。<br> 例如：指定以下的service包中的所有类中，所有方法为切入点。<br> com.service.impl <br> com.bjpowrnode.service.impl <br> cn.crm.bjpowernode.service <br> 使用表达式为：execution(</em> <em>…service.</em>.*(…))</p> 
</blockquote> 
<h3><a id="AOP_492"></a>AOP的功能实现（项目实现）</h3> 
<p>使用quickstart创建一个项目：<br> 05Spring-aop-aspectJ:使用aspectJ框架实现aop。<br> 使用aop：目的是给已经存在的一些类和方法，增加额外的功能。前提是不改变原来类的代码。<br> <strong>使用aspectJ实现aop的基本步骤：</strong><br> 1、新建maven项目<br> 2、加入依赖<br> 1）spring依赖<br> 2）aspectJ依赖<br> 3）Junit测试单元<br> 3、创建目标类：接口和它的实现类<br> 要做的是给类中的方法增加功能<br> 4、创建切面类：普通类<br> 1)在类的上面加入@Aspect<br> 2)在类中定义方法，方法就是切面要执行的功能代码<br> 在方法的上面加入aspectj中的通知注解，例如@Before<br> 有需要指定切入点表达式execution()<br> 5、创建spring的配置文件：声明对象，把对象交给容器统一管理<br> 声明对象你可以使用注解或者xml配置文件<br> 1）声明目标对象<br> 2）声明切面对象<br> 3）声明aspectJ框架中的自动代理生成器标签<br> 自动代理生成器：用来完成代理对象的自动创建功能的。<br> 6、创建测试类，从spring容器中获取目标对象（实际上就是代理对象）。<br> 通过代理执行方法，实现aop的功能增强。</p> 
<p>========================<br> 1、新建maven项目<br> 2、加入依赖<br> <img src="https://images2.imgbox.com/2c/8c/VHys8Smn_o.png" alt="在这里插入图片描述"><br> 3、创建目标类：接口和它的实现类<br> <img src="https://images2.imgbox.com/57/85/mbflaWqo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/db/81/tYRn0K0Z_o.png" alt="在这里插入图片描述"><br> 4、创建切片类<img src="https://images2.imgbox.com/6e/5b/PzbVO4n2_o.png" alt="在这里插入图片描述"><br> 5、创建spring的配置文件：声明对象，把对象交给容器统一管理<br> 声明对象你可以使用注解或者xml配置文件<br> <img src="https://images2.imgbox.com/e6/aa/LYcHd62w_o.png" alt="在这里插入图片描述"><br> 6、创建测试类，从spring容器中获取目标对象<br> <img src="https://images2.imgbox.com/e7/5f/UNGdjJ6J_o.png" alt="在这里插入图片描述"><br> 验证proxy为代理对象，动态代理使用的是jdk动态代理方式。（目标类有接口是jdk动态代理）<br> 自动代理生成器使用AspectJ框架内部的功能，创建目标对象的代理对象。 创建代理对象是在内存中实现的，修改目标对象的内存中的结构。创建为代理对象，所以目标对象就是被修改后的代理对象，aspectj-qutoproxy：会把spring容器中的所有目标对象，一次性都生代理对象。</p> 
<h4><a id="AspectJAOP_533"></a>AspectJ基于注解的AOP实现（掌握）</h4> 
<p><strong>@Before前置通知注解-方法有JoinPoint参数()也就是切面表达式</strong><br> 在目标方法执行之前执行。背注解为前置通知方法，可以包含一个JoinPoint类型参数。该类型对象本身就是切入点表达式。通过该参数，可以获取切入点表达式、方法签名、目标对象。</p> 
<p><em>JoinPoint（连接点）</em>：业务方法，要加入切面功能的业务方法（如果切面中需要用到方法的信息，就要加入JoinPoint）<br> 作用是：可以在通知方法中获取方法执行时的信息，例如方法名称、方法实参。<br> 如果你的切面中需要用到方法的信息，就加入JoinPoint。<br> 这个JoinPoint参数的值是由框架赋予，必须是一个位置的参数<br> <img src="https://images2.imgbox.com/3e/37/rRJqePVA_o.png" alt="在这里插入图片描述"><br> <strong>@AfterReturning:后置通知</strong><br> /*后置通知定义方法，方法是实现切面功能的。<br> 属性：<br> 1、value切入点表达式<br> 2、returning 自定义的变量、表示目标方法的返回值的。<br> 自定义变量名必须和通知方法的形参名一样。<br> 位置在方法定义的上面<br> 特点：<br> 1、在目标方法之后执行的。<br> 2、能够获取目标方法的返回值，可以根据这个返回值做不同的处理功能<br> 3、可以修改这个返回值<br> 后置通知的定义方法，方法是实现要求：<br> 1、公共方法public<br> 2、方法没有返回值<br> 3、方法名称自定义<br> 4、方法有参数，推荐是Object，参数名自定义</p> 
<p><img src="https://images2.imgbox.com/14/1e/0sKJluWW_o.png" alt="在这里插入图片描述"><br> <strong>@Around环绕通知（功能最强的一种通知）（掌握）</strong></p> 
<ul><li>@Aspect:是AspectJ框架中的注解。</li><li>作用:表示当前类是切面类。</li><li>切面类：是用来非业务方法增加功能的类，在这个类中有切面的功能代码。</li><li>位置：在类定义的上面。</li><li> <pre><code> * 环绕通知方法的定义格式
</code></pre> 
  <ul><li>1、public</li><li>2、必须有一个返回值，推荐使用Object</li><li>3、方法名称自定义</li><li>4、方法有参数，固定的参数ProceedingJoinPoint<br> *@Around：环绕通知</li><li>属性：value切入点表达式</li><li>位置：在方法的上面定义<br> *特点：</li><li>1、它是功能最强的通知</li><li>2、在目标方法前和后都能增强功能</li><li>3、控制目标方法是否被调用执行</li><li>4、修改原来的目标方法的执行结果。影响最后的调用结果</li><li><li>环绕通知，等同于jdk动态代理的，InvocationHandler接口</li><li>参数：ProceedingJointPoint就等同于Method</li><li>作用：执行目标方法的</li><li>返回值：就是目标方法的执行结果，可以被修改</li><li><img src="https://images2.imgbox.com/f5/70/B4RWbsfV_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/58/91/7CKgsmUl_o.png" alt="在这里插入图片描述"><br> 说明在环绕通知中能够将结果改变成自己设置的结果。<br> 环绕通知：经常做的是事务，在目标方法之前开始事务，执行目标方法，在目标方法之后提交事务。</li></ul> </li></ul> 
<p><strong>@AfterThrowing异常通知-注解中有throwing属性（了解）</strong><br> * 异常通知方法的定义格式<br> * 1、public<br> * 2、没有返回值<br> * 3、方法名称自定义<br> * 4、方法有一个Exception，如果还有就是JoinPoint<br> *@AfterThrowing：异常通知<br> * 属性：<br> * 1、value切入点表达式<br> * 2、throwing自定义的变量，表示目标方法抛出的异常对象。变量名必须和方法的参数名一样<br> * 特点：<br> * 1、在目标方法抛出异常时执行的<br> * 2、可以做异常的监控程序，监控目标方法执行时是不是有异常。如果有异常，可以发送邮件，短信进行通知<br> * 位置：在方法的上面定义<br> <img src="https://images2.imgbox.com/2c/82/lTgKGf4g_o.png" alt="在这里插入图片描述"><br> <strong>@After: 最终通知</strong><br> * 属性：value切入点表达式<br> * 位置：在方法上面<br> * 特点：<br> * 1、总是会执行<br> * 2、在目标方法之后执行的<br> * 作用一般是做资源清除的<br> <img src="https://images2.imgbox.com/bc/8d/FME6NngL_o.png" alt="在这里插入图片描述"><br> <strong>@Pointcut：定义和管理切入点</strong><br> 如果你的项目中有多个切入点表达式是重复的，可以复用，可以使用@Pointcut</p> 
<ul><li>属性：value切入点表达式</li><li>位置：在自定义的方法上面</li><li>特点：当使用@Pointcut定义在一个方法的上面，此时这个方法的名称就是切入点表达式的别名，其他的通知中，value属性就可以使用这个方法名称</li><li>代替切入点表达式<br> <img src="https://images2.imgbox.com/b5/5a/p1C27bxW_o.png" alt="在这里插入图片描述"><br> <strong>有接口类和没有接口类的代理方式：</strong><br> proxy是代理对象：<br> System.out.println(proxy.getClass().getName());<br> 如果目标类有接口，那么使用的是JDK的动态代理，<br> 如果目标类没有接口，那么使用的是spring中的CGLIB动态代理，<br> <img src="https://images2.imgbox.com/16/40/CN9Hm2cZ_o.png" alt="在这里插入图片描述"><br> 有接口也可以使用CGLIB动态代理：</li><li>如果期望目标类有接口，使用CGLIB代理</li><li>设置属性：proxy-target-class=“true”;告诉框架，要使用cglib动态代理<br> <img src="https://images2.imgbox.com/e1/8d/1NPZQxFK_o.png" alt="在这里插入图片描述"></li></ul> 
<h2><a id="_SpringMyBatis_629"></a>第四章 Spring集成MyBatis</h2> 
<p>将spring和mybatis放在一起用，主要解决的问题就是将SQLSessionFactory对象交由Spring来管理。所以，该整合，只需要将SQLSessionFactory的对象生成器SQLSessionFactoryBean注入册在Spring容器中，再将其注入给Dao的实现类即可完成整合。实现Spring与Mybatis的整合常用的方式：<strong>扫描Mapper动态代理</strong><br> 把myBatis框架和spring集成在一起，像一个框架一样使用。使用的技术是：ioc。<br> <strong>为什么IOC能够把mybatis和spring集成在一起，像一个框架一样使用？</strong><br> 是因为ioc能够创建对象。可以把mybatis框架中的对象交给spring统一创建，开发人员从spring中获取对象。开发人员就不用同时面对两个或者多个框架了，就面对一个spring。</p> 
<p><strong>mybatis使用步骤，对象</strong><br> 1、定义dao接口，StudentDao<br> 2、定义mapper文件 StudentDao.xml<br> 3、定义mybatis的主配置文件mybatis.xml<br> 4、创建dao的代理对象，StudentDao dao = SQLSession.getMapper(StudentDao.class);<br> List students = dao.selecStudents();<br> 要使用dao对象，需要使用getMapper()方法，<br> 怎么能使用getMapper()方法，需要哪些条件<br> 1、获取SqlSession对象，需要使用SQLSessionFactory的openSession()方法。<br> 2、创建SqlSessionFactory对象。通过读取mybatis的主配置文件，能创建SQLSessionFactory对象。<br> 需要SQLSessionFactory对象，使用Factory能获取SQLSession，有了SQLSession就能有dao，目的就是获取dao对象。<br> Factory创建需要读取主配置文件</p> 
<p>主配置文件：<br> 1.数据库信息：我们会使用独立的连接池类替换mybatis默认自己带的，把连接池类交给spring创建。</p> 
<pre><code class="prism language-java"> <span class="token operator">&lt;</span>environment id<span class="token operator">=</span><span class="token string">"mydev"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>transactionManager type<span class="token operator">=</span><span class="token string">"JDBC"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>dataSource type<span class="token operator">=</span><span class="token string">"POOLED"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>数据库的驱动类名<span class="token operator">--</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"driver"</span> value<span class="token operator">=</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>连接数据库的url字符串<span class="token operator">--</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"url"</span> value<span class="token operator">=</span><span class="token string">"jdbc:mysql://localhost:3306/springdb"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>访问数据库的用户名<span class="token operator">--</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"username"</span> value<span class="token operator">=</span><span class="token string">"root"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>密码<span class="token operator">--</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"password"</span> value<span class="token operator">=</span><span class="token string">"123456"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>dataSource<span class="token operator">&gt;</span>
</code></pre> 
<ol start="2"><li>mapper文件的位置</li></ol> 
<pre><code class="prism language-java">   <span class="token generics"><span class="token punctuation">&lt;</span>mappers<span class="token punctuation">&gt;</span></span>
        <span class="token operator">&lt;</span>mapper resource<span class="token operator">=</span><span class="token string">"com/bjpowernode/dao/StudentDao.xml"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token operator">&lt;</span>mapper resource<span class="token operator">=</span><span class="token string">"com/bjpowernode/dao/SchoolDao.xml"</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>mappers<span class="token operator">&gt;</span>
</code></pre> 
<p>============================================================<br> 通过以上的说明，我们需要让spring创建以下对象<br> 1.独立的连接池类的对象， 使用阿里的druid连接池<br> 2.SqlSessionFactory对象<br> 3.创建出dao对象</p> 
<p>需要学习就是上面三个对象的创建语法，使用xml的bean标签。<br> <strong>集成Mybatis的步骤：</strong></p> 
<pre><code class="prism language-java"><span class="token number">06</span>Spring<span class="token operator">-</span><span class="token class-name">Mybatis</span><span class="token operator">:</span>spring和mybatis的集成
步骤：
<span class="token number">1</span>、创建maven项目
<span class="token number">2</span>、加入maven依赖
<span class="token number">1</span><span class="token punctuation">)</span>spring
<span class="token number">2</span><span class="token punctuation">)</span>mybatis
<span class="token number">3</span><span class="token punctuation">)</span>mysql驱动
<span class="token number">4</span><span class="token punctuation">)</span>spring的事务的依赖
<span class="token number">5</span><span class="token punctuation">)</span>mybatis和spring的依赖：mybatis官方体用的，用来在spring项目中创建mybatis的<span class="token class-name">SQLSessionFactory</span>，dao对象
<span class="token number">3</span>、创建实体类
<span class="token number">4</span>、创建dao接口和mapper文件
<span class="token number">5</span>、创建mybatis主配置文件
<span class="token number">6</span>、创建<span class="token class-name">Service</span>接口和实现类，属性是dao
<span class="token number">7</span>、创建spring的配置文件：声明mybatis的对象交给spring创建
<span class="token number">1</span><span class="token punctuation">)</span>数据源
<span class="token number">2</span><span class="token punctuation">)</span><span class="token class-name">SqlSessionFactory</span>
<span class="token number">3</span><span class="token punctuation">)</span>dao对象
<span class="token number">8</span>、创建测试类，获取<span class="token class-name">Service</span>对象，通过service调用dao完成数据库的访问
</code></pre> 
<p>1、创建maven项目<br> 2、加入maven依赖和插件</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>单元测试<span class="token operator">--</span><span class="token operator">&gt;</span>
  <span class="token generics"><span class="token punctuation">&lt;</span>dependencies<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>junit<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>junit<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">4.11</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>test<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    spring核心IOC<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>context<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.5</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    做spring事务用到的<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>tx<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.8</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>jdbc<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.8</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    mybatis依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>mybatis<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mybatis<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.5</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    mybatis和spring集成的依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>mybatis<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mybatis<span class="token operator">-</span>spring<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.3</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>mysql驱动<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">-</span>connector<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">8.0</span><span class="token number">.29</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>阿里公司的连接池<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>alibaba<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>druid<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.1</span><span class="token number">.12</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>lombok快速为类对象创建set、get、构造等函数<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.18</span><span class="token number">.10</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>provided<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>dependencies<span class="token operator">&gt;</span>
  <span class="token generics"><span class="token punctuation">&lt;</span>build<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>目的是吧src<span class="token operator">/</span>main<span class="token operator">/</span>java目录中的xml文件包含到输出结果中。输出到classes目录中<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>resources<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>resource<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>directory<span class="token punctuation">&gt;</span></span>src<span class="token operator">/</span>main<span class="token operator">/</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>directory<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>所在的目录<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>includes<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>包括目录下的<span class="token punctuation">.</span>properties，<span class="token punctuation">.</span>xml文件都会扫描到<span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token generics"><span class="token punctuation">&lt;</span>include<span class="token punctuation">&gt;</span></span><span class="token operator">*</span><span class="token operator">*</span><span class="token comment">/*.properties&lt;/include&gt;
          &lt;include&gt;**/</span><span class="token operator">*</span><span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>include<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>includes<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>filtering<span class="token punctuation">&gt;</span></span><span class="token boolean">false</span><span class="token operator">&lt;</span><span class="token operator">/</span>filtering<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>resource<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>resources<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    指定jdk的版本<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>plugins<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>plugin<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>maven<span class="token punctuation">.</span>plugins<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>maven<span class="token operator">-</span>compiler<span class="token operator">-</span>plugin<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>configuration<span class="token punctuation">&gt;</span></span>
          <span class="token generics"><span class="token punctuation">&lt;</span>source<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>source<span class="token operator">&gt;</span>
          <span class="token generics"><span class="token punctuation">&lt;</span>target<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>target<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>plugins<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>build<span class="token operator">&gt;</span>
</code></pre> 
<p>3、创建实体类</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//属性和列名一样</span>
    <span class="token keyword">private</span>  <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> email<span class="token punctuation">,</span> <span class="token class-name">Integer</span> age<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//用于对对象赋值</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>email <span class="token operator">=</span> email<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>4、创建dao接口和mapper文件<br> dao接口：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StudentDao</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">int</span> <span class="token function">inserStudent</span><span class="token punctuation">(</span><span class="token class-name">Student</span> student<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">SelectStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>mapper文件：</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE mapper
        PUBLIC <span class="token string">"-//mybatis.org//OTD Mapper 3.0//EN"</span>
        <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>mapper namespace <span class="token operator">=</span> <span class="token string">"com.Springtest.dao.StudentDao"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>insert id<span class="token operator">=</span><span class="token string">"insertStudent"</span> <span class="token operator">&gt;</span>
        insert  into <span class="token class-name">Student</span> values <span class="token punctuation">(</span>#<span class="token punctuation">{<!-- --></span>id<span class="token punctuation">}</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>email<span class="token punctuation">}</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>age<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>insert<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectStudents"</span> resultType<span class="token operator">=</span><span class="token string">"com.Springtest.domain.Student"</span><span class="token operator">&gt;</span>
        select  id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>email<span class="token punctuation">,</span>age<span class="token punctuation">,</span> from student order by id desc
    <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="mybatisMapperpackageMapperxmlmappermapperresourcenamespace_832"></a>注意：mybatis配置文件，Mapper标签下以package包扫描形式时需要Mapper.xml文件名称和mapper接口名称一致，当核心配置文件mapper标签下以resource形式指向依赖配置文件时，不需要，这样就可以加载到其相应的依赖配置文件通过namespace找到其相应的方法</h3> 
<p>例如：</p> 
<pre><code class="prism language-java">    <span class="token generics"><span class="token punctuation">&lt;</span>mappers<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span>mapper resource<span class="token operator">=</span><span class="token string">"grg/auto/mapper/DepartMapper.xml"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>mappers<span class="token operator">&gt;</span>
</code></pre> 
<p>5、创建mybatis主配置文件</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE configuration
        PUBLIC <span class="token string">"-//mybatis.org//DTD Config 3.0//EN"</span>
        <span class="token string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>configuration<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>settings：控制mybatis全局行为<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>settings<span class="token punctuation">&gt;</span></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>设置mybatis输出日志<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>setting name<span class="token operator">=</span><span class="token string">"logImpl"</span> value<span class="token operator">=</span><span class="token string">"STDOUT_LOGGING"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>settings<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>设置别名<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>typeAliases<span class="token punctuation">&gt;</span></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token operator">&lt;</span>typeAlias type<span class="token operator">=</span><span class="token string">"com.pojo.User"</span> alias<span class="token operator">=</span><span class="token string">"User"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>typeAlias<span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>name：实体类所在的包名，表示可以直接使用该包名下的实体类的大小写<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token keyword">package</span> <span class="token namespace">name</span><span class="token operator">=</span><span class="token string">"com.Springtest.domain"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>typeAliases<span class="token operator">&gt;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span>mappers<span class="token punctuation">&gt;</span></span>
        <span class="token operator">&lt;</span><span class="token keyword">package</span> <span class="token namespace">name</span><span class="token operator">=</span><span class="token string">"com.Springtest.dao"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>mappers<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<p>6、创建Service接口和实现类，属性是dao</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StudentServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">StudentService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//引用类型</span>
    <span class="token keyword">private</span> <span class="token class-name">StudentDao</span> studentDao<span class="token punctuation">;</span>
    <span class="token comment">//使用set注入，赋值</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStudentDao</span><span class="token punctuation">(</span><span class="token class-name">StudentDao</span> studentDao<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>studentDao <span class="token operator">=</span> studentDao<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">addStudent</span><span class="token punctuation">(</span><span class="token class-name">Student</span> student<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> nums <span class="token operator">=</span> studentDao<span class="token punctuation">.</span><span class="token function">inserStudent</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StudentService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> <span class="token function">addStudent</span><span class="token punctuation">(</span><span class="token class-name">Student</span> student<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>7、创建spring的配置文件：声明mybatis的对象交给spring创建<br> 1)数据源<br> 2)SqlSessionFactory<br> 3)dao对象</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>声明数据源<span class="token class-name">DataSource</span>，作用是连接数据库<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id <span class="token operator">=</span> <span class="token string">"myDataSource"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.alibaba.druid.pool.DruidDataSource"</span> init<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">"init"</span> destroy<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">"close"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>set注入给<span class="token class-name">DruidDataSource</span>提供数据库信息<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"url"</span> value<span class="token operator">=</span><span class="token string">"jdbc:mysql://localhost:3306/mybatis"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"username"</span> value<span class="token operator">=</span><span class="token string">"root"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"password"</span> value<span class="token operator">=</span><span class="token string">"admin"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"maxActive"</span> value<span class="token operator">=</span><span class="token string">"20"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>连接的数量最多是<span class="token number">20</span>个<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>声明的是mybatis中提供的<span class="token class-name">SQLSessionFactoryBean</span>类，这个类内部创建<span class="token class-name">SQLSessionFactory</span>的<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id <span class="token operator">=</span> <span class="token string">"sqlSessionFactory"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.mybatis.spring.SqlSessionFactoryBean"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>set注入，把数据库连接池付给dataSource属性<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"myDataSource"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>mybatis主配置文件的位置
        configLocation属性是<span class="token class-name">Resource</span>类型，读取配置文件
        它的赋值，使用<span class="token class-name">Value</span>，指定文件的路径，使用classpath<span class="token operator">:</span>表示文件的位置
        <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"configLocation"</span> value<span class="token operator">=</span><span class="token string">"classpath:mybatis.xml"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>创建dao对象，使用<span class="token class-name">SQLSession</span>的<span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
        <span class="token class-name">MapperScannerConfigurer</span><span class="token operator">:</span>在内部调用
    <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>指定<span class="token class-name">SqlSessionFactory</span>对象的id<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sqlSessionFactoryBeanName"</span> value<span class="token operator">=</span><span class="token string">"sqlSessionFactory"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>指定包名，包名是dao接口所在的包名。
            <span class="token class-name">MapperScannerConfigurer</span>会扫描这个包中的所有接口，把每个接口都执行一次getMapper方法，得到每个
            接口的dao对象。创建好的dao对象放入到spring的容器中的<span class="token punctuation">,</span>dao对象的默认名称是接口名的首字母小写
        <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"basePackage"</span> value<span class="token operator">=</span><span class="token string">"com.Springtest.dao"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
</code></pre> 
<p>在实际开发中只需要修改dao对象bean配置文件中，指定接口所在包的位置</p> 
<p>8、创建测试类，获取Service对象，通过service调用dao完成数据库的访问<br> 声明service：</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>声明service<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"StudentService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.Springtest.service.impl.StudentServiceImpl"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>name：属性名     ref<span class="token operator">:</span>对象的名称       创建的对象赋值给属性，那么service就可以使用dao了<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"studentMapper"</span> ref<span class="token operator">=</span><span class="token string">"studentMapper"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-java">    <span class="token comment">/*获取Service对象，通过service调用dao完成数据库的访问，执行查询操作*/</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> config <span class="token operator">=</span> <span class="token string">"applicationContext.xml"</span><span class="token punctuation">;</span>
        <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StudentService</span> service <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">StudentService</span><span class="token punctuation">)</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"StudentService"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">queryStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>students<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>students<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>9、添加配置文件，对数据库进行配置,写在一个独立的文件中，编译修改数据库的配置内容。</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>把数据库的配置<span class="token punctuation">,</span>写在一个独立的文件中，编译修改数据库的配置内容
    spring知道jdbc<span class="token punctuation">.</span>properties文件的位置
    <span class="token operator">--</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>context<span class="token operator">:</span>property<span class="token operator">-</span>placeholder location<span class="token operator">=</span><span class="token string">"jdbc.properties"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-java">jdbc<span class="token punctuation">.</span>url<span class="token operator">=</span>jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>mybatis
jdbc<span class="token punctuation">.</span>username<span class="token operator">=</span>root
jdbc<span class="token punctuation">.</span>password<span class="token operator">=</span>admin
jdbc<span class="token punctuation">.</span>maxActive<span class="token operator">=</span><span class="token number">20</span>
</code></pre> 
<p>**问题解决：**解决通配符的匹配很全面，但是无法找到元素“context:property-placeholder”的声明，引入命名空间时报错<br> 原因：原因是在引入命名空间时没有正确引入它的DTD解析文件。<br> <img src="https://images2.imgbox.com/dd/08/Ts8ZLvba_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e3/43/ChWrd6WK_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_Spring_973"></a>第五章 Spring事务（理论多）</h2> 
<h3><a id="Spring_974"></a>Spring的事务管理</h3> 
<p>问题：</p> 
<ol><li>什么是事务<br> 在讲mysql的时候，提出了事务，事务是指一组sql语句的集合，在集合中有多条sql语句可能是insert，update，select，delete，我们希望这些多个sql语句都能够成功，或者都失败，这些sql语句的执行是一致的，作为一个整体执行。</li><li>什么时候想到使用事务？<br> 当我们的操作，涉及到多个表，或者是多个SQL语句的insert，update，delete。需要保证这些语句都是成功才能完成我的功能，或者都失败，保证操作是符合要求的。</li></ol> 
<p>在java代码中要写程序来控制事务，此时事务应该放在那里。<br> service类的业务方法上，因为业务方法会调用多个dao方法，执行多个sql语句</p> 
<ol start="3"><li> <p>通常使用JDBC访问数据库，还是mybatis访问数据库怎么处理事务<br> jdbc访问数据库，处理事务 Connection conn ； conn。commit（）；conn.rollback（）；mybatis访问数据库处理事务，SQLSession.commit（）；SqlSession.rollback();<br> hibernate访问数据库，处理事务，Session.commit();Session.rollback();</p> </li><li> <p>3问题中事务的处理方式，有什么不足<br> 1、不同的数据库访问技术，处理事务的对象，方法不同，需要去了解不同数据库访问技术使用事务的原理，<br> 2、掌握多重数据库中事务的处理逻辑。什么时候提交事务，什么时候回顾事务<br> 3、处理事务的多种方法<br> 总结：就是多种数据库的访问技术，有不同的事务处理机制，对象，方法。</p> </li><li> <p>怎么解决不足<br> spring提供一种处理事务的统一模型，能使用统一步骤，方式完成多种不同的数据库访问技术的事务处理。<br> 使用spring的事务处理机制，可以完成mybatis访问数据库的事务处理<br> 使用spring事务处理机制，可以完成hibernate访问数据库的事务处理</p> </li><li> <p>处理事务，需要怎么做，做什么<br> spring处理事务的模型，使用的步骤都是固定的。把事务使用的信息提供给spring就可以了<br> 1）事务内部提交，回滚事务，使用的事务管理器对象，代替你完成commit，rollback<br> 事务管理器是一个接口和他的众多实现类。<br> 接口：PlatformTransactionManager ，定义了事务重要方法 commit ，rollback<br> 实现类：spring把每一种数据库访问技术对应的事务处理类都创建好了。<br> mybatis访问数据库—spring创建好的是DataSourceTransactionManager<br> hibernate访问数据库----spring创建的是HibernateTransactionManager<br> <strong>怎么使用：你需要告诉spring 你用是那种数据库的访问技术，怎么告诉spring呢？</strong><br> 声明数据库访问技术对于的事务管理器实现类， 在spring的配置文件中使用声明就可以了<br> 例如，你要使用mybatis访问数据库，你应该在xml配置文件中<br> &lt;bean id=“xxx" class=“…DataSourceTransactionManager”&gt;</p> <p>2）你的业务方法需要什么样的事务，说明需要事务的类型。<br> 说明方法需要的事务：<br> 1）事务的隔离级别：有4个值。<br> DEFAULT：采用 DB 默认的事务隔离级别。MySql 的默认为 REPEATABLE_READ； Oracle默认为 READ_COMMITTED。<br> ➢ READ_UNCOMMITTED：读未提交。未解决任何并发问题。<br> ➢ READ_COMMITTED：读已提交。解决脏读，存在不可重复读与幻读。<br> ➢ REPEATABLE_READ：可重复读。解决脏读、不可重复读，存在幻读<br> ➢ SERIALIZABLE：串行化。不存在并发问题。</p> 
  <ol start="2"><li>事务的超时时间： 表示一个方法最长的执行时间，如果方法执行时超过了时间，事务就回滚。<br> 单位是秒， 整数值， 默认是 -1.</li></ol> <p>3）事务的传播行为 ： 控制业务方法是不是有事务的， 是什么样的事务的。<br> 7个传播行为，表示你的业务方法调用时，事务在方法之间是如果使用的。</p> <pre><code>	*PROPAGATION_REQUIRED
	PROPAGATION_REQUIRES_NEW
	PROPAGATION_SUPPORTS*
	以上三个需要掌握的

	PROPAGATION_MANDATORY
	PROPAGATION_NESTED
	PROPAGATION_NEVER
	PROPAGATION_NOT_SUPPORTED
</code></pre> </li></ol> 
<p>3）事务提交事务，回滚事务的时机<br> 1）当你的业务方法，执行成功，没有异常抛出，当方法执行完毕，spring在方法执行后提交事务。事务管理器commit</p> 
<pre><code>  2）当你的业务方法抛出运行时异常或ERROR， spring执行回滚，调用事务管理器的rollback
     运行时异常的定义： RuntimeException  和他的子类都是运行时异常， 例如NullPointException , NumberFormatException
  
  3) 当你的业务方法抛出非运行时异常， 主要是受查异常时，提交事务
    受查异常：在你写代码中，必须处理的异常。例如IOException, SQLException
</code></pre> 
<p>总结spring的事务<br> 1.管理事务的是 事务管理和他的实现类<br> 2.spring的事务是一个统一模型<br> 1）指定要使用的事务管理器实现类，使用<br> 2）指定哪些类，哪些方法需要加入事务的功能<br> 3）指定方法需要的隔离级别，传播行为，超时</p> 
<pre><code>  你需要告诉spring，你的项目中类信息，方法的名称，方法的事务传播行为。
</code></pre> 
<p>spring框架中提供的事务处理方案<br> 1.适合中小项目使用的， 注解方案。<br> spring框架自己用aop实现给业务方法增加事务的功能， 使用@Transactional注解增加事务。<br> @Transactional注解是spring框架自己注解，放在public方法的上面，表示当前方法具有事务。<br> 可以给注解的属性赋值，表示具体的隔离级别，传播行为，异常信息等等</p> 
<p>使用@Transactional的步骤：<br> 1.需要声明事务管理器对象<br> </p> 
<p>2.开启事务注解驱动， 告诉spring框架，我要使用注解的方式管理事务。<br> spring使用aop机制，创建@Transactional所在的类代理对象，给方法加入事务的功能。<br> spring给业务方法加入事务：<br> 在你的业务方法执行之前，先开启事务，在业务方法之后提交或回滚事务，使用aop的环绕通知</p> 
<pre><code>	 @Around("你要增加的事务功能的业务方法名称")
	 Object myAround(){
       开启事务，spring给你开启
		  try{
		     buy(1001,10);
			  spring的事务管理器.commit();
		  }catch(Exception e){
         spring的事务管理器.rollback();
		  }
		 
	 }
</code></pre> 
<p>3.在你的方法的上面加入@Trancational<br> 2.适合大型项目，有很多的类，方法，需要大量的配置事务，使用aspectj框架功能，在spring配置文件中<br> 声明类，方法需要的事务。这种方式业务方法和事务配置完全分离。</p> 
<p>实现步骤： 都是在xml配置文件中实现。<br> 1)要使用的是aspectj框架，需要加入依赖</p> 
<pre><code class="prism language-java">	<span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
		<span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
		<span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>aspects<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
		<span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.5</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<pre><code>2）声明事务管理器对象
 
&lt;bean id="xx" class="DataSourceTransactionManager"&gt;

3) 声明方法需要的事务类型（配置方法的事务属性【隔离级别，传播行为，超时】）
4) 配置aop：指定哪些哪类要创建代理。
</code></pre> 
<h3><a id="_1103"></a>程序举例环境搭建：</h3> 
<p>举例：购买商品trans_sale项目<br> 本例要实现购买商品，模拟用户下订单，向订单表添加销售记录，从商品表减少库存。<br> <strong>实现步骤：</strong><br> 1、创建两个数据库表sale，goods<br> sale销售表<br> <img src="https://images2.imgbox.com/df/d2/31iJryTb_o.png" alt="在这里插入图片描述"></p> 
<p>goods货品表<br> <img src="https://images2.imgbox.com/b3/22/tHVEQcIC_o.png" alt="在这里插入图片描述"><br> 2、添加maven依赖</p> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>properties<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>project<span class="token punctuation">.</span>build<span class="token punctuation">.</span>sourceEncoding<span class="token punctuation">&gt;</span></span>UTF<span class="token operator">-</span><span class="token number">8</span><span class="token operator">&lt;</span><span class="token operator">/</span>project<span class="token punctuation">.</span>build<span class="token punctuation">.</span>sourceEncoding<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>source<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>source<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>target<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>target<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>properties<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>单元测试<span class="token operator">--</span><span class="token operator">&gt;</span>
  <span class="token generics"><span class="token punctuation">&lt;</span>dependencies<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>junit<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>junit<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">4.11</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>test<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    spring核心IOC<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>context<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.5</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    做spring事务用到的<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>tx<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.8</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>jdbc<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.8</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    mybatis依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>mybatis<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mybatis<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.5</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    mybatis和spring集成的依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>mybatis<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mybatis<span class="token operator">-</span>spring<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.3</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>mysql驱动<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">-</span>connector<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">8.0</span><span class="token number">.29</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>阿里公司的连接池<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>alibaba<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>druid<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.1</span><span class="token number">.12</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>lombok快速为类对象创建set、get、构造等函数<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.18</span><span class="token number">.10</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>provided<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>dependencies<span class="token operator">&gt;</span>

  <span class="token generics"><span class="token punctuation">&lt;</span>build<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>目的是吧src<span class="token operator">/</span>main<span class="token operator">/</span>java目录中的xml文件包含到输出结果中。输出到classes目录中<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>resources<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>resource<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>directory<span class="token punctuation">&gt;</span></span>src<span class="token operator">/</span>main<span class="token operator">/</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>directory<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>所在的目录<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>includes<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>包括目录下的<span class="token punctuation">.</span>properties，<span class="token punctuation">.</span>xml文件都会扫描到<span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token generics"><span class="token punctuation">&lt;</span>include<span class="token punctuation">&gt;</span></span><span class="token operator">*</span><span class="token operator">*</span><span class="token comment">/*.properties&lt;/include&gt;
          &lt;include&gt;**/</span><span class="token operator">*</span><span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>include<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>includes<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>        —filtering 选项 <span class="token boolean">false</span> 不启用过滤器， <span class="token operator">*</span><span class="token punctuation">.</span>property 已经起到过滤的作用了 <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>filtering<span class="token punctuation">&gt;</span></span><span class="token boolean">false</span><span class="token operator">&lt;</span><span class="token operator">/</span>filtering<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>resource<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>resources<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    指定jdk的版本<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>plugins<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>plugin<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>maven<span class="token punctuation">.</span>plugins<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>maven<span class="token operator">-</span>compiler<span class="token operator">-</span>plugin<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>configuration<span class="token punctuation">&gt;</span></span>
          <span class="token generics"><span class="token punctuation">&lt;</span>source<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>source<span class="token operator">&gt;</span>
          <span class="token generics"><span class="token punctuation">&lt;</span>target<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>target<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>plugins<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>build<span class="token operator">&gt;</span>
</code></pre> 
<p>3、创建实体类<br> Sale，Goods</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Goods</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> amount<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Float</span> price<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Sale</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> gid<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> nums<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>4、创建dao接口和mapper文件<br> SaleDao接口,GoodsDao接口<br> 响应的XML文件<br> Sale.xml,GoodsDao.xml</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>mapper namespace<span class="token operator">=</span><span class="token string">"org.example.dao.GoodsDao"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectGoods"</span> resultType<span class="token operator">=</span><span class="token string">"goods"</span><span class="token operator">&gt;</span>
        select id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>amount<span class="token punctuation">,</span>price from goods where id <span class="token operator">=</span> #<span class="token punctuation">{<!-- --></span>id<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>update id<span class="token operator">=</span><span class="token string">"updateGoods"</span><span class="token operator">&gt;</span>
        update goods set amount <span class="token operator">=</span> amount <span class="token operator">-</span>#<span class="token punctuation">{<!-- --></span>amount<span class="token punctuation">}</span> where id <span class="token operator">=</span> #<span class="token punctuation">{<!-- --></span>id<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>update<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>mapper namespace<span class="token operator">=</span><span class="token string">"org.example.dao.SaleDao"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>insert id<span class="token operator">=</span><span class="token string">"insertSale"</span><span class="token operator">&gt;</span>
        insert into <span class="token function">sale</span><span class="token punctuation">(</span>gid<span class="token punctuation">,</span>nums<span class="token punctuation">)</span> <span class="token function">values</span><span class="token punctuation">(</span>#<span class="token punctuation">{<!-- --></span>gid<span class="token punctuation">}</span><span class="token punctuation">,</span>#<span class="token punctuation">{<!-- --></span>nums<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>insert<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">GoodsDao</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">//    更新库存</span>
<span class="token comment">//    goods表示本次用户购买的商品信息，id，购买数量</span>
    <span class="token keyword">int</span> <span class="token function">updateGoods</span><span class="token punctuation">(</span><span class="token class-name">Goods</span> goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//    查询商品的信息</span>
    <span class="token class-name">Goods</span> <span class="token function">selectGoods</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SaleDao</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">//    增加销售记录(订单记录)</span>
    <span class="token keyword">int</span> <span class="token function">insertSale</span><span class="token punctuation">(</span><span class="token class-name">Sale</span> sale<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>5、创建mybatis主配置文件</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE configuration
        PUBLIC <span class="token string">"-//mybatis.org//DTD Config 3.0//EN"</span>
        <span class="token string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>configuration<span class="token punctuation">&gt;</span></span>

    <span class="token generics"><span class="token punctuation">&lt;</span>typeAliases<span class="token punctuation">&gt;</span></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token operator">&lt;</span>typeAlias type<span class="token operator">=</span><span class="token string">"com.pojo.User"</span> alias<span class="token operator">=</span><span class="token string">"User"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>typeAlias<span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>name：实体类所在的包名，表示可以直接使用该包名下的实体类的大小写<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token keyword">package</span> <span class="token namespace">name</span><span class="token operator">=</span><span class="token string">"org.example.domain"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>typeAliases<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>mappers<span class="token punctuation">&gt;</span></span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>        <span class="token operator">&lt;</span>mapper resource<span class="token operator">=</span><span class="token string">"com/Springtest/dao/StudentMapper.xml"</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>  当核心配置文件mapper标签下以resource形式指向依赖配置文件时，不需要，<span class="token class-name">Mapper</span><span class="token punctuation">.</span>xml文件名称和mapper接口名称一致<span class="token operator">--</span><span class="token operator">&gt;</span>

 <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>       当核心配置文件mapper标签下以<span class="token keyword">class</span>形式指向依赖配置文件时，<span class="token keyword">class</span>指向接口位置<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>        <span class="token operator">&lt;</span>mapper <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.example.dao.SaleDao"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span><span class="token operator">--</span><span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span><span class="token keyword">package</span> <span class="token namespace">name</span><span class="token operator">=</span><span class="token string">"org.example.dao"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>        mybatis配置文件，<span class="token class-name">Mappers</span>标签下以<span class="token keyword">package</span>包扫描形式时需要<span class="token class-name">Mapper</span><span class="token punctuation">.</span>xml文件名称和mapper接口名称一致，name是包名这个包下的所有xml文件一次性加载<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>mappers<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
</code></pre> 
<p>6、创建异常处理方法</p> 
<pre><code class="prism language-java"><span class="token comment">//自定义的运行时异常</span>
<span class="token comment">//重写两个方法有参和无参</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NotEnoughException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token class-name">NotEnoughException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">NotEnoughException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>7、创建Service接口和实现类</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BuyGoodsService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//购买商品的方法，goodsId:购买商品的编号 ，nums：购买的数量</span>
    <span class="token keyword">void</span> <span class="token function">buy</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> goodsId<span class="token punctuation">,</span><span class="token class-name">Integer</span> nums<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BuyGoodsServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">BuyGoodsService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">GoodsDao</span> goodsDao<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">SaleDao</span> saleDao<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buy</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> goodsId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//goodsId:表示买入的商品编号，nums：表示买入的数量</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"=====buy方法的开始====="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//记录销售信息，向sale表添加记录</span>
        <span class="token class-name">Sale</span> sale <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sale<span class="token punctuation">.</span><span class="token function">setGid</span><span class="token punctuation">(</span>goodsId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sale<span class="token punctuation">.</span><span class="token function">setNums</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>
        saleDao<span class="token punctuation">.</span><span class="token function">insertSale</span><span class="token punctuation">(</span>sale<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//更新库存</span>
        <span class="token class-name">Goods</span> goods <span class="token operator">=</span> goodsDao<span class="token punctuation">.</span><span class="token function">selectGoods</span><span class="token punctuation">(</span>goodsId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>goods<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//商品不存在</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">"编号是："</span><span class="token operator">+</span>goodsId<span class="token operator">+</span><span class="token string">"的商品不存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>goods<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>nums<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//商品库存不够</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NotEnoughException</span><span class="token punctuation">(</span><span class="token string">"编号是："</span><span class="token operator">+</span>goodsId<span class="token operator">+</span><span class="token string">"的商品库存不足"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Goods</span> buyGoods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buyGoods<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>goodsId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        buyGoods<span class="token punctuation">.</span><span class="token function">setAmount</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsDao<span class="token punctuation">.</span><span class="token function">updateGoods</span><span class="token punctuation">(</span>buyGoods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"=====buy方法的完成====="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//set方法完成属性的赋值</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setGoodsDao</span><span class="token punctuation">(</span><span class="token class-name">GoodsDao</span> goodsDao<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>goodsDao <span class="token operator">=</span> goodsDao<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSaleDao</span><span class="token punctuation">(</span><span class="token class-name">SaleDao</span> saleDao<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>saleDao <span class="token operator">=</span> saleDao<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>8、创建spring的配置文件：声明mybatis的对象交给spring创建</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
       xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
       xmlns<span class="token operator">:</span>context<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/context"</span>
       xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans
       http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token punctuation">.</span>xsd
       http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context
       http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context<span class="token operator">/</span>spring<span class="token operator">-</span>context<span class="token operator">-</span><span class="token number">4.2</span><span class="token punctuation">.</span>xsd
       http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>util
       https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>util<span class="token operator">/</span>spring<span class="token operator">-</span>util<span class="token punctuation">.</span>xsd"<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>把数据库的配置<span class="token punctuation">,</span>写在一个独立的文件中，编译修改数据库的配置内容
    spring知道jdbc<span class="token punctuation">.</span>properties文件的位置
    <span class="token operator">--</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>context<span class="token operator">:</span>property<span class="token operator">-</span>placeholder location<span class="token operator">=</span><span class="token string">"jdbc.properties"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>声明数据源<span class="token class-name">DataSource</span>，作用是连接数据库<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id <span class="token operator">=</span> <span class="token string">"myDataSource"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.alibaba.druid.pool.DruidDataSource"</span> init<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">"init"</span> destroy<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">"close"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>set注入给<span class="token class-name">DruidDataSource</span>提供数据库信息<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"url"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.url}"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"username"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.username}"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"password"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.password}"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"maxActive"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.maxActive}"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>连接的数量最多是<span class="token number">20</span>个<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>声明的是mybatis中提供的<span class="token class-name">SQLSessionFactoryBean</span>类，这个类内部创建<span class="token class-name">SQLSessionFactory</span>的<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id <span class="token operator">=</span> <span class="token string">"sqlSessionFactory"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.mybatis.spring.SqlSessionFactoryBean"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>set注入，把数据库连接池付给dataSource属性<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"myDataSource"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>mybatis主配置文件的位置
        configLocation属性是<span class="token class-name">Resource</span>类型，读取配置文件
        它的赋值，使用<span class="token class-name">Value</span>，指定文件的路径，使用classpath<span class="token operator">:</span>表示文件的位置
        <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"configLocation"</span> value<span class="token operator">=</span><span class="token string">"classpath:mybatis.xml"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>创建dao对象，使用<span class="token class-name">SQLSession</span>的<span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
        <span class="token class-name">MapperScannerConfigurer</span><span class="token operator">:</span>在内部调用
    <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>指定<span class="token class-name">SqlSessionFactory</span>对象的id<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sqlSessionFactoryBeanName"</span> value<span class="token operator">=</span><span class="token string">"sqlSessionFactory"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>指定包名，包名是dao接口所在的包名。
            <span class="token class-name">MapperScannerConfigurer</span>会扫描这个包中的所有接口，把每个接口都执行一次getMapper方法，得到每个
            接口的dao对象。创建好的dao对象放入到spring的容器中的<span class="token punctuation">,</span>dao对象的默认名称是接口名的首字母小写
        <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"basePackage"</span> value<span class="token operator">=</span><span class="token string">"org.example.dao"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>声明service<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"BuyGoodsService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.example.service.impl.BuyGoodsServiceImpl"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>name：属性名     ref<span class="token operator">:</span>对象的名称       创建的对象赋值给属性，那么service就可以使用dao了<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"goodsDao"</span> ref<span class="token operator">=</span><span class="token string">"goodsDao"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"saleDao"</span> ref<span class="token operator">=</span><span class="token string">"saleDao"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">&gt;</span>
</code></pre> 
<p>9、创建测试类，获取Service对象</p> 
<p>通过增加事务：使数据库的操作处于一种一致的状态之下，添加成功了那么库存就应该更新，如果有一个失败了，那么整个操作需要撤销需要通过事务来进行操作。给buy方法添加事务，它在执行过程中会涉及到多个数据库的操作，buy方法需要添加事务。</p> 
<p>如果不添加事务：就会导致sql语句执行不一致，导致最终的结果不正确。，以下实例如果没有添加事务，购买不存在的商品会添加记录到销售表中，而后报错，不会执行，更改库存的sql操作，那么就会导致，两张表的执行不一致。</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buy</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> goodsId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//goodsId:表示买入的商品编号，nums：表示买入的数量</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"=====buy方法的开始====="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//记录销售信息，向sale表添加记录</span>
        <span class="token class-name">Sale</span> sale <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sale<span class="token punctuation">.</span><span class="token function">setGid</span><span class="token punctuation">(</span>goodsId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sale<span class="token punctuation">.</span><span class="token function">setNums</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>
        saleDao<span class="token punctuation">.</span><span class="token function">insertSale</span><span class="token punctuation">(</span>sale<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//更新库存</span>
        <span class="token class-name">Goods</span> goods <span class="token operator">=</span> goodsDao<span class="token punctuation">.</span><span class="token function">selectGoods</span><span class="token punctuation">(</span>goodsId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>goods<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//商品不存在</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">"编号是："</span><span class="token operator">+</span>goodsId<span class="token operator">+</span><span class="token string">"的商品不存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>goods<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>nums<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//商品库存不够</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NotEnoughException</span><span class="token punctuation">(</span><span class="token string">"编号是："</span><span class="token operator">+</span>goodsId<span class="token operator">+</span><span class="token string">"的商品库存不足"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Goods</span> buyGoods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buyGoods<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>goodsId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        buyGoods<span class="token punctuation">.</span><span class="token function">setAmount</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsDao<span class="token punctuation">.</span><span class="token function">updateGoods</span><span class="token punctuation">(</span>buyGoods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"=====buy方法的完成====="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>测试代码：</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> config <span class="token operator">=</span> <span class="token string">"applicationContext.xml"</span><span class="token punctuation">;</span>
        <span class="token class-name">ApplicationContext</span> cxt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        从容器中获取service</span>
        <span class="token class-name">BuyGoodsService</span> buyGoodsService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BuyGoodsService</span><span class="token punctuation">)</span> cxt<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"BuyGoodsService"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        调用方法</span>
<span class="token comment">//        buyGoodsService.buy(1001,10);</span>
        buyGoodsService<span class="token punctuation">.</span><span class="token function">buy</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>测试结果：<br> <img src="https://images2.imgbox.com/0a/6e/3fEDq81V_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/40/bf/R4g3ci7z_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_1459"></a>增加事务：怎么给已经存在的代码，额外的增加事务功能，在增加时项目中的逻辑代码</h3> 
<p>通过aop的机制给buy方法增加事务<br> spring框架中提供的事务处理方案<br> 1、适合中小项目使用的，注解方案。<br> spring框架自己用aop实现给业务方法增加事务的功能，使用@Transactional注解增加事务。<br> @Transactional注解是spring框架自己注解，放在public方法的上面，表示当前方法具有事务。<br> 所有属性如下：<br> propagation：用于设置事务传播属性。该属性类型为Propagation枚举，默认值为Propagation.REQUIRED。<br> isolation:用于设置事务的隔离级别。该属性类型为Isolation枚举，默认值为Isolation.DEFAULT。<br> readOnly：用于设置该方法对数据库的操作是否是只读的。该属性为boolean，默认值为false。<br> timeout：用于设置本操作与数据库连接的超时时限。单位为秒，类型为int，默认值为-1，即没有时限。<br> rollbackFor：指定需要回滚的异常类。类型为Class[]，默认值为空数组。当然，若只有一个异常类时，可以不使用数组。</p> 
<h3><a id="spring_1471"></a>使用spring的事务注解来管理事务：</h3> 
<h3><a id="_1472"></a>在小项目中管理事务</h3> 
<p>通过@Transactional注解方式，可将事务织入到相应的public方法中，实现事务管理。<br> 使用@Transactional注解的步骤：<br> 1、声明事务管理器对象</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"xx"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"DataSourceTransactionManager"</span><span class="token operator">&gt;</span>
</code></pre> 
<p>2、开启事务注解驱动，告诉spring框架，我要使用注解的方式管理事务。<br> spring使用aop机制，创建@Transactional所在的类代理对象，给方法加入事务的功能。<br> spring给业务方法加入事务：<br> 在你的业务方法执行之前，先开启事务，在业务方法之后提交或回滚事务，使用aop的环绕通知别人已经在里面写过了，不用自己写<br> @Around(“你要增加的那个事务功能的业务方法名称”)<br> object myAround(){<!-- --><br> 开启事务，spring给你开启<br> try{<!-- --><br> buy(1001,10);<br> spring的事务管理.commit();<br> }catch(Exception){<!-- --><br> spring的事物管理.rollback();<br> }<br> }<br> 3、在你的方法上面加入@Transactional注解<br> 步骤：<br> 1、声明事务管理器对象</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>使用spring的事务处理<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token number">1</span>、声明spring的事务管理器<span class="token punctuation">,</span>完成事务提交和事务回滚的<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"transactionManager"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>连接数据库，指定数据源<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"myDataSource"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
</code></pre> 
<p>2、开启事务注解驱动</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token number">2</span>、开启事务注解驱动，告诉spring使用注解管理事务，创建代理对象transaction<span class="token operator">-</span>manager<span class="token operator">:</span>事务管理器对象的id<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>tx<span class="token operator">:</span>annotation<span class="token operator">-</span>driven transaction<span class="token operator">-</span>manager<span class="token operator">=</span><span class="token string">"transactionManager"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<p>3、在方法上面加入以下@Transactional注解，其中的设置都是默认值，默认的传播行为、默认的隔离级别、默认抛出运行时异常回滚事务，或者直接加入@Transactional。<br> rollbackFor:表示发生指定的异常一定回滚。<br> 处理逻辑是：<br> 1、spring框架会首先检查出方法抛出异常是不是在rollbackFor的属性值中，如果异常在rollbackFor列表中，不管是什么类型的异常，一定回滚。<br> 2、如果你的抛出的异常不在rollbackFor列表中，spring会判断异常是不是RuntimeException，如果是一定回滚。</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span><span class="token comment">//rollbackFor,当发生指定异常时，会回滚</span>
            propagation <span class="token operator">=</span> <span class="token class-name">Propagation</span><span class="token punctuation">.</span>REQUIRED<span class="token punctuation">,</span>
            isolation <span class="token operator">=</span> <span class="token class-name">Isolation</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">,</span>
            readOnly <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            rollbackFor <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">NullPointerException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">NotEnoughException</span><span class="token punctuation">.</span><span class="token keyword">class</span>
            <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_1526"></a>在大项目中管理事务：</h3> 
<p>有很多的类，方法，需要大量的配置事务，使用aspectj框架功能，在spring配置文件中声明类，方法需要的事务。这种方式业务方法和事务配置完全分离。</p> 
<h3><a id="AspectJAOP_1528"></a>使用AspectJ的AOP配置管理事务（掌握）</h3> 
<p>实现步骤：<br> 都是在xml配置文件中实现的。<br> 1、要使用aspectj这个框架，加入依赖</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>aspectj依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>aspects<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.5</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<p>2、声明事务管理器对象</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>声明式事务处理：和源代码完全分离的<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token number">1</span>、声明事务管理器对象<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"transactionManager"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"myDataSource"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>
</code></pre> 
<p>3、声明方法需要配置事务类型（配置方法的事务属性（1、隔离级别 2、传播行为 3、超时 ））</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span>tx<span class="token operator">:</span>advice id <span class="token operator">=</span> <span class="token string">"myAdvice"</span> transaction<span class="token operator">-</span>manager<span class="token operator">=</span><span class="token string">"transactionManager"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>tx<span class="token operator">:</span>attributes<span class="token operator">:</span>配置事务属性<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>tx<span class="token operator">:</span>attributes<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>tx<span class="token operator">:</span>method <span class="token operator">:</span>给具体的方法配置事务属性，method可以有多个，分别给不同的方法设置事务属性
                name： 方法名称 <span class="token number">1</span>、完整的方法名称，不带有包和类
                              <span class="token number">2</span>、方法可以使用通配符，<span class="token operator">*</span>表示任意字符<span class="token punctuation">(</span>适用于多个方法来指定很多的方法<span class="token punctuation">)</span>
                propergation<span class="token operator">:</span>传播行为，枚举值
                isolation： 隔离级别
                rollback<span class="token operator">-</span><span class="token class-name">For</span><span class="token operator">:</span>你指定的异常类名，全限定类名。发生异常一定回滚
            <span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"buy"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> isolation<span class="token operator">=</span><span class="token string">"DEFAULT"</span> rollback<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"java.lang.NullPointerException,org.example.excep.NotEnoughException"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>tx<span class="token operator">:</span>attributes<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>tx<span class="token operator">:</span>advice<span class="token operator">&gt;</span>
</code></pre> 
<p>4、配置aop：声明那些类需要创建代理。</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span>aop<span class="token operator">:</span>config<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>配置切入点表达式：指定那些包中类，要用事务
            id：切入点表达式的名称，唯一值
            expression<span class="token operator">:</span>切入点表达式，指定那些类要使用事务，aspectj会创建代理对象
            com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>service
            com<span class="token punctuation">.</span>service
            com<span class="token punctuation">.</span>crm<span class="token punctuation">.</span>service
        <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>aop<span class="token operator">:</span>pointcut id<span class="token operator">=</span><span class="token string">"servicePT"</span> expression<span class="token operator">=</span><span class="token string">"execution(* org.example.service.impl.BuyGoodsServiceImpl*.*(..))"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>配置增强器：关联advice和pointcut<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>aop<span class="token operator">:</span>advisor advice<span class="token operator">-</span>ref<span class="token operator">=</span><span class="token string">"myAdvice"</span> pointcut<span class="token operator">-</span>ref<span class="token operator">=</span><span class="token string">"servicePT"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>aop<span class="token operator">:</span>advisor<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>aop<span class="token operator">:</span>config<span class="token operator">&gt;</span>
</code></pre> 
<p>5、测试代码：</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> config <span class="token operator">=</span> <span class="token string">"applicationContext.xml"</span><span class="token punctuation">;</span>
        <span class="token class-name">ApplicationContext</span> cxt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        从容器中获取service</span>
        <span class="token class-name">BuyGoodsService</span> buyGoodsService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BuyGoodsService</span><span class="token punctuation">)</span> cxt<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"BuyGoodsService"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"service是代理："</span><span class="token operator">+</span>buyGoodsService<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        调用方法</span>
<span class="token comment">//        buyGoodsService.buy(1001,10);</span>
        buyGoodsService<span class="token punctuation">.</span><span class="token function">buy</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/69/3f/YTwfgRgY_o.png" alt="在这里插入图片描述"><br> service是代理，说明完成了事务管理。</p> 
<h2><a id="SpringWeb_1600"></a>第六章Spring与Web</h2> 
<p>在web项目中怎么使用容器对象。<br> 实例：在web项目中使用spring，完成学生注册功能<br> 实现步骤：<br> 1、创建一个maven，web项目<br> <img src="https://images2.imgbox.com/f8/74/E7MoPSr2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/62/89/HzgW5hZd_o.png" alt="在这里插入图片描述"><br> 2、添加依赖（拷贝依赖，添加jsp、servlet依赖）</p> 
<pre><code class="prism language-java">  <span class="token generics"><span class="token punctuation">&lt;</span>properties<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>project<span class="token punctuation">.</span>build<span class="token punctuation">.</span>sourceEncoding<span class="token punctuation">&gt;</span></span>UTF<span class="token operator">-</span><span class="token number">8</span><span class="token operator">&lt;</span><span class="token operator">/</span>project<span class="token punctuation">.</span>build<span class="token punctuation">.</span>sourceEncoding<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>source<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>source<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>target<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>target<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>properties<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>单元测试<span class="token operator">--</span><span class="token operator">&gt;</span>
  <span class="token generics"><span class="token punctuation">&lt;</span>dependencies<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>junit<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>junit<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">4.11</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>test<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    spring核心IOC<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>context<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.5</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    做spring事务用到的<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>tx<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.8</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>jdbc<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.8</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    mybatis依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>mybatis<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mybatis<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.5</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    mybatis和spring集成的依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>mybatis<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mybatis<span class="token operator">-</span>spring<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.3</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>mysql驱动<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">-</span>connector<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">8.0</span><span class="token number">.29</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>阿里公司的连接池<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>alibaba<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>druid<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.1</span><span class="token number">.12</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>lombok快速为类对象创建set、get、构造等函数<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.18</span><span class="token number">.10</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>provided<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>servlet依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>javax<span class="token punctuation">.</span>servlet<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>javax<span class="token punctuation">.</span>servlet<span class="token operator">-</span>api<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">4.0</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>jsp依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>jsp<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>jsp<span class="token operator">-</span>api<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.2</span><span class="token number">.1</span><span class="token operator">-</span>b03<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>dependencies<span class="token operator">&gt;</span>

  <span class="token generics"><span class="token punctuation">&lt;</span>build<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>目的是吧src<span class="token operator">/</span>main<span class="token operator">/</span>java目录中的xml文件包含到输出结果中。输出到classes目录中<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>resources<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>resource<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>directory<span class="token punctuation">&gt;</span></span>src<span class="token operator">/</span>main<span class="token operator">/</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>directory<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>所在的目录<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>includes<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>包括目录下的<span class="token punctuation">.</span>properties，<span class="token punctuation">.</span>xml文件都会扫描到<span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token generics"><span class="token punctuation">&lt;</span>include<span class="token punctuation">&gt;</span></span><span class="token operator">*</span><span class="token operator">*</span><span class="token comment">/*.properties&lt;/include&gt;
          &lt;include&gt;**/</span><span class="token operator">*</span><span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>include<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>includes<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>        —filtering 选项 <span class="token boolean">false</span> 不启用过滤器， <span class="token operator">*</span><span class="token punctuation">.</span>property 已经起到过滤的作用了 <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>filtering<span class="token punctuation">&gt;</span></span><span class="token boolean">false</span><span class="token operator">&lt;</span><span class="token operator">/</span>filtering<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>resource<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>resources<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>    指定jdk的版本<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>plugins<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>plugin<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>maven<span class="token punctuation">.</span>plugins<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>maven<span class="token operator">-</span>compiler<span class="token operator">-</span>plugin<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>configuration<span class="token punctuation">&gt;</span></span>
          <span class="token generics"><span class="token punctuation">&lt;</span>source<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>source<span class="token operator">&gt;</span>
          <span class="token generics"><span class="token punctuation">&lt;</span>target<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>target<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>plugins<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>build<span class="token operator">&gt;</span>
</code></pre> 
<p>3、拷贝06Spring-mybatis的代码和配置文件<br> <img src="https://images2.imgbox.com/74/56/P3XY5s8n_o.png" alt="在这里插入图片描述"><br> 4、创建index.jsp页面：</p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">%</span>@ page contentType<span class="token operator">=</span><span class="token string">"text/html;charset=UTF-8"</span> language<span class="token operator">=</span><span class="token string">"java"</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>html<span class="token punctuation">&gt;</span></span>
<span class="token generics"><span class="token punctuation">&lt;</span>head<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>title<span class="token punctuation">&gt;</span></span><span class="token class-name">Title</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>body<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>p<span class="token punctuation">&gt;</span></span>注册学生<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">""</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>table<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>tr<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span>id：<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"id"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>tr<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span>姓名：<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"name"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>tr<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span>email：<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"email"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>tr<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span>年龄：<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"age"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>tr<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>td<span class="token punctuation">&gt;</span></span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"submit"</span> value<span class="token operator">=</span><span class="token string">"注册学生"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> 
<p>查看web.xml<br> <img src="https://images2.imgbox.com/3a/40/pR8ooTM4_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/60/15/p80cJ14p_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/57/59/0ZJpn5wP_o.png" alt="在这里插入图片描述"><br> 再将名称修改为web.xml</p> 
<p>4、创建一个jsp发起请求，有参数id、name、email、age</p> 
<p>5、创建Servlet，接收请求参数，调用Service，调用dao完成注册</p> 
<p>6、创建一个jsp作为显示结果页面</p> 
<p>结果演示：<br> 首先注册一个学生<br> <img src="https://images2.imgbox.com/83/10/e5DxzJ1a_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ef/1a/HPJ6U1Qt_o.png" alt="在这里插入图片描述"><br> 创建了一次容器对象<br> <img src="https://images2.imgbox.com/91/86/ZA5LTOE5_o.png" alt="在这里插入图片描述"><br> 然后再次注册一个学生<br> <img src="https://images2.imgbox.com/55/31/bAlMP87R_o.png" alt="在这里插入图片描述"><br> 再次创建了一个容器对象（不同的对象）。</p> 
<p>如果文件中有很多对象，那么创建效率就很慢，占用多余的内存。<br> 容器对象包含所有对象，只需要创建一次就可以了。如何操作？<br> 需求在web项目中，容器对象只需要创建一次，把容器对象放入到全局作用域ServletContext中。</p> 
<h3><a id="_ServletContext_1785"></a>怎么实现？使用监听器，当全局作用域对象被创建时，创建容器 存入ServletContext</h3> 
<p>监听器作用：<br> 1、创建容器对象，执行ApplicationContext ctx = new ClassPathXMLApplicationContext(“applicationContext.xml”);<br> 2、把容器对象放入到ServletContext， ServletContext.setAttribute(key,ctx)</p> 
<p>监听器可以自己创建，也可以使用框架中提供好的ContextLoaderListener<br> private WebApplicationContext context;<br> public interface WebApplicationContext extends ApplicationContext</p> 
<pre><code> ApplicationContext:javase项目中使用的容器对象
WebApplicationContext：web项目中的使用的容器对象
</code></pre> 
<p>把创建的容器对象，放入到全局作用域<br> key： WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE<br> WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE<br> value：this.context</p> 
<pre><code> servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, this.context);
</code></pre> 
<p>为了使用监听器对象：<br> 1、要加入依赖</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>为了使用监听器对象，加入依赖<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
      <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>web<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.2</span><span class="token number">.5</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<p>2、注册监听器ContextLoaderListener（web.xml文件）</p> 
<pre><code class="prism language-java">    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>注册监听器<span class="token class-name">ContextLoaderListener</span>
        监听器被创建爱你对象后，会读取<span class="token operator">/</span>WEB<span class="token operator">-</span>INF<span class="token operator">/</span>applicationContext<span class="token punctuation">.</span>xml
        为什么要读取文件：因为在监听器中要创建<span class="token class-name">ApplicationContext</span>对象，需要加载配置文件。
        <span class="token operator">/</span>WEB<span class="token operator">-</span>INF<span class="token operator">/</span>applicationContext<span class="token punctuation">.</span>xml就是监听器默认读取的spring配置文件的路径

        可以修改默认的文件位置，使用配置项context<span class="token operator">-</span>param重新指定文件的位置
    <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>context<span class="token operator">-</span>param<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">&gt;</span>contextConfigLocation<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>自定义配置文件的路径<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">&gt;</span>classpath<span class="token operator">:</span>applicationContext<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>context<span class="token operator">-</span>param<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>listener<span class="token punctuation">&gt;</span></span>
        <span class="token operator">&lt;</span>listener<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">&gt;</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span>ContextLoaderListener</span><span class="token operator">&lt;</span><span class="token operator">/</span>listener<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>listener<span class="token operator">&gt;</span>
</code></pre> 
<p>3、使用监听器（在Servlet代码中使用）</p> 
<pre><code class="prism language-java">
            <span class="token class-name">WebApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token comment">//获取ServletContext中的容器对象，创建好的容器对象，拿来就用</span>
            <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token class-name">WebApplicationContext</span><span class="token punctuation">.</span>ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE<span class="token punctuation">;</span>
            <span class="token class-name">Object</span> attr <span class="token operator">=</span>  <span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>attr<span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                ctx <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">WebApplicationContext</span><span class="token punctuation">)</span> attr<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"容器对象的信息======="</span><span class="token operator">+</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5c62e52333b8aae2a38371b7e652fd79/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C语言中（%d %.2d %2d %02d）（%2x, %02x, %-2x, %.2x）（%f, %.2f, %2.2f）（%e, %.2e,%3.2e）的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/02cfec5f0a1968cea89c72db7c98a5c5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Smooth L1 Loss】Smooth L1损失函数理解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>