<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Akka 学习（四）Remote Actor - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Akka 学习（四）Remote Actor" />
<meta property="og:description" content="目录 一 介绍1.1 Remote Actor1.2 适用场景1.3 踩坑点 二 实战2.1 需求2.2 Java 版本2.2.1 效果图2.2.2 实体类2.2.3 服务端Actor 处理2.2.4 服务端配置文件2.2.5 客服端Actor处理2.2.6 客服端配置文件2.2.7 测试 2.3 Scala 版本2.3.1 效果2.2.3 服务端Actor处理2.3.4 客户端Actor处理2.3.5 测试 参考文章 Gitter Chat，Akka 在线交流平台Akka Forums，Akka 论坛Akka in GitHub，Akka 开源项目仓库Akka Official Website，Akka 官网Akka Java API，Akka 应用程序编程接口《Akka入门与实践》 [加]Jason Goodwin（贾森·古德温） 文章系列
Akka 学习（一）Actor 初步认识与环境搭建 已完成 Akka 学习（二）第一个入门程序 已完成 Akka 学习（三）Actor的基本使用 已完成 Akka 学习（四）Remote Actor 已完成 Akka 学习（五）消息传递的方式 已完成 Akka 学习（六）Actor的监督机制 已完成 Akka 学习（七）Actor的生命周期 已完成 Akka 学习（八）路由与Dispatcher 已完成 Akka 学习（九）Akka Cluster 已完成 Akka 基础篇就此结束了，Akka基础篇主要介绍Akka的基本概念与一些基本术语，使用方式" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/75a6e84a790be5c43b891f58d1d11f05/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-12T16:13:52+08:00" />
<meta property="article:modified_time" content="2022-12-12T16:13:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Akka 学习（四）Remote Actor</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#__24" rel="nofollow">一 介绍</a></li><li><ul><li><a href="#11_Remote_Actor_25" rel="nofollow">1.1 Remote Actor</a></li><li><a href="#12__34" rel="nofollow">1.2 适用场景</a></li><li><a href="#13__38" rel="nofollow">1.3 踩坑点</a></li></ul> 
  </li><li><a href="#__146" rel="nofollow">二 实战</a></li><li><ul><li><a href="#21__147" rel="nofollow">2.1 需求</a></li><li><a href="#22_Java__153" rel="nofollow">2.2 Java 版本</a></li><li><ul><li><a href="#221__154" rel="nofollow">2.2.1 效果图</a></li><li><a href="#222__167" rel="nofollow">2.2.2 实体类</a></li><li><a href="#223_Actor__234" rel="nofollow">2.2.3 服务端Actor 处理</a></li><li><a href="#224__324" rel="nofollow">2.2.4 服务端配置文件</a></li><li><a href="#225_Actor_343" rel="nofollow">2.2.5 客服端Actor处理</a></li><li><a href="#226__428" rel="nofollow">2.2.6 客服端配置文件</a></li><li><a href="#227__447" rel="nofollow">2.2.7 测试</a></li></ul> 
   </li><li><a href="#23_Scala__453" rel="nofollow">2.3 Scala 版本</a></li><li><ul><li><a href="#231__454" rel="nofollow">2.3.1 效果</a></li><li><a href="#223_Actor_467" rel="nofollow">2.2.3 服务端Actor处理</a></li><li><a href="#234_Actor_512" rel="nofollow">2.3.4 客户端Actor处理</a></li><li><a href="#235__569" rel="nofollow">2.3.5 测试</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<br> 参考文章 
<p></p> 
<ul><li><a href="https://gitter.im/akka/akka?source=orgpage" rel="nofollow">Gitter Chat</a>，Akka 在线交流平台</li><li><a href="https://discuss.lightbend.com/c/akka/" rel="nofollow">Akka Forums</a>，Akka 论坛</li><li><a href="https://github.com/akka/akka">Akka in GitHub</a>，Akka 开源项目仓库</li><li><a href="https://akka.io/" rel="nofollow">Akka Official Website</a>，Akka 官网</li><li><a href="https://doc.akka.io/japi/akka/2.6/overview-summary.html" rel="nofollow">Akka Java API</a>，Akka 应用程序编程接口</li><li>《Akka入门与实践》 [加]Jason Goodwin（贾森·古德温）</li></ul> 
<p>文章系列</p> 
<ul><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> <a href="https://blog.csdn.net/weixin_44451022/article/details/128210469">Akka 学习（一）Actor 初步认识与环境搭建</a> 已完成</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> <a href="https://blog.csdn.net/weixin_44451022/article/details/128210518">Akka 学习（二）第一个入门程序</a> 已完成</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> <a href="https://blog.csdn.net/weixin_44451022/article/details/128219064">Akka 学习（三）Actor的基本使用</a> 已完成</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> <a href="https://blog.csdn.net/weixin_44451022/article/details/128219098">Akka 学习（四）Remote Actor</a> 已完成</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> <a href="https://blog.csdn.net/weixin_44451022/article/details/128259074">Akka 学习（五）消息传递的方式</a> 已完成</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> <a href="https://blog.csdn.net/weixin_44451022/article/details/128259681">Akka 学习（六）Actor的监督机制</a> 已完成</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> <a href="https://blog.csdn.net/weixin_44451022/article/details/128269188">Akka 学习（七）Actor的生命周期</a> 已完成</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> <a href="https://blog.csdn.net/weixin_44451022/article/details/128277337?spm=1001.2014.3001.5502">Akka 学习（八）路由与Dispatcher</a> 已完成</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> <a href="https://blog.csdn.net/weixin_44451022/article/details/128286970?spm=1001.2014.3001.5502">Akka 学习（九）Akka Cluster</a> 已完成</li></ul> 
<p>Akka 基础篇就此结束了，Akka基础篇主要介绍Akka的基本概念与一些基本术语，使用方式<br> 代码：<a href="https://github.com/Eason-shu/Akka">https://github.com/Eason-shu/Akka</a></p> 
<h2><a id="__24"></a>一 介绍</h2> 
<h3><a id="11_Remote_Actor_25"></a>1.1 Remote Actor</h3> 
<p>虽然Akka在单机上可以运行上百万的Actor，但出于容错、负载均衡、灰度发布、提高并行度等等原因，我们仍然需要能在多个不同的服务器上运行Actor。所以Akka提供了akka-remoting的扩展包，屏蔽底层网络传输的细节，让上层以及其简单的方式使用远程的Actor调度。<br> Akka Remoting 是一个以点对点方式连接 actor 系统的通信模块，它是 Akka 集群的基础。远程处理的设计由两个（相关的）设计决策驱动：</p> 
<ol><li>相关系统之间的通信是对称的：如果系统 A 可以连接到系统 B，那么系统 B 也必须能够独立连接到系统 A。</li><li>通信系统的角色在连接模式方面是对称的：没有只接受连接的系统，也没有只发起连接的系统。</li></ol> 
<p>这些决定的结果是不可能安全地创建具有预定义角色的纯客户端-服务器设置（违反假设 2）。对于客户端-服务器设置，最好使用 HTTP 或 Akka I/O。<br> <strong>重要提示</strong>：使用涉及网络地址转换、负载平衡器或 Docker 容器的设置违反了假设 1，除非在网络配置中采取额外步骤以允许相关系统之间的对称通信。在这种情况下，Akka 可以配置为绑定到与用于在 Akka 节点之间建立连接的地址不同的网络地址。请参阅<a href="https://doc.akka.io/docs/akka/current/remoting-artery.html#remote-configuration-nat-artery" rel="nofollow">NAT 后面或 Docker 容器中的 Akka</a>。</p> 
<h3><a id="12__34"></a>1.2 适用场景</h3> 
<ul><li>remoting的存在其实是为akka cluster做底层支持的，通常并不会直接去使用remoting的包。但为了了解cluster的底层原理，还是有必要看下remoting。</li><li>同时，remoting被设计为Peer-to-Peer而非Client-Server，所以不适用于基于后者的系统开发，比如我们无法在一个provider为local的Actor里去查找一个remote actor发送消息，必须两者均为remote actor，才满足对等。</li></ul> 
<h3><a id="13__38"></a>1.3 踩坑点</h3> 
<ul><li>Akka版本需要与Scala版本匹配</li></ul> 
<p>maven仓库地址：<br> <img src="https://images2.imgbox.com/3b/14/P5Ad5j9D_o.png" alt="image.png"><br> 注意版本匹配，不然会疯狂报错，运行不起来<br> 我的版本：<br> scala：2.13.0<br> Akka版本：2.13</p> 
<ul><li>依赖</li></ul> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
  <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.hc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ActorDemo03<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>ActorDemo03<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Demo project for Spring Boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scala.version</span><span class="token punctuation">&gt;</span></span>2.11.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scala.version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>



  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>


    <span class="token comment">&lt;!-- https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.typesafe.akka<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>akka-actor_2.13<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.23<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>


    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.typesafe.akka<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>akka-remote_2.13<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.23<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.typesafe.akka<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>akka-testkit_2.13<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.23<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.scala-lang.modules<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>scala-java8-compat_2.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>







    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.13.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.testng<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>testng<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>compile<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>


  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>



  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>



<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h2><a id="__146"></a>二 实战</h2> 
<h3><a id="21__147"></a>2.1 需求</h3> 
<p><img src="https://images2.imgbox.com/64/0b/jYVJrJGS_o.jpg" alt="epub_22651331_22.jpg"></p> 
<ul><li>我们还将创建一个数据库客户端，用于展示如何请求服务器，以及如何从远程Actor中获取Future。</li><li>服务器端的服务接收到客户端的请求后将返回Future。</li><li>这样我们就已经编写了一个可以使用的键值存储数据库（和redis很类似）以及一个可以使用该数据库的远程客户端。</li></ul> 
<h3><a id="22_Java__153"></a>2.2 Java 版本</h3> 
<h4><a id="221__154"></a>2.2.1 效果图</h4> 
<ul><li>服务端启动前</li></ul> 
<p><img src="https://images2.imgbox.com/61/81/n8lkDKyA_o.png" alt="image.png"></p> 
<ul><li>客服端启动</li></ul> 
<p><img src="https://images2.imgbox.com/f8/70/tJMLcbcC_o.png" alt="image.png"></p> 
<ul><li>服务端收到请求后</li></ul> 
<p><img src="https://images2.imgbox.com/bc/ba/GCvkXGgu_o.png" alt="image.png"></p> 
<h4><a id="222__167"></a>2.2.2 实体类</h4> 
<ul><li>SetRequest</li></ul> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description: 设置消息
 * @author: shu
 * @createDate: 2022/11/28 11:51
 * @version: 1.0
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SetRequest</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> key<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> value<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">SetRequest</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<ul><li>GetRequest</li></ul> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description: 获取消息
 * @author: shu
 * @createDate: 2022/11/28 11:52
 * @version: 1.0
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetRequest</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> key<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">GetRequest</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>错误消息</li></ul> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description:
 * @author: shu
 * @createDate: 2022/11/28 11:52
 * @version: 1.0
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KeyNotFoundException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token keyword">implements</span>
        <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> key<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">KeyNotFoundException</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="223_Actor__234"></a>2.2.3 服务端Actor 处理</h4> 
<pre><code class="prism language-java">
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token class-name">Logging</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token class-name">LoggingAdapter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>japi<span class="token punctuation">.</span>pf<span class="token punctuation">.</span></span><span class="token class-name">ReceiveBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">pojo<span class="token punctuation">.</span></span><span class="token class-name">GetRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">pojo<span class="token punctuation">.</span></span><span class="token class-name">KeyNotFoundException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">pojo<span class="token punctuation">.</span></span><span class="token class-name">SetRequest</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description:
 * @author: shu
 * @createDate: 2022/11/28 12:31
 * @version: 1.0
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestActor</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractActor</span> <span class="token punctuation">{<!-- --></span>

    <span class="token class-name">LoggingAdapter</span> log <span class="token operator">=</span> <span class="token class-name">Logging</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">preStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ToFindRemoteActor is starting"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Receive</span> <span class="token function">createReceive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span>  <span class="token class-name">ReceiveBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置消息</span>
                <span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token class-name">SetRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> message <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 打印消息</span>
                    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Received Set request: {}"</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 缓存消息</span>
                    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>key<span class="token punctuation">,</span> message<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 回应消息</span>
                    <span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Status<span class="token punctuation">.</span>Success</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token comment">// 得到消息</span>
                <span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token class-name">GetRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> message <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 打印日志</span>
                    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Received Get request: {}"</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 获取消息</span>
                    <span class="token class-name">Object</span> value <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">)</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">Object</span> response <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                            <span class="token operator">?</span> value
                            <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Status<span class="token punctuation">.</span>Failure</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">KeyNotFoundException</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 响应消息</span>
                    <span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tell</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token function">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token comment">// 未找到消息</span>
                <span class="token punctuation">.</span><span class="token function">matchAny</span><span class="token punctuation">(</span>o <span class="token operator">-&gt;</span>
                        <span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Status<span class="token punctuation">.</span>Failure</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 测试
     * @param args
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

<span class="token comment">//        Config config = ConfigFactory.parseString(</span>
<span class="token comment">//                        "akka.remote.netty.tcp.port=" + 2551)</span>
<span class="token comment">//                .withFallback(ConfigFactory.load("application.conf"));</span>

        <span class="token comment">// Create an Akka system</span>
        <span class="token class-name">ActorSystem</span> system <span class="token operator">=</span> <span class="token class-name">ActorSystem</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"akkademy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Create an actor</span>
        <span class="token class-name">ActorRef</span> ref <span class="token operator">=</span> system<span class="token punctuation">.</span><span class="token function">actorOf</span><span class="token punctuation">(</span><span class="token class-name">Props</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">RequestActor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"akkademy-db"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ref<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>



<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="224__324"></a>2.2.4 服务端配置文件</h4> 
<p><img src="https://images2.imgbox.com/32/ae/zrxyBfcf_o.png" alt="image.png"></p> 
<pre><code class="prism language-json">akka <span class="token punctuation">{<!-- --></span>
  stdout<span class="token operator">-</span>loglevel <span class="token operator">=</span> <span class="token string">"DEBUG"</span>
  loglevel <span class="token operator">=</span> <span class="token string">"DEBUG"</span>
  actor <span class="token punctuation">{<!-- --></span>
  provider <span class="token operator">=</span> <span class="token string">"akka.remote.RemoteActorRefProvider"</span>
<span class="token punctuation">}</span>
remote <span class="token punctuation">{<!-- --></span>
  enabled<span class="token operator">-</span>transports <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"akka.remote.netty.tcp"</span><span class="token punctuation">]</span>
  netty<span class="token punctuation">.</span>tcp <span class="token punctuation">{<!-- --></span>
  hostname <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
log<span class="token operator">-</span>sent<span class="token operator">-</span>messages <span class="token operator">=</span> on
log<span class="token operator">-</span>received<span class="token operator">-</span>messages <span class="token operator">=</span> on
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="225_Actor_343"></a>2.2.5 客服端Actor处理</h4> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">client</span><span class="token punctuation">;</span>



<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span></span><span class="token class-name">ActorRef</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span></span><span class="token class-name">ActorSelection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span></span><span class="token class-name">ActorSystem</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>pattern<span class="token punctuation">.</span></span><span class="token class-name">AskableActorSelection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Timeout</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">pojo<span class="token punctuation">.</span></span><span class="token class-name">GetRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">pojo<span class="token punctuation">.</span></span><span class="token class-name">SetRequest</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">CompletionStage</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token import static"><span class="token namespace">scala<span class="token punctuation">.</span>compat<span class="token punctuation">.</span>java8<span class="token punctuation">.</span></span><span class="token class-name">FutureConverters</span><span class="token punctuation">.</span><span class="token static">toJava</span></span><span class="token punctuation">;</span>


<span class="token comment">/**
* @description:
* @author: shu
* @createDate: 2022/11/28 16:10
* @version: 1.0
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JClient</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ActorSystem</span> system <span class="token operator">=</span> <span class="token class-name">ActorSystem</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"LocalSystem"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ActorSelection</span> remoteDb<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">JClient</span><span class="token punctuation">(</span><span class="token class-name">String</span> remoteAddress<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        remoteDb <span class="token operator">=</span> system<span class="token punctuation">.</span><span class="token function">actorSelection</span><span class="token punctuation">(</span><span class="token string">"akka.tcp://akkademy@"</span> <span class="token operator">+</span>
                                         remoteAddress <span class="token operator">+</span> <span class="token string">"/user/akkademy-db"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
* 缓存消息
* @param key
* @param value
* @return
*/</span>
    <span class="token keyword">public</span> <span class="token class-name">CompletionStage</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">toJava</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AskableActorSelection</span><span class="token punctuation">(</span>remoteDb<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SetRequest</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Timeout</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
* 获取缓存消息
* @param key
* @return
*/</span>
    <span class="token keyword">public</span> <span class="token class-name">CompletionStage</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span>   <span class="token function">toJava</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AskableActorSelection</span><span class="token punctuation">(</span>remoteDb<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetRequest</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Timeout</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span></span><span class="token class-name">ActorRef</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span></span><span class="token class-name">ActorSelection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span></span><span class="token class-name">ActorSystem</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">client<span class="token punctuation">.</span></span><span class="token class-name">JClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">pojo<span class="token punctuation">.</span></span><span class="token class-name">SetRequest</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">CompletableFuture</span></span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AkkademyDbTest</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">/**
     * 测试注意需要放在不同的两个项目进行测试，不然会Caused by: java.net.BindException: Address already in use: bind
     * @throws Exception
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">itShouldSetRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">JClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JClient</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1:2552"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                client<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Integer</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">)</span> client<span class="token punctuation">.</span>
                        <span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"获取的结果："</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">assert</span><span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="226__428"></a>2.2.6 客服端配置文件</h4> 
<pre><code class="prism language-json">akka <span class="token punctuation">{<!-- --></span>
  stdout<span class="token operator">-</span>loglevel <span class="token operator">=</span> <span class="token string">"DEBUG"</span>
  loglevel <span class="token operator">=</span> <span class="token string">"DEBUG"</span>
  actor <span class="token punctuation">{<!-- --></span>
  provider <span class="token operator">=</span> <span class="token string">"akka.remote.RemoteActorRefProvider"</span>
<span class="token punctuation">}</span>
remote <span class="token punctuation">{<!-- --></span>
  enabled<span class="token operator">-</span>transports <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"akka.remote.netty.tcp"</span><span class="token punctuation">]</span>
  netty<span class="token punctuation">.</span>tcp <span class="token punctuation">{<!-- --></span>
  hostname <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>
  port <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
log<span class="token operator">-</span>sent<span class="token operator">-</span>messages <span class="token operator">=</span> on
log<span class="token operator">-</span>received<span class="token operator">-</span>messages <span class="token operator">=</span> on
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="227__447"></a>2.2.7 测试</h4> 
<p>注意：需要放在两个不一样的配置项目中</p> 
<ol><li>服务端项目启动，等待请求的到来，注意配置文件</li><li>客服端项目启动，发送AKKA请求给服务端</li><li>服务端收到客服端的请求，缓存请求数据，把缓存结果返回给客服端</li></ol> 
<h3><a id="23_Scala__453"></a>2.3 Scala 版本</h3> 
<h4><a id="231__454"></a>2.3.1 效果</h4> 
<ul><li>启动服务前</li></ul> 
<p><img src="https://images2.imgbox.com/6a/5d/GHjZ6pKY_o.png" alt="image.png"></p> 
<ul><li>客户端启动</li></ul> 
<p><img src="https://images2.imgbox.com/75/ba/1slltGEB_o.png" alt="image.png"></p> 
<ul><li>服务端收到请求</li></ul> 
<p><img src="https://images2.imgbox.com/b2/37/8JKq6kQb_o.png" alt="image.png"></p> 
<h4><a id="223_Actor_467"></a>2.2.3 服务端Actor处理</h4> 
<pre><code class="prism language-scala"><span class="token keyword">import</span> <span class="token namespace">akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span></span><span class="token punctuation">{<!-- --></span>Actor<span class="token punctuation">,</span> Status<span class="token punctuation">}</span>
<span class="token keyword">import</span> <span class="token namespace">akka<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token punctuation">{<!-- --></span>Logging<span class="token punctuation">,</span> LoggingAdapter<span class="token punctuation">}</span>

<span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>collection<span class="token punctuation">.</span>convert<span class="token punctuation">.</span></span>ImplicitConversions<span class="token punctuation">.</span>`map AsJavaMap`
<span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>collection<span class="token punctuation">.</span>mutable</span>

<span class="token comment">/**
 * @description:
 * @author: shu
 * @createDate: 2022/11/28 12:41
 * @version: 1.0
 */</span>
<span class="token keyword">class</span> ScalaRequest <span class="token keyword">extends</span> Actor <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">protected</span> <span class="token keyword">val</span> log<span class="token operator">:</span> LoggingAdapter <span class="token operator">=</span> Logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>context<span class="token punctuation">.</span>system<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
   <span class="token keyword">val</span> map<span class="token operator">:</span> mutable<span class="token punctuation">.</span>Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> Object<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> mutable<span class="token punctuation">.</span>HashMap<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> Object<span class="token punctuation">]</span>

  <span class="token keyword">override</span> <span class="token keyword">def</span> receive <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">case</span> SetRequest<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span>
      log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"received SetRequest - key: {} value: {}"</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
      map<span class="token punctuation">.</span>put<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
      sender<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!</span> Status<span class="token punctuation">.</span>Success

    <span class="token keyword">case</span> GetRequest<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span>
      log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"received GetRequest - key: {}"</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>
      <span class="token keyword">val</span> response<span class="token operator">:</span> Option<span class="token punctuation">[</span>Object<span class="token punctuation">]</span> <span class="token operator">=</span> map<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span>

      response <span class="token keyword">match</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">case</span> Some<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> sender<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!</span> x
        <span class="token keyword">case</span> None <span class="token keyword">=&gt;</span> sender<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!</span> Status<span class="token punctuation">.</span>Failure<span class="token punctuation">(</span><span class="token keyword">new</span> KeyNotFoundException<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

    <span class="token keyword">case</span> o <span class="token keyword">=&gt;</span> Status<span class="token punctuation">.</span>Failure<span class="token punctuation">(</span><span class="token keyword">new</span> ClassNotFoundException<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>


<span class="token keyword">case</span> <span class="token keyword">class</span> SetRequest<span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> value<span class="token operator">:</span> Object<span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> GetRequest<span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> KeyNotFoundException<span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Exception
</code></pre> 
<p>配置文件跟Java一样</p> 
<h4><a id="234_Actor_512"></a>2.3.4 客户端Actor处理</h4> 
<pre><code class="prism language-scala"><span class="token keyword">import</span> <span class="token namespace">akka<span class="token punctuation">.</span>actor<span class="token punctuation">.</span></span>ActorSystem
<span class="token keyword">import</span> <span class="token namespace">akka<span class="token punctuation">.</span>pattern<span class="token punctuation">.</span>ask</span>
<span class="token keyword">import</span> <span class="token namespace">akka<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Timeout

<span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>duration<span class="token punctuation">.</span></span>DurationInt
<span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>language<span class="token punctuation">.</span>postfixOps</span>

<span class="token comment">/**
 * @description:
 * @author: shu
 * @createDate: 2022/12/1 11:43
 * @version: 1.0
 */</span>
<span class="token keyword">class</span> SClient<span class="token punctuation">(</span>remoteAddress<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">private</span> <span class="token keyword">implicit</span> <span class="token keyword">val</span> timeout <span class="token operator">=</span> Timeout<span class="token punctuation">(</span><span class="token number">2</span> seconds<span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token keyword">implicit</span> <span class="token keyword">val</span> system <span class="token operator">=</span> ActorSystem<span class="token punctuation">(</span><span class="token string">"LocalSystem"</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token keyword">val</span> remoteDb <span class="token operator">=</span> system<span class="token punctuation">.</span>actorSelection<span class="token punctuation">(</span>
    <span class="token string-interpolation"><span class="token id function">s</span><span class="token string">"akka.tcp://akkademy@</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">remoteAddress</span></span><span class="token string">/user/akkademy-db"</span></span><span class="token punctuation">)</span>
  <span class="token keyword">def</span> set<span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> value<span class="token operator">:</span> Object<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    remoteDb <span class="token operator">?</span> SetRequest<span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">def</span> get<span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    remoteDb <span class="token operator">?</span> GetRequest<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token keyword">case</span> <span class="token keyword">class</span> SetRequest<span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> value<span class="token operator">:</span> Object<span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> GetRequest<span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> KeyNotFoundException<span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Exception
</code></pre> 
<pre><code class="prism language-scala"><span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>duration<span class="token punctuation">.</span></span>DurationInt
<span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span>Await
<span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>language<span class="token punctuation">.</span>postfixOps</span>

<span class="token comment">/**
 * @description:
 * @author: shu
 * @createDate: 2022/12/1 11:44
 * @version: 1.0
 */</span>

<span class="token keyword">object</span> Main <span class="token keyword">extends</span> App <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">val</span> client <span class="token operator">=</span> <span class="token keyword">new</span> SClient<span class="token punctuation">(</span><span class="token string">"127.0.0.1:2552"</span><span class="token punctuation">)</span>
  client<span class="token punctuation">.</span>set<span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> Integer<span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> futureResult <span class="token operator">=</span> client<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> result <span class="token operator">=</span> Await<span class="token punctuation">.</span>result<span class="token punctuation">(</span>futureResult<span class="token punctuation">,</span> <span class="token number">10</span>  seconds<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="235__569"></a>2.3.5 测试</h4> 
<p>注意：需要放在两个不一样的配置项目中</p> 
<ol><li>服务端项目启动，等待请求的到来，注意配置文件</li><li>客服端项目启动，发送AKKA请求给服务端</li><li>服务端收到客服端的请求，缓存请求数据，把缓存结果返回给客服端</li></ol>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eb4b71fd6cf9ee954b46f4653f21ce1f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java时间日期类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cf811e481609b2bf9dcc2c57197f1852/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">centOS7安装oracle</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>