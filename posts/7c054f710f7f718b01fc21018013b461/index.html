<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于STM32的环境监测系统设计与实现 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于STM32的环境监测系统设计与实现" />
<meta property="og:description" content="摘 要 当今，环境问题成为我们最关注的问题之一，环境中的各项数据如温度、湿度、光照度、PM2.5等关乎着我们的生活品质。随着人类社会的蓬勃发展，在人的生活条件逐渐便利的同时，也对环境造成了一定程度上的影响，这就需要对环境进行检测和治理，通过根据各地的实际情况不断的调整发展方向。本次的设计就是基于单片机的检测系统，对检测环境与治理有着重大的作用和意义。
本设计以单片机为核心，实时监测温度、湿度、光照度、PM2.5的值是否超出规定范围。要实现以上要求，首先需要对系统的硬件电路进行设计，选用合适的单片机作为核心和特定的传感器来获取温度、湿度、光照度、PM2.5的数值，然后对硬件部分和软件部分进行调试，达到数据显示基本正常和具有实时性的目的。本设计选择STM32F103单片机作为核心控制元件, 包括以下模块：液晶显示屏、PM2.5检测部分、温湿度检测部分、光敏电阻部分、电源电路等。
通过各个模块之间的相互配合，能够实时监测温度、湿度、光照度、PM2.5的参数，并把数据实时显示在显示屏上。本次设计的优点有：①实时性方面比较的好，因为可以通过延时函数的设计来决定每次采样数据的间隔时间；②使用时比较的方便，随开所用，不用做复杂的前置工作；③比较经济实惠，材料钱不需要花费太多。
关键词
STM32F103单片机；DHT11温湿度传感器；激光粉尘传感器;光敏电阻
目 录 第一章 绪论 1.1 研究背景及意义 1.2 现状分析 1.3 主要研究的内容 第二章 硬件方案 2.1 总体设计 2.2 STM32F103芯片 2.3 TFTLCD液晶显示屏幕 2.4 光敏电阻 2.5 温湿度传感器 2.6 PM2.5传感器 第三章 设计原理 3.1 整体程序处理 3.2 温湿度传感器取值 3.3 光敏电阻取值 3.4 PM2.5取值 第四章 硬件调试 4.1硬件线路的连接 4.2 温湿度调试 4.3 光照度调试 4.4 PM2.5调试 第五章 项目整合 第六章 总结 参考文献 附录A 本次设计的硬件电路图 附录B main 中的主要程序 绪论 1.1 研究背景及意义 环境问题已然成为了我们生活中最重要的问题之一，世界在快速发展的同时，也对环境造成了一定的负面影响，如PM2.5的超标，因此造成的大雾天气等。因此环境的各项数据，如温度、光照度、大气压强、湿度、PM2.5等逐渐引起重视，这些数据对环境的治理有着非常重要的意义，通过对这些数据的分析，我们可以根据各地的实际情况对环境或政策进行治理，环境问题因此可以得到缓解。同时这些数据也关乎到我们的生活质量，只有在适宜的环境中，我们才能发展的更好，社会才会更加繁荣，人们的生活才会更加美好。
1.2 现状分析 我们国家建设了中国环境监测总站用于环境的监控，在各行业部门也已建立起初具规模的环境监测体系;较大规模的环境监控系统在我国已经非常成熟，但规模较大，应用并不广泛，小规模、智能化的环境监控系统有待开发。
现在，我们国家环境监测仪的生产厂家有一百五十多家，而且年产值高达5亿元[3]。但我们国家的环境监测仪还不能适应我国环境监测工作发展的需要。而且我们国家生产的档次不是太高，大部分都是中低档的环境监测仪器，主要表现为：技术的档次有待提高，大部分都是低水平、重复生产，规模效益比较的低；产品质量较低，性能一般不稳定，而且一致性不好，使用寿命不长，引发故障率高；研究开发能力较低，而且研究投入较少，在线监测仪器的系统配套生产的能力较低，不能适应市场的需要。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/7c054f710f7f718b01fc21018013b461/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-20T21:32:21+08:00" />
<meta property="article:modified_time" content="2023-06-20T21:32:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于STM32的环境监测系统设计与实现</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div> 
 <h2 style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">摘  要</span></h2> 
 <p style="margin-left:.0001pt;text-align:center;"></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">当今，环境问题成为我们最关注的问题之一，环境中的各项数据如温度、湿度、光照度、PM2.5等关乎着我们的生活品质。随着人类社会的蓬勃发展，在人的生活条件逐渐便利的同时，也对环境造成了一定程度上的影响，这就需要对环境进行检测和治理，通过根据各地的实际情况不断的调整发展方向。本次的设计就是基于单片机的检测系统，对检测环境与治理有着重大的作用和意义。</span></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">本设计以单片机为核心，实时监测温度、湿度、光照度、PM2.5的值是否超出规定范围。要实现以上要求，首先需要对系统的硬件电路进行设计，选用合适的单片机作为核心和特定的传感器来获取温度、湿度、光照度、PM2.5的数值，然后对硬件部分和软件部分进行调试，达到数据显示基本正常和具有实时性的目的。本设计选择STM32F103单片机作为核心控制元件, 包括以下模块：液晶显示屏、PM2.5检测部分、温湿度检测部分、光敏电阻部分、电源电路等。</span></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">通过各个模块之间的相互配合，能够实时监测温度、湿度、光照度、PM2.5的参数，并把数据实时显示在显示屏上。本次设计的优点有：①实时性方面比较的好，因为可以通过延时函数的设计来决定每次采样数据的间隔时间；②使用时比较的方便，随开所用，不用做复杂的前置工作；③比较经济实惠，材料钱不需要花费太多。</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#0d0016;">关键词</span></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">STM32F103单片机；DHT11温湿度传感器；激光粉尘传感器;光敏电阻</span></p> 
 <p style="text-align:center;"></p> 
 <p style="margin-left:.0001pt;text-align:center;"></p> 
</div> 
<p></p> 
<div> 
 <h2 style="margin-left:.0001pt;text-align:center;"><a name="_Toc25404"></a><strong><strong><a name="_Toc31163"></a><a name="_Toc13532"><span style="color:#0d0016;">目</span></a></strong></strong><span style="color:#0d0016;"><strong>   </strong><strong><strong>录</strong></strong></span></h2> 
 <p style="margin-left:.0001pt;text-align:center;"></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><a href="#_Toc17159" rel="nofollow"><span style="color:#0d0016;"><strong><strong>第一章 绪论</strong></strong><strong> </strong></span></a></strong></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc22733" rel="nofollow"><span style="color:#0d0016;"><strong><strong>1.1 研究背景</strong></strong><strong><strong>及</strong></strong><strong><strong>意义</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc6605" rel="nofollow"><span style="color:#0d0016;"><strong><strong>1.2 现状分析</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc20163" rel="nofollow"><span style="color:#0d0016;"><strong><strong>1.3 </strong></strong><strong><strong>主要研究的内容</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><a href="#_Toc2862" rel="nofollow"><span style="color:#0d0016;"><strong><strong>第二章 硬件方案</strong></strong><strong> </strong></span></a></strong></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc14972" rel="nofollow"><span style="color:#0d0016;"><strong><strong>2.1 总体设计</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc23444" rel="nofollow"><span style="color:#0d0016;"><strong><strong>2.</strong></strong><strong><strong>2</strong></strong><strong><strong> STM32F</strong></strong><strong><strong>103</strong></strong><strong><strong>芯片</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc5431" rel="nofollow"><span style="color:#0d0016;"><strong><strong>2.</strong></strong><strong><strong>3 TFTLCD液晶显示屏幕</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc21436" rel="nofollow"><span style="color:#0d0016;"><strong><strong>2.</strong></strong><strong><strong>4</strong></strong><strong> </strong><strong><strong>光敏电阻</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc20302" rel="nofollow"><span style="color:#0d0016;"><strong><strong>2.5 温湿度传感器</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc2789" rel="nofollow"><span style="color:#0d0016;"><strong><strong>2.6 PM2.5传感器</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><a href="#_Toc4651" rel="nofollow"><span style="color:#0d0016;"><strong><strong>第三章 设计原理</strong></strong><strong> </strong></span></a></strong></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc16235" rel="nofollow"><span style="color:#0d0016;"><strong><strong>3.1 </strong></strong><strong><strong>整体程序处理</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc23273" rel="nofollow"><span style="color:#0d0016;"><strong><strong>3.2 </strong></strong><strong><strong>温湿度传感器取值</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc6496" rel="nofollow"><span style="color:#0d0016;"><strong><strong>3.3 光敏电阻取值</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc31506" rel="nofollow"><span style="color:#0d0016;"><strong><strong>3.4 PM2.5取值</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><a href="#_Toc20202" rel="nofollow"><span style="color:#0d0016;"><strong><strong>第四章 硬件调试</strong></strong><strong> </strong></span></a></strong></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc14347" rel="nofollow"><span style="color:#0d0016;"><strong><strong>4.1硬件线路的连接</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc8286" rel="nofollow"><span style="color:#0d0016;"><strong><strong>4.2 温湿度调试</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc18228" rel="nofollow"><span style="color:#0d0016;"><strong><strong>4.3 光照度调试</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:21pt;text-align:justify;"><a href="#_Toc4727" rel="nofollow"><span style="color:#0d0016;"><strong><strong>4.4  PM2.5调试</strong></strong><strong> </strong></span></a></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><a href="#_Toc5067" rel="nofollow"><span style="color:#0d0016;"><strong><strong>第五章 项目整合</strong></strong><strong> </strong></span></a></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><a href="#_Toc16164" rel="nofollow"><span style="color:#0d0016;"><strong><strong>第六章 总结</strong></strong><strong> </strong></span></a></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><a href="#_Toc6576" rel="nofollow"><span style="color:#0d0016;"><strong><strong>参考文献</strong></strong><strong> </strong></span></a></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><a href="#_Toc28194" rel="nofollow"><span style="color:#0d0016;"><strong><strong>附录</strong></strong><strong><strong>A </strong></strong><strong>本次</strong><strong>设计的硬件电路图</strong><strong> </strong></span></a></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><a href="#_Toc10589" rel="nofollow"><span style="color:#0d0016;"><strong><strong>附录</strong></strong><strong><strong>B</strong></strong><strong> main 中的主要程序</strong><strong> </strong></span></a></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;"></p> 
 <p style="margin-left:.0001pt;text-align:justify;"></p> 
</div> 
<p></p> 
<ul><li style="text-align:center;"> <h2><a name="_Toc17159"></a><span style="color:#0d0016;">绪论</span></h2> </li></ul> 
<h3 style="text-align:justify;"><a name="_Toc439882643"></a><strong><a name="_Toc439882620"></a><a name="_Toc439882771"></a><a name="_Toc439670868"></a><a name="_Toc524776181"></a><a name="_Toc18640"></a><a name="_Toc22733"></a><a name="_Toc4201"><span style="color:#0d0016;">1.1</span></a><span style="color:#0d0016;"> </span></strong><span style="color:#0d0016;"><strong>研究背景</strong><strong>及</strong><strong>意义</strong></span></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">环境问题已然成为了我们生活中最重要的问题之一，世界在快速发展的同时，也对环境造成了一定的负面影响，如PM2.5的超标，因此造成的大雾天气等。因此环境的各项数据，如温度、光照度、大气压强、湿度、PM2.5等逐渐引起重视，这些数据对环境的治理有着非常重要的意义，通过对这些数据的分析，我们可以根据各地的实际情况对环境或政策进行治理，环境问题因此可以得到缓解。同时这些数据也关乎到我们的生活质量，只有在适宜的环境中，我们才能发展的更好，社会才会更加繁荣，人们的生活才会更加美好。</span></p> 
<h3 style="text-align:justify;"><a name="_Toc524776182"></a><strong><a name="_Toc13962"></a><a name="_Toc6605"></a><a name="_Toc22181"><span style="color:#0d0016;">1.2 </span></a></strong><span style="color:#0d0016;"><strong>现状分析</strong></span></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">我们国家建设了中国环境监测总站用于环境的监控，在各行业部门也已建立起初具规模的环境监测体系;较大规模的环境监控系统在我国已经非常成熟，但规模较大，应用并不广泛，小规模、智能化的环境监控系统有待开发。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">现在，我们国家环境监测仪的生产厂家有一百五十多家，而且年产值高达5亿元[3]。但我们国家的环境监测仪还不能适应我国环境监测工作发展的需要。而且我们国家生产的档次不是太高，大部分都是中低档的环境监测仪器，主要表现为：技术的档次有待提高，大部分都是低水平、重复生产，规模效益比较的低；产品质量较低，性能一般不稳定，而且一致性不好，使用寿命不长，引发故障率高；研究开发能力较低，而且研究投入较少，在线监测仪器的系统配套生产的能力较低，不能适应市场的需要。</span></p> 
<h3 style="margin-left:.0001pt;text-align:justify;"><a name="_Toc31585"></a><strong><a name="_Toc20163"><span style="color:#0d0016;">1.3 </span></a></strong><span style="color:#0d0016;"><strong>主要研究的内容</strong></span></h3> 
<p style="margin-left:0pt;"><span style="color:#0d0016;">本次环境监测系统以STM32F103为核心，以温湿度传感器、光敏电阻、PM2.5传感器为输入，传感器在空气中接收模拟量，再通过单片机的数模转换，把从空气中接收到的模拟量转化成数据量，此时在进行进一步的处理，把数据量通过一定的计算转化为我们常见的密度值。最后通过代码将其表现出来，显示到显示屏上，进而起到对温度、湿度、光照、 PM2.5的检测作用。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<ul><li style="text-align:center;"> <h2><a name="_Toc29006"></a><a name="_Toc2862"><span style="color:#0d0016;">硬件方案</span></a></h2> </li></ul> 
<h3 style="text-align:justify;"><a name="_Toc14972"></a><strong><a name="_Toc17366"><span style="color:#0d0016;">2.1 总体设计</span></a></strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">本设计主要研究基于单片机的环境监测仪，采用STM32F103单片机为核心，温湿度传感器、PM2.5传感器、以及光敏电阻作为输入部分，液晶显示屏作为输出部分，以显示实时数据。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">所用器件包括STM32开发板以及温湿度传感器、PM2.5传感器，通过杜邦线将光敏电阻，DHT11温湿度传感器，GP2Y1010AU粉尘传感器连接起来。STM32F103分别从PM2.5模块,温湿度传感器模块，光照度检测模块获取实时的监测数据，通过特定的转换公式将其显示到LCD屏幕。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">硬件系统框图如图2.1所示：</span></p> 
<p style="margin-left:.0001pt;text-align:center;"></p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;"><img alt="" height="361" src="https://images2.imgbox.com/0e/31/tinCAvcb_o.png" width="582"></span></p> 
<p><span style="color:#0d0016;"> </span></p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">图2.1 硬件系统框图</span><a name="_Toc5155"></a><strong><a name="_Toc29804"></a></strong></p> 
<h3 style="margin-left:.0001pt;text-align:justify;"><a name="_Toc23444"></a><span style="color:#0d0016;"><strong>2.</strong><strong>2</strong><strong> STM32F</strong><strong>103</strong><strong>芯片</strong></span></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">整个系统最主要的部分是STM32单片机，也是中心部分，因为需要对控制器具有较高的需求，比如控制精度、好执行速度快、稳定性好以及高灵敏度，所以选择一个具有较高性能并且经济的单片机就很重要。所以此次选用是STM32F103ZET6。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">此芯片属于STM32F1系列的一种，出品的公司都是意法半导体公司，STM32F103的芯片内核是Cortex-M3[4]，是属于32位RAM控制器。内存的容量也十分的大，有521K的FLASH和64K的SRAM。而且芯片的外设功能十分的丰富十分的强大，例如定时器CAN，I2C，ADC，SPI，Timer，USB，UART等。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">STM32F103主频为72MHZ，其引脚有144个，但IO口个数只有112个处模拟通道外大部分的IO口能耐得住5V的电压。GPIO即通用输入输出端口，使用时通过软件来控制GPIO的使用，配置各种的输入输出的模式，从而实现和外部的信息交换等通信功能。对于GPIO的配置，此次的实验用的是库函数来配置，库函数比较的方便快捷，不用一直去查询STM32F103的手册。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">同时这次的设计还用到了ADC功能，STM32F103系列-般都有3个ADC，这些ADC 可以独立使用。A/D转换主要包括积分型、并行比较型、逐次逼近型，而STM32F1的AD逐次逼近型的模拟数字转换器。具有12位。它具有18个复用通道，来自2个内部源信号、16个外部源的信号都可以被测量。这些通道的 A/D转换可以单次、连续、扫描或间断模式执行。此次的ADC的执行模式我选择的是番茨执行模。ADC 的结果可以选择左对齐或右对齐两种方式,一般来说我们会选择右对齐。然后或存储在16位数据寄存器中。这些都可以在初始化ADC的时候进行配置。利用库函数来进行配置会比较的方便。此次的设计ADC就是用库函数来进行配置的。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">此次用的开发板如下：</span></p> 
<p style="margin-left:.0001pt;text-align:center;"></p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" height="407" src="https://images2.imgbox.com/db/8a/KFm6bDmC_o.png" width="409"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">图2.2 开发板实物图</span></p> 
<h3 style="margin-left:.0001pt;text-align:justify;"><a name="_Toc5431"></a><strong><a name="_Toc9090"><span style="color:#0d0016;">2.</span></a></strong><span style="color:#0d0016;"><strong>3 TFTLCD液晶显示屏幕</strong></span></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">TFTLCD就是薄膜晶体管液晶显示器。是一款非常实用的液晶显示屏幕，LCD屏一般用于家用电器，电脑成本低，可以做大屏显示,相对于OLED屏来说的话，功耗比较高,而且也需要背光板，TFT-LCD同时也被叫做真彩液晶显示器。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">此次选用的LCD屏的尺寸大小为2.8寸，工作电压为3.3V,分辨率为320*240RGB，色深为16位，103的LCD接口为8080并口，LCD的显示原理如下图：</span></p> 
<p style="margin-left:.0001pt;text-align:center;"></p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" height="151" src="https://images2.imgbox.com/64/e0/QsHpJzjf_o.png" width="484"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">图2.3 LCD显示原理</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">实物图和引脚说明如下：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">    </span><img alt="" height="263" src="https://images2.imgbox.com/8e/bb/PIqPUubN_o.png" width="182"><span style="color:#0d0016;">            </span><img alt="" height="259" src="https://images2.imgbox.com/6c/8a/Y4ttXIDr_o.png" width="224"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">      图2.4 LCD实物图                                    图2.5  LCD原理图</span><a name="_Toc24845"></a></p> 
<h3 style="margin-left:.0001pt;text-align:justify;"><a name="_Toc21436"></a><span style="color:#0d0016;"><strong>2.</strong><strong>4</strong><strong> </strong><strong>光敏电阻</strong></span></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">光敏电阻的工作原理是基于内光电效应，是用硫化隔或华硒化隔半导体材料制成的电阻器。光照强度越小，光敏电阻的阻值就愈大，随着光照强度的减少，电阻值会升高、亮电阻值可减低至10KΩ。其在无光照时，暗电阻一般可到达1MΩ，呈高阻状态，可见光敏电阻对光线非常敏感，本次选用的光敏电阻型号为GL3528光敏电阻，具有体积小，反应速度快，性能稳定等特点，具体特点如下表：</span></p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">表2.1光敏电阻参数</span></p> 
<table border="1" cellspacing="0" style="width:468.65pt;"><tbody><tr><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">型号</span></p> </td><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">限大电压</span></p> </td><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">限大功耗</span></p> </td><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">环境温度</span></p> </td><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">光谱峰值</span></p> </td><td style="vertical-align:top;width:56.3pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">亮电阻</span></p> </td><td style="vertical-align:top;width:56.3pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">暗电阻</span></p> </td><td style="vertical-align:top;width:74.8pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">响应时间</span></p> </td></tr><tr><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">GL3528</span></p> </td><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">100V</span></p> </td><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">50mW</span></p> </td><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">0~70℃</span></p> </td><td style="vertical-align:top;width:56.25pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">540nm</span></p> </td><td style="vertical-align:top;width:56.3pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">10~20kΩ</span></p> </td><td style="vertical-align:top;width:56.3pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">1MΩ</span></p> </td><td style="vertical-align:top;width:74.8pt;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">上升：30ms</span></p> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">下降：30ms</span></p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">此次的光敏电阻实物图如下：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">                   </span><img alt="" height="281" src="https://images2.imgbox.com/13/eb/bgB9gtW5_o.png" width="345"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">                                  图2.6 光敏电阻实物图        </span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><a name="_Toc24160"></a></p> 
<h3 style="margin-left:.0001pt;text-align:justify;"><a name="_Toc20302"></a><span style="color:#0d0016;"><strong>2.5 温湿度传感器</strong></span></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">此次的设计使用的温湿度传感器的名称为DHT11，它直接就输出的是已校准好的数字信号，因为其内部的8位单片机将其模拟信号转化为数字信号，数字采集功能和温湿度传感功能都比较先进精确，所以产品具有比较高的可靠性与长期稳定性，具有成本便宜、较强的抗干扰能力、信号传输距离长、响应时间短、校准比较精确等特点。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">DHT11湿度的测量范围是20%-90%RH，温度的测量范围是0~50℃</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">湿度的测量精度为±5%RH，温度的测量精度为±2℃，湿度的分辨率为1%RH，温度的分辨率为1℃。传感器内部的因为有NTC测温器件和电容式感湿器件，还有一个性能比较高的8位单片机与之相连接，所以非常的方便。DHT11在非常多的生活领域都很常见，例如家里的空调，汽车上，气象站，甚至是医疗方面。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p><br>  </p> 
<p><span style="color:#0d0016;">DHT11有四个引脚分别为VDD脚：供电引脚，供电范围为3.3~5.5V，NC脚：空脚悬空，DATA脚:单总线串行数据，GND脚：接地。实物图如下：</span></p> 
<p class="img-center"><img alt="" height="223" src="https://images2.imgbox.com/eb/a4/99X1DAjY_o.png" width="238"></p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">图2.7  DHT11实物图           </span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h3 style="margin-left:.0001pt;text-align:justify;"><a name="_Toc6589"></a><strong><a name="_Toc2789"><span style="color:#0d0016;">2.6 PM2.5传感器</span></a></strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">本次用的PM2.5传感器为GP2Y1010AU，是日本夏普公司生产出来的或承诺的传感器，在检测非常小的颗粒、例如香烟颗粒等，是非常有效果的，他是通过其检测到空气中的灰尘反射光然后依靠输出脉冲的高度来判断颗粒的浓度的，因为GP2Y1010AU内部具有一个发光二极管和一个对光比较灵敏的光电晶体管，两者成相对布置。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">该传感器具有很低的电流消耗最大为20毫安 ，正常情况下11毫安，其工作的电压在5-7V。输出是一个模拟电压，而且这个模拟电压和所测得粉尘浓度成正比，GP2Y1010AU敏感性非常好，为0.5V/0.1mg/m3。它的上面有四个管脚需要连接，分别是VCC、GND、PWM、OUT。VCC、GND分别连接STM32F103的VCC、GND。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">        </span></p> 
<p class="img-center"><img alt="" height="277" src="https://images2.imgbox.com/8c/49/c6rRXeIW_o.png" width="458"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">图2.8 PM2.5传感器模块</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<ul><li style="text-align:center;"> <h2><a name="_Toc4651"></a><a name="_Toc3606"><span style="color:#0d0016;">设计原理</span></a></h2> </li></ul> 
<h3 style="text-align:justify;"><a name="_Toc16235"></a><strong><a name="_Toc15469"><span style="color:#0d0016;">3.1 </span></a></strong><span style="color:#0d0016;"><strong>整体程序处理</strong></span></h3> 
<p style="margin-left:.0001pt;text-align:center;"></p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" height="505" src="https://images2.imgbox.com/d1/63/tBPVljBv_o.png" width="494"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;"><strong>图3.1整体流程图</strong></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">整体流程图如图3.1所示，在启动STM32F103后，先配置ADC，定时器等设置，初始化STM32，之后初始化LCD屏幕，接下来就可以处理数据了，接下来可以先处理温湿度传感器的数据，因为DHT11直接就输出的是数字量所以可以直接拿来用，而光敏电阻和PM2.5传感器则需要通过获取传感器的ADC的值，因为STM32的ADC是12位的，所示获取的数值的范围为0~4096，再在程序中通过一些特定的计算就可以将其转化为单位为LX和μg/m3的这些在我们生活中常见的单位。最后使用LCD的一些显示方法函数即可成功显示到LCD屏幕上。通过延时函数函数后再次进入获取参数阶段，以达到实时获取数据的目的。</span></p> 
<h3 style="text-align:justify;"><a name="_Toc24586"></a><strong><a name="_Toc524776188"></a><a name="_Toc23273"></a><a name="_Toc21304"><span style="color:#0d0016;">3.2 </span></a></strong><span style="color:#0d0016;"><strong>温湿度传感器取值</strong></span></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">DHT11与单片机连接如下图所示，GND连接地线，DATA线连接一个上拉电阻，VDD接电源，DATA用于STM32F103与DHT11之间的数据传输,把已经转换好的数字数据送入单片机中，数据分为小数部分和整数部分两部分，我们在此次的设计只用整数部分，而小数部分可以用于以后扩展使用。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">通过DATA导线传输的数据长度为为40bit，首先传输的数据是湿度的整数和小数位，两个都是8bit。然后传输的就是温度的整数和小数位，两个同样也是8bit，最后也是8bit的校验位。校验位是用来校验数据是否正确，具体就是将温湿度的整数位和小数位这4个8bit相加，如果结果等于8bit的校验位，则数据是正确有效的。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">STM32F103发送一次开始信号后,DHT11开始启动，等候主机开始信号结束后,DHT11发送回应信号，发出40bit长的数据,同时触发一次采集信号,获得的数据在DHT11的单面机中已经变成数字数据，所以可以直接使用。</span></p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">                  </span><img alt="" height="186" src="https://images2.imgbox.com/a7/7f/AjjddGJI_o.png" width="324"></p> 
<p style="text-align:center;"> </p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">图3.2  DHT11的管脚连接</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><a name="_Toc7576"></a><strong><a name="_Toc6496"><span style="color:#0d0016;">3.3 光敏电阻取值</span></a></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">光敏电阻在没有光照的情况下的阻值为1MΩ，所以串联一个1kΩ大小的电阻，接上3.3v电压，在有光照时测他们两个中间的电压，光敏电阻的阻值会随着光照的增加而减少，所以随着光照的增强，测定的电压会越来越小，用获取的电压计算出光敏电阻的电阻，电压U计算公式和光敏电阻阻值如下，设获取的ADC数值为X,光敏电阻阻值为Y。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;"><strong>U =  ( X / 4096 )* 3.3V               （3.1）</strong></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">利用串联电流相等原理可得：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;"><strong>Y</strong><strong> =  (U*1KΩ)/(3.3v-U)              （3.2）</strong></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">对着光敏电阻随光照阻值变化曲线即可获得光照度变化曲线如下，因为其为一个不规律的曲线，设光照的未知数为为L，所以其近似其公式为log Y= -log L + 3,将光敏电阻，阻值Y带入即可获得光照度的数值。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="343" src="https://images2.imgbox.com/50/b2/e3CLX5mK_o.png" width="242"><img alt="" height="248" src="https://images2.imgbox.com/f3/35/kAULL7Kk_o.png" width="289"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">     图3.3  阻值与光照的关系                                    图3.4  光谱响应特性</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><a name="_Toc30112"></a></p> 
<p style="margin-left:.0001pt;text-align:justify;"><a name="_Toc31506"></a><span style="color:#0d0016;"><strong>3.4 PM2.5取值</strong></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">通过GP2Y1010AU来获取模拟量，通过ADC转换把模拟量转化为数字量，通过对数字量的进一步处理转化成电压，通过公式的计算转化为浓度，显示在LCD上。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">GP2Y1010AU插上电源后1秒内会稳定，然后正常地运作，可以进行检出。因为ADC转换器是12位的，所以ADC的范围为0 ~4695,即AD_PM的值的范围为0 ~4695，根据GP2Y1010AU传感器的手册，计算公式如下：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;"> <strong>PM = 0.17*AD_PM - 0.1                 （3.3）</strong></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">此时运算出的结果是一次PM2.5的值，要想值比较的精确，可以进行多次的检测，然后取平均数即可。此次取30个数据来取值平均数作为一次PM2.5的结果。然后通过延时函数后再进行取30次数据取平均值的操作，以此来体现实时性。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<ul><li style="text-align:center;"> <h2><a name="_Toc20202"></a><a name="_Toc23995"><span style="color:#0d0016;">硬件调试</span></a></h2> </li></ul> 
<p style="margin-left:.0001pt;text-align:justify;"><a name="_Toc21442"></a><strong><a name="_Toc14347"><span style="color:#0d0016;">4.1硬件线路的连接</span></a></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">按照其设定好的原理图开始进行连接，用的导线是杜邦线，杜邦线可用于实验板的引脚扩展，无需焊接，非常的方便，将LCD屏幕插入单片机STM32F103的开发板上，将光敏电阻引出的模拟输入端口连接到单片机STM32F103芯片GPIO的PF8处。DHT11温湿度传感器的DATA线连接到GPIO的PG11处,最后是PM2.5传感器的模拟输入端口ANALOG连接到GPIO的PA0处，将DIGITAL连接到GPIO的PB1处，硬件电路连接完成。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><a name="_Toc8286"></a><strong><a name="_Toc10712"><span style="color:#0d0016;">4.2 温湿度调试</span></a></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">在不做任何处理的条件下，LCD屏幕温湿度显示如下图所示：</span></p> 
<p style="margin-left:.0001pt;text-align:center;"></p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" height="426" src="https://images2.imgbox.com/12/eb/IQADZfk1_o.png" width="319"></p> 
<p style="text-align:center;"> </p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">图4.1 温湿度正常情况时</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">此时对着温湿度传感器哈一口气后温湿度发生了变化，如下图所示：</span></p> 
<p style="margin-left:.0001pt;text-align:center;"></p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" height="355" src="https://images2.imgbox.com/23/f5/aNDBTyBK_o.png" width="266"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">图4.2 处理后的温湿度</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><a name="_Toc18228"></a><strong><a name="_Toc30085"><span style="color:#0d0016;">4.3 光照度调试</span></a></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">在不做任何处理情况下的光照度的值为图4.1所示，此时拿一个小手电筒照向光敏电阻，即可发现光照度显著增加，如下图所示：</span></p> 
<p style="margin-left:.0001pt;"><img alt="" height="322" src="https://images2.imgbox.com/50/64/d5v73QdG_o.png" width="242"></p> 
<p style="text-align:center;"> </p> 
<p style="margin-left:.0001pt;text-align:center;"></p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">图4.3 光照度处理过后</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><a name="_Toc4727"></a><strong><a name="_Toc1375"><span style="color:#0d0016;">4.4  PM2.5调试</span></a></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">在不做任何处理情况下的PM2.5的值为图4.1所示，此时点燃烟雾（已在有防火的条件下进行），让PM2.5传感器靠近烟雾，发现PM2.5浓度显著增加，如下图所示：</span></p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">              </span><img alt="" height="378" src="https://images2.imgbox.com/47/c0/MDmVwz6Y_o.png" width="318"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:center;"><span style="color:#0d0016;">4.4  PM2.5处理过后</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<ul><li style="text-align:center;"><a name="_Toc10014"></a><a name="_Toc5067"><span style="color:#0d0016;">项目整合</span></a></li></ul> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">因为LCD的屏幕显示的东西太过于简陋，可以稍加一些其他的东西润色一下，例如图片等，把其他的数据文字放到比较适当的位置，此时可用如下图所示的图片取模软件进行取模，软件及取模条件如下图5.1.1所示：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">    </span><img alt="" height="112" src="https://images2.imgbox.com/6e/6c/lBqDc67V_o.png" width="586"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">图5.1 取模软件</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">           </span><img alt="" height="344" src="https://images2.imgbox.com/78/44/ieKFhnZX_o.png" width="467"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">    </span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">图5.2取模软件设置条件</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">先选好要加入的图片，按照上图5.1.2所示进行配置，配置成功之后，点击保存按钮，即可生成文件，加入工程之后，在主函数中进行声明，声明过后即可在主函数中进行使用。此时主要是调用LCD屏幕的方法进行在LCD屏幕显示方法如下图所示：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="126" src="https://images2.imgbox.com/d9/87/GE5Gt4Kc_o.png" width="554"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">图5.3 显示图片的方法</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">在添加完图片之后，可以把其他的参数位置进行调整一下，以免被挡在图片的后面，加入图片调整文字后的效果如下图所示：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">         </span><img alt="" height="496" src="https://images2.imgbox.com/18/1e/Q4Wu33yQ_o.png" width="372"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">图5.4展示效果图</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<ul><li style="text-align:center;"> <h2><a name="_Toc25464"></a><a name="_Toc16164"><span style="color:#0d0016;">总结</span></a></h2> </li></ul> 
<p style="margin-left:.0001pt;text-align:justify;"><a name="_Toc27434"></a><span style="color:#0d0016;">本设计主要就是检测温度、湿度、光照度、PM2.5的数值，以此来对环境中的数值进行分析，对环境的监测和环境的治理有着非常大的意义，同时也让我对环境的现状以及一些关于环境的知识有了进一步 的了解。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">这次的设计用的是STM32F103作为主控制器，传感器用的是GP2Y1010AU粉尘传感器、光敏电阻、DHT11温湿度传感器，<span style="background-color:#ffffff;">结合硬件方案与软件编写</span><span style="background-color:#ffffff;">，设计出可以</span>检测温度、湿度、光照度、PM2.5在空气中的数值的功能。之所以选择DHT11温湿度传感器是因为DHT11温湿度传感器直接输出的是数据，我们只需要获取它的数据即可，非常的便捷快速。而GP2Y1010AU粉尘传感器和STM32F103在我以前的课程设计中有使用到，对两者比较的熟悉，所以自然而然的选择他们。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">该环境监测系统操作方便，给单片机烧录程序后，只需接上电源即可使用。通过延时函数，每隔一段时间就会从空气中获取相应的参数，并可以将其显示在显示屏幕上。要监测各个传感器获取的数据是否有效，需要先在不做任何操作的情况下观察各个传感器的值是否处于正常值的范围内，然后做如同第四章一样的调试，观察传感器是否能正常工作，如果结果和第四章结果相同，则数据有效。此次设计的不足之处在于由于没有成功的设计出当数据超出一定值时会发出警报或者显示一张图片等，今后会加强此方面的学习。</span></p> 
<p style="text-align:center;"><br><a name="_Toc4560"></a></p> 
<h2 style="margin-left:.0001pt;text-align:justify;"><a name="_Toc6908"></a><strong><strong><a name="_Toc28194"><span style="color:#0d0016;">附录</span></a></strong></strong><span style="color:#0d0016;"><strong><strong>A </strong></strong>本次设计的硬件电路图</span></h2> 
<p><img alt="" height="359" src="https://images2.imgbox.com/ef/2e/ErszYUnc_o.png" width="586"></p> 
<p><img alt="" height="125" src="https://images2.imgbox.com/e6/f8/8AbSFC1c_o.png" width="271"><img alt="" height="111" src="https://images2.imgbox.com/36/44/AqmQtOIU_o.png" width="151"><img alt="" height="102" src="https://images2.imgbox.com/4a/be/MdDsOg46_o.png" width="149"></p> 
<p> </p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">          光敏电阻                           PM2.5模块                温湿度模块</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="303" src="https://images2.imgbox.com/84/9d/ea6IiUUR_o.png" width="409"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">LCD显示屏</span></p> 
<h2 style="margin-left:.0001pt;text-align:justify;"><a name="_Toc10589"></a><span style="color:#0d0016;"><strong><strong>附录</strong></strong><strong><strong>B</strong></strong> main 中的主要程序</span></h2> 
<p></p> 
<pre><code class="language-cpp">#include "dht11.h"

#include "adc.h"

#include "pm25.h"

#include "usart.h"

#include "stdio.h"

extern const unsigned char gImage_MYX[106400];



char show_buff[30] = {0};

u32 light = 0;

u8 temperature;       

u8 humidity;

double pm = 0;

int main(void)

{  

delay_init();

NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);  

uart_init(115200);

LED_Init();

LCD_Init();//

MYADC_Init();

Adc_Init();

POINT_COLOR=RED;

    LCD_Clear(WHITE);

  LCD_ShowString(25,0,200,16,16,(u8 *)"Environmental monitoring");

  LCD_ShowString(95,20,200,16,16,(u8 *)"system");



LCD_Show_Photo(25,40,200,198, gImage_MYX);

while(DHT11_Init())

{

delay_ms(200);

  delay_ms(200);

}

while(1)

{  

light = Get_Adc3();//光照度

sprintf(show_buff,"light: %d   ",light);

LCD_ShowString(30,240,100,16,16,(u8 *)show_buff);



DHT11_Read_Data(&amp;temperature,&amp;humidity);

sprintf(show_buff,"temp: %dC ",temperature);温度

LCD_ShowString(130,240,100,16,16,(u8 *)show_buff);



sprintf(show_buff,"humi: %d%%",humidity);湿度

LCD_ShowString(30,265,100,16,16,(u8 *)show_buff);



pm = Get_GP2Y_Average(30);//PM2.5

sprintf(show_buff,"pm2.5: %3.1f ug/m3     ",pm);

LCD_ShowString(30,290,140,16,16,(u8 *)show_buff);



delay_ms(1000);

}

}</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d4f3b235895cf15d489f1b2851fe0987/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">async/await 函数到底要不要加 try catch ?</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ca5bf09c88ddf8d28ec8939bfcad8b5f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">kafka的原理及集群部署详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>