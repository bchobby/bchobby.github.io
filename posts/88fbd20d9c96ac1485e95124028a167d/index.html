<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>linux开发板物联网项目实战之环境检测学生毕业设计首选 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="linux开发板物联网项目实战之环境检测学生毕业设计首选" />
<meta property="og:description" content="stm32mp157开发板FS-MP1A是华清远见自主研发的一款高品质、高性价比的Linux&#43;单片机二合一的嵌入式教学级开发板。开发板搭载ST的STM32MP157高性能微处理器，集成2个Cortex-A7核和1个Cortex-M4 核，A7核上可以跑Linux操作系统，M4核上可以跑FreeRTOS、RT-Thread等实时操作系统。开发板搭配仿真器、显示屏、摄像头、资源扩展板等丰富的扩展模块，可拓展物联网、人工智能等相关技术学习，还可以拓展丰富的项目实战，非常贴合企业当下开发需求，是一款嵌入式Linux入门进阶必备开发板！
可学习技术：嵌入式Linux应用/系统/驱动开发、ARM裸机开发、Qt界面编程、STM32单片机、FreeRTOS、人工智能机器视觉等。其中ARM Cortex-A7裸机开发课程是华清远见独有特色课程，可关注：https://www.bilibili.com/video/BV1Xe4y1i7vm/，持续更新中。
14个Linux&#43;Qt综合项目案例，6个MP1A物联网拓展项目
公众号“华清远见在线实验室”，回复“mp157项目”，即可领取项目配套文档及源码。 Linux&#43;Qt综合项目案例：华清远见stm32mp157开发板优势特色部分，包括音乐播放器、智慧家庭、智能工业电表、智能出行助手、智能猫眼、环境监测、智能安防、智能语音识别等10余个项目案例，涉及家居、医疗、农业多种应用方向，在案例中使用了多种物联网和嵌入式技术，包括OT开发、linux应用开发、linux驱动开发、物联网云端接入、MQTT协议、json字符串等知识点。
基于Linux&#43;Qt的环境检测项目 项目功能介绍：
（1）设计有环境监测功能，通过温湿度、光照传感器实时采集环境温度、湿度、光照显示到 LCD 屏上。
（2）设计有设备控制功能，通过控制触摸屏来进行控制 3 个 LED 灯、风扇、蜂鸣器。
（3）设计智能检测功能，用户可以根据自己的需求修改智能检测的阈值，开启智能检测后，当环境达到阈值后会启动设备。比如设置温度阈值为 28 摄氏度，当环境温度达到 28 摄氏度时，会自动开启风扇。设置一级照明为 50lux，二级照明为 30lux，三级照明为 1lux，当光照强度小于 50lux 会开启一个 led 灯，小于 30lux 会开启 2 个 led 灯，当光照强度小于 1lux 时，3 个 led 灯会全部开启。
开发平台：
华清远见stm32mp157开发板豪华套餐（开发板&#43;仿真器&#43;五寸屏&#43;摄像头&#43;资源扩展板&#43;tf卡&#43;读卡器）
项目实战：
Qt 开发环境搭建 主机开发环境说明 1) 本文档主要介绍 linux 环境下的 Qt 程序开发；
2) 主机 Qt 版本为 5.14.1；
主机 Qt 环境搭建及使用 Qt Creator 安装 将 qt-creator-opensource-linux-x86_64-4.10.1.run（Qt 实验源码\工具软件） 复制到 ubuntu 主机中，可以采用共享文件夹的方式也可以使用 tfp方式将文 件存入家目录下的 Downloads 目录。我们需要在终端中赋予安装程序可执行的权限" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/88fbd20d9c96ac1485e95124028a167d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-03T11:32:30+08:00" />
<meta property="article:modified_time" content="2023-03-03T11:32:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">linux开发板物联网项目实战之环境检测学生毕业设计首选</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <p style="text-align:left;">stm32mp157开发板FS-MP1A是华清远见自主研发的一款高品质、高性价比的Linux+单片机二合一的嵌入式教学级开发板。开发板搭载ST的STM32MP157高性能微处理器，集成2个Cortex-A7核和1个Cortex-M4 核，A7核上可以跑Linux操作系统，M4核上可以跑FreeRTOS、RT-Thread等实时操作系统。开发板搭配仿真器、显示屏、摄像头、资源扩展板等丰富的扩展模块，可拓展物联网、人工智能等相关技术学习，还可以拓展丰富的项目实战，非常贴合企业当下开发需求，是一款嵌入式Linux入门进阶必备开发板！</p> 
 <p style="text-align:left;"> </p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">可学习技术</span>：嵌入式Linux应用/系统/驱动开发、ARM裸机开发、Qt界面编程、STM32单片机、FreeRTOS、人工智能机器视觉等。其中ARM Cortex-A7裸机开发课程是华清远见独有特色课程，可关注：<a class="kdocs-link" style="color:#0A6CFF;" href="https://www.bilibili.com/video/BV1Xe4y1i7vm/" rel="nofollow noopener noreferrer" target="_blank"><span class="kdocs-bold" style="font-weight:bold;">https://www.bilibili.com/video/BV1Xe4y1i7vm/</span></a>，持续更新中。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:404px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:48.019802%;height:0;"> 
    <img src="https://images2.imgbox.com/28/40/iaiUlS7M_o.png" style="margin-left:;display:block;width:404px;margin-top:-48.019802%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">14个Linux+Qt综合项目案例，6个MP1A物联网拓展项目</p> 
 <p style="text-align:left;"><span class="kdocs-color" style="color:#C21C13;"><span class="kdocs-bold" style="font-weight:bold;">公众号“华清远见在线实验室”，回复“mp157项目”，即可领取项目配套文档及源码。 </span></span></p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">Linux+Qt综合项目案例</span>：华清远见stm32mp157开发板优势特色部分，包括音乐播放器、智慧家庭、智能工业电表、智能出行助手、智能猫眼、环境监测、智能安防、智能语音识别等10余个项目案例，涉及家居、医疗、农业多种应用方向，在案例中使用了多种物联网和嵌入式技术，包括OT开发、linux应用开发、linux驱动开发、物联网云端接入、MQTT协议、json字符串等知识点。</p> 
 <h2 style="text-align:center;"><span class="kdocs-bold" style="font-weight:bold;">基于Linux+Qt的环境检测项目</span></h2> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">项目功能介绍：</span></p> 
 <p style="text-align:left;">（1）设计有环境监测功能，通过温湿度、光照传感器实时采集环境温度、湿度、光照显示到 LCD 屏上。</p> 
 <p style="text-align:left;">（2）设计有设备控制功能，通过控制触摸屏来进行控制 3 个 LED 灯、风扇、蜂鸣器。</p> 
 <p style="text-align:left;">（3）设计智能检测功能，用户可以根据自己的需求修改智能检测的阈值，开启智能检测后，当环境达到阈值后会启动设备。比如设置温度阈值为 28 摄氏度，当环境温度达到 28 摄氏度时，会自动开启风扇。设置一级照明为 50lux，二级照明为 30lux，三级照明为 1lux，当光照强度小于 50lux 会开启一个 led 灯，小于 30lux 会开启 2 个 led 灯，当光照强度小于 1lux 时，3 个 led 灯会全部开启。</p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">开发平台：</span></p> 
 <p style="text-align:left;">华清远见stm32mp157开发板豪华套餐（开发板+仿真器+五寸屏+摄像头+资源扩展板+tf卡+读卡器）</p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">项目实战：</span></p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">Qt 开发环境搭建</span></h3> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">主机开发环境说明</span></h4> 
 <p style="text-align:left;">1) 本文档主要介绍 linux 环境下的 Qt 程序开发；</p> 
 <p style="text-align:left;">2) 主机 Qt 版本为 5.14.1；</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">主机 Qt 环境搭建及使用</span></h3> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">Qt Creator 安装</span></h4> 
 <p style="text-align:left;">将 qt-creator-opensource-linux-x86_64-4.10.1.run（Qt 实验源码\工具软件） 复制到 ubuntu 主机中，可以采用共享文件夹的方式也可以使用 tfp方式将文 件存入家目录下的 Downloads 目录。我们需要在终端中赋予安装程序可执行的权限</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:466px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:7.2961373%;height:0;"> 
    <img src="https://images2.imgbox.com/ea/75/1SqMWyrZ_o.png" style="margin-left:;display:block;width:466px;margin-top:-7.2961373%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">我们可以使用图形化的文件管理器来查看</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:462px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:66.01732%;height:0;"> 
    <img src="https://images2.imgbox.com/36/81/qGNCIzQL_o.png" style="margin-left:;display:block;width:462px;margin-top:-66.01732%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">双击“qt-creator-opensource-linux-x86_64-4.10.1.run”图标运行安装程序。</p> 
 <p style="text-align:left;">出现如下界面：</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:446px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:72.421524%;height:0;"> 
    <img src="https://images2.imgbox.com/ed/90/qTAVRm77_o.png" style="margin-left:;display:block;width:446px;margin-top:-72.421524%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">等待程序验证完成后点击“Next”</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:452px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:69.91151%;height:0;"> 
    <img src="https://images2.imgbox.com/18/7d/gIozOp4P_o.png" style="margin-left:;display:block;width:452px;margin-top:-69.91151%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">这里我们需要登录或者注册一个账号，如果我们之前已经注册过直接登录就可以。如果没有注册过则需要新注册有一个账号后登录。这里笔者已经注册过账号，所以直接登录。 登录成功后出现如下界面，点击 Next</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:448px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:71.20536%;height:0;"> 
    <img src="https://images2.imgbox.com/da/73/wmt5ZTO4_o.png" style="margin-left:;display:block;width:448px;margin-top:-71.20536%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">这里选择安装路径</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:463px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:68.89849%;height:0;"> 
    <img src="https://images2.imgbox.com/21/17/dfxYGSTq_o.png" style="margin-left:;display:block;width:463px;margin-top:-68.89849%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">可以直接默认，Next</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:469px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:68.23028%;height:0;"> 
    <img src="https://images2.imgbox.com/21/fa/vqrBGfKo_o.png" style="margin-left:;display:block;width:469px;margin-top:-68.23028%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">这路选择安装的组件，直接默认即可</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:470px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:68.723404%;height:0;"> 
    <img src="https://images2.imgbox.com/82/23/S4sSAgLv_o.png" style="margin-left:;display:block;width:470px;margin-top:-68.723404%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">这里我们需要同意用户协议</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:472px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:67.79661%;height:0;"> 
    <img src="https://images2.imgbox.com/7b/b1/y69DfjOS_o.png" style="margin-left:;display:block;width:472px;margin-top:-67.79661%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">这个界面告诉我们安装完成后需要占用的空间。点击”Install”按钮后开始安装。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:468px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:68.16239%;height:0;"> 
    <img src="https://images2.imgbox.com/5a/76/87evn9MO_o.png" style="margin-left:;display:block;width:468px;margin-top:-68.16239%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">安装完成后出现如下界面</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:475px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:69.26316%;height:0;"> 
    <img src="https://images2.imgbox.com/79/1a/ene6hOYH_o.png" style="margin-left:;display:block;width:475px;margin-top:-69.26316%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">点击“Finish”按钮后将弹出 Qt Creator 主界面</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:495px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:57.777775%;height:0;"> 
    <img src="https://images2.imgbox.com/94/5d/8zeNy6Ad_o.png" style="margin-left:;display:block;width:495px;margin-top:-57.777775%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">点击“Cancel”按钮后即可正常使用</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">Qt5.14.1 安装</span></h4> 
 <p style="text-align:left;">复制到 qt-opensource-linux-x64-5.14.1.run（Qt 实验源码\工具软件）到 ubuntu 主机中，可以采用共享文件夹的方式也可以使用 tfp 方式将文件存入家目录下的 Downloads 目录。进入所在文件夹，先给执行权限</p> 
 <p style="text-align:left;">输入命令</p> 
 <p style="text-align:left;">chmod +x ./qt-opensource-linux-x64-5.14.1.run</p> 
 <p style="text-align:left;">安装在命令行输入</p> 
 <p style="text-align:left;">./qt-opensource-linux-x64-5.14.1.run</p> 
 <p style="text-align:left;">会有可视化引导安装，一直 next 就行了</p> 
 <p style="text-align:left;">在选择安装组件的时候要是不知道选择那些就全选了 大概有 4 个 G 左右</p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">下载 gcc 和 g++</span></p> 
 <p style="text-align:left;">sudo apt-get install gcc g++</p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">下载 cmake</span></p> 
 <p style="text-align:left;">sudo apt-get install cmake</p> 
 <p style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">下载链接库</span></p> 
 <p style="text-align:left;">sudo apt-get install libgl1-mesa-dev libglu1-mesa-dev</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">Qt Creator 配置</span></h4> 
 <p style="text-align:left;">1）配置 GCC</p> 
 <p style="text-align:left;">运行 QtCreator 后，依次点击"Tool"-&gt;"Options"，出现选项对话框，在左侧点击"Kits"，右 边选择"Compilers"标签。 检查有没有下图标注的 C++和 C ，般按上面步骤执行后都会有</p> 
 <p style="text-align:left;">点击右侧"Add"按钮，弹出下拉列表后，选择"GCC"的"C"</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:509px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:56.58153%;height:0;"> 
    <img src="https://images2.imgbox.com/03/98/pSW1p5T3_o.png" style="margin-left:;display:block;width:509px;margin-top:-56.58153%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">填写信息如下，"Name"为"Auto-GCC"，"Compiler path"点击旁边的"Browse.."按钮选择编译器的路径，例子中的路径是 “/usr/bin/gcc”</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:510px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:58.627453%;height:0;"> 
    <img src="https://images2.imgbox.com/a7/22/TZU5gmHZ_o.png" style="margin-left:;display:block;width:510px;margin-top:-58.627453%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">2）配置 G++</p> 
 <p style="text-align:left;">点击右侧"Add"按钮，弹出下拉列表后，选择"GCC"的"C++"，下面的文本框填写"Name" 为"Auto-G++"，"Compiler path"点击旁边的"Browse.."按钮选择编译器的路径，例子中的路径是" /usr/bin/g++"。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:517px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:67.698265%;height:0;"> 
    <img src="https://images2.imgbox.com/8d/cd/z3iOAn3b_o.png" style="margin-left:;display:block;width:517px;margin-top:-67.698265%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">填写完成后，点击"Apply"。</p> 
 <p style="text-align:left;">3）配置 qmake</p> 
 <p style="text-align:left;">选择"Qt Versions"标签，如果有下面红框中的文本，可以跳过下面步骤</p> 
 <p style="text-align:left;">如果没有，在右侧点击"Add..."</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:524px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:42.93893%;height:0;"> 
    <img src="https://images2.imgbox.com/68/c6/xbAFNatJ_o.png" style="margin-left:;display:block;width:524px;margin-top:-42.93893%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">会弹出 qmake 路径选择对话框，这里以"</p> 
 <p style="text-align:left;">/home/linux/Qt5.14.1/5.14.1/gcc_64/bin/qmake"为例子。 选择”qmake”文件后，点击"Open"按钮</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:530px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:31.132074%;height:0;"> 
    <img src="https://images2.imgbox.com/7d/73/AlTUxDAh_o.png" style="margin-left:;display:block;width:530px;margin-top:-31.132074%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">"Version name"改为" Qt %{Qt:Version} GCC"。然后点击"Apply"按钮。</p> 
 <p style="text-align:left;">4）配置 Kits</p> 
 <p style="text-align:left;">点击左侧"Kits"，右侧选择"Kits"标签。检查有没有下图红框选中的文本，如果有可以跳过下面步骤</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:528px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:57.386364%;height:0;"> 
    <img src="https://images2.imgbox.com/0d/f5/beIp2IPt_o.png" style="margin-left:;display:block;width:528px;margin-top:-57.386364%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">然后没有，点击 Add：</p> 
 <p style="text-align:left;">在弹出的对话框中"Name"为"Desktop"，"Device Type"选择"Desktop"选项, "Sysroot"选择目标设备的系统目录，"Compiler"选择之前配置的名称"Auto-GCC"和"Auto-G++"，"Qt version"选择之前配 置的名称"Qt 5.14.1GCC"，其它默认即可，最后点击"Apply"和"OK"按钮。</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">Qt Creator 新建工程</span></h4> 
 <p style="text-align:left;"><span class="kdocs-color" style="color:#C21C13;">注意：工程路径最好不要包含中文、特殊字符、空格等。</span></p> 
 <p style="text-align:left;">我们可以新建一个“qt”文件夹，该文件夹用作我们以后存放源代码。</p> 
 <p style="text-align:left;">打开 Qt Creator，在欢迎页面点击 “New”按钮，来新建一个工程。</p> 
 <p style="text-align:left;">在出现的新建项目窗口中，我们选则“Application”-&gt;“Qt Widgets</p> 
 <p style="text-align:left;">Application”，然后点击右下方“Choose…”按钮，来创建一个桌面 Qt 应用。</p> 
 <p style="text-align:left;">我们在这里设置项目介绍和源码位置，我们这里创建一个名为“HelloWorld”的示例项目，设置完成之后点击 next</p> 
 <p style="text-align:left;">直接点击 next</p> 
 <p style="text-align:left;">随后进行细节设置，主要设置要创建的源码文件的基本类信息，包括类名等。这里我们可以根据自己的项目特点进行设置。需要说明的一点就是基类的选择，这里基类有 QMainWindow、QWidget、QDialog 三种，它们的不同之处如下：</p> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>QMainWindow 类提供一个带有菜单条，工具条和一个状态条的主应用程序窗口。主窗口通常提供一个大的中央窗口部件，以及周围菜单，工具条，和一个状态栏。QMainWindow 窗口经常被继承，使得封装中央部件，菜单，工具条，状态栏等都变得很容易，当用户点击它的时候，相应的槽就会被调用；</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>QWidget 类是所有用户界面对象的基类，窗口部件是用户界面的一个基本单元，它从窗口系统接收鼠标，键盘和其他消息，并在屏幕上绘制自己。一个窗口部件可以被他的父窗口或者是其他窗口挡住一部分；</p></li></ul> 
 <ul><li style="margin-left:1.4em;list-style-type:disc;text-indent:0;"><p>QDialog 类是对话框窗口的基类，对话框窗口主要用于短期任务和用户进行短期通讯的顶级窗口，QDialog 可以是模态对话框或者是非模态对话框。QDialog 支持扩展并带有返回值，他们可以带有默认值；我们在这里选择 QDialog 类即可，点击 next 完成类信息设置。</p></li></ul> 
 <p style="text-align:left;">直接点击 next 按钮即可。</p> 
 <p style="text-align:left;">然后进行工具选择，该页面可以选择我们创建的工程可以使用的工具，选择想要使用的编译器模块，例如下图 。点击 next</p> 
 <p style="text-align:left;">最后我们设置汇总信息，如果不需要版本控制等功能，直接点击完成finish 即可。</p> 
 <p style="text-align:left;">随后我们就进入到了主界面，这时候 Qt 已经帮我们做好了一些准备工作，包括创建了一些文件，写好了一些前置代码等等。</p> 
 <p style="text-align:left;">我们可以点击左边 protect 栏，来查看我们的编译选项。</p> 
 <p style="text-align:left;">我们可以在左下角选择编译 Debug 版或者 Release 版，即调试版或发行版。</p> 
 <p style="text-align:left;">左下角绿色剪头是编译并运行，锤子是仅编译，我们可以直接点击绿色小箭头将我们导入的工程编译并运行起来。</p> 
 <p style="text-align:left;">点击运行按钮后，我们可以看到 HelloWorld 窗口运行起来了。</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">Qt Creator导入工程</span></h4> 
 <p style="text-align:left;">我们可以将已存在的 Qt 程序项目直接打开，这里以上一章节的HelloWorld 程序为例。首先我们确定源码存在的位置，如 HelloWorld 程序源码在 /home/linux/qt/helloworld 路径下点击欢迎页面的“Open” 按钮可以打开已有的工程</p> 
 <p style="text-align:left;">找到我们刚才解压好的源码，选择“helloworld.pro”文件并点击打开</p> 
 <p style="text-align:left;">接下来我们就可以进入到代码编辑界面了。</p> 
 <p style="text-align:left;">左上角是项目栏，点击项目名称左边的小箭头可以展开项目目录</p> 
 <p style="text-align:left;">我们可以点击左边项目栏，来查看我们的编译选项。需注意的是构建设置中的路径应与工程路径处于同级目录下。</p> 
 <p style="text-align:left;">我们可以在左下角选择编译 Debug 版或者 Release 版，即调试版或发行版。</p> 
 <p style="text-align:left;">左下角绿色剪头是编译并运行，锤子是仅编译，我们可以直接点击绿色小箭头将我们导入的工程编译并运行起来</p> 
 <p style="text-align:left;">点击运行按钮后，我们可以看到 HelloWorld 窗口运行起来了。</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">Qt Creator 文件说明</span></h4> 
 <p style="text-align:left;">通过上面两个章节，我们学习到了 Qt 程序的新建与导入的方法，也知道了Qt 会帮我们做一些基础工作，比如帮我们建立了一些文件，那么这些文件都是干什么用的呢？我们以HelloWorld 程序来说明一下。</p> 
 <p style="text-align:left;">以“.pro”为后缀名的文件，为 Qt 的项目管理文件，存储项目设置的文件；</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:566px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:46.81979%;height:0;"> 
    <img src="https://images2.imgbox.com/54/7b/dtpgEXev_o.png" style="margin-left:;display:block;width:566px;margin-top:-46.81979%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">“Qt += core gui”表示项目中加入 core gui 模块。core gui 是 Qt 用于GUI 设计的类库模块，如果创建的是控制台（console）应用程序，就不需要添加 core gui。</p> 
 <p style="text-align:left;">Qt 类库以模块的形式组织各种功能的类，根据项目涉及的功能需求，在项目中添加适当的类库模块支持。例如，如果项目中使用到了涉及数据库操作的类就需要用到 sql（数据库）模块，在 pro 文件中需要在后面加上 sql：</p> 
 <p style="text-align:center;">1 Qt += core gui sql</p> 
 <p style="text-align:left;">“greaterThan(QT_MAJOR_VERSION, 4): QT += widgets”，这是个条件执行语句，表示当 Qt 主版本大于 4 时，才加入 widgets 模块。</p> 
 <p style="text-align:left;">“TARGET = HelloWorld”表示生成的目标可执行文件的名称，即编译后生成的可执行文件是 HelloWorld.exe。</p> 
 <p style="text-align:left;">“TEMPLATE = app”表示项目使用的模板是 app，是一般的应用程序。</p> 
 <p style="text-align:left;">后面的 SOURCES、HEADERS、FORMS 记录了项目中包含的源程序文件、头文件和窗体文件（.ui 文件）的名称。这些文件列表是 Qt Creator 自动添加到项目管理文件里面的，用户不需要手动修改。当添加一个文件到项目，或从项目里删除一个文件时，项目管理文件里的条目会自动修改。</p> 
 <p style="text-align:left;">文件夹“Header”中，存放的是所设计的窗体类的头文件；</p> 
 <p style="text-align:left;">文件夹“Sources”中，存放着源码文件。main.cpp 是实现 main()函数的程序文件，HelloWorld.cpp 是 widget.h 里定义类的实现文件。C++中，任何窗体或界面组件都是用类封装的，一个类一般有一个头文件（.h 文件）和一个源程序文件（.cpp 文件）；</p> 
 <p style="text-align:left;">文件夹“Forms”中，存放着界面设计文件，“.ui”文件是一个 XML 格式存储的窗体上的元件及其布局的文件，双击项目文件目录树中的文件 ui，会打开一个集成在 Qt Creator 中的 Qt Designer 对窗体进行可视化设计；</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:442px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:51.357468%;height:0;"> 
    <img src="https://images2.imgbox.com/cf/81/6varYYNn_o.png" style="margin-left:;display:block;width:442px;margin-top:-51.357468%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">UI 设计器有以下一些功能区域：</p> 
 <p style="text-align:left;">组件面板：窗口左侧是界面设计组件面板，分为多个组，如 Layouts、Buttons、Display Widgets 等，界面设计的常见组件都可以在组件面板里找到。</p> 
 <p style="text-align:left;">中间主要区域是待设计的窗体。如果要将某个组件放置到窗体上时，从组件面板上拖放一个组件到窗体上即可。</p> 
 <p style="text-align:left;">Signals 和 Slots 编辑器与 Action 编辑器是位于待设计窗体下方的两个编辑器。Signals 和 Slots 编辑器用于可视化地进行信号与槽的关联，Action 编辑器用于可视化设计 Action。</p> 
 <p style="text-align:left;">布局和界面设计工具栏：窗口上方的一个工具栏，工具栏上的按钮主要实现布局和界面设计。</p> 
 <p style="text-align:left;">对象浏览器（Object Inspector）：窗口右上方是 Object Inspector，用树状视图显示窗体上各组件之间的布局包含关系，视图有两列，显示每个组件的对象名称（ObjectName）和类名称。</p> 
 <p style="text-align:left;">属性编辑器（Property Editor）：窗口右下方是属性编辑器，是界面设计时最常用到的编辑器。属性编辑器显示某个选中的组件或窗体的各种属性及其取值，可以在属性编辑器里修改这些属性的值。属性编辑器的内容分为两列，左侧为属性的名称，右侧为属性的值。属性又分为多个组，实际上表示了类的继承关系，位于下方的类属性组继承自位于上方的类属性组；</p> 
 <p style="text-align:left;">如果我们需要新建资源文件、源码文件等，可以在项目文件夹出点击鼠标右键，选择 Add New；如果我们有新的文件需要添加，可以在项目文件夹出点击鼠标右键，选择 Add Existing Files。</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">Qt Creator 帮助文档</span></h4> 
 <p style="text-align:left;">Qt 的帮助文档是伴随我们学习 Qt 开发的好伙伴。在 Qt 开发过程中，我们会面临图形接口使用的问题，它不像 C 语言那样就那么几个函数接口，图形接口的接口数量可以用海量来形容，常用的我们可能能记住，其它的就没有必要去记了，用到什么就去帮助文档查看用法是比较方便的。我们可以按 F1 按键，或通过上方导航栏的“help-&gt;contects”来进入帮助文档。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:466px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:49.141632%;height:0;"> 
    <img src="https://images2.imgbox.com/cd/27/4YHRXNLq_o.png" style="margin-left:;display:block;width:466px;margin-top:-49.141632%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">上方的前进后退按钮方便我们查看文档，如返回到上一步，返回到下一步。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:145px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:45.51724%;height:0;"> 
    <img src="https://images2.imgbox.com/28/45/3IlUl2SY_o.png" style="margin-left:;display:block;width:145px;margin-top:-45.51724%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">我们可以通过帮助文档来查看以下几个部分：类使用的相关介绍；</p> 
 <p style="text-align:left;">查看相关类的使用介绍，我们可以先进入到帮助文档，然后在左上角选择“Search”。笔者这里以 QWidget 类为例，输入我们想要查找的类的名字，然后双击查找结果来查看说明。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:366px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:39.617485%;height:0;"> 
    <img src="https://images2.imgbox.com/c7/55/5fUSIsFA_o.png" style="margin-left:;display:block;width:366px;margin-top:-39.617485%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:284px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:134.50705%;height:0;"> 
    <img src="https://images2.imgbox.com/80/6d/a7E1sV69_o.png" style="margin-left:;display:block;width:284px;margin-top:-134.50705%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">也可以先将鼠标移动到想要查询的类的位置，如图所示，将鼠标移动至“QWidget”处，然后按“F1”键，即可跳转到相应的帮助文档。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:411px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:59.367397%;height:0;"> 
    <img src="https://images2.imgbox.com/52/db/Mek0sEIs_o.png" style="margin-left:;display:block;width:411px;margin-top:-59.367397%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:404px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:48.019802%;height:0;"> 
    <img src="https://images2.imgbox.com/43/25/bw8RWey7_o.png" style="margin-left:;display:block;width:404px;margin-top:-48.019802%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">我们可以通过再按一次“F1”键来全窗口查看帮助文档，按“Esc”键可以退出。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:428px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:78.97196%;height:0;"> 
    <img src="https://images2.imgbox.com/43/12/Z0owKopk_o.png" style="margin-left:;display:block;width:428px;margin-top:-78.97196%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">部分常用的成员元素包括以下几项：</p> 
 <p style="text-align:left;">公有成员函数：操作部件属性的相关函数；</p> 
 <p style="text-align:left;">公有槽函数：Qt 类中已经定义好的槽函数，直接可与信号相连接；</p> 
 <p style="text-align:left;">信号：软中断，如按下按钮触发 pressed() 信号等；</p> 
 <p style="text-align:left;"> 保护成员函数：通常事件所对应的虚函数放在此处；</p> 
 <p style="text-align:left;">事件：常用事件，如操作鼠标触发的鼠标事件；</p> 
 <p style="text-align:left;">滚动鼠标滚轮，向下即可看到“Qwdget Class”类的相关说明了。</p> 
 <p style="text-align:left;">部分常用的成员元素包括以下几项：</p> 
 <p style="text-align:left;">公有成员函数：操作部件属性的相关函数；</p> 
 <p style="text-align:left;">公有槽函数：Qt 类中已经定义好的槽函数，直接可与信号相连接；</p> 
 <p style="text-align:left;">信号：软中断，如按下按钮触发 pressed() 信号等；</p> 
 <p style="text-align:left;">保护成员函数：通常事件所对应的虚函数放在此处；</p> 
 <p style="text-align:left;">事件：常用事件，如操作鼠标触发的鼠标事件；</p> 
 <p style="text-align:left;">滚动鼠标滚轮，向下即可看到“Qwdget Class”类的相关说明了。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:466px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:59.65665%;height:0;"> 
    <img src="https://images2.imgbox.com/9e/97/G1TXhLx8_o.png" style="margin-left:;display:block;width:466px;margin-top:-59.65665%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">1) 查看所用的部件的相应成员函数。</p> 
 <p style="text-align:left;">我们可以查找到该类所用部件的相应成员函数的使用方法、功能、参数、返回值等等，我们以“按钮”控件，即“QPushButton Class”类为例，我们通过索引搜索的方式，来找到这个类</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:402px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:55.22388%;height:0;"> 
    <img src="https://images2.imgbox.com/f8/32/mmoqFx1f_o.png" style="margin-left:;display:block;width:402px;margin-top:-55.22388%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">我们可以通过点击“Public Functions” 来查看“QPushButton”这个类中的成员函数。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:397px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:74.5592%;height:0;"> 
    <img src="https://images2.imgbox.com/da/54/u0swdM5s_o.png" style="margin-left:;display:block;width:397px;margin-top:-74.5592%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">这里以“QPushButton(const QString &amp;text, QWidget *parent =Q_NULLPTR)”为例，我们点击函数名字可以进入到函数详情中。我们可以看到相应的描述为：以“text”为显示内容，以“parent”为父对象，构造一个push 按钮。“text”“parent”为函数参数，由于是构造函数，所以此函数没有返回值。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:524px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:15.267175%;height:0;"> 
    <img src="https://images2.imgbox.com/e1/18/fRJokEnW_o.png" style="margin-left:;display:block;width:524px;margin-top:-15.267175%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">还有一些函数是继承自其它类的，例如“Public Functions”中有 21 个继承自“QAbstractButton”类的函数，我们点击“QAbstractButton”即可查看。击“QAbstractButton”即可查看</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:402px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:50.74627%;height:0;"> 
    <img src="https://images2.imgbox.com/4c/0d/ehi9a3or_o.png" style="margin-left:;display:block;width:402px;margin-top:-50.74627%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:345px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:162.89854%;height:0;"> 
    <img src="https://images2.imgbox.com/6b/3a/iH8a4I9u_o.png" style="margin-left:;display:block;width:345px;margin-top:-162.89854%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">同样我们可以点击相应的函数进入查看详情。如查看“voidsetText(const QString &amp;text)”。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:451px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:58.758316%;height:0;"> 
    <img src="https://images2.imgbox.com/80/0f/ZvsuAdFZ_o.png" style="margin-left:;display:block;width:451px;margin-top:-58.758316%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">2) 查看所用的部件的信号。</p> 
 <p style="text-align:left;">我们这里还是以“PushButton”为例，我们点击“Public Slots”。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:307px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:73.2899%;height:0;"> 
    <img src="https://images2.imgbox.com/ca/15/VVTBiZjM_o.png" style="margin-left:;display:block;width:307px;margin-top:-73.2899%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">可以看到“PushButton”本身有一个“void showMenu()”的信号，并且有很多继承自其他类的信号。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:349px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:44.69914%;height:0;"> 
    <img src="https://images2.imgbox.com/17/d6/ROZ5xLeq_o.png" style="margin-left:;display:block;width:349px;margin-top:-44.69914%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">一般来说我们用的“PushButton”的信号，最多的是用到其继承自基类“QAbstractButton”中的几个信号，分别是点击（按下后抬起）、按压（单按下）、释放（单抬起）等</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:313px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:74.76038%;height:0;"> 
    <img src="https://images2.imgbox.com/18/f5/wXhT3U9a_o.png" style="margin-left:;display:block;width:313px;margin-top:-74.76038%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">我们可以点击相应信号查看详情</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:380px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:22.105263%;height:0;"> 
    <img src="https://images2.imgbox.com/4e/40/DjMU31Jf_o.png" style="margin-left:;display:block;width:380px;margin-top:-22.105263%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">3) 查看所用的部件的事件(所对应的虚函数如何编写)。</p> 
 <p style="text-align:left;">部件常用事件主要在 “QWidget”中声明，选择“Events”即可查看相关说明。</p> 
 <p style="text-align:left;">每个事件都对应着事件函数。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:366px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:77.04918%;height:0;"> 
    <img src="https://images2.imgbox.com/f9/10/WSu5Ug3U_o.png" style="margin-left:;display:block;width:366px;margin-top:-77.04918%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">点击事件函数可查看详情</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">项目总体设计介绍</span></h3> 
 <p style="text-align:left;">（1）设计有环境监测功能，通过温湿度、光照传感器实时采集环境温度、湿度、光照显示到 LCD 屏上。</p> 
 <p style="text-align:left;">（2）设计有设备控制功能，通过控制触摸屏来进行控制 3 个 LED 灯、风扇、蜂鸣器。</p> 
 <p style="text-align:left;">（3）设计智能检测功能，用户可以根据自己的需求修改智能检测的阈值，开启智能检测后，当环境达到阈值后会启动设备。比如设置温度阈值为 28 摄氏度，当环境温度达到 28 摄氏度时，会自动开启风扇。设置一级照明为 50lux，二级照明为 30lux，三级照明为 1lux，当光照强度小于 50lux 会开启一个 led 灯，小于 30lux 会开启 2 个 led 灯，当光照强度小于 1lux 时，3 个 led 灯会全部开启</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">M4 部分实验原理</span></h3> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">M4 部分功能概述</span></h4> 
 <p style="text-align:left;">M4 核部分主要实现两个功能，首先可以接收 A7 核发送的指令，根据指令控制风扇、蜂鸣器以及 LED 灯工作，同时 M4 部分可以采集环境光、温湿度传感器数据，将采集数值打包成 JSON 字符串然后发送给 A7。另外，通过按键可以控制数码管显示采集的温湿度、环境光数据。</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">cubeIDE 功能配置</span></h4> 
 <p style="text-align:left;">首先打开 cubeIDE，创建一个新工程，进入 cubeMX 配置界面，因为需要实现 A7 与 M4 通信，需要配置 IPCC 与 OPENAMP 部分，如下图所示</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:456px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:64.03509%;height:0;"> 
    <img src="https://images2.imgbox.com/0b/f7/ptY5xDvZ_o.png" style="margin-left:;display:block;width:456px;margin-top:-64.03509%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:456px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:66.00877%;height:0;"> 
    <img src="https://images2.imgbox.com/67/10/uURuYAqe_o.png" style="margin-left:;display:block;width:456px;margin-top:-66.00877%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">配置 I2C1 用于采集温湿度、环境光传感器数据，这里分别选择 PF14、PF15 引脚用作 I2C1_SDA 和 I2C1_SCL 功能</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:449px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:68.15145%;height:0;"> 
    <img src="https://images2.imgbox.com/e7/28/blhG3qVB_o.png" style="margin-left:;display:block;width:449px;margin-top:-68.15145%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">因为需要用到数码管显示采集的传感器数值，这里通过 SPI 进行控制，使用 SPI 默认引脚，分别对 PE11、PE12、PE13 和 PE14 配置为 SPI4_NSS、SPI4_SCK、SPI4_MISO 和 SPI4_MOSI。切换到 SPI4 标签，勾选给“M4”，Mode”选择“Full-Duplex-Master”，使用硬件片选，选择“Hardware NSS</p> 
 <p style="text-align:left;">Output Signal”，其配置如下图所示</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:429px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:62.470863%;height:0;"> 
    <img src="https://images2.imgbox.com/d8/3a/3Rqnxk9n_o.png" style="margin-left:;display:block;width:429px;margin-top:-62.470863%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">扩展板 LED 灯对应的 GPIO 引脚分别为 PE8、PE10、PF10，这里左键点击设置为 GPIO_Output</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:447px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:64.653244%;height:0;"> 
    <img src="https://images2.imgbox.com/27/75/lC6Hc54Z_o.png" style="margin-left:;display:block;width:447px;margin-top:-64.653244%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">可以通过按键中断控制数码管显示的数值，这里配置扩展板的按键为PF9，如下所示</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:460px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:64.565216%;height:0;"> 
    <img src="https://images2.imgbox.com/4f/3a/zTKWTAuF_o.png" style="margin-left:;display:block;width:460px;margin-top:-64.565216%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">另外，这里还需要对刚才配置的 I/O 引脚设置“ Pin Reservation”给“ Cortex-M4”，否则 STM32CubeMX 不会生生成 GPIO 初始化相关代码。具体操作：在刚才选择的引脚上，鼠标右键选择“ Pin Reservation”-&gt;“ CortexM4”。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:443px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:43.340855%;height:0;"> 
    <img src="https://images2.imgbox.com/54/a8/ooeeBfjd_o.png" style="margin-left:;display:block;width:443px;margin-top:-43.340855%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">打开 GPIO 标签，对 PF9 引脚进行配置</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:454px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:65.85903%;height:0;"> 
    <img src="https://images2.imgbox.com/3e/70/8pNReB7C_o.png" style="margin-left:;display:block;width:454px;margin-top:-65.85903%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">实验中还用到了蜂鸣器与风扇，查看原理图得，对应管脚分别为 PB6 与PE9，分别配置为 TIM4 与 TIM1 功能，在本次实验中，系统默认时钟频率为64MHz，TIM 配置如下所示</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:472px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:59.957626%;height:0;"> 
    <img src="https://images2.imgbox.com/54/31/X2PnLXL0_o.png" style="margin-left:;display:block;width:472px;margin-top:-59.957626%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:470px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:57.021275%;height:0;"> 
    <img src="https://images2.imgbox.com/76/de/T3oK06l0_o.png" style="margin-left:;display:block;width:470px;margin-top:-57.021275%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style=""></p> 
 <p style="text-align:left;">如果实现开发板与电脑串口通信，这里可以通过 485 总线实现，即配置UART5，如下所示</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:462px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:53.246754%;height:0;"> 
    <img src="https://images2.imgbox.com/d9/71/IGrLclJP_o.png" style="margin-left:;display:block;width:462px;margin-top:-53.246754%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">另外，在本次实验中，A7 与 M4 数据通信和数码管显示相当于同时运行，可以通过配置 FreeRTOS 实现多任务运行。切换到中间件“Middleware”的“FREERTOS”，默认自动勾选给 M4 了，然后接口“Interface”选择</p> 
 <p style="">“CMSIS_V2”。为了运行其他任务，这里需要切换到“Tasks and Queues”标签，可以看到看到默认有个“defaultTask”任务，我们点击“Add”再新增一个任务，如图所示</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:444px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:61.936935%;height:0;"> 
    <img src="https://images2.imgbox.com/50/ff/t2z1f3FD_o.png" style="margin-left:;display:block;width:444px;margin-top:-61.936935%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">上述配置完成以后，还要注意一点，因为用到 FreeRTOS,这里我们不能为每一种外设生成头文件，如下所示</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:464px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:52.15517%;height:0;"> 
    <img src="https://images2.imgbox.com/7c/92/vZBaJZtr_o.png" style="margin-left:;display:block;width:464px;margin-top:-52.15517%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">配置完成以后保存，然后生成初始化代码，其间会出现如下提示框，选择“Yes”</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:484px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:34.710743%;height:0;"> 
    <img src="https://images2.imgbox.com/ea/26/QzTEZfko_o.png" style="margin-left:;display:block;width:484px;margin-top:-34.710743%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">代码实现</span></h3> 
 <p style="text-align:left;">生成初始代码以后，在 usart.c 文件 USER CODE BEGIN 1 与 USER CODE</p> 
 <p style="text-align:left;">END 1 之间添加 printf 的重定向函数，实现 UART5 与 printf 绑定。</p> 
 <p style="text-align:left;">#ifdef __GNUC__</p> 
 <p style="text-align:left;">#define PUTCHAR_PROTOTYPE int __io_putchar(int ch)</p> 
 <p style="text-align:left;">PUTCHAR_PROTOTYPE</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;"> HAL_UART_Transmit(&amp;huart5,(uint8_t*)&amp;ch,1,HAL_MAX_DELAY);</p> 
 <p style="text-align:left;">return ch;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">#endif </p> 
 <p style="text-align:left;">这里创建了一个 RPMSG tty 通道，用于实现 A7 与 M4 之间的数据传输</p> 
 <p style="text-align:left;">1、初始化 RPMSG tty 虚拟串口</p> 
 <p style="text-align:left;">printf("Virtual UART0 OpenAMP-rpmsg channel creation\r\n");</p> 
 <p style="text-align:left;"> if (VIRT_UART_Init(&amp;huart0) != VIRT_UART_OK) {<!-- --></p> 
 <p style="text-align:left;"> printf("VIRT_UART_Init UART0 failed.\r\n");</p> 
 <p style="text-align:left;"> Error_Handler();</p> 
 <p style="text-align:left;">} </p> 
 <p style="text-align:left;">2、注册回调函数以按通道接收消息 </p> 
 <p style="text-align:left;">if(VIRT_UART_RegisterCallback(&amp;huart0, VIRT_UART_RXCPLT_CB_ID,</p> 
 <p style="text-align:left;">VIRT_UART0_RxCpltCallback) != VIRT_UART_OK)</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> Error_Handler();</p> 
 <p style="text-align:left;"> }</p> 
 <p style="text-align:left;">3、虚拟串口回调函数</p> 
 <p style="text-align:left;">M4 接收到数据以后，将会调用该回调函数，需要将接收的数据复制到用户</p> 
 <p style="text-align:left;">内存，修改接收标志位，通知用户完成数据接收。</p> 
 <p style="text-align:left;">void VIRT_UART0_RxCpltCallback(VIRT_UART_HandleTypeDef *huart)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">printf("Msg received on VIRTUAL UART0 channel: %s \n\r", (char *)</p> 
 <p style="text-align:left;">huart-&gt;pRxBuffPtr);</p> 
 <p style="text-align:left;"> /* copy received msg in a variable to sent it back to master processor</p> 
 <p style="text-align:left;">in main infinite loop*/</p> 
 <p style="text-align:left;"> VirtUart0ChannelRxSize = huart-&gt;RxXferSize &lt; MAX_BUFFER_SIZE?</p> 
 <p style="text-align:left;">huart-&gt;RxXferSize : MAX_BUFFER_SIZE-1;</p> 
 <p style="text-align:left;"> memcpy(VirtUart0ChannelBuffRx, huart-&gt;pRxBuffPtr,</p> 
 <p style="text-align:left;">VirtUart0ChannelRxSize);</p> 
 <p style="text-align:left;">VirtUart0RxMsg = SET;</p> 
 <p style="text-align:left;">｝</p> 
 <p style="text-align:left;">添加driver_si7006.c文件，编写温湿度数据采集函数</p> 
 <p style="text-align:left;">uint8_t SI7006_Init(void)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">HAL_I2C_Init(&amp;hi2c1);</p> 
 <p style="text-align:left;">SI7006_WriteByte(SI7006CMD_RESET);</p> 
 <p style="text-align:left;">return 0;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">uint8_t SI7006_WriteByte(uint8_t reg)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint8_t write_data = reg;</p> 
 <p style="text-align:left;">if(HAL_I2C_Master_Transmit(&amp;hi2c1, SI7006_ADDR | SI7006_W ,</p> 
 <p style="text-align:left;">(uint8_t*)&amp;write_data, 1, 300) != HAL_OK)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">Error_Handler();</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">while (HAL_I2C_GetState(&amp;hi2c1) != HAL_I2C_STATE_READY);</p> 
 <p style="text-align:left;">return 0;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">uint16_t SI7006_ReadWord(uint8_t reg)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint16_t read_data = 0;</p> 
 <p style="text-align:left;">if(HAL_I2C_Master_Transmit(&amp;hi2c1, SI7006_ADDR | SI7006_W ,</p> 
 <p style="text-align:left;">(uint8_t*)&amp;reg, 1, 300) != HAL_OK) //发送命令</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">Error_Handler();</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">while (HAL_I2C_GetState(&amp;hi2c1) != HAL_I2C_STATE_READY);</p> 
 <p style="text-align:left;">if(HAL_I2C_Master_Receive(&amp;hi2c1, SI7006_ADDR | SI7006_R ,</p> 
 <p style="text-align:left;">(uint8_t*)&amp;read_data, 2, 300) != HAL_OK) //接收 word 数据</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">Error_Handler();</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;"> return read_data;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">uint16_t SI7006_Read_Data(uint16_t cmd)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint16_t data = 0,data_low = 0,data_high = 0;</p> 
 <p style="text-align:left;">data = SI7006_ReadWord(cmd); //采集温湿度</p> 
 <p style="text-align:left;">data_low = (data &amp; 0xff); //进行高低字节转换</p> 
 <p style="text-align:left;">data_high = (data &gt;&gt; 8) &amp; 0xff;</p> 
 <p style="text-align:left;"> data = (data_low &lt;&lt; 8) + data_high;</p> 
 <p style="text-align:left;">return data;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">uint16_t SI7006_Readhum(void)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint16_t hum = 0;</p> 
 <p style="text-align:left;">hum = SI7006_Read_Data(SI7006CMD_RH_HOLD);</p> 
 <p style="text-align:left;">hum = (125*hum/65536 - 6);</p> 
 <p style="text-align:left;">return hum;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">uint16_t SI7006_Readtem(void)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint16_t tem = 0;</p> 
 <p style="text-align:left;">tem = SI7006_Read_Data(SI7006CMD_TEMP_HOLD);</p> 
 <p style="text-align:left;">tem = ((17572*tem)/65536 - 4685);</p> 
 <p style="text-align:left;">return tem;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">添加 driver_ap3216.c 文件，编写环境光数据采集函数</p> 
 <p style="text-align:left;">uint8_t AP3216_Init(void)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint8_t ret_value = 0;</p> 
 <p style="text-align:left;">AP3216_WriteOneByte(SYS_CONFIG_ADDR, SYS_SW_RESET);</p> 
 <p style="text-align:left;">HAL_Delay(50);</p> 
 <p style="text-align:left;">AP3216_WriteOneByte(SYS_CONFIG_ADDR, SYS_ALS_ACT);</p> 
 <p style="text-align:left;">HAL_Delay(50);</p> 
 <p style="text-align:left;">ret_value = AP3216_ReadOneByte(SYS_CONFIG_ADDR);</p> 
 <p style="text-align:left;">if(ret_value != SYS_ALS_ACT)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">printf("read error \n");</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">printf("\r I2C Configuration register: 0x%x \n", SYS_CONFIG_ADDR);</p> 
 <p style="text-align:left;">printf("\r I2C Configuration value: 0x%x \n", SYS_ALS_ACT);</p> 
 <p style="text-align:left;">printf("\r I2C Read configuration value: 0x%x \n", ret_value);</p> 
 <p style="text-align:left;">return 0;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">uint8_t AP3216_WriteOneByte(uint8_t reg, uint8_t data)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint16_t write_data = reg | (data&lt;&lt;8)</p> 
 <p style="text-align:left;">if(HAL_I2C_Master_Transmit(&amp;hi2c1, AP3216_ADDR | AP3216_W ,</p> 
 <p style="text-align:left;">(uint8_t*)&amp;write_data, 2, 300) != HAL_OK)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">Error_Handler();</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">while (HAL_I2C_GetState(&amp;hi2c1) != HAL_I2C_STATE_READY);</p> 
 <p style="text-align:left;">return 0;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">uint8_t AP3216_ReadOneByte(uint8_t reg)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint8_t read_data = 0;</p> 
 <p style="text-align:left;">if(HAL_I2C_Master_Transmit(&amp;hi2c1, AP3216_ADDR | AP3216_W ,</p> 
 <p style="text-align:left;">(uint8_t*)&amp;reg, 1, 300) != HAL_OK)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">Error_Handler();</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">while (HAL_I2C_GetState(&amp;hi2c1) != HAL_I2C_STATE_READY);</p> 
 <p style="text-align:left;">if(HAL_I2C_Master_Receive(&amp;hi2c1, AP3216_ADDR | AP3216_R ,</p> 
 <p style="text-align:left;">(uint8_t*)&amp;read_data, 1, 300) != HAL_OK)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">Error_Handler();</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;"> return read_data;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">uint16_t AP3216_Read_ALS_Data()</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint8_t als_l = 0, als_h = 0;</p> 
 <p style="text-align:left;">uint16_t data;</p> 
 <p style="text-align:left;">als_l = AP3216_ReadOneByte(ALS_DATA_LOW);</p> 
 <p style="text-align:left;">als_h = AP3216_ReadOneByte(ALS_DATA_HIGH);</p> 
 <p style="text-align:left;">data = (als_h&lt;&lt;8) | (als_l);</p> 
 <p style="text-align:left;">return data;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">添加 driver_m74hc.c 文件，编写数码管显示函数</p> 
 <p style="text-align:left;">uint8_t num[10] = {0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};</p> 
 <p style="text-align:left;">uint8_t rw_595_Register(uint8_t reg,uint8_t data)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;"> uint8_t txdata[2] = {reg, data};</p> 
 <p style="text-align:left;"> if(HAL_SPI_Transmit(&amp;hspi4, txdata ,2,300) != HAL_OK) //发送数据</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> Error_Handler();</p> 
 <p style="text-align:left;"> }</p> 
 <p style="text-align:left;"> return 0;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">void M74HC595_ReadDataTest(uint16_t data,uint8_t sign)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">uint8_t data1,data2, data3,data4;</p> 
 <p style="text-align:left;">data1 = data/1000;</p> 
 <p style="text-align:left;">data2 = data%1000/100;</p> 
 <p style="text-align:left;">data3 = data%100/10;</p> 
 <p style="text-align:left;">data4 = data%10;</p> 
 <p style="text-align:left;">num[data1] = (num[data1] &amp; 0x7f);</p> 
 <p style="text-align:left;"> rw_595_Register(0X01,num[data1]);</p> 
 <p style="text-align:left;"> HAL_Delay(1);</p> 
 <p style="text-align:left;"> if(sign == 0) //sign = 1 为整数， = 0 为小数</p> 
 <p style="text-align:left;"> num[data2] = (num[data2] | 0x80);</p> 
 <p style="text-align:left;"> else</p> 
 <p style="text-align:left;"> num[data2] = (num[data2] &amp; 0x7f);</p> 
 <p style="text-align:left;"> rw_595_Register(0X02,num[data2]);</p> 
 <p style="text-align:left;">HAL_Delay(1);</p> 
 <p style="text-align:left;">num[data3] = (num[data3] &amp; 0x7f);</p> 
 <p style="text-align:left;"> rw_595_Register(0X04,num[data3]);</p> 
 <p style="text-align:left;"> HAL_Delay(1);</p> 
 <p style="text-align:left;"> num[data4] = (num[data4] &amp; 0x7f);</p> 
 <p style="text-align:left;"> rw_595_Register(0X08,num[data4]);</p> 
 <p style="text-align:left;"> HAL_Delay(1);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">添加 driver_pwm.c 文件，编写风扇与蜂鸣器控制函数</p> 
 <p style="text-align:left;">void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;"> if(htim-&gt;Instance==TIM4) //beep</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> __HAL_TIM_SET_COMPARE(&amp;htim4,TIM_CHANNEL_1,9999);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;"> if(htim-&gt;Instance==TIM1) //fan</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> __HAL_TIM_SET_COMPARE(&amp;htim1,TIM_CHANNEL_1,level *</p> 
 <p style="text-align:left;">3000);</p> 
 <p style="text-align:left;"> }</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">void TIM4_PWM_START(void)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;"> if(HAL_TIM_Base_Start_IT(&amp;htim4) != HAL_OK)</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> Error_Handler();</p> 
 <p style="text-align:left;"> }</p> 
 <p style="text-align:left;"> HAL_TIM_PWM_Start(&amp;htim4,TIM_CHANNEL_1);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">void TIM4_PWM_STOP(void)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;"> if(HAL_TIM_Base_Start_IT(&amp;htim4) != HAL_OK)</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> Error_Handler();</p> 
 <p style="text-align:left;"> }</p> 
 <p style="text-align:left;"> HAL_TIM_PWM_Stop(&amp;htim4,TIM_CHANNEL_1);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">void TIM1_PWM_START(void)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;"> if(HAL_TIM_Base_Start_IT(&amp;htim1) != HAL_OK)</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> Error_Handler();</p> 
 <p style="text-align:left;"> }</p> 
 <p style="text-align:left;">HAL_TIM_PWM_Start(&amp;htim1,TIM_CHANNEL_1);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">void TIM1_PWM_STOP(void)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;"> if(HAL_TIM_Base_Start_IT(&amp;htim1) != HAL_OK)</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> Error_Handler();</p> 
 <p style="text-align:left;"> }</p> 
 <p style="text-align:left;"> HAL_TIM_PWM_Stop(&amp;htim1,TIM_CHANNEL_1);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">在 StartDefaultTask（） 任务中实现 A7 与 M4 的数据传输，在 StartTask02</p> 
 <p style="text-align:left;">（） 任务中实现控制数码管显示采集的传感器数值，相关代码如下 </p> 
 <p style="text-align:left;">void StartDefaultTask(void *argument)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">/* USER CODE BEGIN 5 */</p> 
 <p style="text-align:left;">printf("Virtual UART0 OpenAMP-rpmsg channel creation\r\n");</p> 
 <p style="text-align:left;">if (VIRT_UART_Init(&amp;huart0) != VIRT_UART_OK) {<!-- --></p> 
 <p style="text-align:left;">printf("VIRT_UART_Init UART0 failed.\r\n");</p> 
 <p style="text-align:left;">Error_Handler();</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">if(VIRT_UART_RegisterCallback(&amp;huart0, VIRT_UART_RXCPLT_CB_ID,</p> 
 <p style="text-align:left;">VIRT_UART0_RxCpltCallback) != VIRT_UART_OK)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">printf("callback 0 error \n");</p> 
 <p style="text-align:left;">Error_Handler();</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">AP3216_Init();</p> 
 <p style="text-align:left;">SI7006_Init();</p> 
 <p style="text-align:left;">/* Infinite loop */</p> 
 <p style="text-align:left;">for(;;)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">OPENAMP_check_for_message();</p> 
 <p style="text-align:left;">if (VirtUart0RxMsg)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">VirtUart0RxMsg = RESET;</p> 
 <p style="text-align:left;">usr = cJSON_CreateObject();</p> 
 <p style="text-align:left;">#if 1</p> 
 <p style="text-align:left;">json = cJSON_Parse((char *)VirtUart0ChannelBuffRx);</p> 
 <p style="text-align:left;">json_led1 = cJSON_GetObjectItem(json,"led1");</p> 
 <p style="text-align:left;">json_led2 = cJSON_GetObjectItem(json,"led2");</p> 
 <p style="text-align:left;">json_led3 = cJSON_GetObjectItem(json,"led3");</p> 
 <p style="text-align:left;">json_beep = cJSON_GetObjectItem(json,"beep");</p> 
 <p style="text-align:left;">json_fan = cJSON_GetObjectItem(json,"fan");</p> 
 <p style="text-align:left;">if( strcmp((char*)json_led3-&gt;string,"led3") == 0)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">printf("led1 light \n");</p> 
 <p style="text-align:left;">if(json_led3-&gt;valueint == 1)</p> 
 <p style="text-align:left;">HAL_GPIO_WritePin(GPIOE,</p> 
 <p style="text-align:left;">GPIO_PIN_8,GPIO_PIN_SET);</p> 
 <p style="text-align:left;">else</p> 
 <p style="text-align:left;">HAL_GPIO_WritePin(GPIOE,</p> 
 <p style="text-align:left;">GPIO_PIN_8,GPIO_PIN_RESET);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">else if( strcmp((char*)json_led2-&gt;string,"led2") == 0)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">printf("led2 light \n");</p> 
 <p style="text-align:left;">if(json_led2-&gt;valueint == 1)</p> 
 <p style="text-align:left;">HAL_GPIO_WritePin(GPIOF,</p> 
 <p style="text-align:left;">GPIO_PIN_10,GPIO_PIN_SET);</p> 
 <p style="text-align:left;">else</p> 
 <p style="text-align:left;">HAL_GPIO_WritePin(GPIOF,</p> 
 <p style="text-align:left;">GPIO_PIN_10,GPIO_PIN_RESET);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">else if( strcmp((char*)json_led1-&gt;string,"led1") == 0)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">printf("led1 light \n");</p> 
 <p style="text-align:left;">if(json_led1-&gt;valueint == 1)</p> 
 <p style="text-align:left;">HAL_GPIO_WritePin(GPIOE,</p> 
 <p style="text-align:left;">GPIO_PIN_10,GPIO_PIN_SET);</p> 
 <p style="text-align:left;">else</p> 
 <p style="text-align:left;">HAL_GPIO_WritePin(GPIOE,</p> 
 <p style="text-align:left;">GPIO_PIN_10,GPIO_PIN_RESET);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">else if( strcmp((char*)json_beep-&gt;string,"beep") == 0)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">printf("beep work \n");</p> 
 <p style="text-align:left;">if(json_beep-&gt;valueint == 1)</p> 
 <p style="text-align:left;">TIM4_PWM_START();</p> 
 <p style="text-align:left;">else</p> 
 <p style="text-align:left;">TIM4_PWM_STOP();</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">else if( strcmp((char*)json_fan-&gt;string,"fan") == 0)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">printf("fan work \n");</p> 
 <p style="text-align:left;">switch(json_fan-&gt;valueint)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">case 1 :</p> 
 <p style="text-align:left;">case 2 :</p> 
 <p style="text-align:left;">case 3:</p> 
 <p style="text-align:left;">level = json_fan-&gt;valueint;</p> 
 <p style="text-align:left;">TIM1_PWM_START();</p> 
 <p style="text-align:left;">break;</p> 
 <p style="text-align:left;">case 0:</p> 
 <p style="text-align:left;">TIM1_PWM_STOP();</p> 
 <p style="text-align:left;">break;</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">#endif</p> 
 <p style="text-align:left;">value_als = AP3216_Read_ALS_Data();</p> 
 <p style="text-align:left;">value_tem = SI7006_Readtem();</p> 
 <p style="text-align:left;">value_hum = SI7006_Readhum();</p> 
 <p style="text-align:left;">cJSON_AddNumberToObject(usr,"als",value_als);</p> 
 <p style="text-align:left;">cJSON_AddNumberToObject(usr,"tem",value_tem);</p> 
 <p style="text-align:left;">cJSON_AddNumberToObject(usr,"hum",value_hum);</p> 
 <p style="text-align:left;">out = cJSON_Print(usr);</p> 
 <p style="text-align:left;">printf("the out: %s \n",out);</p> 
 <p style="text-align:left;">strcpy((char *)BuffTx,out);</p> 
 <p style="text-align:left;">if( VIRT_UART_Transmit(&amp;huart0, BuffTx, strlen((const char</p> 
 <p style="text-align:left;">*)BuffTx)) != VIRT_UART_OK)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;">printf("transmit error \n");</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">memset(BuffTx, 0 ,strlen((const char *)BuffTx));</p> 
 <p style="text-align:left;">cJSON_Delete(usr);</p> 
 <p style="text-align:left;">memset(VirtUart0ChannelBuffRx, 0 ,VirtUart0ChannelRxSize);</p> 
 <p style="text-align:left;">cJSON_Delete(json);</p> 
 <p style="text-align:left;">cJSON_Delete(json_led1);</p> 
 <p style="text-align:left;">cJSON_Delete(json_led2);</p> 
 <p style="text-align:left;">cJSON_Delete(json_led3);</p> 
 <p style="text-align:left;">cJSON_Delete(json_beep);</p> 
 <p style="text-align:left;">cJSON_Delete(json_fan);</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">/* USER CODE END 5 */</p> 
 <p style="text-align:left;">}</p> 
 <p style="text-align:left;">void StartTask02(void *argument)</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;"> /* USER CODE BEGIN StartTask02 */</p> 
 <p style="text-align:left;"> /* Infinite loop */</p> 
 <p style="text-align:left;"> for(;;)</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> switch(vol_cur)</p> 
 <p style="text-align:left;"> {<!-- --></p> 
 <p style="text-align:left;"> case 1:</p> 
 <p style="text-align:left;"> M74HC595_ReadDataTest(value_als,1);</p> 
 <p style="text-align:left;"> break;</p> 
 <p style="text-align:left;"> case 2:</p> 
 <p style="text-align:left;"> M74HC595_ReadDataTest(value_tem,0);</p> 
 <p style="text-align:left;"> break;</p> 
 <p style="text-align:left;"> case 3:</p> 
 <p style="text-align:left;"> M74HC595_ReadDataTest(value_hum,0);</p> 
 <p style="text-align:left;"> break;</p> 
 <p style="text-align:left;"> }</p> 
 <p style="text-align:left;"> }</p> 
 <p style="text-align:left;"> /* USER CODE END StartTask02 */</p> 
 <p style="text-align:left;">} </p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">M4 部分调试、执行</span></h4> 
 <p style="text-align:left;">程序编译没问题以后，点击“debug”下载调试，会将生成的 elf 文件下载到开发板/lib/fireware/目录下</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:415px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:40.0%;height:0;"> 
    <img src="https://images2.imgbox.com/55/9b/NcvwpRS4_o.png" style="margin-left:;display:block;width:415px;margin-top:-40.0%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">进入内核终端下，查看对应目录下文件，如下所示</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:419px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:21.24105%;height:0;"> 
    <img src="https://images2.imgbox.com/13/31/r6D4UAWt_o.png" style="margin-left:;display:block;width:419px;margin-top:-21.24105%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">在/usr/local/projects/ 目录下，可以看到含有所创工程名的目录</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:400px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:18.75%;height:0;"> 
    <img src="https://images2.imgbox.com/5b/44/GlbGhMvY_o.png" style="margin-left:;display:block;width:400px;margin-top:-18.75%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">进入目录下，其包含文件如图所示</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:380px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:11.842105%;height:0;"> 
    <img src="https://images2.imgbox.com/35/30/vXQwWZXY_o.png" style="margin-left:;display:block;width:380px;margin-top:-11.842105%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">此时执行 ./fw_cortex_m4.sh start便可以启动 M4 程序。</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">源码分析</span></h3> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">环境监测模块和智能检测模块</span></h4> 
 <p style="text-align:left;">启动 m4 程序后会生成一个串口设备，m4 程序采集温湿度、环境光照信息。将采集到的数据写入到串口，a7 通过实时读取串口的数据，对数据进行解析、计算获得温湿度和光照的数值，再使用信号的方式传给主线程，实时显示到 UI 界面上，实现环境的温湿度和光照的监测。</p> 
 <p style="text-align:left;">使用 sqlite3 数据库进行存储用户设置的温度开启风扇的阈值、照明等级。用户每次改变阈值后都会存储到数据库里，当关闭程序后，下次启动会从数据库读取上次保存的数值，不用每次都重新设置阈值，更加人性化。</p> 
 <p style="text-align:left;">如果开启了智能检测，每次采集到数据后会跟用户设置的阈值进行比较，如果采集的温度大于设置的温度阈值，就会自动开启风扇；如果设置一级照明为 50lux，二级照明为 30lux，三级照明为 1lux，当光照强度小于 50lux 会开启一个 led 灯，小于 30lux 会开启 2 个 led 灯，当光照强度小于 1lux 时，3 个led 灯会全部开启。从而实现智能检测的功能</p> 
 <h4 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">设备控制模块</span></h4> 
 <p style="text-align:left;">只需要向相应的设备文件写入数据就能实现对 LED 灯、风扇、蜂鸣器的控制。在 QT 程序中，只需点击按键后触发 clicked 信号，进入相应的槽函数，向串口设备文件写入数据，M4 程序对数据进行采集，根据数据的不同，通过实现对设备的控制，核心代码如下</p> 
 <p style="text-align:left;">void MainWindow::led1_on_btnSlot()</p> 
 <p style="text-align:left;">{<!-- --></p> 
 <p style="text-align:left;"> QString ctrl ="{\"led1\":1}";</p> 
 <p style="text-align:left;"> thread_collentdata.ctrlEnv = false;</p> 
 <p style="text-align:left;"> write(fd, ctrl.toUtf8(), ctrl.length());</p> 
 <p style="text-align:left;"> qDebug()&lt;&lt;"write fd:"&lt;&lt;fd&lt;&lt;" success"&lt;&lt;" data = "&lt;&lt;ctrl;</p> 
 <p style="text-align:left;"> ui-&gt;pushButton-&gt;setEnabled(true);</p> 
 <p style="text-align:left;">}</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">设备树编译</span></h3> 
 <p style="text-align:left;">使用 M4 程序进行数据采集的时候，因为 A7 和 M4 有冲突，所以需要重新编译设备树文件。详细参考【FS-MP1A 开发教程】中 50.5 linux 源码编译章节</p> 
 <p style="text-align:left;">1. 进入在镜像中拿到的 linux 源码下的 dts 路径下：</p> 
 <p style="text-align:left;">linux@ubuntu:~cd linux/fsmp1a-linux-5.4.31/arch/arm/boot/dts</p> 
 <p style="text-align:left;">2. 新建设备树文件</p> 
 <p style="text-align:left;">linux@ubuntu:~/linux/fsmp1a-linux-5.4.31/arch/arm/boot/dts$ cp stm32mp157a-fsmp1aextended-rgb070.dts stm32mp157a-fsmp1a-extended-noi2c1-rgb070.dts</p> 
 <p style="text-align:left;">3. 修改复制的文件，将 i2c1 节点关闭</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:494px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:48.38057%;height:0;"> 
    <img src="https://images2.imgbox.com/7b/09/HqniHiFk_o.png" style="margin-left:;display:block;width:494px;margin-top:-48.38057%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">4. 修改 Makefile</p> 
 <p style="text-align:left;">linux@ubuntu:~/linux/fsmp1a-linux-5.4.31/arch/arm/boot/dts$ vi Makefile</p> 
 <p style="text-align:left;">加入以下内容。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:494px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:46.356274%;height:0;"> 
    <img src="https://images2.imgbox.com/3b/ae/uz2LEnSU_o.png" style="margin-left:;display:block;width:494px;margin-top:-46.356274%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">5.进入内核顶层目录编译</p> 
 <p style="text-align:left;">linux@ubuntu:~/linux/fsmp1a-linux-5.4.31$ make dtbs</p> 
 <p style="text-align:left;">6. 拷贝编译好的设备树文件到开发板</p> 
 <p style="text-align:left;">linux@ubuntu:~/linux/fsmp1a-linux-5.4.31$scparch/arm/boot/dts/stm32mp157a-fsmp1a</p> 
 <p style="text-align:left;">extended-noi2c1-rgb070.dtb <a class="kdocs-link" style="color:#0A6CFF;" href="mailto:root@192.168.10.130" rel="nofollow noopener noreferrer" target="_blank">root@192.168.10.130</a>:/boot</p> 
 <p style="text-align:left;">7. 修改默认启动选项</p> 
 <p style="text-align:left;">root@fsmp1a:~# vi /boot/mmc1_extlinux/stm32mp157a-fsmp1a-extended_extlinux.conf</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:464px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:65.08621%;height:0;"> 
    <img src="https://images2.imgbox.com/4d/39/fxLlryEg_o.png" style="margin-left:;display:block;width:464px;margin-top:-65.08621%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">8. 重启开发板</p> 
 <p style="text-align:left;">选择后，即可载入设备树文件。</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:478px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:33.054394%;height:0;"> 
    <img src="https://images2.imgbox.com/9e/69/ZfScPPPY_o.png" style="margin-left:;display:block;width:478px;margin-top:-33.054394%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">源码路径【8_环境检测\实验源码\8_EnvironmentalTest】</p> 
 <h3 style="text-align:left;"><span class="kdocs-bold" style="font-weight:bold;">注意事项</span></h3> 
 <p style="text-align:left;">1.在开发板运行时，需要导入中文字库，否则会因为识别不了中文。将【8_环境检测\工具软件\wqy-zenhei-0.9.47-nightlybuild.tar.gz 或wqy-zenhei-0.8.38-1.tar.gz】复制到 ubuntu 下。并使用 scp 命令将文件拷贝到开发板的 usr/share/fonts 目录下，使用 tar 命令解压后即可。</p> 
 <p style="text-align:left;"> linux@ubuntu:~$ scp wqy-zenhei-0.8.38-1.tar.gz</p> 
 <p style="text-align:left;"><a class="kdocs-link" style="color:#0A6CFF;" href="mailto:root@192.168.10.128" rel="nofollow noopener noreferrer" target="_blank"><span class="kdocs-bold" style="font-weight:bold;">root@192.168.10.128</span></a><span class="kdocs-bold" style="font-weight:bold;">:/usr/share/fonts/</span></p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:460px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:14.130435%;height:0;"> 
    <img src="https://images2.imgbox.com/fa/1d/X5IuYQQE_o.png" style="margin-left:;display:block;width:460px;margin-top:-14.130435%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">2.如果使用 mipi 五寸屏运行此项目，需要进行屏幕旋转以适应屏幕，具体</p> 
 <p style="text-align:left;">步骤如下：</p> 
 <p style="text-align:left;">在/etc/profile.d/qt-eglfs.sh 添加环境变量如下</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:495px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:19.19192%;height:0;"> 
    <img src="https://images2.imgbox.com/b5/dd/cbo5OH4D_o.png" style="margin-left:;display:block;width:495px;margin-top:-19.19192%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:484px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:57.85124%;height:0;"> 
    <img src="https://images2.imgbox.com/8a/ca/a2Y9TWGz_o.png" style="margin-left:;display:block;width:484px;margin-top:-57.85124%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">下面变量的 event0 设备需要填实际的触摸屏设备</p> 
 <div class="kdocs-line-container" style="display:flex;justify-content:center;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:482px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:10.373444%;height:0;"> 
    <img src="https://images2.imgbox.com/40/39/AVVc5APc_o.png" style="margin-left:;display:block;width:482px;margin-top:-10.373444%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:left;">这里即填 event0</p> 
 <p style="text-align:left;">export QT_QPA_EGLFS_ROTATION=90</p> 
 <p style="text-align:left;">export QT_QPA_EGLFS_NO_LIBINPUT=1</p> 
 <p style="text-align:left;">export</p> 
 <p style="text-align:left;">QT_QPA_EVDEV_TOUCHSCREEN_PARAMETERS=/dev/input/event0:rotate=90</p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3387aeba154a276e6b3eb0ce5cd24e26/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Rsyslog系统日志管理，解决/var/log/message文件过大问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7e9df175e8ab8ba67ea2758b9ccc85ad/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">history查看历史命令，并显示运行时间</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>