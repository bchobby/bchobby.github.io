<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL经典100问 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL经典100问" />
<meta property="og:description" content="目录
常规篇
1、说一下数据库的三大范式？ 2、只查询一条数据，但是也执行非常慢，原因一般有哪些？
3、count(*)、count(0)、count(id)实现方式的区别？
4、误删数据怎么办？
5、drop、truncate 和 delete 的区别
6、MySQL大表查询为什么不会爆内存？
7、深度分页（超大分页）怎么处理?
8、日常开发中你是怎么优化SQL的？
9、MySQL 的并发连接与并发查询什么区别？
10、MySQL更新字段值为原来的值内部是怎么操作呢？
11、datetime和timestamp有什么区别？
12、事务的隔离级别有哪些？
13、在 MySQL 中有两个 kill 命令
索引篇
1、索引分类有哪些？
2、聚集索引和非聚集索引有什么区别？
3、InnoDB 为什么设计B&#43;树，而不是B-Tree，Hash，二叉树，红黑树？
4、讲一讲聚簇索引与非聚簇索引？
5、非聚簇索引一定会回表查询吗？
6、讲一讲MySQL的最左前缀原则？
7、什么是索引下推？
8、Innodb为什么要用自增id作为主键？
9、事务ACID特性的实现原理？
10、MyISAM和InnoDB实现B树索引方式的区别是什么？
11、索引有哪些分类？
12、有哪些场景会导致索引失效？
方案篇
1、有一个未分库分表的系统，如何设计才可以让系统动态切换到分库分表上？
2、如何设计可以动态扩容缩容的分库分表方案？ 原理篇
1、一条 MySQL 语句执行步骤是什么样的？
2、order by 排序内部原理是什么样的？
3、MVCC 实现原理？
4、change buffer是什么，有何作用？
5、MySQL是如何保证数据不丢失?
6、为什么删除了表，表文件的大小还是没变？
7、binlog三种格式对比
8、MySQL加锁规则
9、什么是脏读、不可重复读、幻读呢？
10、MySQL都有哪些锁呢?像上面那样子进行锁定岂不是有点阻碍并发效率了?
框架篇
1、Mysql 主从复制原理的是啥？
2、Mysql主从复制同步方式有哪些？
3、Mysql主从同步延时产生原因?怎么优化？
4、Mysql主从同步延时产生原因?怎么优化？
5、主库出问题如何完成主从库切换?
6、bin log/redo log/undo log是什么？
常规篇 1、说一下数据库的三大范式？ 第一范式：确保每列保持原子性；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/a91a6192c4908a59cb28bde08f0b96b3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-28T15:01:51+08:00" />
<meta property="article:modified_time" content="2022-05-28T15:01:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL经典100问</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%B8%B8%E8%A7%84%E7%AF%87-toc" style="margin-left:0px;"><a href="#%E5%B8%B8%E8%A7%84%E7%AF%87" rel="nofollow">常规篇</a></p> 
<p id="1%E3%80%81%E8%AF%B4%E4%B8%80%E4%B8%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F%EF%BC%9F%C2%A0-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E8%AF%B4%E4%B8%80%E4%B8%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F%EF%BC%9F%C2%A0" rel="nofollow">1、说一下数据库的三大范式？ </a></p> 
<p id="2%E3%80%81%E5%8F%AA%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%BD%86%E6%98%AF%E4%B9%9F%E6%89%A7%E8%A1%8C%E9%9D%9E%E5%B8%B8%E6%85%A2%EF%BC%8C%E5%8E%9F%E5%9B%A0%E4%B8%80%E8%88%AC%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F-toc" style="margin-left:80px;"><a href="#2%E3%80%81%E5%8F%AA%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%BD%86%E6%98%AF%E4%B9%9F%E6%89%A7%E8%A1%8C%E9%9D%9E%E5%B8%B8%E6%85%A2%EF%BC%8C%E5%8E%9F%E5%9B%A0%E4%B8%80%E8%88%AC%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F" rel="nofollow">2、只查询一条数据，但是也执行非常慢，原因一般有哪些？</a></p> 
<p id="3%E3%80%81count(*)%E3%80%81count(0)%E3%80%81count(id)%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F-toc" style="margin-left:80px;"><a href="#3%E3%80%81count%28*%29%E3%80%81count%280%29%E3%80%81count%28id%29%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F" rel="nofollow">3、count(*)、count(0)、count(id)实现方式的区别？</a></p> 
<p id="4%E3%80%81%E8%AF%AF%E5%88%A0%E6%95%B0%E6%8D%AE%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F-toc" style="margin-left:80px;"><a href="#4%E3%80%81%E8%AF%AF%E5%88%A0%E6%95%B0%E6%8D%AE%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F" rel="nofollow">4、误删数据怎么办？</a></p> 
<p id="5%E3%80%81drop%E3%80%81truncate%20%E5%92%8C%20delete%20%E7%9A%84%E5%8C%BA%E5%88%AB-toc" style="margin-left:80px;"><a href="#5%E3%80%81drop%E3%80%81truncate%20%E5%92%8C%20delete%20%E7%9A%84%E5%8C%BA%E5%88%AB" rel="nofollow">5、drop、truncate 和 delete 的区别</a></p> 
<p id="6%E3%80%81MySQL%E5%A4%A7%E8%A1%A8%E6%9F%A5%E8%AF%A2%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E4%BC%9A%E7%88%86%E5%86%85%E5%AD%98%EF%BC%9F-toc" style="margin-left:80px;"><a href="#6%E3%80%81MySQL%E5%A4%A7%E8%A1%A8%E6%9F%A5%E8%AF%A2%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E4%BC%9A%E7%88%86%E5%86%85%E5%AD%98%EF%BC%9F" rel="nofollow">6、MySQL大表查询为什么不会爆内存？</a></p> 
<p id="7%E3%80%81%E6%B7%B1%E5%BA%A6%E5%88%86%E9%A1%B5%EF%BC%88%E8%B6%85%E5%A4%A7%E5%88%86%E9%A1%B5%EF%BC%89%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86%3F-toc" style="margin-left:80px;"><a href="#7%E3%80%81%E6%B7%B1%E5%BA%A6%E5%88%86%E9%A1%B5%EF%BC%88%E8%B6%85%E5%A4%A7%E5%88%86%E9%A1%B5%EF%BC%89%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86%3F" rel="nofollow">7、深度分页（超大分页）怎么处理?</a></p> 
<p id="8%E3%80%81%E6%97%A5%E5%B8%B8%E5%BC%80%E5%8F%91%E4%B8%AD%E4%BD%A0%E6%98%AF%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96SQL%E7%9A%84%EF%BC%9F-toc" style="margin-left:80px;"><a href="#8%E3%80%81%E6%97%A5%E5%B8%B8%E5%BC%80%E5%8F%91%E4%B8%AD%E4%BD%A0%E6%98%AF%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96SQL%E7%9A%84%EF%BC%9F" rel="nofollow">8、日常开发中你是怎么优化SQL的？</a></p> 
<p id="9%E3%80%81MySQL%20%E7%9A%84%E5%B9%B6%E5%8F%91%E8%BF%9E%E6%8E%A5%E4%B8%8E%E5%B9%B6%E5%8F%91%E6%9F%A5%E8%AF%A2%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F-toc" style="margin-left:80px;"><a href="#9%E3%80%81MySQL%20%E7%9A%84%E5%B9%B6%E5%8F%91%E8%BF%9E%E6%8E%A5%E4%B8%8E%E5%B9%B6%E5%8F%91%E6%9F%A5%E8%AF%A2%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F" rel="nofollow">9、MySQL 的并发连接与并发查询什么区别？</a></p> 
<p id="10%E3%80%81MySQL%E6%9B%B4%E6%96%B0%E5%AD%97%E6%AE%B5%E5%80%BC%E4%B8%BA%E5%8E%9F%E6%9D%A5%E7%9A%84%E5%80%BC%E5%86%85%E9%83%A8%E6%98%AF%E6%80%8E%E4%B9%88%E6%93%8D%E4%BD%9C%E5%91%A2%EF%BC%9F-toc" style="margin-left:80px;"><a href="#10%E3%80%81MySQL%E6%9B%B4%E6%96%B0%E5%AD%97%E6%AE%B5%E5%80%BC%E4%B8%BA%E5%8E%9F%E6%9D%A5%E7%9A%84%E5%80%BC%E5%86%85%E9%83%A8%E6%98%AF%E6%80%8E%E4%B9%88%E6%93%8D%E4%BD%9C%E5%91%A2%EF%BC%9F" rel="nofollow">10、MySQL更新字段值为原来的值内部是怎么操作呢？</a></p> 
<p id="11%E3%80%81datetime%E5%92%8Ctimestamp%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F-toc" style="margin-left:80px;"><a href="#11%E3%80%81datetime%E5%92%8Ctimestamp%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F" rel="nofollow">11、datetime和timestamp有什么区别？</a></p> 
<p id="12%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F-toc" style="margin-left:80px;"><a href="#12%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F" rel="nofollow">12、事务的隔离级别有哪些？</a></p> 
<p id="13%E3%80%81%E5%9C%A8%20MySQL%20%E4%B8%AD%E6%9C%89%E4%B8%A4%E4%B8%AA%20kill%20%E5%91%BD%E4%BB%A4-toc" style="margin-left:80px;"><a href="#13%E3%80%81%E5%9C%A8%20MySQL%20%E4%B8%AD%E6%9C%89%E4%B8%A4%E4%B8%AA%20kill%20%E5%91%BD%E4%BB%A4" rel="nofollow">13、在 MySQL 中有两个 kill 命令</a></p> 
<p id="%E7%B4%A2%E5%BC%95%E7%AF%87-toc" style="margin-left:0px;"><a href="#%E7%B4%A2%E5%BC%95%E7%AF%87" rel="nofollow">索引篇</a></p> 
<p id="1%E3%80%81%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F" rel="nofollow">1、索引分类有哪些？</a></p> 
<p id="2%E3%80%81%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E5%92%8C%E9%9D%9E%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F-toc" style="margin-left:80px;"><a href="#2%E3%80%81%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E5%92%8C%E9%9D%9E%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F" rel="nofollow">2、聚集索引和非聚集索引有什么区别？</a></p> 
<p id="2%E3%80%81InnoDB%20%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1B%2B%E6%A0%91%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AFB-Tree%EF%BC%8CHash%EF%BC%8C%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%8C%E7%BA%A2%E9%BB%91%E6%A0%91%EF%BC%9F-toc" style="margin-left:80px;"><a href="#2%E3%80%81InnoDB%20%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1B%2B%E6%A0%91%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AFB-Tree%EF%BC%8CHash%EF%BC%8C%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%8C%E7%BA%A2%E9%BB%91%E6%A0%91%EF%BC%9F" rel="nofollow">3、InnoDB 为什么设计B+树，而不是B-Tree，Hash，二叉树，红黑树？</a></p> 
<p id="3%E3%80%81%E8%AE%B2%E4%B8%80%E8%AE%B2%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E4%B8%8E%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%EF%BC%9F-toc" style="margin-left:80px;"><a href="#3%E3%80%81%E8%AE%B2%E4%B8%80%E8%AE%B2%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E4%B8%8E%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%EF%BC%9F" rel="nofollow">4、讲一讲聚簇索引与非聚簇索引？</a></p> 
<p id="4%E3%80%81%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E4%B8%80%E5%AE%9A%E4%BC%9A%E5%9B%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E5%90%97%EF%BC%9F-toc" style="margin-left:80px;"><a href="#4%E3%80%81%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E4%B8%80%E5%AE%9A%E4%BC%9A%E5%9B%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E5%90%97%EF%BC%9F" rel="nofollow">5、非聚簇索引一定会回表查询吗？</a></p> 
<p id="5%E3%80%81%E8%AE%B2%E4%B8%80%E8%AE%B2MySQL%E7%9A%84%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99%EF%BC%9F-toc" style="margin-left:80px;"><a href="#5%E3%80%81%E8%AE%B2%E4%B8%80%E8%AE%B2MySQL%E7%9A%84%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99%EF%BC%9F" rel="nofollow">6、讲一讲MySQL的最左前缀原则？</a></p> 
<p id="6%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8%EF%BC%9F-toc" style="margin-left:80px;"><a href="#6%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8%EF%BC%9F" rel="nofollow">7、什么是索引下推？</a></p> 
<p id="7%E3%80%81Innodb%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%E8%87%AA%E5%A2%9Eid%E4%BD%9C%E4%B8%BA%E4%B8%BB%E9%94%AE%EF%BC%9F-toc" style="margin-left:80px;"><a href="#7%E3%80%81Innodb%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%E8%87%AA%E5%A2%9Eid%E4%BD%9C%E4%B8%BA%E4%B8%BB%E9%94%AE%EF%BC%9F" rel="nofollow">8、Innodb为什么要用自增id作为主键？</a></p> 
<p id="8%E3%80%81%E4%BA%8B%E5%8A%A1ACID%E7%89%B9%E6%80%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%9F-toc" style="margin-left:80px;"><a href="#8%E3%80%81%E4%BA%8B%E5%8A%A1ACID%E7%89%B9%E6%80%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%9F" rel="nofollow">9、事务ACID特性的实现原理？</a></p> 
<p id="9%E3%80%81MyISAM%E5%92%8CInnoDB%E5%AE%9E%E7%8E%B0B%E6%A0%91%E7%B4%A2%E5%BC%95%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F-toc" style="margin-left:80px;"><a href="#9%E3%80%81MyISAM%E5%92%8CInnoDB%E5%AE%9E%E7%8E%B0B%E6%A0%91%E7%B4%A2%E5%BC%95%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F" rel="nofollow">10、MyISAM和InnoDB实现B树索引方式的区别是什么？</a></p> 
<p id="10%E3%80%81%E7%B4%A2%E5%BC%95%E6%9C%89%E5%93%AA%E4%BA%9B%E5%88%86%E7%B1%BB%EF%BC%9F-toc" style="margin-left:80px;"><a href="#10%E3%80%81%E7%B4%A2%E5%BC%95%E6%9C%89%E5%93%AA%E4%BA%9B%E5%88%86%E7%B1%BB%EF%BC%9F" rel="nofollow">11、索引有哪些分类？</a></p> 
<p id="11%E3%80%81%E6%9C%89%E5%93%AA%E4%BA%9B%E5%9C%BA%E6%99%AF%E4%BC%9A%E5%AF%BC%E8%87%B4%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%EF%BC%9F-toc" style="margin-left:80px;"><a href="#11%E3%80%81%E6%9C%89%E5%93%AA%E4%BA%9B%E5%9C%BA%E6%99%AF%E4%BC%9A%E5%AF%BC%E8%87%B4%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%EF%BC%9F" rel="nofollow">12、有哪些场景会导致索引失效？</a></p> 
<p id="%E6%96%B9%E6%A1%88%E7%AF%87-toc" style="margin-left:0px;"><a href="#%E6%96%B9%E6%A1%88%E7%AF%87" rel="nofollow">方案篇</a></p> 
<p id="1%E3%80%81%E7%8E%B0%E5%9C%A8%E6%9C%89%E4%B8%80%E4%B8%AA%E6%9C%AA%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E7%9A%84%E7%B3%BB%E7%BB%9F%EF%BC%8C%E6%9C%AA%E6%9D%A5%E8%A6%81%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%EF%BC%8C%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E6%89%8D%E5%8F%AF%E4%BB%A5%E8%AE%A9%E7%B3%BB%E7%BB%9F%E4%BB%8E%E6%9C%AA%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%8A%A8%E6%80%81%E5%88%87%E6%8D%A2%E5%88%B0%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E4%B8%8A%EF%BC%9F-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E7%8E%B0%E5%9C%A8%E6%9C%89%E4%B8%80%E4%B8%AA%E6%9C%AA%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E7%9A%84%E7%B3%BB%E7%BB%9F%EF%BC%8C%E6%9C%AA%E6%9D%A5%E8%A6%81%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%EF%BC%8C%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E6%89%8D%E5%8F%AF%E4%BB%A5%E8%AE%A9%E7%B3%BB%E7%BB%9F%E4%BB%8E%E6%9C%AA%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%8A%A8%E6%80%81%E5%88%87%E6%8D%A2%E5%88%B0%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E4%B8%8A%EF%BC%9F" rel="nofollow">1、有一个未分库分表的系统，如何设计才可以让系统动态切换到分库分表上？</a></p> 
<p id="2%E3%80%81%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E5%8F%AF%E4%BB%A5%E5%8A%A8%E6%80%81%E6%89%A9%E5%AE%B9%E7%BC%A9%E5%AE%B9%E7%9A%84%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%96%B9%E6%A1%88%EF%BC%9F%C2%A0-toc" style="margin-left:80px;"><a href="#2%E3%80%81%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E5%8F%AF%E4%BB%A5%E5%8A%A8%E6%80%81%E6%89%A9%E5%AE%B9%E7%BC%A9%E5%AE%B9%E7%9A%84%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%96%B9%E6%A1%88%EF%BC%9F%C2%A0" rel="nofollow">2、如何设计可以动态扩容缩容的分库分表方案？ </a></p> 
<p id="%E5%8E%9F%E7%90%86%E7%AF%87-toc" style="margin-left:0px;"><a href="#%E5%8E%9F%E7%90%86%E7%AF%87" rel="nofollow">原理篇</a></p> 
<p id="1%E3%80%81%E4%B8%80%E6%9D%A1%20MySQL%20%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E6%AD%A5%E9%AA%A4%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E4%B8%80%E6%9D%A1%20MySQL%20%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E6%AD%A5%E9%AA%A4%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F" rel="nofollow">1、一条 MySQL 语句执行步骤是什么样的？</a></p> 
<p id="%C2%A02%E3%80%81order%20by%20%E6%8E%92%E5%BA%8F%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F-toc" style="margin-left:80px;"><a href="#%C2%A02%E3%80%81order%20by%20%E6%8E%92%E5%BA%8F%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F" rel="nofollow">2、order by 排序内部原理是什么样的？</a></p> 
<p id="3%E3%80%81MVCC%20%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%9F-toc" style="margin-left:80px;"><a href="#3%E3%80%81MVCC%20%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%9F" rel="nofollow">3、MVCC 实现原理？</a></p> 
<p id="4%E3%80%81change%20buffer%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E6%9C%89%E4%BD%95%E4%BD%9C%E7%94%A8%EF%BC%9F-toc" style="margin-left:80px;"><a href="#4%E3%80%81change%20buffer%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E6%9C%89%E4%BD%95%E4%BD%9C%E7%94%A8%EF%BC%9F" rel="nofollow">4、change buffer是什么，有何作用？</a></p> 
<p id="5%E3%80%81MySQL%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%A2%E5%A4%B1%3F-toc" style="margin-left:80px;"><a href="#5%E3%80%81MySQL%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%A2%E5%A4%B1%3F" rel="nofollow">5、MySQL是如何保证数据不丢失?</a></p> 
<p id="6%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E5%88%A0%E9%99%A4%E4%BA%86%E8%A1%A8%EF%BC%8C%E8%A1%A8%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%A7%E5%B0%8F%E8%BF%98%E6%98%AF%E6%B2%A1%E5%8F%98%EF%BC%9F-toc" style="margin-left:80px;"><a href="#6%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E5%88%A0%E9%99%A4%E4%BA%86%E8%A1%A8%EF%BC%8C%E8%A1%A8%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%A7%E5%B0%8F%E8%BF%98%E6%98%AF%E6%B2%A1%E5%8F%98%EF%BC%9F" rel="nofollow">6、为什么删除了表，表文件的大小还是没变？</a></p> 
<p id="7%E3%80%81binlog%E4%B8%89%E7%A7%8D%E6%A0%BC%E5%BC%8F%E5%AF%B9%E6%AF%94-toc" style="margin-left:80px;"><a href="#7%E3%80%81binlog%E4%B8%89%E7%A7%8D%E6%A0%BC%E5%BC%8F%E5%AF%B9%E6%AF%94" rel="nofollow">7、binlog三种格式对比</a></p> 
<p id="8%E3%80%81MySQL%E5%8A%A0%E9%94%81%E8%A7%84%E5%88%99-toc" style="margin-left:80px;"><a href="#8%E3%80%81MySQL%E5%8A%A0%E9%94%81%E8%A7%84%E5%88%99" rel="nofollow">8、MySQL加锁规则</a></p> 
<p id="9%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E8%84%8F%E8%AF%BB%E3%80%81%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E3%80%81%E5%B9%BB%E8%AF%BB%E5%91%A2%EF%BC%9F-toc" style="margin-left:80px;"><a href="#9%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E8%84%8F%E8%AF%BB%E3%80%81%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E3%80%81%E5%B9%BB%E8%AF%BB%E5%91%A2%EF%BC%9F" rel="nofollow">9、什么是脏读、不可重复读、幻读呢？</a></p> 
<p id="10%E3%80%81MySQL%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E9%94%81%E5%91%A2%3F%E5%83%8F%E4%B8%8A%E9%9D%A2%E9%82%A3%E6%A0%B7%E5%AD%90%E8%BF%9B%E8%A1%8C%E9%94%81%E5%AE%9A%E5%B2%82%E4%B8%8D%E6%98%AF%E6%9C%89%E7%82%B9%E9%98%BB%E7%A2%8D%E5%B9%B6%E5%8F%91%E6%95%88%E7%8E%87%E4%BA%86%3F-toc" style="margin-left:80px;"><a href="#10%E3%80%81MySQL%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E9%94%81%E5%91%A2%3F%E5%83%8F%E4%B8%8A%E9%9D%A2%E9%82%A3%E6%A0%B7%E5%AD%90%E8%BF%9B%E8%A1%8C%E9%94%81%E5%AE%9A%E5%B2%82%E4%B8%8D%E6%98%AF%E6%9C%89%E7%82%B9%E9%98%BB%E7%A2%8D%E5%B9%B6%E5%8F%91%E6%95%88%E7%8E%87%E4%BA%86%3F" rel="nofollow">10、MySQL都有哪些锁呢?像上面那样子进行锁定岂不是有点阻碍并发效率了?</a></p> 
<p id="%E6%A1%86%E6%9E%B6%E7%AF%87-toc" style="margin-left:0px;"><a href="#%E6%A1%86%E6%9E%B6%E7%AF%87" rel="nofollow">框架篇</a></p> 
<p id="1%E3%80%81Mysql%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86%E7%9A%84%E6%98%AF%E5%95%A5%EF%BC%9F-toc" style="margin-left:80px;"><a href="#1%E3%80%81Mysql%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86%E7%9A%84%E6%98%AF%E5%95%A5%EF%BC%9F" rel="nofollow">1、Mysql 主从复制原理的是啥？</a></p> 
<p id="2%E3%80%81Mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%90%8C%E6%AD%A5%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F-toc" style="margin-left:80px;"><a href="#2%E3%80%81Mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%90%8C%E6%AD%A5%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F" rel="nofollow">2、Mysql主从复制同步方式有哪些？</a></p> 
<p id="3%E3%80%81Mysql%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%BB%B6%E6%97%B6%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0%3F%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96%EF%BC%9F-toc" style="margin-left:80px;"><a href="#3%E3%80%81Mysql%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%BB%B6%E6%97%B6%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0%3F%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96%EF%BC%9F" rel="nofollow">3、Mysql主从同步延时产生原因?怎么优化？</a></p> 
<p id="4%E3%80%81Mysql%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%BB%B6%E6%97%B6%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0%3F%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96%EF%BC%9F-toc" style="margin-left:80px;"><a href="#4%E3%80%81Mysql%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%BB%B6%E6%97%B6%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0%3F%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96%EF%BC%9F" rel="nofollow">4、Mysql主从同步延时产生原因?怎么优化？</a></p> 
<p id="5%E3%80%81%E4%B8%BB%E5%BA%93%E5%87%BA%E9%97%AE%E9%A2%98%E5%A6%82%E4%BD%95%E5%AE%8C%E6%88%90%E4%B8%BB%E4%BB%8E%E5%BA%93%E5%88%87%E6%8D%A2%3F-toc" style="margin-left:80px;"><a href="#5%E3%80%81%E4%B8%BB%E5%BA%93%E5%87%BA%E9%97%AE%E9%A2%98%E5%A6%82%E4%BD%95%E5%AE%8C%E6%88%90%E4%B8%BB%E4%BB%8E%E5%BA%93%E5%88%87%E6%8D%A2%3F" rel="nofollow">5、主库出问题如何完成主从库切换?</a></p> 
<p id="6%E3%80%81bin%20log%2Fredo%20log%2Fundo%20log%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F-toc" style="margin-left:80px;"><a href="#6%E3%80%81bin%20log%2Fredo%20log%2Fundo%20log%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F" rel="nofollow">6、bin log/redo log/undo log是什么？</a></p> 
<hr id="hr-toc"> 
<h2>常规篇</h2> 
<h4 id="1%E3%80%81%E8%AF%B4%E4%B8%80%E4%B8%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F%EF%BC%9F%C2%A0">1、说一下数据库的三大范式？ </h4> 
<p>第一范式：确保每列保持原子性；<br> 第二范式：确保表中的每列都和主键相关；<br> 第三范式：确保每列都和主键列直接相关,而不是间接相关。<br> 实际应用中会通过冗余少量字段来少关联表，提升查询效率。</p> 
<h4 id="2%E3%80%81%E5%8F%AA%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%BD%86%E6%98%AF%E4%B9%9F%E6%89%A7%E8%A1%8C%E9%9D%9E%E5%B8%B8%E6%85%A2%EF%BC%8C%E5%8E%9F%E5%9B%A0%E4%B8%80%E8%88%AC%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F">2、只查询一条数据，但是也执行非常慢，原因一般有哪些？</h4> 
<ul><li>MySQL数据库本身被堵住了，比如：系统或网络资源不够</li><li>SQL语句被堵住了，比如：表锁，行锁等，导致存储引擎不执行对应的SQL语句</li><li>确实是索引使用不当，没有走索引</li><li>表中数据的特点导致的，走了索引，但回表次数庞大</li></ul> 
<h4 id="3%E3%80%81count(*)%E3%80%81count(0)%E3%80%81count(id)%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F">3、count(*)、count(0)、count(id)实现方式的区别？</h4> 
<ul><li>对于<code>count(*)</code>、<code>count(常数)</code>、<code>count(主键)</code>形式的count函数来说，优化器可以选择扫描成本最小的索引执行查询，从而提升效率，它们的执行过程是一样的。</li><li>而对于<code>count(非索引列)</code>来说，优化器选择全表扫描，说明只能在聚集索引的叶子结点顺序扫描。</li><li><code>count(二级索引列)</code>只能选择包含我们指定的列的索引去执行查询，可能导致优化器选择的索引执行的代价并不是最小。</li></ul> 
<p><img alt="" height="710" src="https://images2.imgbox.com/ee/58/PCRlUjym_o.png" width="1200"></p> 
<h4 id="4%E3%80%81%E8%AF%AF%E5%88%A0%E6%95%B0%E6%8D%AE%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F">4、误删数据怎么办？</h4> 
<p>1）如果数据量比较大,用物理备份xtrabackup。定期对数据库进行全量备份,也可以做增量备份。</p> 
<p>2）如果数据量较少,用mysqldump或者mysqldumper，再利用binlog来恢复或者搭建主从的方式来恢复数据，可以从以下几个点来恢复：</p> 
<ul><li>DML误操作语句：可以通过flashback，先解析binlog event,然后在进行反转。</li><li>DDL语句误操作：只能通过全量备份+应用binlog的方式来恢复数据。一旦数据量比较大,那么恢复时间就特别长。</li><li>rm 删除：使用备份跨机房，或者最好是跨城市保存。</li></ul> 
<h4 id="5%E3%80%81drop%E3%80%81truncate%20%E5%92%8C%20delete%20%E7%9A%84%E5%8C%BA%E5%88%AB">5、drop、truncate 和 delete 的区别</h4> 
<ul><li>DELETE语句执行删除的过程是每次从表中删除一行，并且同时将该行的删除操作作为事务记录在日志中保存以便进行进行回滚操作。</li><li>TRUNCATE TABLE 则一次性地从表中删除所有的数据并不把单独的删除操作记录记入日志保存，删除行是不能恢复的。并且在删除的过程中不会激活与表有关的删除触发器，执行速度快。</li><li>drop语句将表所占用的空间全释放掉。</li></ul> 
<h4 id="6%E3%80%81MySQL%E5%A4%A7%E8%A1%A8%E6%9F%A5%E8%AF%A2%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E4%BC%9A%E7%88%86%E5%86%85%E5%AD%98%EF%BC%9F">6、MySQL大表查询为什么不会爆内存？</h4> 
<ul><li>MySQL 是“边读边发的”，这就意味着，如果客户端接收得慢，会导致 MySQL 服务端由于结果发不出去，这个事务的执行时间变长。</li><li>服务端并不需要保存一个完整的结果集。取数据和发数据的流程都是通过一个next_buffer来操作的。</li><li>内存的数据页是在 Buffer Pool (BP) 中管理的。</li><li>InnoDB 管理 Buffer Pool 使用改进的 LRU 算法，是用链表来实现的。在 InnoDB 实现上，按照 5:3 的比例把整个 LRU 链表分成了 young 区域和 old 区域，确保大批量加载冷数据时不会冲掉热点数据。</li></ul> 
<h4 id="7%E3%80%81%E6%B7%B1%E5%BA%A6%E5%88%86%E9%A1%B5%EF%BC%88%E8%B6%85%E5%A4%A7%E5%88%86%E9%A1%B5%EF%BC%89%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86%3F">7、深度分页（超大分页）怎么处理?</h4> 
<ul><li>用id优化：先找到上次分页的最大ID,然后利用id上的索引来查询,类似于select * from user where id&gt;1000000 limit 100。</li><li>用覆盖索引优化：Mysql的查询完全命中索引的时候,称为覆盖索引,是非常快的,因为查询只需要在索引上进行查找,之后可以直接返回,而不用再回表拿数据.因此我们可以先查出索引的ID,然后根据Id拿数据。</li><li>在业务允许的情况下限制页数</li></ul> 
<h4 id="8%E3%80%81%E6%97%A5%E5%B8%B8%E5%BC%80%E5%8F%91%E4%B8%AD%E4%BD%A0%E6%98%AF%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96SQL%E7%9A%84%EF%BC%9F">8、日常开发中你是怎么优化SQL的？</h4> 
<ul><li>添加合适索引：对作为查询条件和order by的字段建立索引，对于多个查询字段的考虑建立组合索引，同时注意组合索引字段的顺序,将最常用作限制条件的列放在最左边，依次递减，索引不宜太多，一般5个以内。</li><li>优化表结构：数字型字段优于字符串类型，数据类型更小通常更好，尽量使用 NOT NULL</li><li>优化查询语句：分析SQl执行计划，是否命中索引等，如果SQL很复杂，优化SQL结构，如果表数据量太大，考虑分表</li></ul> 
<h4 id="9%E3%80%81MySQL%20%E7%9A%84%E5%B9%B6%E5%8F%91%E8%BF%9E%E6%8E%A5%E4%B8%8E%E5%B9%B6%E5%8F%91%E6%9F%A5%E8%AF%A2%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F">9、MySQL 的并发连接与并发查询什么区别？</h4> 
<ul><li>在执行show processlist的结果里，看到了几千个连接，指的是并发连接。</li><li>而"当前正在执行"的语句，才是并发查询。</li><li>并发连接数多影响的是内存。</li><li>并发查询太高对CPU不利。一个机器的CPU核数有限，线程全冲进来，上下文切换的成本就会太高。</li><li>需要注意的是，在线程进入锁等待以后，并发线程计数减一，所以等行锁或者间隙锁时的线程是不算在计数范围内的。也就是说进入锁等待的线程不吃CPU，从而避免整个系统锁死。</li></ul> 
<h4 id="10%E3%80%81MySQL%E6%9B%B4%E6%96%B0%E5%AD%97%E6%AE%B5%E5%80%BC%E4%B8%BA%E5%8E%9F%E6%9D%A5%E7%9A%84%E5%80%BC%E5%86%85%E9%83%A8%E6%98%AF%E6%80%8E%E4%B9%88%E6%93%8D%E4%BD%9C%E5%91%A2%EF%BC%9F">10、MySQL更新字段值为原来的值内部是怎么操作呢？</h4> 
<ul><li>相同的数据时，不会做update更新。</li><li>不过对不同的binlog格式，处理的日志方式有所不同： 
  <ul><li>1）基于row模式时，server层匹配到要更新的记录，发现新值和旧值一致，不做更新，就直接返回，也不记录binlog。</li><li>2）基于 statement 或者 mixed格式时，MySQL执行 update 语句，并把更新语句记录到binlog。</li></ul></li></ul> 
<h4 id="11%E3%80%81datetime%E5%92%8Ctimestamp%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F">11、datetime和timestamp有什么区别？</h4> 
<ul><li>datetime 的日期范围是 1001——9999 年；timestamp 的时间范围是 1970——2038 年</li><li>datetime 存储时间与时区无关；timestamp 存储时间与时区有关，显示的值也依赖于时区</li><li>datetime 的存储空间为 8 字节；timestamp 的存储空间为 4 字节</li><li>datetime 的默认值为 null；timestamp 的字段默认不为空(not null)，默认值为当前时间(current_timestamp)</li></ul> 
<h4 id="12%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F">12、事务的隔离级别有哪些？</h4> 
<ul><li>「读未提交」（Read Uncommitted）最低级别，任何情况都无法保证</li><li>「读已提交」（Read Committed）可避免脏读的发生</li><li>「可重复读」（Repeatable Read）可避免脏读、不可重复读的发生</li><li>「串行化」（Serializable）可避免脏读、不可重复读、幻读的发生</li><li>Mysql默认的事务隔离级别是「可重复读」(Repeatable Read)</li></ul> 
<h4 id="13%E3%80%81%E5%9C%A8%20MySQL%20%E4%B8%AD%E6%9C%89%E4%B8%A4%E4%B8%AA%20kill%20%E5%91%BD%E4%BB%A4">13、在 MySQL 中有两个 kill 命令</h4> 
<ul><li>kill query + 线程 id，表示终止这个线程中正在执行的语句</li><li>kill connection + 线程 id，这里 connection 可缺省，表示断开这个线程的连接</li></ul> 
<h2 id="%E7%B4%A2%E5%BC%95%E7%AF%87">索引篇</h2> 
<h4 id="1%E3%80%81%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F">1、索引分类有哪些？</h4> 
<ul><li>根据叶子节点的内容，索引类型分为主键索引和非主键索引。</li><li>主键索引的叶子节点存的是整行数据。在 InnoDB 里，主键索引也被称为聚簇索引（clustered index）。</li><li>非主键索引的叶子节点内容是主键的值。在 InnoDB 里，非主键索引也被称为二级索引（secondary index）。</li></ul> 
<h4 id="2%E3%80%81%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E5%92%8C%E9%9D%9E%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%EF%BC%9F">2、聚集索引和非聚集索引有什么区别？</h4> 
<ul><li> <p> <strong>聚集索引：</strong>聚集索引就是以主键创建的索引，聚集索引在叶子节点存储的是表中的数据。</p> <img alt="" src="https://images2.imgbox.com/e9/06/900I5AM8_o.png">  </li><li> <p><strong>非聚集索引：</strong>非主键创建的索引，在叶子节点存储的是主键和索引列，使用非聚集索引查询出数据时，拿到叶子上的主键再去查到想要查找的数据。(拿到主键再查找这个过程叫做回表)。</p> <img alt="" src="https://images2.imgbox.com/d4/0d/nNLlDQY2_o.png"></li><li> <p><strong>覆盖索引：</strong>假设所查询的列，刚好都是索引对应的列，不用再回表查，那么这个索引列就叫覆盖索引。  </p> </li></ul> 
<h4 id="2%E3%80%81InnoDB%20%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AE%BE%E8%AE%A1B%2B%E6%A0%91%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AFB-Tree%EF%BC%8CHash%EF%BC%8C%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%8C%E7%BA%A2%E9%BB%91%E6%A0%91%EF%BC%9F">3、InnoDB 为什么设计B+树，而不是B-Tree，Hash，二叉树，红黑树？</h4> 
<ul><li>哈希索引能够以 O(1) 的速度处理单个数据行的增删改查，但是面对范围查询或者排序时就会导致全表扫描的结果。</li><li>B树可以在非叶结点中存储数据，由于所有的节点都可能包含目标数据，我们总是要从根节点向下遍历子树查找满足条件的数据行，这个特点带来了大量的随机 I/O，造成性能下降。</li><li>B+树所有的数据行都存储在叶节点中，而这些叶节点可以通过『指针』依次按顺序连接，当我们在如下所示的 B+ 树遍历数据时可以直接在多个子节点之间进行跳转，这样能够节省大量的磁盘 I/O 时间。</li><li> <p>二叉树：树的高度不均匀，不能自平衡，查找效率跟数据有关（树的高度），并且IO代价高。</p> </li><li> <p>红黑树：树的高度随着数据量增加而增加，IO代价高。</p> </li></ul> 
<h4 id="3%E3%80%81%E8%AE%B2%E4%B8%80%E8%AE%B2%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E4%B8%8E%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%EF%BC%9F">4、讲一讲聚簇索引与非聚簇索引？</h4> 
<ul><li>在InnoDB里，索引B+ Tree的叶子节点存储了整行数据的是主键索引，也被称之为聚簇索引，即将数据存储与索引放到了一块，找到索引也就找到了数据。</li><li>而索引B+Tree的叶子节点存储了主键的值的是非主键索引，也被称之为非聚簇索引、二级索引。</li><li><span style="background-color:#fefcd8;">第一次索引一般是顺序IO，回表的操作属于随机IO。</span>需要回表的次数越多，即随机IO次数越多，我们就越倾向于使用全表扫描 。</li></ul> 
<h4 id="4%E3%80%81%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E4%B8%80%E5%AE%9A%E4%BC%9A%E5%9B%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2%E5%90%97%EF%BC%9F">5、非聚簇索引一定会回表查询吗？</h4> 
<ul><li>不一定，这涉及到查询语句所要求的字段是否全部命中了索引，如果全部命中了索引，那么就不必再进行回表查询。一个索引包含（覆盖）所有需要查询字段的值，被称之为“覆盖索引”。</li></ul> 
<h4 id="5%E3%80%81%E8%AE%B2%E4%B8%80%E8%AE%B2MySQL%E7%9A%84%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99%EF%BC%9F">6、讲一讲MySQL的最左前缀原则？</h4> 
<ul><li>最左前缀原则就是最左优先，在创建多列索引时，要根据业务需求，where子句中使用最频繁的一列放在最左边。</li><li>MySQL会一直向右匹配直到遇到范围查询（&gt;、&lt;、between、like）就停止匹配，比如a = 1 and b = 2 and c &gt; 3 and d = 4 如果建立（a，b，c，d）顺序的索引，d是用不到索引的，如果建立（a，b，d，c）的索引则都可以用到，a，b，d的顺序可以任意调整。</li><li>=和in可以乱序，比如a = 1 and b = 2 and c = 3 建立（a，b，c）索引可以任意顺序，MySQL的查询优化器会帮你优化成索引可以识别的形式。</li></ul> 
<h4 id="6%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8%EF%BC%9F">7、什么是索引下推？</h4> 
<ul><li>满足最左前缀原则的时候，最左前缀可以用于在索引中定位记录。</li><li>在 MySQL 5.6 之前，只能从ID开始一个个回表。到主键索引上找出数据行，再对比字段值。</li><li>而 MySQL 5.6 引入的索引下推优化（index condition pushdown)， 可以在索引遍历过程中，对索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数。</li></ul> 
<h4 id="7%E3%80%81Innodb%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%E8%87%AA%E5%A2%9Eid%E4%BD%9C%E4%B8%BA%E4%B8%BB%E9%94%AE%EF%BC%9F">8、Innodb为什么要用自增id作为主键？</h4> 
<ul><li>如果表使用自增主键，那么每次插入新的记录，记录就会顺序添加到当前索引节点的后续位置，当一页写满，就会自动开辟一个新的页。如果使用非自增主键（如果身份证号或学号等），由于每次插入主键的值近似于随机，因此每次新纪录都要被插到现有索引页得中间某个位置， 频繁的移动、分页操作造成了大量的碎片，得到了不够紧凑的索引结构，后续不得不通过OPTIMIZE TABLE（optimize table）来重建表并优化填充页面。</li></ul> 
<h4 id="8%E3%80%81%E4%BA%8B%E5%8A%A1ACID%E7%89%B9%E6%80%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%9F">9、事务ACID特性的实现原理？</h4> 
<ul><li>「原子性」：是使用 undo log 来实现的，如果事务执行过程中出错或者用户执行了rollback，系统通过undo log日志返回事务开始的状态。</li><li>「持久性」：使用 redo log 来实现，只要redo log日志持久化了，当系统崩溃，即可通过redo log把数据恢复。</li><li>「隔离性」：通过锁以及 MVCC,使事务相互隔离开。</li><li>「一致性」：通过回滚、恢复，以及并发情况下的隔离性，从而实现一致性。</li></ul> 
<h4 id="9%E3%80%81MyISAM%E5%92%8CInnoDB%E5%AE%9E%E7%8E%B0B%E6%A0%91%E7%B4%A2%E5%BC%95%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F">10、MyISAM和InnoDB实现B树索引方式的区别是什么？</h4> 
<ul><li> <p>InnoDB 存储引擎：B+ 树索引的叶子节点保存数据本身；</p> </li><li> <p>MyISAM 存储引擎：B+ 树索引的叶子节点保存数据的物理地址；</p> </li><li>InnoDB，其数据文件本身就是索引文件，相比MyISAM，索引文件和数据文件是分离的，其表数据文件本身就是按B+Tree组织的一个索引结构，树的节点data域保存了完整的数据记录，这个索引的key是数据表的主键，因此InnoDB表数据文件本身就是主索引，这被称为“聚簇索引”或者聚集索引，而其余的索引都作为辅助索引，辅助索引的data域存储相应记录主键的值而不是地址，这也是和MyISAM不同的地方。</li></ul> 
<h4 id="10%E3%80%81%E7%B4%A2%E5%BC%95%E6%9C%89%E5%93%AA%E4%BA%9B%E5%88%86%E7%B1%BB%EF%BC%9F">11、索引有哪些分类？</h4> 
<ul><li>根据叶子节点的内容，索引类型分为主键索引和非主键索引。</li><li>主键索引的叶子节点存的是整行数据。在 InnoDB 里，主键索引也被称为聚簇索引（clustered index）。</li><li>非主键索引的叶子节点内容是主键的值。在 InnoDB 里，非主键索引也被称为二级索引（secondary index）。 </li></ul> 
<h4 id="11%E3%80%81%E6%9C%89%E5%93%AA%E4%BA%9B%E5%9C%BA%E6%99%AF%E4%BC%9A%E5%AF%BC%E8%87%B4%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%EF%BC%9F">12、有哪些场景会导致索引失效？</h4> 
<p><span style="background-color:#fefcd8;">背景：B+ 树提供的这个快速定位能力，来源于同一层兄弟节点的有序性，所以说破坏了这个有序性，大概率就失效了，具体有如下几种情况：</span></p> 
<ul><li> <p>对索引使用左或者左右模糊匹配：也就是 like %xx 或者 like %xx% 这两种方式都会造成索引失效。原因在于查询的结果可能是「陈林、张林、周林」等之类的，所以不知道从哪个索引值开始比较，于是就只能通过全表扫描的方式来查询。</p> </li><li> <p>对索引使用函数/对索引进行表达式计算：因为索引保存的是索引字段的原始值，而不是经过函数计算后的值，自然就没办法走索引了。</p> </li><li> <p>对索引隐式类型转换：相当于用了新函数</p> </li><li> <p>WHERE 子句中的 OR：的含义就是两个只要满足一个即可，因此只有一个条件列是索引列是没有意义的，只要有条件列不是索引列，就会进行全表扫描。</p> </li></ul> 
<h2 id="%E6%96%B9%E6%A1%88%E7%AF%87">方案篇</h2> 
<h4 id="1%E3%80%81%E7%8E%B0%E5%9C%A8%E6%9C%89%E4%B8%80%E4%B8%AA%E6%9C%AA%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E7%9A%84%E7%B3%BB%E7%BB%9F%EF%BC%8C%E6%9C%AA%E6%9D%A5%E8%A6%81%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%EF%BC%8C%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E6%89%8D%E5%8F%AF%E4%BB%A5%E8%AE%A9%E7%B3%BB%E7%BB%9F%E4%BB%8E%E6%9C%AA%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%8A%A8%E6%80%81%E5%88%87%E6%8D%A2%E5%88%B0%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E4%B8%8A%EF%BC%9F">1、有一个未分库分表的系统，如何设计才可以让系统动态切换到分库分表上？</h4> 
<ul><li>停机扩容（不推荐）</li><li>双写迁移方案：设计好扩容后的表结构方案，然后对单库和分库实现双写，观察一周没问题后，关闭单库的读流量，再观察一段时间，持续稳定后，关闭单库的写流量，平滑切换到分库分表中。</li></ul> 
<h4 id="2%E3%80%81%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E5%8F%AF%E4%BB%A5%E5%8A%A8%E6%80%81%E6%89%A9%E5%AE%B9%E7%BC%A9%E5%AE%B9%E7%9A%84%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%96%B9%E6%A1%88%EF%BC%9F%C2%A0">2、如何设计可以动态扩容缩容的分库分表方案？ </h4> 
<p></p> 
<h2 id="%E5%8E%9F%E7%90%86%E7%AF%87">原理篇</h2> 
<h4 id="1%E3%80%81%E4%B8%80%E6%9D%A1%20MySQL%20%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E6%AD%A5%E9%AA%A4%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F">1、一条 MySQL 语句执行步骤是什么样的？</h4> 
<p id="%E2%80%8B"><img alt="" src="https://images2.imgbox.com/f7/e9/AAGmXeXO_o.png"></p> 
<ul><li>Server层按顺序执行sql的步骤为：</li><li>客户端请求 -&gt; 连接器（验证用户身份，给予权限） -&gt; 查询缓存（存在缓存则直接返回，不存在则执行后续操作）-&gt; 分析器（对SQL进行词法分析和语法分析操作） -&gt; 优化器（主要对执行的sql优化选择最优的执行方案方法） -&gt; 执行器（执行时会先看用户是否有执行权限，有才去使用这个引擎提供的接口）-&gt; 去引擎层获取数据返回（如果开启查询缓存则会缓存查询结果）。</li></ul> 
<h4 id="%C2%A02%E3%80%81order%20by%20%E6%8E%92%E5%BA%8F%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%EF%BC%9F">2、order by 排序内部原理是什么样的？</h4> 
<ul><li>MySQL会为每个线程分配一个内存（sort_buffer）用于排序该内存大小为sort_buffer_size。</li><li>如果排序的数据量小于sort_buffer_size，排序将会在内存中完成。</li><li>如果排序数据量很大，内存中无法存下这么多数据，则会使用磁盘临时文件来辅助排序，也称外部排序。</li><li>在使用外部排序时，MySQL会分成好几份单独的临时文件用来存放排序后的数据，然后在将这些文件合并成一个大文件。</li></ul> 
<h4 id="3%E3%80%81MVCC%20%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%9F">3、MVCC 实现原理？</h4> 
<ul><li>MVCC(Multiversion concurrency control) 就是同一份数据保留多版本的一种方式，进而实现并发控制。在查询的时候，通过read view和版本链找到对应版本的数据。</li><li>作用：提升并发性能。对于高并发场景，MVCC 比行级锁开销更小。</li><li>MVCC 的实现依赖于版本链，版本链是通过表的三个隐藏字段实现。 
  <ul><li>1）DB_TRX_ID：当前事务 id，通过事务 id 的大小判断事务的时间顺序。</li><li>2）DB_ROLL_PRT：回滚指针，指向当前行记录的上一个版本，通过这个指针将数据的多个版本连接在一起构成undo log版本链。</li><li>3）DB_ROLL_ID：主键，如果数据表没有主键，InnoDB 会自动生成主键。</li></ul></li></ul> 
<h4 id="4%E3%80%81change%20buffer%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E6%9C%89%E4%BD%95%E4%BD%9C%E7%94%A8%EF%BC%9F">4、change buffer是什么，有何作用？</h4> 
<p></p> 
<h4 id="5%E3%80%81MySQL%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%A2%E5%A4%B1%3F">5、MySQL是如何保证数据不丢失?</h4> 
<ul><li>只要 redolog 和 binlog 保证持久化磁盘就能确保 MySQL 异常重启后数据恢复 binlog 写入机制。</li><li>redolog确保系统异常后，丢失的数据可以重做，binlog将数据进行归档，确保丢失的数据可以恢复。</li><li>事务执行前先写redolog，事务执行过程中，先把日志写到 binlog cache 里，事务提交的时候，再把 binlog cache 写到 binlog 文件中。</li></ul> 
<h4 id="6%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E5%88%A0%E9%99%A4%E4%BA%86%E8%A1%A8%EF%BC%8C%E8%A1%A8%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%A7%E5%B0%8F%E8%BF%98%E6%98%AF%E6%B2%A1%E5%8F%98%EF%BC%9F">6、为什么删除了表，表文件的大小还是没变？</h4> 
<ul><li>数据项删除之后InnoDB标记 page A 会被标记为可复用</li><li>delete 命令把整个表的数据删除呢？结果就是，所有的数据页都会被标记为可复用。但是磁盘上，文件不会变小。</li><li>经过大量增删改的表，都是可能是存在空洞的。这些空洞也占空间所以，如果能够把这些空洞去掉，就能达到收缩表空间的目的。</li><li>重建表，就可以达到这样的目的。可以使用 alter table A engine=InnoDB 命令来重建表。</li></ul> 
<h4 id="7%E3%80%81binlog%E4%B8%89%E7%A7%8D%E6%A0%BC%E5%BC%8F%E5%AF%B9%E6%AF%94">7、binlog三种格式对比</h4> 
<ul><li>row格式的binlog记录的操作行的主键id以及每个字段的真实值，所以不会出现主备操作数据不一致的情况。</li><li>statement：记录的源SQL语句</li><li>mixed：前两种混合，为什么还需要有mixed格式的文件，因为有些 statement 格式的 binlog 可能会导致主备不一致，所以要使用 row 格式。但 row 格式的缺点是，很占空间。MySQL 就取了个折中方案，MySQL 自己会判断这条 SQL 语句是否可能引起主备不一致，如果有可能，就用 row 格式，否则就用 statement 格式。</li></ul> 
<h4 id="8%E3%80%81MySQL%E5%8A%A0%E9%94%81%E8%A7%84%E5%88%99">8、MySQL加锁规则</h4> 
<ul><li>原则 1：加锁的基本单位是 <a class="link-info" href="https://blog.csdn.net/yangbindxj/article/details/123135434?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164679264116780265465158%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=164679264116780265465158&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-2-123135434.nonecase&amp;utm_term=next-key&amp;spm=1018.2226.3001.4450" title="next-key lock">next-key lock</a>，next-key lock 是前开后闭区间。</li><li>原则 2：查找过程中访问到的对象才会加锁</li><li>优化 1：索引上的等值查询，给唯一索引加锁的时候，next-key lock 退化为行锁。</li><li>优化 2：索引上的等值查询，向右遍历时且最后一个值不满足等值条件的时候，next-key lock 退化为间隙锁</li><li>一个 bug：唯一索引上的范围查询会访问到不满足条件的第一个值为止。</li></ul> 
<h4 id="9%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E8%84%8F%E8%AF%BB%E3%80%81%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E3%80%81%E5%B9%BB%E8%AF%BB%E5%91%A2%EF%BC%9F">9、什么是脏读、不可重复读、幻读呢？</h4> 
<ul><li>「脏读」: 脏读指的是读到了其他事务未提交的数据，未提交意味着这些数据可能会回滚，也就是可能最终不会存到数据库中，也就是不存在的数据。读到了并不一定最终存在的数据，这就是脏读。</li><li>「不可重复读」: 不可重复读指的是在一个事务内，最开始读到的数据和事务结束前的任意时刻读到的同一批数据出现不一致的情况。</li><li>「幻读」: 幻读，并不是说两次读取获取的结果集不同，幻读侧重的方面是某一次的 select 操作得到的结果的数据状态无法支撑后续的业务操作。更为具体一些：select 某记录是否存在，不存在，准备插入此记录，但执行 insert 时发现此记录已存在，无法插入，此时就发生了幻读。</li></ul> 
<h4 id="10%E3%80%81MySQL%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E9%94%81%E5%91%A2%3F%E5%83%8F%E4%B8%8A%E9%9D%A2%E9%82%A3%E6%A0%B7%E5%AD%90%E8%BF%9B%E8%A1%8C%E9%94%81%E5%AE%9A%E5%B2%82%E4%B8%8D%E6%98%AF%E6%9C%89%E7%82%B9%E9%98%BB%E7%A2%8D%E5%B9%B6%E5%8F%91%E6%95%88%E7%8E%87%E4%BA%86%3F">10、MySQL都有哪些锁呢?像上面那样子进行锁定岂不是有点阻碍并发效率了?</h4> 
<ul><li>从锁的类别上来讲,有共享锁和排他锁。 
  <ul><li>1）共享锁: 又叫做读锁. 当用户要进行数据的读取时,对数据加上共享锁.共享锁可以同时加上多个。</li><li>2）排他锁: 又叫做写锁. 当用户要进行数据的写入时,对数据加上排他锁.排他锁只可以加一个,他和其他的排他锁,共享锁都相斥。</li></ul></li><li>锁的粒度取决于具体的存储引擎,InnoDB实现了行级锁,页级锁,表级锁。</li><li> <p>他们的加锁开销从大大小,并发能力也是从大到小。</p> </li></ul> 
<h2 id="%E6%A1%86%E6%9E%B6%E7%AF%87">框架篇</h2> 
<h4 id="1%E3%80%81Mysql%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86%E7%9A%84%E6%98%AF%E5%95%A5%EF%BC%9F">1、Mysql 主从复制原理的是啥？</h4> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/da/6d/cRYAHoLe_o.png"></p> 
<ul><li>Master的更新事件(update、insert、delete)会按照顺序写入<code>bin-log</code>中。当Slave连接到Master的后,Master机器会为Slave开启<code>binlog dump</code>线程,该线程会去读取bin-log日志。</li><li>Slave连接到Master后,Slave库有一个<code>I/O线程</code> 通过请求binlog dump thread读取bin-log日志,然后写入从库的<code>relay log</code>日志中。</li><li>Slave还有一个 <code>SQL线程</code>,实时监控 relay-log日志内容是否有更新,解析文件中的SQL语句,在Slave数据库中去执行。 </li></ul> 
<h4 id="2%E3%80%81Mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%90%8C%E6%AD%A5%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F">2、Mysql主从复制同步方式有哪些？</h4> 
<ul><li><strong>异步复制：</strong>Mysql主从同步 默认是异步复制的。就是上面三步中,只有第一步是同步的(也就是Mater写入bin log日志),就是主库写入binlog日志后即可成功返回客户端，无须等待binlog日志传递给从库的过程。</li><li><strong>同步复制：</strong>对于同步复制而言，Master主机将事件发送给Slave主机后会触发一个等待，直到所有Slave节点（如果有多个Slave）返回数据复制成功的信息给Master。</li><li><strong>半同步复制：</strong>对于半同步复制而言，Master主机将事件发送给Slave主机后会触发一个等待，<span style="background-color:#fefcd8;">直到其中一个Slave节点</span>（如果有多个Slave）返回数据复制成功的信息给Master。</li></ul> 
<h4 id="3%E3%80%81Mysql%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%BB%B6%E6%97%B6%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0%3F%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96%EF%BC%9F">3、Mysql主从同步延时产生原因?怎么优化？</h4> 
<ul><li> <p>主节点如果执行一个很大的事务，那么就会对主从延迟产生较大的影响</p> </li><li> <p>网络延迟，日志较大，slave数量过多</p> </li><li> <p>主上多线程写入，从节点只有单线程同步</p> </li><li> <p>机器性能问题，从节点是否使用了“烂机器”</p> </li><li> <p>锁冲突问题也可能导致从机的SQL线程执行慢</p> </li></ul> 
<h4 id="4%E3%80%81Mysql%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%BB%B6%E6%97%B6%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0%3F%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96%EF%BC%9F">4、Mysql主从同步延时产生原因?怎么优化？</h4> 
<ul><li>大事务：将大事务分为小事务，分批更新数据</li><li>减少Slave的数量，不要超过5个，减少单次事务的大小</li><li>Mysql 5.7之后，可以使用多线程复制，使用MGR复制架构</li><li>在磁盘、raid卡、调度策略有问题的情况下可能会出现单个IO延迟很高的情况，可用iostat命令查看DB数据盘的IO情况，再进一步判断</li><li>针对锁问题可以通过抓去processlist以及查看information_schema下面和锁以及事务相关的表来查看。</li></ul> 
<h4 id="5%E3%80%81%E4%B8%BB%E5%BA%93%E5%87%BA%E9%97%AE%E9%A2%98%E5%A6%82%E4%BD%95%E5%AE%8C%E6%88%90%E4%B8%BB%E4%BB%8E%E5%BA%93%E5%88%87%E6%8D%A2%3F">5、主库出问题如何完成主从库切换?</h4> 
<p></p> 
<h4 id="6%E3%80%81bin%20log%2Fredo%20log%2Fundo%20log%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F">6、bin log/redo log/undo log是什么？</h4> 
<ul><li>bin log是Mysql数据库级别的文件，记录对Mysql数据库执行修改的所有操作，不会记录select和show语句。</li><li>redo log中记录的是要更新的数据，比如一条数据已提交成功，并不会立即同步到磁盘，而是先记录到redo log中，等待合适的时机再刷盘，为了实现事务的持久性。</li><li>undo log用于数据的撤回操作，它保留了记录修改前的内容。通过undo log可以实现事务回滚，并且可以根据undo log回溯到某个特定的版本的数据，实现MVCC。</li></ul>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4975cc507268f1a0443bf2fa8801f539/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端使用print.js实现打印</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a2761a054778d219ae8b1d567ffeec29/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">对象的封装和继承详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>