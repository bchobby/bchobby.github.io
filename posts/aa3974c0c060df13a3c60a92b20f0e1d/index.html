<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Redis事务P0级事故，超卖100瓶茅台，项目组慌的一批！ - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Redis事务P0级事故，超卖100瓶茅台，项目组慌的一批！" />
<meta property="og:description" content="「 关注“石杉的架构笔记”，大厂架构经验倾囊相授 」 文章来源：【公众号：悟空聊架构】
一、前言
最近项目的生产环境遇到一个奇怪的问题：
现象：每天早上客服人员在后台创建客服事件时，都会创建失败。当我们重启这个微服务后，后台就可以正常创建了客服事件了。到第二天早上又会创建失败，又得重启这个微服务才行。
初步排查：创建一个客服事件时，会用到 Redis 的递增操作来生成一个唯一的分布式 ID 作为事件 id。代码如下所示：
return redisTemplate.opsForValue().increment(&#34;count&#34;, 1); 而恰巧每天早上这个递增操作都会返回 null，进而导致后面的一系列逻辑出错，保存客服事件失败。当重启微服务后，这个递增操作又正常了。
那么排查的方向就是 Redis 的操作为什么会返回 null 了，以及为什么重启就又恢复正常了。
二、排查
根据上面的信息，我们先来看看 Redis 的自增操作在什么情况下会返回 null。
2.1 推测一 根据重启后就恢复正常，我们推测晚上执行了大量的 job，大量 Redis 连接未释放，当早上再来执行 Redis 操作时，执行失败。重启后，连接自动释放了。
但是其他有使用到 Redis 的业务功能又是正常的，所以推测一的方向有问题，排除。
2.2 推测二 可能是 Redis 事务造成的问题。这个推测的依据是根据下面的代码来排查的。
直接看 redisTemplate 递增的方法 increment，如下所示：
官方注释已经说明什么情况下会返回 null：
当在 pipeline（管道）中使用这个 increment 方法时会返回 null。
当在 transaction（事务）中使用这个 increment 方法时会返回 null。
事务提供了一种将多个命令打包，然后一次性、有序地执行机制.
多个命令会被入列到事务队列中，然后按先进先出（FIFO）的顺序执行。
事务在执行过程中不会被中断，当事务队列中的所有命令都被执行完毕之后，事务才会结束。（内容来自 Redis 设计与实现）
继续看代码，发现在操作 Redis 的 ServiceImpl 实现类的上面添加了一个 @Transactional 注解，推测是不是这个注解影响了 Redis 的操作结果。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/aa3974c0c060df13a3c60a92b20f0e1d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-03T07:50:56+08:00" />
<meta property="article:modified_time" content="2023-01-03T07:50:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Redis事务P0级事故，超卖100瓶茅台，项目组慌的一批！</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <h3><strong><strong>「 </strong>关注<strong>“石杉的架构笔记”</strong>，大厂架构经验<strong>倾囊相授</strong> <strong>」</strong></strong></h3> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/22/df/l2JLoGuV_o.png" alt="087dd84af2ad1a2381e12f1e489f124d.png"></p> 
 <p style="text-align:right;"><strong><strong>文章来源：【公众号：</strong></strong><strong><strong>悟空聊架构】</strong></strong></p> 
 <p><img src="https://images2.imgbox.com/b9/fb/A9c7vuEy_o.gif" alt="243494e0a661aa37fdd020da03e72483.gif"></p> 
 <p>一、前言</p> 
 <p>最近项目的生产环境遇到一个奇怪的问题：</p> 
 <p>现象：每天早上客服人员在后台创建客服事件时，都会创建失败。当我们重启这个微服务后，后台就可以正常创建了客服事件了。到第二天早上又会创建失败，又得重启这个微服务才行。</p> 
 <p>初步排查：创建一个客服事件时，会用到 Redis 的递增操作来生成一个唯一的分布式 ID 作为事件 id。代码如下所示：</p> 
 <pre class="has"><code class="language-go">return redisTemplate.opsForValue().increment("count", 1);</code></pre> 
 <p>而恰巧每天早上这个递增操作都会返回 <code>null</code>，进而导致后面的一系列逻辑出错，保存客服事件失败。当重启微服务后，这个递增操作又正常了。</p> 
 <blockquote> 
  <p>那么排查的方向就是 Redis 的操作为什么会返回 null 了，以及为什么重启就又恢复正常了。</p> 
 </blockquote> 
 <h3><br></h3> 
 <blockquote> 
  <blockquote> 
   <p><strong>二、排查</strong></p> 
  </blockquote> 
 </blockquote> 
 <p>根据上面的信息，我们先来看看 Redis 的自增操作在什么情况下会返回 null。</p> 
 <h4>2.1 推测一</h4> 
 <p>根据重启后就恢复正常，我们推测晚上执行了大量的 job，大量 Redis 连接未释放，当早上再来执行 Redis 操作时，执行失败。重启后，连接自动释放了。</p> 
 <p>但是其他有使用到 Redis 的业务功能又是正常的，所以推测一的方向有问题，排除。</p> 
 <h4>2.2 推测二</h4> 
 <p>可能是 Redis 事务造成的问题。这个推测的依据是根据下面的代码来排查的。</p> 
 <p>直接看 <code>redisTemplate</code> 递增的方法 <code>increment</code>，如下所示：</p> 
 <img src="https://images2.imgbox.com/85/60/EVY286RD_o.png" alt="cd3d776e43c4961eccb946589ee121a4.png"> 
 <p>官方注释已经说明什么情况下会返回 null：</p> 
 <ul><li><p>当在 pipeline（管道）中使用这个 increment 方法时会返回 null。</p></li><li><p>当在 transaction（事务）中使用这个 increment 方法时会返回 null。</p></li></ul> 
 <blockquote> 
  <p>事务提供了一种将多个命令打包，然后一次性、有序地执行机制.</p> 
  <p>多个命令会被入列到事务队列中，然后按先进先出（FIFO）的顺序执行。</p> 
  <p>事务在执行过程中不会被中断，当事务队列中的所有命令都被执行完毕之后，事务才会结束。（内容来自 Redis 设计与实现）</p> 
 </blockquote> 
 <p>继续看代码，发现在操作 Redis 的 ServiceImpl 实现类的上面添加了一个 @Transactional 注解，推测是不是这个注解影响了 Redis 的操作结果。</p> 
 <h4>2.3 验证推测二</h4> 
 <p>如下面的表格所示，第二行中没有添加 Spring 的事务注解<code> @Transactional</code>时，执行 Redis 的递增命令肯定是正常的，而接下来要验证的是表格中的第一行：加了 <code>@Transactional</code> 是否对 Redis 的命令有影响。</p> 
 <img src="https://images2.imgbox.com/4a/f2/r8T4wR2F_o.png" alt="3a32670d8715fb1614a47d804164dd4f.png"> 
 <p>为了验证上面的推论，我写了一个 Demo 程序。</p> 
 <p>Controller 类，定义了一个 API，用来模拟前端发起的请求：</p> 
 <img src="https://images2.imgbox.com/a4/14/DV25x8af_o.png" alt="bf161f192bd5434265f766e9ff11544e.png"> 
 <p>Service 实现类，定义了一个方法，用来递增 Redis 中的 count 键，每次递增 1，然后返回命令执行后的结果。而且这个 Service 方法加了@Transactional 注解。</p> 
 <img src="https://images2.imgbox.com/78/04/KF5iMmPB_o.png" alt="8a694eca97383c7f43a2aa8de2487718.png"> 
 <p>Postman 测试下，发现每发一次请求，count 都会递增 1，并没有返回 null。</p> 
 <img src="https://images2.imgbox.com/f0/c8/yMp2c3bg_o.png" alt="24a0ff8fe259364833045788bc11d511.png"> 
 <p>然后到 Redis 中查看数据，count 的值也是递增后的值 38，也不是 null。</p> 
 <img src="https://images2.imgbox.com/f2/29/wBSxPgQz_o.png" alt="6b069460e686b7e2880b7c6c8fe0df7a.png"> 
 <p>通过这个实验说明在 @Transactional 注解的方法里面执行 Redis 的操作并不会返回 null，结论我记录到了表格中。</p> 
 <img src="https://images2.imgbox.com/f5/52/wlSABop7_o.png" alt="79de12984446db9bfae4922dde2a598f.png"> 
 <p>所以说上面的推论不成立（加了 @Transactional 注解并不影响），到这里线索似乎断了。</p> 
 <h4>2.4 推测三</h4> 
 <p>然后跟当时做这块功能的开发人员说明了情况，告诉他可能是 Redis 事务造成的，然后问有没有其他同学在凌晨执行过 Redis 事务相关的 Job。</p> 
 <p>他说最近有同事加过 Redis 的事务功能，在凌晨执行 Job 的时候用到事务。我将这位同事加的代码简化后如下所示：</p> 
 <img src="https://images2.imgbox.com/28/70/bRZacIR6_o.png" alt="df4cc51dbe79e7e4b35f76d4a520d861.png"> 
 <p>下面是针对这段代码的解释，简单来说就是开启事务，将 Redis 命令顺序放到一个队列中，然后最后一起执行，且保证原子性。</p> 
 <p><code>setEnableTransactionSupport</code>表示是否开启事务支持，默认不开启。</p> 
 <img src="https://images2.imgbox.com/5a/81/J3oe1yMy_o.png" alt="68110deb2cc1a30ecb95880609d806bf.png"> 
 <blockquote> 
  <p>难道开启了 Redis 事务，还能影响 Spring 事务中的 Redis 操作？</p> 
 </blockquote> 
 <h4>2.5 验证推测三</h4> 
 <p>如下表，序号 3 和 序号 4 的场景都是<strong>开启了 Redis 的事务支持</strong>，两个场景的区别是<strong>是否加了 @Transactional 注解</strong>。</p> 
 <img src="https://images2.imgbox.com/8b/96/RgIBfuoH_o.png" alt="46bf23a4d734fbc199a81017d55232d1.png"> 
 <p>为了验证上面的场景，我们来做个实验：</p> 
 <ul><li><p>先开启 Redis 事务支持，然后执行 Redis 的事务命令 multi  和 exec 。</p></li><li><p>验证场景 3：在 @Transactional 注解的方法中执行 Redis 的递增操作。</p></li><li><p>验证场景 4：在非 @Transactional 注解的方法中执行 Redis 的递增操作</p></li></ul> 
 <h5>2.5.1 执行 Redis 事务</h5> 
 <p>首先就用 Redis 的 multi 和 exec 命令来设置两个 key 的值。</p> 
 <img src="https://images2.imgbox.com/d1/50/GbO9m7Z2_o.png" alt="e20d4beddcafc9d4d360bd5d180a6bec.png"> 
 <p>如下图所示，设置成功了。</p> 
 <img src="https://images2.imgbox.com/9f/c2/PAD5zES8_o.png" alt="3ce16c32477df06fad495f89197b5eb4.png"> 
 <h5>2.5.2 @Transactional 中执行 Redis 命令</h5> 
 <p>接下来在标注有 @Transactional 注解的方法中执行 Redis 的递增操作。<br></p> 
 <img src="https://images2.imgbox.com/a3/f8/CLcou9Gc_o.png" alt="c2f3ebfe7355e7af225499167082312c.png"> 
 <p>多次执行这个命令返回的结果都是 null，这不就正好重现了！</p> 
 <img src="https://images2.imgbox.com/7a/78/M7NGbmyj_o.png" alt="825901e05e2ab6c0571ce67bb20c4d2f.png"> 
 <p>再来看 Redis 中 count 的值，发现每执行一次 API 请求调用，都会递增 1，所以虽然命令返回的是 null，但最后 Redis 中存放的还是递增后的结果。</p> 
 <img src="https://images2.imgbox.com/08/83/CEJne9mJ_o.png" alt="145363cc616bb6ba97c56d4178ce64f0.png"> 
 <img src="https://images2.imgbox.com/c6/c2/HPoFWLgR_o.png" alt="514091a7b7efa4d22f4f0c3e06fdbaef.png"> 
 <p>接下来我们验证下场景 4，先执行 Redis 事务操作，然后在不添加 @Transactional 注解的方法中执行 Redis 递增操作。</p> 
 <img src="https://images2.imgbox.com/3a/16/P1011o7l_o.png" alt="4a7ea2a5a7382b5375832d59e7bbc54a.png"> 
 <p>用 Postman 调用这个接口后，正常返回自增后的结果，并不是返回 null。说明在非 @Transactional 中执行 Redis 操作并没有受到 Redis 事务的影响。</p> 
 <img src="https://images2.imgbox.com/f1/ea/71otwdJ6_o.png" alt="a10745e05f4e1a73d9ed14cec22f3936.png"> 
 <p>四个场景的结论如下所示，只有第三个场景下，Redis 的递增操作才会返回 null。</p> 
 <img src="https://images2.imgbox.com/53/60/wjAwp1ol_o.png" alt="9f5700cdab33ca11e738680282f07cf4.png"> 
 <p>问题原因找到了，说明 RedisTemplete 开启了 Redis 事务支持后，在 @Transactional 中执行的 Redis 命令也会被认为是在 Redis 事务中执行的，要执行的递增命令会被放到队列中，不会立即返回执行后的结果，返回的是一个 null，需要等待事务提交时，队列中的命令才会顺序执行，最后 Redis 数据库的键值才会递增。</p> 
 <h3><br></h3> 
 <blockquote> 
  <blockquote> 
   <p><strong>三、源码解析</strong></p> 
  </blockquote> 
 </blockquote> 
 <p>那我们就看下为什么开启了 Redis 事务支持，效果就不一样了。</p> 
 <p>找到 Redis 执行命令的核心方法， execute 方法。</p> 
 <img src="https://images2.imgbox.com/d0/1a/T2UAHb2f_o.png" alt="f266dda1ca9ab004ab82255b54d32df1.png"> 
 <p>然后一步一步点进去看，关键代码就是 211 行到 216 行，有一个逻辑判断，当开启了 Redis 事务支持后，就会去绑定一个连接（<code>bindConnection</code>），否则就去获取新的 Redis 连接（<code>getConnection</code>）。这里我们是开启了的，所以再到 <code>bindConnection</code>方法中查看如何绑定连接的。</p> 
 <img src="https://images2.imgbox.com/6f/9f/ttL04TMo_o.png" alt="f3b42a40e09e93f60be08af6fa258bec.png"> 
 <p>接着往下看，关键代码如下所示，当开启了 Redis 事务支持，且添加了 @Transactional 注解时，就会执行 Redis 的 mutil 命令。</p> 
 <p><strong>关键代码：conn.multi();</strong><br></p> 
 <img src="https://images2.imgbox.com/aa/4b/MzFbxoqn_o.png" alt="edf0a7747d4fa7108fd25e344835dffb.png"> 
 <p>Redis Multi 命令用于标记一个事务块的开始，事务块内的多条命令会按照先后顺序被放进一个队列当中，最后由 EXEC 命令原子性(atomic)地执行。</p> 
 <blockquote> 
  <p>真相大白，开启 Redis 事务支持 + @Transactional 注解后，最后其实是标记了一个 Redis 事务块，后续的操作命令是在这个事务块中执行的。</p> 
 </blockquote> 
 <p>比如下面的的递增命令并不会返回递增后的结果，而是返回 null。</p> 
 <pre class="has"><code class="language-go">stringRedisTemplate.opsForValue().increment("count", 1);</code></pre> 
 <p>而我们的生产环境重启服务后，开启的 Redis 事务支持又被重置为默认值了，所以后续的 Redis 递增操作都能正常执行。</p> 
 <h3><br></h3> 
 <blockquote> 
  <blockquote> 
   <p><strong>四、修复方案</strong></p> 
  </blockquote> 
 </blockquote> 
 <p>目前想到了两种解决方案：</p> 
 <ul><li><p>方案一：每次 Redis 的事务操作完成后，关闭 Redis 事务支持，然后再执行 @Transactional 中的 Redis 命令。（有弊端）</p></li><li><p>方案二：创建两个 StringRedisTemplate，一个专门用来执行 Redis 事务，一个用来执行普通的 Redis 命令。</p></li></ul> 
 <h4>4.1 方案一</h4> 
 <p>方案一的写法如下，先开启事务支持，事务执行之后，再关闭事务支持。</p> 
 <img src="https://images2.imgbox.com/10/85/i0EjOyQc_o.png" alt="114692a171295182cf3585e7a39791b8.png"> 
 <p>但是这种写法有个弊端，如果在执行 Redis 事务期间，在 @Transactional 注解的方法里面执行 Redis 命令，则还是会造成返回结果为 null。</p> 
 <img src="https://images2.imgbox.com/cd/9b/eGgEsjDl_o.png" alt="7bc662e285595c02e67cb1a89e6c8ec9.png"> 
 <h4>4.2 方案二</h4> 
 <p>弄两个 RedisTemplate Bean，一个是用来执行 Redis 事务的，一个是用来执行普通 Redis 命令的（不支持事务）。不同的地方引入不同的 Bean 就可以了。</p> 
 <p>先创建一个 RedisConfig 文件，自动装配两个 Bean。一个 Bean 名为 <code>stringRedisTemplate</code> 代表不支持事务的，执行命令后立即返回实际的执行结果。另外一个 Bean 名为 <code>stringRedisTemplateTransaction</code>，代表开启 Redis 事务支持的。</p> 
 <p>代码如下所示：</p> 
 <img src="https://images2.imgbox.com/aa/9b/BV3j7o0T_o.png" alt="ceaf9b84cf5141b160b458a91ec63887.png"> 
 <p>接下来在测试的 Service 类中注入两个不同的 StringRedisTemplate 实例，代码如下所示：</p> 
 <img src="https://images2.imgbox.com/75/5b/VjCt9WSV_o.png" alt="3249f2c29a12ee8ecd1e2d18fd0fb7ed.png"> 
 <p>Redis 事务的操作改写成这样，且不需要手动开启 Redis 事务支持了。用到的 StringRedisTemplate 是支持事务的那个实例。</p> 
 <img src="https://images2.imgbox.com/ee/cc/ewqeuv9s_o.png" alt="50433caaa8cc24eaef2c3f9681fc6122.png"> 
 <p>在 Spring 的 @Tranactional 中执行的 Redis 命令如下所示，用到的 StringRedisTemplate 是不支持事务的那个实例。</p> 
 <img src="https://images2.imgbox.com/73/a5/VbReGOqh_o.png" alt="ae91fd96925187d395249ae6cff17c34.png"> 
 <p>然后还是按照上面场景 3 的测试步骤，先执行 testRedisMutil 方法，再执行 testTransactionAnnotations 方法。</p> 
 <p><strong>验证结果</strong>：Redis 递增操作正常返回 count 的值，修复完成。</p> 
 <p>参考资料：https://blog.csdn.net/qq_34021712/article/details/79606551</p> 
 <p><img src="https://images2.imgbox.com/8f/af/SuOkCmd3_o.png" alt="f416c287808c4245c23d8267da707b26.png"></p> 
 <p><img src="https://images2.imgbox.com/e9/cd/zBZ5IKFJ_o.png" alt="5cc6825c4a47c99e377bc22b56444fd9.png"></p> 
 <p style="text-align:left;">欢迎扫码加入儒猿技术交流群，每天晚上20:00都有Java面试、Redis、MySQL、RocketMQ、SpringCloudAlibaba、Java架构等技术答疑分享，更能跟小伙伴们一起交流技术</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/86/25/93xJjr1J_o.png" alt="fd6471c4a02131257e124492e76d6798.png"></p> 
 <p style="text-align:center;"><strong>另外推荐儒猿课堂的1元系列课程给您，欢迎加入一起学习~</strong></p> 
 <p style="text-align:center;"><strong>互联网Java工程师面试突击课</strong></p> 
 <p style="text-align:center;"><strong>（1元专享）</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/77/08/PAia5ZZO_o.png" alt="bbcc4910bd3b07393e1326e8fabe5e37.png"></p> 
 <p style="text-align:center;"><strong>SpringCloudAlibaba零基础入门到项目实战</strong></p> 
 <p style="text-align:center;"><strong>（1元专享）</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/41/25/cVaKU7c6_o.png" alt="1bf77995dcf6373f8dc9213410e33d50.png"></p> 
 <p style="text-align:center;"><strong>亿级流量下的电商详情页系统实战项目</strong></p> 
 <p style="text-align:center;"><strong>（1元专享）</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/63/0d/SPJCWx8z_o.png" alt="ec1b7c8ff9eacadc186342fc84437fbe.png"></p> 
 <p style="text-align:center;"><strong>Kafka消息中间件内核源码精讲</strong></p> 
 <p style="text-align:center;"><strong>（1元专享）</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/af/64/pxrP4vwe_o.png" alt="2666d6c5bf69bf405157187bc0f41e60.png"></p> 
 <p style="text-align:center;"><strong>12个实战案例带你玩转Java并发编程</strong></p> 
 <p style="text-align:center;"><strong>（1元专享）</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/4d/30/JRfRDSuP_o.png" alt="720bc1df07ed502288f3400e063e9b43.png"></p> 
 <p style="text-align:center;"><strong>Elasticsearch零基础入门到精通</strong></p> 
 <p style="text-align:center;"><strong>（1元专享）</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/58/f0/RosBoEka_o.png" alt="c2ed3240e1c1272d08dff0ae8ff2ba2e.png"></p> 
 <p style="text-align:center;"><strong>基于Java手写分布式中间件系统实战</strong></p> 
 <p style="text-align:center;"><strong>（1元专享）</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/e9/b2/H8JIgHat_o.png" alt="1b49fe34034f2a7bcd655884134557fe.png"></p> 
 <p style="text-align:center;"><strong>基于ShardingSphere的分库分表实战课</strong></p> 
 <p style="text-align:center;"><strong>（1元专享）</strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/50/25/BKXvvxbE_o.png" alt="faf2bd25ee1eba88794490605aa0acb9.png"></p> 
</div>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/18264d8fa40298cb0d29c2e81675545f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">推荐30个以上比较好的意图识别github源码？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1018c1414cf771e2404a2b6a9007a4b0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">S32K144—从0到1一个MBD模型的诞生</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>