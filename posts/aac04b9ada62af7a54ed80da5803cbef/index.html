<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VBA操作剪切板 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VBA操作剪切板" />
<meta property="og:description" content="VBA操作剪切板 一，利用MsForms.DataObject操作1，什么是DataObject对象2，用vba操作剪切板注意3，声明方式4，文本写入剪切板5，读取剪切板文本 二，利用API操作剪切板1，用到得API函数2，写入剪切板3，读取4， 提取剪贴板所有数据格式的代码5，整理一个上面用得全部api 一，利用MsForms.DataObject操作 1，什么是DataObject对象 传输操作中使用的格式化文本数据的保留区域。 还保留 DataObject 中存储的文本块所对应的 格式 的列表
DataObject 可包括一段针对剪贴板文本格式的文本和一段针对每种其他文本格式（如自定义格式和用户定义的格式）的文本。
DataObject 与剪贴板不同。 DataObject 支持涉及剪贴板和文本的拖放操作的命令。 在启动涉及剪贴板的操作（如 GetText）或拖放操作时，该操作中涉及的数据将移动到 DataObject。
DataObject 的工作方式与剪贴板类似。 如果您将文本字符串复制到 DataObject，则 DataObject 将存储文本字符串。 如果您将同一格式的第二个字符串复制到 DataObject，则 DataObject 将弃用第一个文本字符串并存储第二个字符串的副本。 它将存储一段指定格式的文本并保留最近操作中的文本。
2，用vba操作剪切板注意 不要打开剪切板，同时只能一个操作，否则强制退出
3，声明方式 前期绑定
勾选–&gt;Micorosoft Forms 2.0 Object LIbrary
后期绑定
CreateObject(&#34;new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}&#34;)
4，文本写入剪切板 Sub test() Dim jq As New MSForms.DataObject Dim ss As String ss = &#34;测试文本&#34; &#39;文本变量 jq.SetText ss &#39;赋值给DataObject jq.PutInClipboard &#39;写入剪切板 End Sub 5，读取剪切板文本 Sub test2() Dim jq As New MSForms." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/aac04b9ada62af7a54ed80da5803cbef/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-26T13:23:55+08:00" />
<meta property="article:modified_time" content="2021-09-26T13:23:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VBA操作剪切板</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>VBA操作剪切板</h4> 
 <ul><li><ul><li><a href="#MsFormsDataObject_4" rel="nofollow">一，利用MsForms.DataObject操作</a></li><li><ul><li><a href="#1DataObject_6" rel="nofollow">1，什么是DataObject对象</a></li><li><a href="#2vba_16" rel="nofollow">2，用vba操作剪切板注意</a></li><li><a href="#3_20" rel="nofollow">3，声明方式</a></li><li><a href="#4_30" rel="nofollow">4，文本写入剪切板</a></li><li><a href="#5_43" rel="nofollow">5，读取剪切板文本</a></li></ul> 
   </li><li><a href="#API_58" rel="nofollow">二，利用API操作剪切板</a></li><li><ul><li><a href="#1API_60" rel="nofollow">1，用到得API函数</a></li><li><a href="#2_142" rel="nofollow">2，写入剪切板</a></li><li><a href="#3_214" rel="nofollow">3，读取</a></li><li><a href="#4__274" rel="nofollow">4， 提取剪贴板所有数据格式的代码</a></li><li><a href="#5api_394" rel="nofollow">5，整理一个上面用得全部api</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="MsFormsDataObject_4"></a>一，利用MsForms.DataObject操作</h3> 
<h4><a id="1DataObject_6"></a>1，什么是DataObject对象</h4> 
<p>传输操作中使用的格式化文本数据的保留区域。 还保留 DataObject 中存储的文本块所对应的 <strong>格式</strong> 的列表</p> 
<p><strong>DataObject</strong> 可包括一段针对剪贴板文本格式的文本和一段针对每种其他文本格式（如自定义格式和用户定义的格式）的文本。</p> 
<p><strong>DataObject</strong> 与剪贴板不同。 <strong>DataObject</strong> 支持涉及剪贴板和文本的拖放操作的命令。 在启动涉及剪贴板的操作（如 <strong>GetText</strong>）或拖放操作时，该操作中涉及的数据将移动到 <strong>DataObject</strong>。</p> 
<p><strong>DataObject</strong> 的工作方式与剪贴板类似。 如果您将文本字符串复制到 <strong>DataObject</strong>，则 <strong>DataObject</strong> 将存储文本字符串。 如果您将同一格式的第二个字符串复制到 <strong>DataObject</strong>，则 <strong>DataObject</strong> 将弃用第一个文本字符串并存储第二个字符串的副本。 它将存储一段指定格式的文本并保留最近操作中的文本。</p> 
<h4><a id="2vba_16"></a>2，用vba操作剪切板注意</h4> 
<p>不要打开剪切板，同时只能一个操作，否则强制退出</p> 
<h4><a id="3_20"></a>3，声明方式</h4> 
<ol><li> <p>前期绑定</p> <p>勾选–&gt;<code>Micorosoft Forms 2.0 Object LIbrary</code></p> </li><li> <p>后期绑定</p> <p><code>CreateObject("new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}")</code></p> </li></ol> 
<h4><a id="4_30"></a>4，文本写入剪切板</h4> 
<pre><code class="prism language-vbnet"><span class="token keyword">Sub</span> test<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> jq <span class="token keyword">As</span> <span class="token keyword">New</span> MSForms.DataObject
    <span class="token keyword">Dim</span> ss <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    ss <span class="token operator">=</span> "测试文本"  <span class="token comment">'文本变量</span>
    jq.SetText ss  <span class="token comment">'赋值给DataObject</span>
    jq.PutInClipboard <span class="token comment">'写入剪切板</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> 
<h4><a id="5_43"></a>5，读取剪切板文本</h4> 
<pre><code class="prism language-vbnet"><span class="token keyword">Sub</span> test2<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> jq <span class="token keyword">As</span> <span class="token keyword">New</span> MSForms.DataObject
    <span class="token keyword">Dim</span> ss <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    jq.GetFromClipboard <span class="token comment">'读取剪切板</span>
    ss <span class="token operator">=</span> jq.GetText   <span class="token comment">'调用方法得到文本</span>
    <span class="token function">Debug</span>.<span class="token function">Print</span> ss
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> 
<h3><a id="API_58"></a>二，利用API操作剪切板</h3> 
<h4><a id="1API_60"></a>1，用到得API函数</h4> 
<ol><li> <p><code>OpenClipboard</code>函数：作用是打开剪贴板</p> <p>声明及引用：<code>Declare Function OpenClipboard Lib "user32" Alias "OpenClipboard" (ByVal hwnd As Long) As Long</code></p> <p>如果调用成功，它会返回一个非0值；如果失败，则返回0；</p> <p>如果有其他窗口已经打开剪贴板，这个函数会调用失败。</p> <p>如果函数调用成功，一定要记得使用<code>CloseClipboard</code>函数关闭它。</p> </li><li> <p><code>GetClipboardData</code>函数：作用是读取剪贴板里面的数据</p> <p>声明及引用：<code>Declare Function GetClipboardData Lib "user32" (ByVal wFormat As Long) As Long</code></p> <p>如果调用成功，返回剪贴板中以指定格式存放的剪贴板对象的句柄；</p> <p>如果调用失败，返回Null；</p> <p>在使用<code>GetClipboardData</code>之前，必须先成功调用<code>OpenClipboard</code></p> <p>常用得几个常量</p> 
  <ul><li> <p>Public Const CF_TEXT = 1</p> </li><li> <p>Public Const CF_BITMAP = 2</p> </li><li> <p>Public Const CF_METAFILEPICT = 3</p> </li><li> <p>Public Const CF_SYLK = 4</p> </li></ul> </li><li> <p><code>CopyMemory</code>函数将一定字节长度的数据从内存中的一个位置（源）复制到另一个位置（目的地）</p> <p>声明及引用：<code>Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (Destination As Any, Source As Any, ByVal Length As Long)</code></p> <p>这个函数需要三个参数：</p> 
  <ul><li> <p><code>Destination</code>：目的地的第一个字节的内存地址（指针）</p> </li><li> <p><code>Source</code>:　　　源的第一个字节的内存地址（指针）</p> </li><li> <p><code>Length</code>:　　　要复制的数据的长度</p> </li></ul> </li><li> <p><code>GlobalLock</code>函数锁定一个全局内存对象并返回它所占用内存块的第一个字节的内存地址（指针）</p> <p>声明及引用：<code>Declare Function GlobalLock Lib "kernel32" (ByVal hMem As Long) As Long</code></p> </li><li> <p><code>GlobalSize</code>函数返回给定内存对象的字节长度</p> <p>声明及引用：<code>Declare Function GlobalSize Lib "kernel32" (ByVal hMem As Long) As Long</code></p> </li><li> <p><code>GlobalUnlock</code>函数将可移动(GMEM_MOVEABLE)内存对象的锁计数器数值－1，对于固定位置(GMEM_FIXED)的内存对象，这个函数不起作用</p> <p><strong>简单说这个函数就是解锁内存指针和上面锁定对应</strong></p> <pre><code> 用到上面GlobalAlloc函数得到参数来解锁
</code></pre> <p>声明及引用：<code>Declare Function GlobalUnlock Lib "kernel32" (ByVal hMem As Long) As Long</code></p> </li><li> <p><code>CloseClipboard</code>函数关闭剪贴板</p> <p>声明及引用：<code>Declare Function CloseClipboard Lib "user32"() As Long</code></p> </li><li> <p><code>EmptyClipboard</code>函数清空剪切板</p> <p>声明及引用：<code>Declare Function EmptyClipboard Lib "user32" () As Long</code></p> </li><li> <p>GlobalAlloc分配可移动的全局内存</p> <p>声明及引用：<code>Private Declare Function GlobalAlloc Lib "kernel32" (ByVal wFlags As Long, ByVal dwBytes As Long) As Long</code></p> <pre><code> wFlags 参数给个常量：`Const GHND = &amp;H42`
</code></pre> </li><li> <p>lstrcpy复制字符串到该全局内存</p> <p>声明及引用：<code>Private Declare Function lstrcpy Lib "kernel32" (ByVal lpString1 As Any, ByVal lpString2 As Any) As Long</code></p> <pre><code> lpString1 是要复制得内存指针地址，用`GlobalLock`得到
</code></pre> </li></ol> 
<h4><a id="2_142"></a>2，写入剪切板</h4> 
<pre><code class="prism language-vbnet"><span class="token comment">'处理64位和32位Office</span>
<span class="token keyword">#If</span> VBA7 <span class="token keyword">And</span> Win64 <span class="token keyword">Then</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalUnlock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalLock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalAlloc <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFlags <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> dwBytes <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> CloseClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> OpenClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hwnd <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> EmptyClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> lstrcpy <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpString1 <span class="token keyword">As</span> Any<span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> lpString2 <span class="token keyword">As</span> Any<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> SetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
<span class="token keyword">#Else</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalUnlock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span>ByValhMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalLock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMemAs <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalAlloc <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span>ByValwFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> dwBytes <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> CloseClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> AsLong
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> OpenClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span>ByValhwnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> EmptyClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> AsLong
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> lstrcpy <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span>ByVallpString1 <span class="token keyword">As</span> Any<span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> lpString2 <span class="token keyword">As</span> Any<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> FunctionSetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat _
        <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">#End</span> <span class="token keyword">If</span>
<span class="token keyword">Const</span> GHND <span class="token operator">=</span> <span class="token operator">&amp;</span>H42
<span class="token keyword">Const</span> CF_TEXT <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">Const</span> MAXSIZE <span class="token operator">=</span> <span class="token number">4096</span>
<span class="token comment">'复制文本到剪贴板的API函数</span>
<span class="token comment">'来源:www.msdn.microsoft.com/en-us/library/office/ff192913.aspx</span>
<span class="token keyword">Function</span> ClipBoard_SetData<span class="token punctuation">(</span>MyString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> hGlobalMemory <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> lpGlobalMemory <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Dim</span> hClipMemory <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> X <span class="token keyword">As</span> LongPtr
    <span class="token comment">'分配可移动的全局内存</span>
    hGlobalMemory <span class="token operator">=</span> GlobalAlloc<span class="token punctuation">(</span>GHND<span class="token punctuation">,</span> <span class="token function">Len</span><span class="token punctuation">(</span>MyString<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token comment">'锁定该块以获取该内存的远指针</span>
    lpGlobalMemory <span class="token operator">=</span> GlobalLock<span class="token punctuation">(</span>hGlobalMemory<span class="token punctuation">)</span>
    <span class="token comment">'复制字符串到该全局内存</span>
    lpGlobalMemory <span class="token operator">=</span> lstrcpy<span class="token punctuation">(</span>lpGlobalMemory<span class="token punctuation">,</span> MyString<span class="token punctuation">)</span>
    <span class="token comment">'解锁该内存</span>
    <span class="token keyword">If</span> GlobalUnlock<span class="token punctuation">(</span>hGlobalMemory<span class="token punctuation">)</span> <span class="token operator">&lt;&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        MsgBox "不能解锁内存位置. 复制中止."
        <span class="token keyword">GoTo</span> OutOfHere2
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token comment">'打开剪贴板复制数据.</span>
    <span class="token keyword">If</span> OpenClipboard<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        MsgBox "不能打开剪贴板. 复制中止."
        <span class="token keyword">Exit</span> <span class="token keyword">Function</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token comment">'清空剪贴板</span>
    X <span class="token operator">=</span> EmptyClipboard<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">'复制数据到剪贴板</span>
    hClipMemory <span class="token operator">=</span> SetClipboardData<span class="token punctuation">(</span>CF_TEXT<span class="token punctuation">,</span> hGlobalMemory<span class="token punctuation">)</span>
OutOfHere2<span class="token punctuation">:</span>
    <span class="token keyword">If</span> CloseClipboard<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        MsgBox "不能关闭剪贴板."
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>
<span class="token keyword">Sub</span> CopyTextToClipboard<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> strText <span class="token keyword">As</span> <span class="token keyword">String</span>
    strText <span class="token operator">=</span> "这里使用VBA复制文本到剪贴板<span class="token comment">!"</span>
    <span class="token comment">'放置文本到剪贴板</span>
    ClipBoard_SetData strText
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> 
<h4><a id="3_214"></a>3，读取</h4> 
<p>代码</p> 
<pre><code class="prism language-vbnet"><span class="token comment">'来源：https://zhuanlan.zhihu.com/p/214106380</span>
<span class="token keyword">#If</span> VBA7 <span class="token keyword">And</span> Win64 <span class="token keyword">Then</span>
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> OpenClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hwnd <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> CloseClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Sub</span> CopyMemory <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token keyword">Alias</span> <span class="token string">"RtlMoveMemory"</span> <span class="token punctuation">(</span>Destination <span class="token keyword">As</span> Any<span class="token punctuation">,</span> Source <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token function">Length</span> <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span>
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalLock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalUnlock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalSize <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
<span class="token keyword">#Else</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> OpenClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hwnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> CloseClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Sub</span> CopyMemory <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token keyword">Alias</span> <span class="token string">"RtlMoveMemory"</span> <span class="token punctuation">(</span>Destination <span class="token keyword">As</span> Any<span class="token punctuation">,</span> Source <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token function">Length</span> <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalLock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalUnlock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalSize <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">#End</span> <span class="token keyword">If</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_TEXT <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">Sub</span> mynzB<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">#If</span> VBA7 <span class="token keyword">And</span> Win64 <span class="token keyword">Then</span>
        <span class="token keyword">Dim</span> hMem <span class="token keyword">As</span> LongPtr
        <span class="token keyword">Dim</span> lpData <span class="token keyword">As</span> LongPtr
        <span class="token keyword">Dim</span> nClipSize <span class="token keyword">As</span> LongPtr
    <span class="token keyword">#Else</span>
        <span class="token keyword">Dim</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span>
        <span class="token keyword">Dim</span> lpData <span class="token keyword">As</span> <span class="token keyword">Long</span>
        <span class="token keyword">Dim</span> nClipSize <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">#End</span> <span class="token keyword">If</span>
    <span class="token keyword">Dim</span> bytClipData<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Byte</span>
    <span class="token keyword">Dim</span> sClipString <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token comment">'Sheets("sheet1").Select</span>
    Range<span class="token punctuation">(</span><span class="token string">"A1:A3"</span><span class="token punctuation">)</span>.Copy
    <span class="token keyword">If</span> OpenClipboard<span class="token punctuation">(</span><span class="token keyword">ByVal</span> <span class="token number">0</span><span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token comment">'如果OpenClipboard函数返回非0值，说明成功打开剪贴板</span>
        hMem <span class="token operator">=</span> GetClipboardData<span class="token punctuation">(</span>CF_TEXT<span class="token punctuation">)</span> <span class="token comment">'获取剪贴板中以文本格式存在的内存对象的句柄</span>
        <span class="token comment">'如果剪贴板中对应的格式不存在，此时的hMem会是0(Null)</span>
        <span class="token comment">'这里用CBool把它转换成Boolean类型加以判断</span>
        <span class="token keyword">If</span> <span class="token keyword">CBool</span><span class="token punctuation">(</span>hMem<span class="token punctuation">)</span> <span class="token keyword">Then</span>
            lpData <span class="token operator">=</span> GlobalLock<span class="token punctuation">(</span>hMem<span class="token punctuation">)</span> <span class="token comment">'获取内存对象第一个字节的内存地址</span>
            nClipSize <span class="token operator">=</span> GlobalSize<span class="token punctuation">(</span>hMem<span class="token punctuation">)</span> <span class="token comment">'获取内存对象的字节长度</span>
            <span class="token comment">'修改缓冲字节数组的长度，确保能够容纳内存对象的全部数据</span>
            <span class="token keyword">ReDim</span> bytClipData<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> <span class="token keyword">CLng</span><span class="token punctuation">(</span>nClipSize<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">'复制内存对象的数据到字节数组中，注意Byval的用法</span>
            CopyMemory bytClipData<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpData<span class="token punctuation">,</span> nClipSize
            sClipString <span class="token operator">=</span> StrConv<span class="token punctuation">(</span>bytClipData<span class="token punctuation">,</span> vbUnicode<span class="token punctuation">)</span> <span class="token comment">'将字节转化成字符串</span>
            MsgBox "当前剪贴板内的文本是：" <span class="token operator">&amp;</span> vbCrLf <span class="token operator">&amp;</span> sClipString <span class="token comment">'将结果显示给用户</span>
        <span class="token keyword">Else</span>
            MsgBox "当前剪贴板内没有文本"
        <span class="token keyword">End</span> <span class="token keyword">If</span>
        CloseClipboard  <span class="token comment">'记住关闭，否则下次用报错</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> 
<h4><a id="4__274"></a>4， 提取剪贴板所有数据格式的代码</h4> 
<pre><code class="prism language-vbnet"><span class="token keyword">#If</span> VBA7 <span class="token keyword">And</span> Win64 <span class="token keyword">Then</span>
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> OpenClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hwnd <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> CloseClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Sub</span> CopyMemory <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token keyword">Alias</span> <span class="token string">"RtlMoveMemory"</span> <span class="token punctuation">(</span>Destination <span class="token keyword">As</span> Any<span class="token punctuation">,</span> Source <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token function">Length</span> <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span>
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalLock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalUnlock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalSize <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token comment">'这是获得剪切板格式用到得额外得api函数</span>
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> EnumClipboardFormats <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GetClipboardFormatName <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token keyword">Alias</span> <span class="token string">"GetClipboardFormatNameA"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nMaxCount <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
<span class="token keyword">#Else</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> OpenClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hwnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> CloseClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Sub</span> CopyMemory <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token keyword">Alias</span> <span class="token string">"RtlMoveMemory"</span> <span class="token punctuation">(</span>Destination <span class="token keyword">As</span> Any<span class="token punctuation">,</span> Source <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token function">Length</span> <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalLock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalUnlock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalSize <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> EnumClipboardFormats <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span>ByValwFormat <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GetClipboardFormatName <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token keyword">Alias</span> <span class="token string">"GetClipboardFormatNameA"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nMaxCount <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">#End</span> <span class="token keyword">If</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_TEXT <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment">'文本常量</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_BITMAP <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">'Bitmap对象</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_METAFILEPICT <span class="token operator">=</span> <span class="token number">3</span> <span class="token comment">'Metafile Picture格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_SYLK <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment">'微软符号连接格式（Microsoft Symbolic Link Format）</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_DIF <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment">'Software Arts' Data Interchange Format.</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_TIFF <span class="token operator">=</span> <span class="token number">6</span> <span class="token comment">'标签图像文件格式（TIFF）</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_OEMTEXT <span class="token operator">=</span> <span class="token number">7</span> <span class="token comment">'包含OEM字符集的文本格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_DIB <span class="token operator">=</span> <span class="token number">8</span> <span class="token comment">'设备无关位图（DIB）格式，前面是一个BITMAPINFO结构，后面是图像像素位</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_PALETTE <span class="token operator">=</span> <span class="token number">9</span> <span class="token comment">'调色板对象格式，当程序向剪贴板中放入一幅使用调色板的位图时，它需要同时将调色板也放入剪贴板</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_PENDATA <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">'手写笔数据</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_RIFF <span class="token operator">=</span> <span class="token number">11</span> <span class="token comment">'比标准CF_WAVE所能代表的音频格式更加复杂的音频格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_WAVE <span class="token operator">=</span> <span class="token number">12</span> <span class="token comment">'标准音频格式（如11kHz或22kHz脉冲编码调制）的数据</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_UNICODETEXT <span class="token operator">=</span> <span class="token number">13</span> <span class="token comment">'Unicode文本格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_ENHMETAFILE <span class="token operator">=</span> <span class="token number">14</span> <span class="token comment">'增强图元文件格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_HDROP <span class="token operator">=</span> <span class="token number">15</span> <span class="token comment">'文件名列表</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_LOCALE <span class="token operator">=</span> <span class="token number">16</span> <span class="token comment">'与剪贴板内文本相关的区域选项的ID</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_MAX <span class="token operator">=</span> <span class="token number">17</span>
<span class="token keyword">Dim</span> lFormat <span class="token keyword">As</span> LongPtr
<span class="token keyword">Sub</span> mynzC<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> i
    Sheets<span class="token punctuation">(</span><span class="token string">"SHEET2"</span><span class="token punctuation">)</span>.<span class="token keyword">Select</span>
    Cells<span class="token punctuation">(</span><span class="token punctuation">)</span>.ClearContents
    Sheets<span class="token punctuation">(</span><span class="token string">"SHEET4"</span><span class="token punctuation">)</span>.<span class="token keyword">Select</span>
    Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>.Copy
    Sheets<span class="token punctuation">(</span><span class="token string">"SHEET2"</span><span class="token punctuation">)</span>.<span class="token keyword">Select</span>
    <span class="token keyword">If</span> OpenClipboard<span class="token punctuation">(</span><span class="token keyword">ByVal</span> <span class="token number">0</span><span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
        lFormat <span class="token operator">=</span> EnumClipboardFormats<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">If</span> lFormat <span class="token operator">&lt;&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
            i <span class="token operator">=</span> <span class="token number">1</span>
            Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> "格式代码"
            Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> "格式名称"
            i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">Do</span> <span class="token keyword">While</span> lFormat <span class="token operator">&lt;&gt;</span> <span class="token number">0</span>
                Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> lFormat
                Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> GetFormatName<span class="token punctuation">(</span>lFormat<span class="token punctuation">)</span>
                i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
                lFormat <span class="token operator">=</span> EnumClipboardFormats<span class="token punctuation">(</span>lFormat<span class="token punctuation">)</span>
            <span class="token keyword">Loop</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
        CloseClipboard
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
<span class="token keyword">Public</span> <span class="token keyword">Function</span> GetFormatName<span class="token punctuation">(</span><span class="token keyword">ByVal</span> lFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Select Case</span> lFormat
        <span class="token keyword">Case</span> <span class="token number">1</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_Text"</span>
        <span class="token keyword">Case</span> <span class="token number">2</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_Bitmap"</span>
        <span class="token keyword">Case</span> <span class="token number">3</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_MetaFilePict"</span>
        <span class="token keyword">Case</span> <span class="token number">4</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_SYLK"</span>
        <span class="token keyword">Case</span> <span class="token number">5</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_Dif"</span>
        <span class="token keyword">Case</span> <span class="token number">6</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_Tiff"</span>
        <span class="token keyword">Case</span> <span class="token number">7</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_OEMText"</span>
        <span class="token keyword">Case</span> <span class="token number">8</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_DIB"</span>
        <span class="token keyword">Case</span> <span class="token number">9</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_Pallette"</span>
        <span class="token keyword">Case</span> <span class="token number">10</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_PenData"</span>
        <span class="token keyword">Case</span> <span class="token number">11</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_Riff"</span>
        <span class="token keyword">Case</span> <span class="token number">12</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_Wave"</span>
        <span class="token keyword">Case</span> <span class="token number">13</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_UnicodeText"</span>
        <span class="token keyword">Case</span> <span class="token number">14</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_EnhMetaFile"</span>
        <span class="token keyword">Case</span> <span class="token number">15</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_HDrop"</span>
        <span class="token keyword">Case</span> <span class="token number">16</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_Locale"</span>
        <span class="token keyword">Case</span> <span class="token number">17</span>
            GetFormatName <span class="token operator">=</span> <span class="token string">"CF_Max"</span>
        <span class="token keyword">Case</span> <span class="token keyword">Else</span><span class="token punctuation">:</span>
            <span class="token comment">'以下是非标准部分</span>
            <span class="token keyword">Dim</span> sBuffer <span class="token keyword">As</span> <span class="token keyword">String</span>
            sBuffer <span class="token operator">=</span> <span class="token keyword">String</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token function">Chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            GetClipboardFormatName lFormat<span class="token punctuation">,</span> sBuffer<span class="token punctuation">,</span> <span class="token number">100</span>
            GetFormatName <span class="token operator">=</span> Trim<span class="token punctuation">(</span>sBuffer<span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">Select</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>
<span class="token keyword">Sub</span> mynzD<span class="token punctuation">(</span><span class="token punctuation">)</span>
    CloseClipboard
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> 
<p>api弄得比较乱</p> 
<h4><a id="5api_394"></a>5，整理一个上面用得全部api</h4> 
<pre><code class="prism language-vbnet"><span class="token keyword">#If</span> VBA7 <span class="token keyword">And</span> Win64 <span class="token keyword">Then</span>
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> OpenClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hwnd <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> CloseClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Sub</span> CopyMemory <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token keyword">Alias</span> <span class="token string">"RtlMoveMemory"</span> <span class="token punctuation">(</span>Destination <span class="token keyword">As</span> Any<span class="token punctuation">,</span> _
        Source <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token function">Length</span> <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span>
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalLock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalUnlock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalSize <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token comment">'这是获得剪切板格式用到得额外得api函数</span>
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> EnumClipboardFormats <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GetClipboardFormatName <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token keyword">Alias</span> <span class="token string">"GetClipboardFormatNameA"</span> _
        <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nMaxCount <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr

    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> GlobalAlloc <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFlags <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> dwBytes <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> EmptyClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> lstrcpy <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpString1 <span class="token keyword">As</span> Any<span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> lpString2 <span class="token keyword">As</span> Any<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> PtrSafe <span class="token keyword">Function</span> SetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> LongPtr<span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> LongPtr<span class="token punctuation">)</span> <span class="token keyword">As</span> LongPtr

<span class="token keyword">#Else</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> OpenClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hwnd <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> CloseClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Sub</span> CopyMemory <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token keyword">Alias</span> <span class="token string">"RtlMoveMemory"</span> <span class="token punctuation">(</span>Destination <span class="token keyword">As</span> Any<span class="token punctuation">,</span> Source <span class="token keyword">As</span> Any<span class="token punctuation">,</span> <span class="token keyword">ByVal</span> <span class="token function">Length</span> <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalLock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalUnlock <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalSize <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> EnumClipboardFormats <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span>ByValwFormat <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GetClipboardFormatName <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token keyword">Alias</span> <span class="token string">"GetClipboardFormatNameA"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> lpString <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> nMaxCount <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>

    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> GlobalAlloc <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFlags <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> dwBytes <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> EmptyClipboard <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> AsLong
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> <span class="token keyword">Function</span> lstrcpy <span class="token keyword">Lib</span> <span class="token string">"kernel32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> lpString1 <span class="token keyword">As</span> Any<span class="token punctuation">,</span> _
        <span class="token keyword">ByVal</span> lpString2 <span class="token keyword">As</span> Any<span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Private</span> <span class="token keyword">Declare</span> FunctionSetClipboardData <span class="token keyword">Lib</span> <span class="token string">"user32"</span> <span class="token punctuation">(</span><span class="token keyword">ByVal</span> wFormat _
        <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> hMem <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
<span class="token keyword">#End</span> <span class="token keyword">If</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_TEXT <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment">'文本常量</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_BITMAP <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">'Bitmap对象</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_METAFILEPICT <span class="token operator">=</span> <span class="token number">3</span> <span class="token comment">'Metafile Picture格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_SYLK <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment">'微软符号连接格式（Microsoft Symbolic Link Format）</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_DIF <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment">'Software Arts' Data Interchange Format.</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_TIFF <span class="token operator">=</span> <span class="token number">6</span> <span class="token comment">'标签图像文件格式（TIFF）</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_OEMTEXT <span class="token operator">=</span> <span class="token number">7</span> <span class="token comment">'包含OEM字符集的文本格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_DIB <span class="token operator">=</span> <span class="token number">8</span> <span class="token comment">'设备无关位图（DIB）格式，前面是一个BITMAPINFO结构，后面是图像像素位</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_PALETTE <span class="token operator">=</span> <span class="token number">9</span> <span class="token comment">'调色板对象格式，当程序向剪贴板中放入一幅使用调色板的位图时，它需要同时将调色板也放入剪贴板</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_PENDATA <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">'手写笔数据</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_RIFF <span class="token operator">=</span> <span class="token number">11</span> <span class="token comment">'比标准CF_WAVE所能代表的音频格式更加复杂的音频格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_WAVE <span class="token operator">=</span> <span class="token number">12</span> <span class="token comment">'标准音频格式（如11kHz或22kHz脉冲编码调制）的数据</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_UNICODETEXT <span class="token operator">=</span> <span class="token number">13</span> <span class="token comment">'Unicode文本格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_ENHMETAFILE <span class="token operator">=</span> <span class="token number">14</span> <span class="token comment">'增强图元文件格式</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_HDROP <span class="token operator">=</span> <span class="token number">15</span> <span class="token comment">'文件名列表</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_LOCALE <span class="token operator">=</span> <span class="token number">16</span> <span class="token comment">'与剪贴板内文本相关的区域选项的ID</span>
<span class="token keyword">Private</span> <span class="token keyword">Const</span> CF_MAX <span class="token operator">=</span> <span class="token number">17</span>

<span class="token keyword">Const</span> GHND <span class="token operator">=</span> <span class="token operator">&amp;</span>H42
<span class="token keyword">Const</span> MAXSIZE <span class="token operator">=</span> <span class="token number">4096</span>
</code></pre> 
<p>再比较常用得比如从剪切板导出图片<br> 从剪切板读取图片到控件等，大同小异</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2849fc4699956bc572c40e6f206b881c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【从零学习硬件】I2C总线协议学习</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/64d72bbe5c12fb1e9da290b19972d372/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux系统设置history显示命令运行的时间</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>