<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hive的函数 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Hive的函数" />
<meta property="og:description" content="提示：文章内容仅供参考
目录
前言
一.内置函数
二.处理json数据
三.窗口函数
1.窗口聚合
2.窗口分片
3.窗口排序
4.上下移动
5.首尾值
四.自定义函数
1.自定义UDF
五. Hive的Shell操作
总结
前言 本文就主要介绍hive函数了。
提示：以下是本篇文章正文内容，下面案例可供参考
一.内置函数 类型转换
cast(expr as &lt;type&gt;)
例：select cast(‘1’ as bignit)
select cast(‘money’ as bignit)
切割
split(string str, string pat)
例：select split(&#39;hi|hello|morning&#39;,&#39;\\|&#39;)
正则表达式截取字符串
select regexp_extract(字段名,正则表达式,索引)
regexp_extract(string subject, string pattern, int index)
例：select regexp_extract(&#39;hello&lt;B&gt;world&lt;/B&gt;haha&#39;,&#39;&lt;B&gt;(.*)&lt;/B&gt;&#39;,1)
将字符串前后出现的空格去掉
去掉首尾空格 : trim(atring A)去掉字段的前置空格 : ltrim(atring A)去掉字段的后置空格 : rtrim(atring A) 例：select trim(‘ hallo ’)
select ltrim(‘ hallo ’)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/ab74f1834fe2f54c92df3d88f33a8b60/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-20T14:07:28+08:00" />
<meta property="article:modified_time" content="2022-10-20T14:07:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hive的函数</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p>提示：文章内容仅供参考</p> 
</blockquote> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="-toc" style="margin-left:0px;"><a href="#%E4%B8%80.%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0" rel="nofollow">一.内置函数</a></p> 
<p id="%E4%BA%8C.%E5%A4%84%E7%90%86json%E6%95%B0%E6%8D%AE-toc" style="margin-left:0px;"><a href="#%E4%BA%8C.%E5%A4%84%E7%90%86json%E6%95%B0%E6%8D%AE" rel="nofollow">二.处理json数据</a></p> 
<p id="%E4%B8%89.%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0-toc" style="margin-left:0px;"><a href="#%E4%B8%89.%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0" rel="nofollow">三.窗口函数</a></p> 
<p id="1.%E7%AA%97%E5%8F%A3%E8%81%9A%E5%90%88-toc" style="margin-left:40px;"><a href="#1.%E7%AA%97%E5%8F%A3%E8%81%9A%E5%90%88" rel="nofollow">1.窗口聚合</a></p> 
<p id="2.%E7%AA%97%E5%8F%A3%E5%88%86%E7%89%87-toc" style="margin-left:40px;"><a href="#2.%E7%AA%97%E5%8F%A3%E5%88%86%E7%89%87" rel="nofollow">2.窗口分片</a></p> 
<p id="-toc" style="margin-left:40px;"><a href="#3.%E7%AA%97%E5%8F%A3%E6%8E%92%E5%BA%8F" rel="nofollow">3.窗口排序</a></p> 
<p id="4.%E4%B8%8A%E4%B8%8B%E7%A7%BB%E5%8A%A8-toc" style="margin-left:40px;"><a href="#4.%E4%B8%8A%E4%B8%8B%E7%A7%BB%E5%8A%A8" rel="nofollow">4.上下移动</a></p> 
<p id="5.%E9%A6%96%E5%B0%BE%E5%80%BC-toc" style="margin-left:40px;"><a href="#5.%E9%A6%96%E5%B0%BE%E5%80%BC" rel="nofollow">5.首尾值</a></p> 
<p id="%E5%9B%9B.%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0-toc" style="margin-left:0px;"><a href="#%E5%9B%9B.%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0" rel="nofollow">四.自定义函数</a></p> 
<p id="1.%E8%87%AA%E5%AE%9A%E4%B9%89UDF-toc" style="margin-left:40px;"><a href="#1.%E8%87%AA%E5%AE%9A%E4%B9%89UDF" rel="nofollow">1.自定义UDF</a></p> 
<p id="-toc" style="margin-left:0px;"><a href="#%E4%BA%94.%C2%A0Hive%E7%9A%84Shell%E6%93%8D%E4%BD%9C" rel="nofollow">五. Hive的Shell操作</a></p> 
<p id="-toc" style="margin-left:0px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E5%89%8D%E8%A8%80">前言</h2> 
<p>本文就主要介绍hive函数了。</p> 
<hr> 
<p><code>提示：以下是本篇文章正文内容，下面案例可供参考</code></p> 
<h2><a id="pandas_16"></a></h2> 
<h2 id="%E4%B8%80.%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0">一.内置函数</h2> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>类型转换</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">cast(expr as &lt;type&gt;)</p> 
<p style="margin-left:.0001pt;text-align:justify;">例：select cast(‘1’ as bignit)</p> 
<p style="margin-left:.0001pt;text-align:justify;">select cast(‘money’ as bignit)</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="373" src="https://images2.imgbox.com/45/0d/BrAUxFsF_o.png" width="646"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>切割</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">split(string str, string pat)</p> 
<p style="margin-left:.0001pt;text-align:justify;">例：select split('hi|hello|morning','\\|')</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="114" src="https://images2.imgbox.com/f7/c5/ad71YPvl_o.png" width="692"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>正则表达式截取字符串</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">select regexp_extract(字段名,正则表达式,索引)</p> 
<p style="margin-left:.0001pt;text-align:justify;">regexp_extract(string subject, string pattern, int index)</p> 
<p style="margin-left:.0001pt;text-align:justify;">例：select regexp_extract('hello&lt;B&gt;world&lt;/B&gt;haha','&lt;B&gt;(.*)&lt;/B&gt;',1)</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="102" src="https://images2.imgbox.com/f3/5f/U4J0wwEL_o.png" width="692"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>将字符串前后出现的空格去掉</strong></strong></p> 
<ul><li style="text-align:justify;">去掉首尾空格 : trim(atring A)</li><li style="text-align:justify;">去掉字段的前置空格 : ltrim(atring A)</li><li style="text-align:justify;">去掉字段的后置空格 : rtrim(atring A)</li></ul> 
<p style="margin-left:.0001pt;text-align:justify;">例：select trim(‘           hallo         ’)</p> 
<p style="margin-left:.0001pt;text-align:justify;">select ltrim(‘           hallo         ’)</p> 
<p style="margin-left:.0001pt;text-align:justify;">select rtrim(‘           hallo         ’)</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="328" src="https://images2.imgbox.com/26/f2/ayPBnzVz_o.png" width="692"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>求指定列的</strong></strong><strong><strong>聚合函数</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">指定列元素求和：sum(col)</p> 
<p style="margin-left:.0001pt;text-align:justify;">指定列元素平均值：avg(col)</p> 
<p style="margin-left:.0001pt;text-align:justify;">指定列元素最小值：min(col)</p> 
<p style="margin-left:.0001pt;text-align:justify;">指定列元素最大值：max(col)</p> 
<p style="margin-left:.0001pt;text-align:justify;">例：数据准备：</p> 
<p style="margin-left:.0001pt;text-align:justify;">name subject score</p> 
<p style="margin-left:.0001pt;text-align:justify;">zhangsan,数学,99</p> 
<p style="margin-left:.0001pt;text-align:justify;">lisi,数学,89</p> 
<p style="margin-left:.0001pt;text-align:justify;">wangwu,数学,80</p> 
<p style="margin-left:.0001pt;text-align:justify;">zhaozhu,Hadoop,98</p> 
<p style="margin-left:.0001pt;text-align:justify;">tingting,Hadoop,78</p> 
<p style="text-align:justify;">1.求和：</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：0: jdbc:hive2://192.168.67.110:10000&gt; select subject,sum(score)</p> 
<p style="margin-left:.0001pt;text-align:justify;">. . . . . . . . . . . . . . . . . . &gt; from score</p> 
<p style="margin-left:.0001pt;text-align:justify;">. . . . . . . . . . . . . . . . . . &gt; group by subject;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="321" src="https://images2.imgbox.com/ca/17/o45UcIas_o.png" width="692"></p> 
<p> 2.平均值：</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：0: jdbc:hive2://192.168.67.110:10000&gt; select subject,avg(score)</p> 
<p style="margin-left:.0001pt;text-align:justify;">. . . . . . . . . . . . . . . . . . &gt; from score</p> 
<p style="margin-left:.0001pt;text-align:justify;">. . . . . . . . . . . . . . . . . . &gt; group by subject;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="186" src="https://images2.imgbox.com/d1/86/WtxECEIQ_o.png" width="692"></p> 
<p> 3.最小值：</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：0: jdbc:hive2://192.168.67.110:10000&gt; select subject,min(score)</p> 
<p style="margin-left:.0001pt;text-align:justify;">. . . . . . . . . . . . . . . . . . &gt; from score</p> 
<p style="margin-left:.0001pt;text-align:justify;">. . . . . . . . . . . . . . . . . . &gt; group by subject;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="189" src="https://images2.imgbox.com/0c/1a/sdVAegiJ_o.png" width="692"></p> 
<p> 4.最大值：</p> 
<p style="margin-left:.0001pt;text-align:justify;">0: jdbc:hive2://192.168.67.110:10000&gt; select subject,max(score)</p> 
<p style="margin-left:.0001pt;text-align:justify;">. . . . . . . . . . . . . . . . . . &gt; from score</p> 
<p style="margin-left:.0001pt;text-align:justify;">. . . . . . . . . . . . . . . . . . &gt; group by subject;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="212" src="https://images2.imgbox.com/8a/66/OMIMdkYh_o.png" width="692"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>拼接字符串</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：concat(string A, string B...)</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="123" src="https://images2.imgbox.com/9a/43/KniBiLpz_o.png" width="660"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>字符串的截取</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select substr('halloworld',3,2)</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="281" src="https://images2.imgbox.com/41/29/jDvImbcg_o.png" width="679"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>炸裂函数</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select explode(split("nice|good|well","\\|"));</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="145" src="https://images2.imgbox.com/06/c1/wa7hoqNN_o.png" width="692"></p> 
<p> 例：</p> 
<p style="margin-left:.0001pt;text-align:justify;">数据准备：</p> 
<p style="margin-left:.0001pt;text-align:justify;">tom a,b,c</p> 
<p style="margin-left:.0001pt;text-align:justify;">jim b,c,d</p> 
<p style="margin-left:.0001pt;text-align:justify;">tony a,c,d</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="155" src="https://images2.imgbox.com/59/e8/ZPEqp5n7_o.png" width="585"></p> 
<p> <img alt="" height="252" src="https://images2.imgbox.com/49/f9/w54tTtxk_o.png" width="692"></p> 
<p><strong>case when </strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">数据准备:</p> 
<p style="margin-left:.0001pt;text-align:justify;">tom,95</p> 
<p style="margin-left:.0001pt;text-align:justify;">hua,90</p> 
<p style="margin-left:.0001pt;text-align:justify;">hong,100</p> 
<p style="margin-left:.0001pt;text-align:justify;">lele,85</p> 
<p style="margin-left:.0001pt;text-align:justify;">kaka,70</p> 
<p style="margin-left:.0001pt;text-align:justify;">kebi,60</p> 
<p style="margin-left:.0001pt;text-align:justify;">ming,55</p> 
<p style="margin-left:.0001pt;text-align:justify;">kang,78</p> 
<p style="margin-left:.0001pt;text-align:justify;">lolo,93</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="217" src="https://images2.imgbox.com/7c/12/crlMMEYZ_o.png" width="692"></p> 
<p> <img alt="" height="294" src="https://images2.imgbox.com/0a/c5/vV405ZaP_o.png" width="692"></p> 
<p><strong> 日期处理函数</strong></p> 
<p style="text-align:justify;">1.date_format函数（根据格式整理日期）</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select date_format('2020-03-05','yyyy-MM');</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="104" src="https://images2.imgbox.com/9b/d6/GtJr1CHx_o.png" width="692"></p> 
<p> 2.date_add函数（加减日期）</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select date_add('2020-03-05',-1);</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select date_add('2020-03-05',1);</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select date_sub('2020-03-05',1);</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="357" src="https://images2.imgbox.com/03/b3/adbbiShc_o.png" width="692"></p> 
<p> 3.next_day函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">·取当前天的下一个周一</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select next_day('2020-03-05','MO');</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="121" src="https://images2.imgbox.com/2c/96/SMx4jKHZ_o.png" width="692"></p> 
<p>   取当前周的周一</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select date_add(next_day('2020-03-05','MO'),-7);</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="93" src="https://images2.imgbox.com/c2/4d/sGbRzWx9_o.png" width="692"></p> 
<p> 4.list_day函数（求当月最后一天的日期）</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select last_day('2020-03-05');</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="140" src="https://images2.imgbox.com/e2/1d/fSvBNPVK_o.png" width="652"></p> 
<p></p> 
<h2 id="%E4%BA%8C.%E5%A4%84%E7%90%86json%E6%95%B0%E6%8D%AE" style="margin-left:.0001pt;text-align:justify;">二.处理json数据</h2> 
<p style="margin-left:.0001pt;text-align:justify;">现有json数据：</p> 
<pre><code class="language-java">{"movie":"1193","rate":"5","timeStamp":"978300760","uid":"1"}
{"movie":"661","rate":"3","timeStamp":"978302109","uid":"1"}
{"movie":"914","rate":"3","timeStamp":"978301968","uid":"1"}
{"movie":"3408","rate":"4","timeStamp":"978300275","uid":"1"}
{"movie":"2355","rate":"5","timeStamp":"978824291","uid":"1"}
{"movie":"1197","rate":"3","timeStamp":"978302268","uid":"1"}
{"movie":"1287","rate":"5","timeStamp":"978302039","uid":"1"}
{"movie":"2804","rate":"5","timeStamp":"978300719","uid":"1"}
{"movie":"594","rate":"4","timeStamp":"978302268","uid":"1"}</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="240" src="https://images2.imgbox.com/48/39/D2WLWVsg_o.png" width="685"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;">创建表，并load数据。</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：create table json(data string);</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：load data local inpath '/opt/testData/hive/json.txt' into table json;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="252" src="https://images2.imgbox.com/6c/fc/Oht0yI59_o.png" width="692"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;">查询json数据。</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：select get_json_object(data,'$.movie') as movie,</p> 
<p style="margin-left:.0001pt;text-align:justify;">get_json_object(data,'$.rate') as rate</p> 
<p style="margin-left:.0001pt;text-align:justify;">from json;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="253" src="https://images2.imgbox.com/b4/1c/LGIFKC08_o.png" width="692"></p> 
<h2 id="%E4%B8%89.%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0">三.窗口函数</h2> 
<h3 id="1.%E7%AA%97%E5%8F%A3%E8%81%9A%E5%90%88" style="text-align:justify;"><strong>1.窗口聚合</strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>准备数据</strong></strong></p> 
<pre><code class="language-java">cookie1,2015-04-10,1
cookie1,2015-04-13,3
cookie1,2015-04-11,5
cookie1,2015-04-12,2
cookie1,2015-04-15,4
cookie1,2015-04-16,4
cookie1,2015-04-14,4
cookie2,2015-04-14,3
cookie2,2015-04-15,9
cookie2,2015-04-16,7
cookie2,2015-04-10,2
cookie2,2015-04-11,3
cookie2,2015-04-12,5
cookie2,2015-04-13,6</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建表。</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">create table cookie1(cookieid string, createtime string, pv int) row format delimited fields terminated by ',';</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>加载数据。</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">load data local inpath "/usr/datadir/cookie1.txt" into table cookie1;</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>sum(pv) over()</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">我们通过cookieid分组，createtime排序，求pv的和。</p> 
<p style="margin-left:.0001pt;text-align:justify;">求之前行到当前行的pv和。不加范围限定，默认也是这种。</p> 
<p style="margin-left:.0001pt;text-align:justify;">sum(pv) over(partition by cookieid order by createtime rows between unbounded preceding and current row) as pv1,</p> 
<p style="margin-left:.0001pt;text-align:justify;">sum(pv) over (partition by cookieid order by createtime) as pv2,</p> 
<p style="margin-left:.0001pt;text-align:justify;">如果只进行了分组，没有排序，会将分组内的所有数据进行求和。</p> 
<p style="margin-left:.0001pt;text-align:justify;">sum(pv) over (partition by cookieid) as pv3,</p> 
<p style="margin-left:.0001pt;text-align:justify;">求当前行与前3行的pv和。</p> 
<p style="margin-left:.0001pt;text-align:justify;">sum(pv) over (partition by cookieid order by createtime rows between 3 preceding and current row) as pv4,</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">当前行的前3行到后2行。</p> 
<p style="margin-left:.0001pt;text-align:justify;">sum(pv) over(partition by cookid order by createtime rows between 3 preceding and 2 following) as pv5,</p> 
<p style="margin-left:.0001pt;text-align:justify;">当前行到最后行。</p> 
<p style="margin-left:.0001pt;text-align:justify;">sum(pv) over (partition by cookieid order by createtime rows between current row and unbounded following) as pv6,</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码</p> 
<pre><code class="language-java">select cookieid,createtime, 
   pv, 
   sum(pv) over (partition by cookieid order by createtime rows between unbounded preceding and current row) as pv1, 
   sum(pv) over (partition by cookieid order by createtime) as pv2, 
   sum(pv) over (partition by cookieid) as pv3, 
   sum(pv) over (partition by cookieid order by createtime rows between 3 preceding and current row) as pv4, 
   sum(pv) over (partition by cookieid order by createtime rows between 3 preceding and 2 following) as pv5, 
   sum(pv) over (partition by cookieid order by createtime rows between current row and unbounded following) as pv6 
from cookie1;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>avg(pv) over()</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>min(pv) over()</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>max(pv) over()</strong></strong></p> 
<h3 id="2.%E7%AA%97%E5%8F%A3%E5%88%86%E7%89%87">2.窗口分片</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>数据准备</strong></strong></p> 
<pre><code class="language-java">cookie1,2015-04-10,1
cookie1,2015-04-11,5
cookie1,2015-04-12,7
cookie1,2015-04-13,3
cookie1,2015-04-14,2
cookie1,2015-04-15,4
cookie1,2015-04-16,4
cookie2,2015-04-10,2
cookie2,2015-04-11,3
cookie2,2015-04-12,5
cookie2,2015-04-13,6
cookie2,2015-04-14,3
cookie2,2015-04-15,9
cookie2,2015-04-16,7</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>创建表</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">create table cookie2(cookieid string, createtime string, pv int)</p> 
<p style="margin-left:.0001pt;text-align:justify;">row format delimited</p> 
<p style="margin-left:.0001pt;text-align:justify;">fields terminated by ',';</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>加载数据</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">load data local inpath "/usr/datadir/cookie2.txt" into table cookie2;</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>查看数据</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="444" src="https://images2.imgbox.com/8c/ce/rNSJqyr7_o.png" width="692"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:justify;">以下不支持rows between</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>ntile(n) over()</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">按顺序将组内的数据分为几片，一般用来求前几分之几的数据。</p> 
<p style="margin-left:.0001pt;text-align:justify;">ntile(2) over (partition by cookieid order by createtime) as rn1</p> 
<p style="margin-left:.0001pt;text-align:justify;">ntile(3) over (partition by cookieid order by createtime) as rn2,</p> 
<p style="margin-left:.0001pt;text-align:justify;">如果不加分区，会将所有数据分成多片。</p> 
<p style="margin-left:.0001pt;text-align:justify;">ntile(4) over (order by createtime) as rn3</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">代码</p> 
<pre><code class="language-java">select cookieid,createtime,
  pv,
  ntile(2) over (partition by cookieid order by createtime) as rn1,
  ntile(3) over (partition by cookieid order by createtime) as rn2,
  ntile(4) over (order by createtime) as rn3
from cookie1 
order by cookieid,createtime;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">结果</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="445" src="https://images2.imgbox.com/e8/50/1TwvBixp_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">例：比如，统计一个cookie，pv数最多的前1/3的天。</p> 
<pre><code class="language-java">create table cookie_temp
as
select
  cookieid,
  createtime,
  pv,
  ntile(3) over (partition by cookieid order by pv desc) as rn 
from cookie2;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">结果</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="453" src="https://images2.imgbox.com/ae/06/wFJ8LK0v_o.png" width="534"> </p> 
<p style="margin-left:.0001pt;text-align:justify;">例：我们取rn=1的就是pv最多的前三分之一</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="185" src="https://images2.imgbox.com/0e/5b/y7EAsEsi_o.png" width="692"></p> 
<p> </p> 
<h3 id="3.%E7%AA%97%E5%8F%A3%E6%8E%92%E5%BA%8F" style="margin-left:.0001pt;text-align:justify;">3.窗口排序</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>row_number() over()</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">分组排序，并记录名次，一般用来取前n名</p> 
<p style="margin-left:.0001pt;text-align:justify;">row_number() over (partition by cookieid order by pv desc) as rn1</p> 
<p style="margin-left:.0001pt;text-align:justify;">100 99 98 98 97 96</p> 
<p style="margin-left:.0001pt;text-align:justify;">1，2，3，4，5，6</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>rank() over()</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">rank() over(partition by cookieid order by pv desc) as rn2</p> 
<p style="margin-left:.0001pt;text-align:justify;">100 99 98 98 97 96</p> 
<p style="margin-left:.0001pt;text-align:justify;">1，2，3，3，5，6</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>dense_rank() over()</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">dense_rank() over(partition by cookieid order by pv desc) as rn3</p> 
<p style="margin-left:.0001pt;text-align:justify;">100 99 98 98 97 96</p> 
<p style="margin-left:.0001pt;text-align:justify;">1，2，3，3，4，5</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码</p> 
<pre><code class="language-java">select
  cookieid,
  createtime,
  pv,
  rank() over (partition by cookieid order by pv desc) as rn1,
  dense_rank() over (partition by cookieid order by pv desc) as rn2,
  row_number() over (partition by cookieid order by pv desc) as rn3
from cookie2 
where cookieid='cookie1';</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">结果</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h3 id="4.%E4%B8%8A%E4%B8%8B%E7%A7%BB%E5%8A%A8" style="margin-left:.0001pt;text-align:justify;">4.上下移动</h3> 
<p style="margin-left:.0001pt;text-align:justify;">首先，新建一个node01窗口</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="433" src="https://images2.imgbox.com/82/7f/0ADF5Elg_o.png" width="693"></p> 
<p> 然后进入编写文档的文件夹</p> 
<p style="margin-left:.0001pt;text-align:justify;">[root@node01 ~]# cd /opt/testData/hive/</p> 
<p style="margin-left:.0001pt;text-align:justify;">然后新建文件，编辑数据</p> 
<p style="margin-left:.0001pt;text-align:justify;">[root@node01 hive]# vi cookie3.txt</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>数据准备</strong></strong></p> 
<pre><code class="language-java">cookie1,2015-04-10 10:00:02,url2
cookie1,2015-04-10 10:00:00,url1
cookie1,2015-04-10 10:03:04,url3
cookie1,2015-04-10 10:50:05,url6
cookie1,2015-04-10 11:00:00,url7
cookie1,2015-04-10 10:10:00,url4
cookie1,2015-04-10 10:50:01,url5
cookie2,2015-04-10 10:00:02,url22
cookie2,2015-04-10 10:00:00,url11
cookie2,2015-04-10 10:03:04,url33
cookie2,2015-04-10 10:50:05,url66
cookie2,2015-04-10 11:00:00,url77
cookie2,2015-04-10 10:10:00,url44
cookie2,2015-04-10 10:50:01,url55</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="400" src="https://images2.imgbox.com/55/0a/Nz4tQ2mc_o.png" width="693"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;">进入hive里</p> 
<p style="margin-left:.0001pt;text-align:justify;">创建表</p> 
<pre><code class="language-java">
0: jdbc:hive2://192.168.67.110:10000&gt; create table cookie3(cookieid string, createtime string, url string)
. . . . . . . . . . . . . . . . . . &gt; row format delimited fields terminated by ',';
No rows affected (0.631 seconds)</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="57" src="https://images2.imgbox.com/65/c1/KaDKranN_o.png" width="693"></p> 
<p> 加载数据</p> 
<pre><code class="language-java">0: jdbc:hive2://192.168.67.110:10000&gt; load data local inpath "/opt/testData/hive/cookie3.txt" into table cookie3;
No rows affected (1.095 seconds)</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="41" src="https://images2.imgbox.com/6e/d4/yL2rnJfB_o.png" width="693"></p> 
<p> <img alt="" height="217" src="https://images2.imgbox.com/84/4c/Zf2o20Gm_o.png" width="693"></p> 
<p> 查看数据</p> 
<pre><code class="language-java">0: jdbc:hive2://192.168.67.110:10000&gt; create table cookie3(cookieid string, createtime string, url string)
. . . . . . . . . . . . . . . . . . &gt; row format delimited fields terminated by ',';
No rows affected (0.299 seconds)
0: jdbc:hive2://192.168.67.110:10000&gt; load data local inpath "/opt/testData/hive/cookie3.txt" into table cookie3;
No rows affected (0.786 seconds)
0: jdbc:hive2://192.168.67.110:10000&gt; select * from cookie3;</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="388" src="https://images2.imgbox.com/44/b2/BsQKl3cE_o.png" width="693"></p> 
<p> <img alt="" height="406" src="https://images2.imgbox.com/8f/65/miu0Ylw7_o.png" width="693"></p> 
<p> <strong><strong>LAG(col,n,DEFAULT) </strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">用于将当前列往上移n行</p> 
<p style="margin-left:.0001pt;text-align:justify;">第一个参数为列名。</p> 
<p style="margin-left:.0001pt;text-align:justify;">第二个参数为往上第n行（可选，默认为1）。</p> 
<p style="margin-left:.0001pt;text-align:justify;">第三个参数为默认值（当往上第n行为NULL时候，取默认值，如不指定，则为NULL）。</p> 
<p style="margin-left:.0001pt;text-align:justify;">LAG(createtime,1,'1970-01-01 00:00:00') over (partition by cookieid order by createtime) as last_1_time</p> 
<p style="margin-left:.0001pt;text-align:justify;">LAG(createtime,2) over (partition by cookieid order by createtime) as last_2_time</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="388" src="https://images2.imgbox.com/a8/42/GrxYVUNx_o.png" width="693"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>LEAD(col,n,DEFAULT)</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">与上面的相似，用于将当前列往下移n行。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="135" src="https://images2.imgbox.com/1d/6d/i57WPFQN_o.png" width="693"></p> 
<p> <img alt="" height="388" src="https://images2.imgbox.com/7d/19/ZUgWDTFY_o.png" width="693"></p> 
<p> <img alt="" height="235" src="https://images2.imgbox.com/e7/c6/zSElBiOC_o.png" width="693"></p> 
<p></p> 
<h3 id="5.%E9%A6%96%E5%B0%BE%E5%80%BC" style="margin-left:.0001pt;text-align:justify;">5.首尾值</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>FIRST_VALUE(url) over ()</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">分组排序后截至到当前行的第一个值。</p> 
<p style="margin-left:.0001pt;text-align:justify;">FIRST_VALUE(url) over (partition by cookieid order by createtime desc) as last1</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>LAST_VALUE(url) over ()</strong></strong> </p> 
<p style="margin-left:.0001pt;text-align:justify;">分组排序后截至到当前行的最后一个值。</p> 
<p style="margin-left:.0001pt;text-align:justify;">FIRST_VALUE(url) over (partition by cookieid order by createtime desc) as last2</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码</p> 
<pre><code class="language-java">select cookieid,createtime,url,
row_number() over (partition by cookieid order by createtime) as rn,
FIRST_VALUE(url) over (partition by cookieid order by createtime desc) as last1,
LAST_VALUE(url) over (partition by cookieid order by createtime desc) as last2
from cookie3;</code></pre> 
<p><img alt="" height="726" src="https://images2.imgbox.com/7d/d4/XnVSODyP_o.png" width="1136"></p> 
<h2 id="%E5%9B%9B.%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0">四.自定义函数</h2> 
<p style="margin-left:.0001pt;text-align:justify;">当 Hive 提供的内置函数无法满足业务处理需要时，此时就可以考虑使用用户自定义函数。</p> 
<p style="margin-left:.0001pt;text-align:justify;">UDF（user-defined function）作用于单个数据行，产生一个数据行作为输出。</p> 
<p style="margin-left:.0001pt;text-align:justify;">UDAF（用户定义聚集函数 User- Defined Aggregation Funcation）：接收多个输入数据行，并产生一个输出数据行。类似于max、min。</p> 
<p style="margin-left:.0001pt;text-align:justify;">UDTF（表格生成函数 User-Defined Table Functions）：接收一行输入，输出多行。类似于explode。</p> 
<h3 id="1.%E8%87%AA%E5%AE%9A%E4%B9%89UDF" style="margin-left:.0001pt;text-align:justify;">1.自定义UDF</h3> 
<ol><li style="text-align:justify;">创建Maven项目，并导入依赖（eclipse中也可将hive-exec的jar包复制进来然后build path）。 <pre><code class="language-XML">&lt;dependency&gt;
            &lt;groupId&gt;org.apache.hive&lt;/groupId&gt;
            &lt;artifactId&gt;hive-exec&lt;/artifactId&gt;
            &lt;version&gt;2.3.3&lt;/version&gt;
&lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;jdk.tools&lt;/groupId&gt;
                    &lt;artifactId&gt;jdk.tools&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;</code></pre> <p></p> </li><li style="text-align:justify;">自定义一个java类继承UDF，重载 evaluate 方法。 <pre><code class="language-java">import org.apache.hadoop.hive.ql.exec.UDF;

public class ToLower extends UDF {
    public String evaluate(String field) {
        String result = field.toLowerCase();
        return result;
    }
}</code></pre> <p></p> </li><li style="text-align:justify;">打成jar包上传到服务器。</li></ol> 
<p style="text-align:justify;"><img alt="" height="328" src="https://images2.imgbox.com/c2/d2/jY9435zH_o.png" width="378"></p> 
<p>      4.添加jar包到hive中。</p> 
<p><img alt="" height="66" src="https://images2.imgbox.com/35/ba/jyMt4cu3_o.png" width="744"></p> 
<p style="text-align:justify;">    5.创建临时函数与开发好的 class 关联起来。</p> 
<p style="text-align:justify;">   代码：create temporary function tolowercase as 'com.udf.toLower';</p> 
<p style="text-align:justify;"><img alt="" height="67" src="https://images2.imgbox.com/4c/93/f77UD5GX_o.png" width="740"></p> 
<p>      6.在HQL种使用</p> 
<p><img alt="" height="145" src="https://images2.imgbox.com/2a/e2/cCw29jc1_o.png" width="567"></p> 
<p><span style="color:#fe2c24;"> 注意</span>：这种方式创建的临时函数只在一次hive会话中有效，重启会话后就无效 </p> 
<p style="text-align:justify;">      7.永久生效。</p> 
<p style="margin-left:.0001pt;text-align:justify;">如果需要经常使用该自定义函数，可以考虑创建永久函数：</p> 
<p style="margin-left:.0001pt;text-align:justify;">拷贝jar包到hive的lib目录下。</p> 
<p style="margin-left:.0001pt;text-align:justify;">创建永久关联函数。</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：create function tolowercase as 'cn.jixiang.udf.ToLower';</p> 
<p style="text-align:justify;">       8.删除函数。</p> 
<p style="margin-left:.0001pt;text-align:justify;">删除临时函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：drop temporary function tolowercase;</p> 
<p style="margin-left:.0001pt;text-align:justify;">删除永久函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">代码：drop function tolowercase;</p> 
<h2></h2> 
<h2 id="%E4%BA%94.%C2%A0Hive%E7%9A%84Shell%E6%93%8D%E4%BD%9C">五. Hive的Shell操作</h2> 
<p style="margin-left:.0001pt;text-align:justify;">hive -e 从命令行执行指定的HQL</p> 
<p style="margin-left:.0001pt;text-align:justify;">例：hive -e "select * from student"</p> 
<p style="margin-left:.0001pt;text-align:justify;">hive -f 执行 HQL 脚本</p> 
<p style="margin-left:.0001pt;text-align:justify;">例：echo "select * from student" &gt; hive.sql</p> 
<p style="margin-left:.0001pt;text-align:justify;">    hive -f hive.sql</p> 
<h2><a id="_19"></a></h2> 
<hr> 
<h2 id="%E6%80%BB%E7%BB%93"><a id="_45"></a>总结</h2> 
<p>提示：这里对文章进行总结：<br>         以上就是今天要讲的内容，本文仅仅简单介绍了hive的函数。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b7468782641373e6af88836279e117a1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">正运动三轴运动控制卡ECI3320控制汇川EtherCat伺服2</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/34f6387e6e41b7e3e7264e19067f5af1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据结构基础</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>