<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>zookeeper基本使用 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="zookeeper基本使用" />
<meta property="og:description" content="目录
环境搭建
单机版搭建
集群版搭建
基本语法使用
可视化客户端
数据结构
节点分类
1. 持久节点
2. 临时节点
3. 有序节点
4. 容器节点
5. TTL节点
节点状态
监听机制
watch监听
永久性watch
应用场景
1. 实现分布式锁
2. 乐观锁更新数据
应用场景总结
Zookeeper集群架构
角色
集群架构
选举机制
选举时机
选举源码
选举规则
四字命令使用
1. 安装nc
2. 开启nc
3. 验证
4. 其他用法 环境搭建 单机版搭建 1. 官网下载zookeeper压缩包, 这里用3.8.3版本, 并解压
官网下载地址: Apache ZooKeeper
2. 复制示例配置文件
cp zoo_sample.cfg zoo.cfg zoo.cfg配置里面参数说明, 不用修改也能启动
# zookeeper基本时间单位，2妙 tickTime=2000 # follower初始化到leader最大时长, 表示tickTime的倍数, 也就是20秒 initLimit=10 # leader和follower同步数据的最大时长, 表示tickTime的倍数, 也就是10秒 syncLimit=5 # 数据和日志存储目录, 也可以配dataLogDir单独指定日志存储目录, 不建议放在默认的/tmp下 dataDir=/tmp/zookeeper # 对客户端提供端口号 clientPort=2181 # 对单个客户端提供最大连接数 #maxClientCnxns=60 # # Be sure to read the maintenance section of the # administrator guide before turning on autopurge." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/ad6f9c8c7c8a5179836b7b1d25ca0c51/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-27T04:38:41+08:00" />
<meta property="article:modified_time" content="2023-12-27T04:38:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">zookeeper基本使用</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-toc" style="margin-left:0px;"><a href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA" rel="nofollow">环境搭建</a></p> 
<p id="%E5%8D%95%E6%9C%BA%E7%89%88%E6%90%AD%E5%BB%BA-toc" style="margin-left:40px;"><a href="#%E5%8D%95%E6%9C%BA%E7%89%88%E6%90%AD%E5%BB%BA" rel="nofollow">单机版搭建</a></p> 
<p id="%E9%9B%86%E7%BE%A4%E7%89%88%E6%90%AD%E5%BB%BA-toc" style="margin-left:40px;"><a href="#%E9%9B%86%E7%BE%A4%E7%89%88%E6%90%AD%E5%BB%BA" rel="nofollow">集群版搭建</a></p> 
<p id="%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E4%BD%BF%E7%94%A8-toc" style="margin-left:0px;"><a href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E4%BD%BF%E7%94%A8" rel="nofollow">基本语法使用</a></p> 
<p id="%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AE%A2%E6%88%B7%E7%AB%AF-toc" style="margin-left:0px;"><a href="#%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AE%A2%E6%88%B7%E7%AB%AF" rel="nofollow">可视化客户端</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-toc" style="margin-left:0px;"><a href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" rel="nofollow">数据结构</a></p> 
<p id="%E8%8A%82%E7%82%B9%E5%88%86%E7%B1%BB-toc" style="margin-left:0px;"><a href="#%E8%8A%82%E7%82%B9%E5%88%86%E7%B1%BB" rel="nofollow">节点分类</a></p> 
<p id="1.%20%E6%8C%81%E4%B9%85%E8%8A%82%E7%82%B9-toc" style="margin-left:40px;"><a href="#1.%20%E6%8C%81%E4%B9%85%E8%8A%82%E7%82%B9" rel="nofollow">1. 持久节点</a></p> 
<p id="2.%20%E4%B8%B4%E6%97%B6%E8%8A%82%E7%82%B9-toc" style="margin-left:40px;"><a href="#2.%20%E4%B8%B4%E6%97%B6%E8%8A%82%E7%82%B9" rel="nofollow">2. 临时节点</a></p> 
<p id="3.%20%E6%9C%89%E5%BA%8F%E8%8A%82%E7%82%B9-toc" style="margin-left:40px;"><a href="#3.%20%E6%9C%89%E5%BA%8F%E8%8A%82%E7%82%B9" rel="nofollow">3. 有序节点</a></p> 
<p id="4.%20%E5%AE%B9%E5%99%A8%E8%8A%82%E7%82%B9-toc" style="margin-left:40px;"><a href="#4.%20%E5%AE%B9%E5%99%A8%E8%8A%82%E7%82%B9" rel="nofollow">4. 容器节点</a></p> 
<p id="5.%20TTL%E8%8A%82%E7%82%B9-toc" style="margin-left:40px;"><a href="#5.%20TTL%E8%8A%82%E7%82%B9" rel="nofollow">5. TTL节点</a></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E8%8A%82%E7%82%B9%E7%8A%B6%E6%80%81-toc" style="margin-left:0px;"><a href="#%E8%8A%82%E7%82%B9%E7%8A%B6%E6%80%81" rel="nofollow">节点状态</a></p> 
<p id="%E7%9B%91%E5%90%AC%E6%9C%BA%E5%88%B6-toc" style="margin-left:0px;"><a href="#%E7%9B%91%E5%90%AC%E6%9C%BA%E5%88%B6" rel="nofollow">监听机制</a></p> 
<p id="watch%E7%9B%91%E5%90%AC-toc" style="margin-left:40px;"><a href="#watch%E7%9B%91%E5%90%AC" rel="nofollow">watch监听</a></p> 
<p id="%E6%B0%B8%E4%B9%85%E6%80%A7watch-toc" style="margin-left:40px;"><a href="#%E6%B0%B8%E4%B9%85%E6%80%A7watch" rel="nofollow">永久性watch</a></p> 
<p id="%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-toc" style="margin-left:0px;"><a href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" rel="nofollow">应用场景</a></p> 
<p id="1.%20%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81-toc" style="margin-left:40px;"><a href="#1.%20%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81" rel="nofollow">1. 实现分布式锁</a></p> 
<p id="2.%20%E4%B9%90%E8%A7%82%E9%94%81%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#2.%20%E4%B9%90%E8%A7%82%E9%94%81%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE" rel="nofollow">2. 乐观锁更新数据</a></p> 
<p id="%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E6%80%BB%E7%BB%93-toc" style="margin-left:40px;"><a href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E6%80%BB%E7%BB%93" rel="nofollow">应用场景总结</a></p> 
<p id="Zookeeper%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84-toc" style="margin-left:0px;"><a href="#Zookeeper%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84" rel="nofollow">Zookeeper集群架构</a></p> 
<p id="%E8%A7%92%E8%89%B2-toc" style="margin-left:40px;"><a href="#%E8%A7%92%E8%89%B2" rel="nofollow">角色</a></p> 
<p id="%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84-toc" style="margin-left:40px;"><a href="#%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84" rel="nofollow">集群架构</a></p> 
<p id="%E9%80%89%E4%B8%BE%E6%9C%BA%E5%88%B6-toc" style="margin-left:40px;"><a href="#%E9%80%89%E4%B8%BE%E6%9C%BA%E5%88%B6" rel="nofollow">选举机制</a></p> 
<p id="%E9%80%89%E4%B8%BE%E6%97%B6%E6%9C%BA-toc" style="margin-left:80px;"><a href="#%E9%80%89%E4%B8%BE%E6%97%B6%E6%9C%BA" rel="nofollow">选举时机</a></p> 
<p id="%E9%80%89%E4%B8%BE%E6%BA%90%E7%A0%81-toc" style="margin-left:80px;"><a href="#%E9%80%89%E4%B8%BE%E6%BA%90%E7%A0%81" rel="nofollow">选举源码</a></p> 
<p id="%E9%80%89%E4%B8%BE%E8%A7%84%E5%88%99-toc" style="margin-left:80px;"><a href="#%E9%80%89%E4%B8%BE%E8%A7%84%E5%88%99" rel="nofollow">选举规则</a></p> 
<p id="%E5%9B%9B%E5%AD%97%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E5%AD%97%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8" rel="nofollow">四字命令使用</a></p> 
<p id="1.%20%E5%AE%89%E8%A3%85nc-toc" style="margin-left:40px;"><a href="#1.%20%E5%AE%89%E8%A3%85nc" rel="nofollow">1. 安装nc</a></p> 
<p id="2.%20%E5%BC%80%E5%90%AFnc-toc" style="margin-left:40px;"><a href="#2.%20%E5%BC%80%E5%90%AFnc" rel="nofollow">2. 开启nc</a></p> 
<p id="3.%20%E9%AA%8C%E8%AF%81-toc" style="margin-left:40px;"><a href="#3.%20%E9%AA%8C%E8%AF%81" rel="nofollow">3. 验证</a></p> 
<p id="4.%20%E5%85%B6%E4%BB%96%E7%94%A8%E6%B3%95%C2%A0-toc" style="margin-left:40px;"><a href="#4.%20%E5%85%B6%E4%BB%96%E7%94%A8%E6%B3%95%C2%A0" rel="nofollow">4. 其他用法 </a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA" style="background-color:transparent;">环境搭建</h2> 
<h3 id="%E5%8D%95%E6%9C%BA%E7%89%88%E6%90%AD%E5%BB%BA" style="background-color:transparent;">单机版搭建</h3> 
<p>1. 官网下载zookeeper压缩包, 这里用3.8.3版本, 并解压</p> 
<p>官网下载地址: <a href="https://zookeeper.apache.org/releases.html" rel="nofollow" title="Apache ZooKeeper">Apache ZooKeeper</a></p> 
<p><img alt="" height="969" src="https://images2.imgbox.com/3b/46/32XM99c2_o.png" width="1200"></p> 
<p>2. 复制示例配置文件</p> 
<pre><code class="language-cs">cp zoo_sample.cfg zoo.cfg</code></pre> 
<p>zoo.cfg配置里面参数说明, 不用修改也能启动</p> 
<pre><code class="language-cs"># zookeeper基本时间单位，2妙
tickTime=2000
# follower初始化到leader最大时长, 表示tickTime的倍数, 也就是20秒
initLimit=10
# leader和follower同步数据的最大时长, 表示tickTime的倍数, 也就是10秒
syncLimit=5
# 数据和日志存储目录, 也可以配dataLogDir单独指定日志存储目录, 不建议放在默认的/tmp下
dataDir=/tmp/zookeeper
# 对客户端提供端口号
clientPort=2181
# 对单个客户端提供最大连接数
#maxClientCnxns=60
#
# Be sure to read the maintenance section of the 
# administrator guide before turning on autopurge.
#
# https://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance
#
# 保存数据的快照数量, 多余的会被清除
#autopurge.snapRetainCount=3
# 自动触发清除任务的时间间隔, 单位小时. 0表示不清除
#autopurge.purgeInterval=1

## Metrics Providers
#
# https://prometheus.io Metrics Exporter
#metricsProvider.className=org.apache.zookeeper.metrics.prometheus.PrometheusMetricsProvider
#metricsProvider.httpHost=0.0.0.0
#metricsProvider.httpPort=7000
#metricsProvider.exportJvmInfo=true
</code></pre> 
<p>3. 启动zookeeper服务</p> 
<pre><code class="language-cs"># 启动, 如果不指定配置文件, 默认找conf/zoo.cfg
bin/zkServer.sh start

# 指定配置文件启动
bin/zkServer.sh start conf/my_zoo.cfg

#查看zookeeper状态
bin/zkServer.sh status

# 关闭服务
bin/zkServer.sh stop

# 重启服务
bin/zkServer.sh restart</code></pre> 
<p>4. 客户端连接</p> 
<pre><code class="language-cs"># 连接本地zookeeper服务
bin/zkCli.sh

# 连接远程的zookeeper server
bin/zkCli.sh -server ip:port</code></pre> 
<p>5. 查看基本命令</p> 
<p>        5.1 客户端输入help</p> 
<p><img alt="" height="572" src="https://images2.imgbox.com/41/99/OtBd2vuA_o.png" width="1200"></p> 
<p>        5.2 官网查看客户端命令</p> 
<p><a href="https://zookeeper.apache.org/doc/r3.8.0/zookeeperCLI.html" rel="nofollow" title="ZooKeeper: Because Coordinating Distributed Systems is a Zoo">ZooKeeper: Because Coordinating Distributed Systems is a Zoo</a></p> 
<p></p> 
<p>6. 增删改查等操作</p> 
<pre><code class="language-cs"># 查看/下子节点
ls /

# 新增
create /kk a1

# 修改
set /kk a2

# 查看/kk
get /kk

# 删除
delete /kk</code></pre> 
<p><img alt="" height="199" src="https://images2.imgbox.com/19/71/MbhZq4tL_o.png" width="1200"></p> 
<p></p> 
<h3 id="%E9%9B%86%E7%BE%A4%E7%89%88%E6%90%AD%E5%BB%BA" style="background-color:transparent;">集群版搭建</h3> 
<p>搭建1Leader和2Follower集群, 这里简化版, 在一台服务器上搭建</p> 
<p>1. 从zoo_sample.cfg复制三份配置文件, 以及创建对应的data和log目录</p> 
<pre><code class="language-cs"># config1配置
# 客户端连接端口
clientPort=2181
# 三个实例的ip; 端口1: Leader和Follower交换信息端口; 端口2: 选举通信接口
server.1=192.168.6.128:12888:13888
server.2=192.168.6.128:12889:13889
server.3=192.168.6.128:12890:13890
# 存数据路径
dataDir=/home/kk/local/apache-zookeeper-3.8.3-bin/zoo1/data
# 存日志路径
dataLogDir=/home/kk/local/apache-zookeeper-3.8.3-bin/zoo1/log


# config2配置
clientPort=2182
server.1=192.168.6.128:12888:13888
server.2=192.168.6.128:12889:13889
server.3=192.168.6.128:12890:13890
dataDir=/home/kk/local/apache-zookeeper-3.8.3-bin/zoo2/data
dataLogDir=/home/kk/local/apache-zookeeper-3.8.3-bin/zoo2/log

# config3配置
clientPort=2183
server.1=192.168.6.128:12888:13888
server.2=192.168.6.128:12889:13889
server.3=192.168.6.128:12890:13890
dataDir=/home/kk/local/apache-zookeeper-3.8.3-bin/zoo3/data
dataLogDir=/home/kk/local/apache-zookeeper-3.8.3-bin/zoo3/log</code></pre> 
<p>2. 去三个data目录创建myid文件, 对应上面config里面的server.1</p> 
<p><img alt="" height="97" src="https://images2.imgbox.com/d7/e7/Ns6pTt9t_o.png" width="492"></p> 
<p>3. 分别启动三个zookeeper实例</p> 
<pre><code class="language-cs">bin/zkServer.sh start /home/kk/local/apache-zookeeper-3.8.3-bin/zoo1/conf/zoo.cfg

bin/zkServer.sh start /home/kk/local/apache-zookeeper-3.8.3-bin/zoo2/conf/zoo.cfg

bin/zkServer.sh start /home/kk/local/apache-zookeeper-3.8.3-bin/zoo3/conf/zoo.cfg</code></pre> 
<p> 4. 检查节点状态</p> 
<pre><code class="language-cs">bin/zkServer.sh status /home/kk/local/apache-zookeeper-3.8.3-bin/zoo1/conf/zoo.cfg</code></pre> 
<p><img alt="" height="276" src="https://images2.imgbox.com/cb/32/nR9z52Em_o.png" width="1169"></p> 
<p></p> 
<h2 id="%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E4%BD%BF%E7%94%A8">基本语法使用</h2> 
<table><tbody><tr><td> <p>命令基本语法</p> </td><td> <p>功能描述</p> </td></tr><tr><td> <p>help</p> </td><td> <p>显示所有操作命令</p> </td></tr><tr><td> <p>ls [-s] [-w] [-R] path</p> </td><td> <p>使用 ls 命令来查看当前 znode 的子节点 [可监听]</p> <p>-w: 监听子节点变化</p> <p>-s: 节点状态信息（时间戳、版本号、数据大小等）</p> <p>-R: 表示递归的获取</p> </td></tr><tr><td> <p>create [-s] [-e] [-c] [-t ttl] path [data] [acl]</p> </td><td> <p>创建节点</p> <p>-s : 创建有序节点。</p> <p>-e : 创建临时节点。</p> <p>-c : 创建一个容器节点。</p> <p>t ttl] : 创建一个TTL节点， -t 时间（单位毫秒）。</p> <p>data：节点的数据，可选，如果不使用时，节点数据就为null。</p> <p>acl：访问控制</p> </td></tr><tr><td> <p>get [-s] [-w] path</p> </td><td> <p>获取节点数据信息</p> <p>-s: 节点状态信息（时间戳、版本号、数据大小等）</p> <p>-w: 监听节点变化</p> </td></tr><tr><td> <p>set [-s] [-v version] path data</p> </td><td> <p>设置节点数据</p> <p>-s:表示节点为顺序节点</p> <p>-v: 指定版本号</p> </td></tr><tr><td> <p>getAcl [-s] path</p> </td><td> <p>获取节点的访问控制信息</p> <p>-s: 节点状态信息（时间戳、版本号、数据大小等）</p> </td></tr><tr><td> <p>setAcl [-s] [-v version] [-R] path acl</p> </td><td> <p>设置节点的访问控制列表</p> <p>-s:节点状态信息（时间戳、版本号、数据大小等）</p> <p>-v:指定版本号</p> <p>-R:递归的设置</p> </td></tr><tr><td> <p>stat [-w] path</p> </td><td> <p>查看节点状态信息</p> </td></tr><tr><td> <p>delete [-v version] path</p> </td><td> <p>删除某一节点，只能删除无子节点的节点。</p> <p>-v： 表示节点版本号</p> </td></tr><tr><td> <p>deleteall path</p> </td><td> <p>递归的删除某一节点及其子节点</p> </td></tr><tr><td> <p>setquota -n|-b val path</p> </td><td> <p>对节点增加限制</p> <p>n:表示子节点的最大个数</p> <p>b:数据值的最大长度，-1表示无限制</p> </td></tr></tbody></table> 
<p></p> 
<h2 id="%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AE%A2%E6%88%B7%E7%AB%AF">可视化客户端</h2> 
<ul><li>Zookeeper图形化工具：<a href="https://issues.apache.org/jira/secure/attachment/12436620/ZooInspector.zip" rel="nofollow" title="ZooInspector">ZooInspector</a></li><li>Zookeeper图形化工具：开源的<a href="https://github.com/vran-dev/PrettyZoo/releases" title="prettyZoo">prettyZoo</a>(推荐)</li><li>Zookeeper图形化工具：收费的<a href="http://www.redisant.cn/za" rel="nofollow" title="ZooKeeperAssistant">ZooKeeperAssistant</a></li></ul> 
<p>这里使用<strong>prettyZoo</strong>, 连接远程zookeeper</p> 
<p><img alt="" height="980" src="https://images2.imgbox.com/44/ce/kUD4lbQC_o.png" width="1200"></p> 
<p></p> 
<h2 id="%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">数据结构</h2> 
<p><img alt="" height="760" src="https://images2.imgbox.com/7e/6e/wQSireTR_o.png" width="1200"></p> 
<p>zookeeper是 文件系统 + key value 数据结构</p> 
<ol><li>文件系统的树形结构便于表达数据之间的层次关系</li><li>文件系统的树形结构便于为不同的应用分配独立的命名空间( namespace )</li></ol> 
<p>ZooKeeper的层次模型称作Data Tree，Data Tree的每个节点叫作Znode。不同于文件系统，每个节点都可以保存数据，每一个 ZNode 默认能够存储 1MB 的数据，每个 ZNode 都可以通过其路径唯一标识，每个节点都有一个版本(version)，版本从0开始计数, 可用来CAS实现乐观锁。</p> 
<p></p> 
<h2 id="%E8%8A%82%E7%82%B9%E5%88%86%E7%B1%BB">节点分类</h2> 
<p>zookeeper存在几种不同的节点类型，他们具有不同的生命周期：</p> 
<table><tbody><tr><td> <p>类型</p> </td><td> <p>生命周期</p> </td><td> <p>创建示例</p> </td></tr><tr><td> <p>持久节点 （persistent node)</p> </td><td> <p>一直存在，一直存储在ZooKeeper 服务器上，即使创建该节点的客户端与服务端的会话关闭了，该节点依然不会被删除</p> </td><td> <p>create /locks</p> </td></tr><tr><td> <p>临时节点 (ephemeral node)</p> </td><td> <p>当创建该临时节点的客户端会话因超时或发生异常而关闭时，该节点也相应在 ZooKeeper 服务器上被删除。</p> </td><td> <p>create -e /locks/DBLock</p> </td></tr><tr><td> <p>有序节点 (sequential node)</p> </td><td> <p>并不算是一种单独种类的节点，而是在之前提到的持久节点和临时节点特性的基础上，增加了一个节点有序的性质。在我们创建有序节点的时候会自动使用一个单调递增的数字作为后缀</p> </td><td> <p>create -e -s /jobs/job</p> <p>(临时有序节点)</p> </td></tr><tr><td> <p>容器节点 (container node)</p> </td><td> <p>当一个容器节点的最后一个子节点被删除后，容器节点也会被删除</p> </td><td> <p>create -c /work</p> </td></tr><tr><td> <p>TTL节点 (ttl node)</p> </td><td> <p>当一个TTL节点在 TTL 内没有被修改并且没有子节点，会被删除。注意：默认此功能不开启，需要修改配置文件extendedTypesEnabled=true</p> </td><td> <p>create -t 3000 /ttl_node</p> </td></tr></tbody></table> 
<h3 id="1.%20%E6%8C%81%E4%B9%85%E8%8A%82%E7%82%B9">1. 持久节点</h3> 
<p>客户端与服务端会话关闭, 或服务端重启, 节点依然存在</p> 
<h3 id="2.%20%E4%B8%B4%E6%97%B6%E8%8A%82%E7%82%B9">2. 临时节点</h3> 
<p>client宕机或者client在指定的timeout时间内没有给ZooKeeper集群发消息，节点就会消失</p> 
<p>创建方式: -e</p> 
<pre><code class="language-cs"># 创建临时节点
create -e /kk-tmp a3</code></pre> 
<p></p> 
<h3 id="3.%20%E6%9C%89%E5%BA%8F%E8%8A%82%E7%82%B9">3. 有序节点</h3> 
<p>可以和持久节点或临时节点组合</p> 
<ul><li>持久有序节点</li><li>临时有序节点</li></ul> 
<p>创建方式: -s</p> 
<p><img alt="" height="152" src="https://images2.imgbox.com/82/c0/VkFYbKch_o.png" width="685"></p> 
<p></p> 
<h3 id="4.%20%E5%AE%B9%E5%99%A8%E8%8A%82%E7%82%B9">4. 容器节点</h3> 
<p>        Container容器节点(3.5.3版本新增)，当容器中没有任何子节点，该容器节点会被zk定期删除（定时任务默认60s 检查一次)。 和持久节点的区别是 ZK 服务端启动后，会有一个单独的线程去扫描，所有的容器节点，当发现容器节点的子节点数量为 0 时，会自动删除该节点。可以用于 leader 或者锁的场景中。</p> 
<p>创建方式:  -c</p> 
<pre><code class="language-cs"># 创建容器节点
create -c /kk-contain aa</code></pre> 
<p></p> 
<h3 id="5.%20TTL%E8%8A%82%E7%82%B9">5. TTL节点</h3> 
<p>带过期时间节点, 当一个TTL节点在 TTL 内没有被修改并且没有子节点，会被删除. 默认禁用。</p> 
<p>注意：TTL不能用于临时节点</p> 
<p>需要在zoo.cfg中配置extendedTypesEnabled参数</p> 
<pre><code class="language-cs"># 开启TTL节点
extendedTypesEnabled=true</code></pre> 
<p>创建方式: -t</p> 
<pre><code class="language-cs"># 创建ttl节点
create -t 10 /kk-ttl</code></pre> 
<h2></h2> 
<h2 id="%E8%8A%82%E7%82%B9%E7%8A%B6%E6%80%81">节点状态</h2> 
<pre><code class="language-cs"># 查看节点状态
[zk: localhost:2181(CONNECTED) 35] ls -s /kk
[k1, k2, k3]
cZxid = 0xcd
ctime = Tue Dec 26 03:36:44 CST 2023
mZxid = 0xcd
mtime = Tue Dec 26 03:36:44 CST 2023
pZxid = 0xd1
cversion = 3
dataVersion = 0
aclVersion = 0
ephemeralOwner = 0x0
dataLength = 2
numChildren = 3
</code></pre> 
<p> 参数描述:</p> 
<ul><li>cZxid ：Znode创建的事务id。</li><li>ctime：节点创建时的时间戳。</li><li>mZxid ：Znode被修改的事务id，即每次对znode的修改都会更新mZxid。对于zk来说，每次的变化都会产生一个唯一的事务id，zxid（ZooKeeper Transaction Id），通过zxid，可以确定更新操作的先后顺序。例如，如果zxid1小于zxid2，说明zxid1操作先于zxid2发生，zxid对于整个zk都是唯一的，即使操作的是不同的znode。</li><li>pZxid: 表示该节点的子节点列表最后一次修改的事务ID，添加子节点或删除子节点就会影响子节点列表，但是修改子节点的数据内容则不影响该ID（注意: 只有子节点列表变更了才会变更pzxid，子节点内容变更不会影响pzxid）</li><li>mtime：节点最新一次更新发生时的时间戳.</li><li>cversion ：子节点的版本号。当znode的子节点有变化时，cversion 的值就会增加1。</li><li>dataVersion：数据版本号，每次对节点进行set操作，dataVersion的值都会增加1（即使设置的是相同的数据），可有效避免了数据更新时出现的先后顺序问题。</li><li>ephemeralOwner:如果该节点为临时节点, ephemeralOwner值表示与该节点绑定的session id。如果不是, ephemeralOwner值为0(持久节点)。在client和server通信之前,首先需要建立连接,该连接称为session。连接建立后,如果发生连接超时、授权失败,或者显式关闭连接,连接便处于closed状态, 此时session结束。</li><li>dataLength ： 数据的长度</li><li>numChildren ：子节点的数量（只统计直接子节点的数量）</li></ul> 
<p></p> 
<h2 id="%E7%9B%91%E5%90%AC%E6%9C%BA%E5%88%B6">监听机制</h2> 
<h3 id="watch%E7%9B%91%E5%90%AC">watch监听</h3> 
<p>zookeeper中的watch机制，必须客户端先去服务端注册监听，这样事件发送才会触发监听，通知给客户端。</p> 
<p>支持的事件类型：</p> 
<ul><li>None: 连接建立事件</li><li>NodeCreated： 节点创建</li><li>NodeDeleted： 节点删除</li><li>NodeDataChanged：节点数据变化</li><li>NodeChildrenChanged：子节点列表变化</li><li>DataWatchRemoved：节点监听被移除</li><li>ChildWatchRemoved：子节点监听被移除</li></ul> 
<p>命令:</p> 
<pre><code class="language-cs">#监听节点数据的变化
get -w /kk
stat -w /kk

#监听子节点增减的变化 
ls -w /kk
</code></pre> 
<p>说明: </p> 
<table><tbody><tr><td> <p>特性</p> </td><td> <p>说明</p> </td></tr><tr><td> <p>一次性触发</p> </td><td> <p>watch是一次性的，一旦被触发就会移除，再次使用时需要重新注册</p> </td></tr><tr><td> <p>客户端顺序回调</p> </td><td> <p>watch回调是顺序串行执行的，只有回调后客户端才能看到最新的数据状态。一个watcher回调逻辑不应该太多，以免影响别的watch执行</p> </td></tr><tr><td> <p>轻量级</p> </td><td> <p>WatchEvent是最小的通信单位，结构上只包含通知状态、事件类型和节点路径，并不会告诉数据节点变化前后的具体内容</p> </td></tr><tr><td> <p>时效性</p> </td><td> <p>watcher只有在当前session彻底失效时才会无效，若在session有效期内快速重连成功，则watcher依然存在，仍可接收到通知；</p> </td></tr></tbody></table> 
<p></p> 
<h3 id="%E6%B0%B8%E4%B9%85%E6%80%A7watch">永久性watch</h3> 
<ul><li>-w: 一次性监听事件</li><li>addWatch: 可持续监听事件</li></ul> 
<pre><code class="language-cs"># 持续监听当前节点的修改和删除事件，以及当前节点的子节点的删除和新增事件
addWatch -m PERSISTENT /kk

# - 持久化递归订阅(默认)，在PERSISTENT的基础上，增加了子节点修改的事件触发，以及子节点的子节点的数据变化都会触发相关事件
addWatch -m PERSISTENT_RECURSIVE /kk
</code></pre> 
<p><img alt="" height="97" src="https://images2.imgbox.com/d8/fd/HS8bchqX_o.png" width="681"></p> 
<p></p> 
<h2 id="%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" style="background-color:transparent;">应用场景</h2> 
<h3 id="1.%20%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81">1. 实现分布式锁</h3> 
<p>多个客户端同时创建临时节点, 只会有一个节点成功. 如果客户端1创建成功, 执行完业务流程后, 释放锁, 也就是删除临时节点, 其他客户端监听该节点删除, 重新竞争锁. 这里用临时节点, 避免客户端宕机情况产生死锁.</p> 
<pre><code class="language-cs"># 客户端1
create -c /kk-lock 1


# 客户端2

create -c /kk-lock 1


# 假如客户端1竞争成功, 客户端2创建失败, 客户端2监听该节点
get -w /kk-lock


# 客户端1执行完业务流程后, 释放锁, 删除节点
delete /kk-lock

# 客户端2监听到节点有变动, 重新竞争锁, 创建节点
create -c /kk-lock 1</code></pre> 
<p></p> 
<h3 id="2.%20%E4%B9%90%E8%A7%82%E9%94%81%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE">2. 乐观锁更新数据</h3> 
<p>更新时带上版本号, CAS更新</p> 
<pre><code class="language-cs"># 创建节点
create /kt aa


# 查看节点状态(版本号, 创建时间等)

ls -s /kt


# 带版本号更新, 如果版本不匹配则更新失败
set -v 0 /kt bb</code></pre> 
<p><img alt="" height="545" src="https://images2.imgbox.com/ca/e4/fKPZn3Xq_o.png" width="512"></p> 
<p></p> 
<h3 id="%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E6%80%BB%E7%BB%93" style="background-color:transparent;">应用场景总结</h3> 
<ul><li>注册中心</li><li>数据发布/订阅（常用于实现配置中心）</li><li>负载均衡</li><li>命名服务</li><li>分布式协调/通知</li><li>集群管理</li><li>Master选举</li><li>分布式锁</li><li>分布式队列</li></ul> 
<p></p> 
<h2 id="Zookeeper%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84">Zookeeper集群架构</h2> 
<h3 id="%E8%A7%92%E8%89%B2">角色</h3> 
<p>1. <strong>Leader</strong>-领导者</p> 
<p>事务请求（写操作）的唯一调度者和处理者，保证集群事务处理的顺序性</p> 
<p>2. <strong>Follower</strong>-跟随者</p> 
<p>处理客户端非事务（读操作）请求（可以直接响应），转发事务请求给Leader；参与集群Leader选举投票</p> 
<p>3. <strong>Observer</strong>-观察者</p> 
<p>处理客户端非事务（读操作）请求（可以直接响应），转发事务请求给Leader；不参与选举</p> 
<p> Observer应用:</p> 
<ul><li>提升集群的读性能</li><li>跨数据中心部署</li></ul> 
<p></p> 
<h3 id="%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84">集群架构</h3> 
<p><img alt="" height="477" src="https://images2.imgbox.com/d5/41/kF876vhw_o.png" width="1050"></p> 
<ul><li>leader处理读请求和写请求</li><li>follower处理读请求, 把写请求转发到leader</li></ul> 
<p>Zookeeper数据一致性保证：</p> 
<ul><li>全局可线性化(Linearizable )写入∶先到达leader的写请求会先处理，leader决定写请求的执行顺序。</li><li>客户端FIFO顺序∶来自给定客户端的请求按照发送顺序执行。</li></ul> 
<p></p> 
<h3 id="%E9%80%89%E4%B8%BE%E6%9C%BA%E5%88%B6" style="background-color:transparent;">选举机制</h3> 
<h4 id="%E9%80%89%E4%B8%BE%E6%97%B6%E6%9C%BA">选举时机</h4> 
<p>zookeeper集群启动时, 或者leader宕机时, 会触发选举. 老的leader服务恢复时, 会以follower身份加入集群.</p> 
<h4 id="%E9%80%89%E4%B8%BE%E6%BA%90%E7%A0%81">选举源码</h4> 
<pre><code class="language-java">/**
 * Check if a pair (server id, zxid) succeeds our
 * current vote.
 *
 */
protected boolean totalOrderPredicate(long newId, long newZxid, long newEpoch, long curId, long curZxid, long curEpoch) {
    LOG.debug(
        "id: {}, proposed id: {}, zxid: 0x{}, proposed zxid: 0x{}",
        newId,
        curId,
        Long.toHexString(newZxid),
        Long.toHexString(curZxid));

    if (self.getQuorumVerifier().getWeight(newId) == 0) {
        return false;
    }

    /*
     * We return true if one of the following three cases hold:
     * 1- New epoch is higher
     * 2- New epoch is the same as current epoch, but new zxid is higher
     * 3- New epoch is the same as current epoch, new zxid is the same
     *  as current zxid, but server id is higher.
     */

    return ((newEpoch &gt; curEpoch)
            || ((newEpoch == curEpoch)
                &amp;&amp; ((newZxid &gt; curZxid)
                    || ((newZxid == curZxid)
                        &amp;&amp; (newId &gt; curId)))));
}</code></pre> 
<p></p> 
<h4 id="%E9%80%89%E4%B8%BE%E8%A7%84%E5%88%99">选举规则</h4> 
<p>先介绍几个重要参数:</p> 
<ul><li>Epoch: 选举轮次</li><li>Zxid: 最后一次提交的事务id. 可用来判断事务执行先后</li><li>myId: 自定义的服务id</li></ul> 
<p></p> 
<p>投票规则</p> 
<p>1. 比较Epoch, epoch大的成为Leader</p> 
<p>2. 若Epoch一样, 比较Zxid, Zxid大(数据更完整)的成为Leader</p> 
<p>3. 若Zxid一样, 比较myId, myId大的成为Leader</p> 
<p>4. 若投票未超过半数, 继续下一轮选举, 下一轮票数少的会改投票数获胜的</p> 
<p></p> 
<p>zxid结构</p> 
<ol><li>zxid是一个64位的整数，由高32位的epoch和低32位的counter组成。</li><li>epoch表示ZooKeeper服务器的逻辑时期（logical epoch），它是一个相对时间的概念，用于区分不同的Leader选举周期。</li><li>counter是一个在每个时期（epoch）内递增的计数器，用于标识事务的顺序。</li></ol> 
<p></p> 
<h2 id="%E5%9B%9B%E5%AD%97%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8">四字命令使用</h2> 
<h3 id="1.%20%E5%AE%89%E8%A3%85nc">1. 安装nc</h3> 
<pre><code class="language-cs">yum install nc</code></pre> 
<h3 id="2.%20%E5%BC%80%E5%90%AFnc" style="background-color:transparent;">2. 开启nc</h3> 
<p>方式一: zoo.cfg 文件里加入配置项</p> 
<pre><code class="language-cs">#开启四字命令
4lw.commands.whitelist=*</code></pre> 
<p>方式二: 启动脚本zkServer.sh中新增指令</p> 
<pre><code class="language-cs">#添加JVM环境变量-Dzookeeper.4lw.commands.whitelist=*
ZOOMAIN="-Dzookeeper.4lw.commands.whitelist=* ${ZOOMAIN}"</code></pre> 
<h3 id="3.%20%E9%AA%8C%E8%AF%81">3. 验证</h3> 
<p>stat 命令用于查看 zk 的状态信息</p> 
<pre><code class="language-cs">echo stat | nc 192.168.6.128 2182</code></pre> 
<p><img alt="" height="276" src="https://images2.imgbox.com/5a/75/tJ9o9FqV_o.png" width="907"></p> 
<h3 id="4.%20%E5%85%B6%E4%BB%96%E7%94%A8%E6%B3%95%C2%A0">4. 其他用法 </h3> 
<table><tbody><tr><td> <p>四字命令</p> </td><td> <p>功能描述</p> </td></tr><tr><td> <p>conf</p> </td><td> <p>3.3.0版本引入的。打印出服务相关配置的详细信息。</p> </td></tr><tr><td> <p>cons</p> </td><td> <p>3.3.0版本引入的。列出所有连接到这台服务器的客户端全部连接/会话详细信息。包括"接受/发送"的包数量、会话id、操作延迟、最后的操作执行等等信息。</p> </td></tr><tr><td> <p>crst</p> </td><td> <p>3.3.0版本引入的。重置所有连接的连接和会话统计信息。</p> </td></tr><tr><td> <p>dump</p> </td><td> <p>列出那些比较重要的会话和临时节点。这个命令只能在leader节点上有用。</p> </td></tr><tr><td> <p>envi</p> </td><td> <p>打印出服务环境的详细信息。</p> </td></tr><tr><td> <p>reqs</p> </td><td> <p>列出未经处理的请求</p> </td></tr><tr><td> <p>ruok</p> </td><td> <p>测试服务是否处于正确状态。如果确实如此，那么服务返回"imok"，否则不做任何相应。</p> </td></tr><tr><td> <p>stat</p> </td><td> <p>输出关于性能和连接的客户端的列表。</p> </td></tr><tr><td> <p>srst</p> </td><td> <p>重置服务器的统计。</p> </td></tr><tr><td> <p>srvr</p> </td><td> <p>3.3.0版本引入的。列出连接服务器的详细信息</p> </td></tr><tr><td> <p>wchs</p> </td><td> <p>3.3.0版本引入的。列出服务器watch的详细信息。</p> </td></tr><tr><td> <p>wchc</p> </td><td> <p>3.3.0版本引入的。通过session列出服务器watch的详细信息，它的输出是一个与watch相关的会话的列表。</p> </td></tr><tr><td> <p>wchp</p> </td><td> <p>3.3.0版本引入的。通过路径列出服务器watch的详细信息。它输出一个与session相关的路径。</p> </td></tr><tr><td> <p>mntr</p> </td><td> <p>3.4.0版本引入的。输出可用于检测集群健康状态的变量列表</p> </td></tr></tbody></table> 
<p><a href="https://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_4lw" rel="nofollow" title="官方文档: https://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_4lw">官方文档: https://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_4lw</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/534a78e4ab0d9cfd38aa265ea22ca3ff/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java与前端2023：真相与焦虑</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/92465c6273f90973c985ee82bb1b9d47/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">软件工程PPT 笔记摘录（2）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>