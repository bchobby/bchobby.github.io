<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>方差分析-单因素方差分析示例 (Between Subjects) - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="方差分析-单因素方差分析示例 (Between Subjects)" />
<meta property="og:description" content="目录
1、从一个例子出发
2、建立零假设
3、什么是MSE和MSB
4、样本大小
5、计算MSE
6、计算MSB
7、比较MSE和MSB
8、分析差异的来源
本文将从一个例子（“微笑宽容实验”）出发，详细介绍单因素方差分析的原理。
1、从一个例子出发 有证据表明，微笑可以减弱人们对他人错误行为的判断，比如在法院上被告的微笑可能带来更少的惩罚。”微笑宽容实验“就是来研究不同类型的微笑带来的宽容程度是否有差异。在这个研究中，136名受试者被分到了4个不同的组，每组受试者会被展示不同微笑类型的图片（false、felt、miserable和neutral）。每位受试者都会给图片打一个score，用来代表受试者对图片里微笑的宽容程度。数据源在此。
2、建立零假设 方差分析的零假设为所有组别的总体均值都相等，即： 其中H0代表零假设，k代表组别。在“微笑宽容实验”中，k=4，并且零假设为：
如果零假设被拒绝，则表明至少有一个组的总体均值与其他组是不同的。
3、什么是MSE和MSB 方差分析是通过分析方差来检测均值差异的一种统计学方法。这种检测方法基于两种对总体均值（）的估计。一种估计是基于分组内部得分的差异，被称为组内均方或误差均方（Mean Square Error，MSE）。无论零假设是否为真（总体均值相等），MSE都可以用来估计。另一种估计是基于组间均值之间的差异，被称为组间均方（Mean Square Between，MSB）。只有在总体均值相等时，MSB才能准确估计。如果总体均值不想等，MSB的估计值将会大于。因此，如果MSB比MSE大得多，那么总体均值是不太可能相等的。但是，如果MSB和MSE的值差不多，那么总体均值相等的零假设是成立的。
在计算MSE和MSB之前，需要先介绍方差分析的前提假设：
1）方差齐性（homogeneity of variance）：总体方差是相等的。
2）正态分布（normally distributed）：总体服从正态分布。
3）样本独立（independent sample）：每一个样本值都是独立与其他样本值的。这个假设要求每名受试者只能提供一个样本值，因为如果一名受试者提供了两个样本值，那么这两个值必然不是独立的（这属于within-subjects ANOVA，不在本节内容中）。
以上假设对于双样本t检验也是一样的。
在“微笑宽容实验”中，首先需要计算4个组别的均值和方差：
ConditionMeanVarianceFalse5.3683.338Felt4.9122.825Miserable4.9122.113Neutral4.1182.319 表1 “微笑宽容实验”各组的均值和方差
4、样本大小 后续方差分析的前提是每组受试者的数量是相等的（不相等的分析不在本篇考虑内）。我们用n来表示每组的受试者数量，用N来表示所有的受试者数量。在“微笑宽容实验”中，受试者被分到了4个组别，每个组别都是34人，所以我们有n=34，N=136。
5、计算MSE 我们前面做了方差齐性的假设，即假设每个组别的总体方差（）都是相等的。这个就是MSE的估计值，我们可以通过计算样本方差的均值来得到：
6、计算MSB 对于样本均值抽样分布的方差（），有以下公式：
其中n是每组的样本数量。通过变换，可以得到：
因此，如果我们知道了，再乘以n就得到了总体方差。尽管我们不知道样本均值抽样分布的方差，我们可以通过样本均值的方差来估计它。对于“微笑宽容实验”，4个样本均值的方差为：
这里VAR.S()表示计算样本方差。
总结一下MSB的计算步骤：
1）计算样本均值
2）计算样本均值的方差
3）样本均值的方差乘以n
扼要重述
如果总体均值是相等的，那么MSE和MSB都可以认为是的准确估计，并且二者的值应当是相等的。当然，二者不会完全相等，因为他们是通过数据的不同角度计算得出的：MSB通过样本均值计算得出，而MSE通过样本方差计算得出。
当总体均值不相等时，MSE仍可以有效的估计，因为MSE是通过样本方差计算得到的，而总体均值的差异不会影响样本方差。但是，总体均值的差异会影响MSB对的估计，因为总体均值的差异与样本均值之前的差异是相关的。因此，如果样本均值之间的差异越大，MSB也会越大。
简而言之，无论总体均值是否相等，MSE都可以用来估计。然而，只有在样本均值相等的条件下，MSB才可以用来估计，并且当总体均值不相等时，MSB的估计值会偏大。
7、比较MSE和MSB 比较MSE和MSB是方差分析中至关重要的一步。既然当总体均值不相等时，MSB会比MSE的估计值更大，那么当计算出的MSB值比MSE值更大时，也就说明了总体均值是不相等的。但是即使当总体均值是相等的时候，也会偶然地发生MSB比MSE要大的情况，所以想要得到可靠的结论，MSB必须比MSE大的足够多。但是多大的MSB才算大呢？对于“微笑宽容实验”的数据来说，MSB 和MSE分别为9.178和2.649，这个差异足够大吗？为了回答这一问题，我们需要知道如果总体均值是相等的，达到这一差距或更大差距的概率是多少。统计学家Fisher从数学上回答了这一问题。尽管与Fisher最初的公式形式略有不同，但是确定概率的标准方法是都是基于MSB与MSE的比率。这个比率以Fisher命名，称为 F ratio。
对于“微笑宽容实验”的数据，F ratio为：
因此，MSB是MSE的3.465倍。如果所有组别的总体均值都是相等的，有可能得到这个结果吗？回答这个问题还要考虑样本数量。当样本数量很小时，得到这样的结果不足为奇，因为结果是不稳定的。可是，当样本数量很大时，MSB和MSE的值基本是不会改变的，所以F ratio为3.465或者更大是反常的。图1展示了“微笑宽容实验”的样本数量下，F的抽样分布。可以看到，分布是正偏态的。
图1 F的分布
从图1可以看出，3.465或更大的F ratio是反常现象。3.465右侧黑色区域的面积，代表得到此F或者更大F的概率，这个概率值为0.018。换句话说，零假设“总体均值是相等的”的概率值（p value）为0.018，所以我们可以拒绝零假设。于是，我们得到结论：至少有一个组的总体均值是不同于其他组的。
F分布的形状取决于样本数量。更准确地说，分布的形状取决于两个自由度（df）：一个是分子的自由度（MSB），另一个是分母的自由度（MSE）。我们都知道方差估计值的自由度等于样本数量减一，MSB是k个均值的方差估计，所以它的自由度为k-1。MSE是k个方差的均值，每个方差的自由度都是n-1，所以MSE的自由度为k(n-1)=N-k，其中N代表总样本数量，n代表每组的样本数量，k代表组数。总结如下：
对于“微笑宽容实验”，我们有：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/ae2d7f264c7a275ec38cbea73063aa0f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-01T11:57:43+08:00" />
<meta property="article:modified_time" content="2023-02-01T11:57:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">方差分析-单因素方差分析示例 (Between Subjects)</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%BB%8E%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90%E5%87%BA%E5%8F%91-toc" style="margin-left:40px;"><a href="#%E4%BB%8E%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90%E5%87%BA%E5%8F%91" rel="nofollow">1、从一个例子出发</a></p> 
<p id="%E9%9B%B6%E5%81%87%E8%AE%BE-toc" style="margin-left:40px;"><a href="#%E9%9B%B6%E5%81%87%E8%AE%BE" rel="nofollow">2、建立零假设</a></p> 
<p id="MSE%E4%B8%8EMSB-toc" style="margin-left:40px;"><a href="#MSE%E4%B8%8EMSB" rel="nofollow">3、什么是MSE和MSB</a></p> 
<p id="%E6%A0%B7%E6%9C%AC%E5%A4%A7%E5%B0%8F-toc" style="margin-left:40px;"><a href="#%E6%A0%B7%E6%9C%AC%E5%A4%A7%E5%B0%8F" rel="nofollow">4、样本大小</a></p> 
<p id="%E8%AE%A1%E7%AE%97MSE-toc" style="margin-left:40px;"><a href="#%E8%AE%A1%E7%AE%97MSE" rel="nofollow">5、计算MSE</a></p> 
<p id="%E8%AE%A1%E7%AE%97MSB-toc" style="margin-left:40px;"><a href="#%E8%AE%A1%E7%AE%97MSB" rel="nofollow">6、计算MSB</a></p> 
<p id="%E6%AF%94%E8%BE%83MSE%E5%92%8CMSB-toc" style="margin-left:40px;"><a href="#%E6%AF%94%E8%BE%83MSE%E5%92%8CMSB" rel="nofollow">7、比较MSE和MSB</a></p> 
<p id="%E5%8F%98%E5%BC%82%E7%9A%84%E6%9D%A5%E6%BA%90-toc" style="margin-left:40px;"><a href="#%E5%8F%98%E5%BC%82%E7%9A%84%E6%9D%A5%E6%BA%90" rel="nofollow">8、分析差异的来源</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p>本文将从一个例子（“微笑宽容实验”）出发，详细介绍单因素方差分析的原理。</p> 
<h3 id="%E4%BB%8E%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90%E5%87%BA%E5%8F%91">1、从一个例子出发</h3> 
<p>有证据表明，微笑可以减弱人们对他人错误行为的判断，比如在法院上被告的微笑可能带来更少的惩罚。”微笑宽容实验“就是来研究不同类型的微笑带来的宽容程度是否有差异。在这个研究中，136名受试者被分到了4个不同的组，每组受试者会被展示不同微笑类型的图片（false、felt、miserable和neutral）。每位受试者都会给图片打一个score，用来代表受试者对图片里微笑的宽容程度。<a class="link-info" href="https://onlinestatbook.com/2/case_studies/data/leniency.txt" rel="nofollow" title="数据源在此">数据源在此</a>。</p> 
<h3 id="%E9%9B%B6%E5%81%87%E8%AE%BE">2、建立零假设</h3> 
<p>方差分析的零假设为所有组别的总体均值都相等，即： </p> 
<p><img alt="H_0:\mu_{1}=\mu_{2}=...=\mu_{k}" class="mathcode" src="https://images2.imgbox.com/e9/98/VdFpy0jT_o.png"></p> 
<p>其中H0代表零假设，k代表组别。在“微笑宽容实验”中，k=4，并且零假设为：</p> 
<p><img alt="H_0:\mu_{false}=\mu_{felt}=\mu_{miserable}=\mu_{neutral}" class="mathcode" src="https://images2.imgbox.com/34/72/9XL7EGex_o.png"></p> 
<p>如果零假设被拒绝，则表明至少有一个组的总体均值与其他组是不同的。</p> 
<h3 id="MSE%E4%B8%8EMSB">3、什么是MSE和MSB</h3> 
<p>方差分析是通过分析方差来检测均值差异的一种统计学方法。这种检测方法基于两种对总体均值（<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/97/7d/3W4Y8aAT_o.png">）的估计。一种估计是基于分组内部得分的差异，被称为组内均方或误差均方（Mean Square Error，MSE）。无论零假设是否为真（总体均值相等），MSE都可以用来估计<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/46/8f/i9rI3EYV_o.png">。另一种估计是基于组间均值之间的差异，被称为组间均方（Mean Square Between，MSB）。只有在总体均值相等时，MSB才能准确估计<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/0d/d6/3DmMvWfr_o.png">。如果总体均值不想等，MSB的估计值将会大于<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/f7/a6/VqjHDbTu_o.png">。因此，如果MSB比MSE大得多，那么总体均值是不太可能相等的。但是，如果MSB和MSE的值差不多，那么总体均值相等的零假设是成立的。</p> 
<p>在计算MSE和MSB之前，需要先介绍<span style="color:#fe2c24;">方差分析的前提假设：</span></p> 
<p>    1）方差齐性（homogeneity of variance）：总体方差是相等的。</p> 
<p>    2）正态分布（normally distributed）：总体服从正态分布。</p> 
<p>    3）样本独立（independent sample）：每一个样本值都是独立与其他样本值的。这个假设要求每名受试者只能提供一个样本值，因为如果一名受试者提供了两个样本值，那么这两个值必然不是独立的（这属于within-subjects ANOVA，不在本节内容中）。</p> 
<p>以上假设对于双样本t检验也是一样的。</p> 
<p>在“微笑宽容实验”中，首先需要计算4个组别的均值和方差：</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:328px;"><tbody><tr><td style="text-align:center;"><strong>Condition</strong></td><td style="text-align:center;width:128px;"><strong>Mean</strong></td><td style="text-align:center;width:103px;"><strong>Variance</strong></td></tr><tr><td style="text-align:center;vertical-align:middle;width:65pt;"><span style="color:#000000;">False</span></td><td style="text-align:center;vertical-align:middle;width:128px;"><span style="color:#000000;">5.368</span></td><td style="text-align:center;vertical-align:middle;width:103px;"><span style="color:#000000;">3.338</span></td></tr><tr><td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">Felt</span></td><td style="text-align:center;vertical-align:middle;width:128px;"><span style="color:#000000;">4.912</span></td><td style="text-align:center;vertical-align:middle;width:103px;"><span style="color:#000000;">2.825</span></td></tr><tr><td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">Miserable</span></td><td style="text-align:center;vertical-align:middle;width:128px;"><span style="color:#000000;">4.912</span></td><td style="text-align:center;vertical-align:middle;width:103px;"><span style="color:#000000;">2.113</span></td></tr><tr><td style="text-align:center;vertical-align:middle;"><span style="color:#000000;">Neutral</span></td><td style="text-align:center;vertical-align:middle;width:128px;"><span style="color:#000000;">4.118</span></td><td style="text-align:center;vertical-align:middle;width:103px;"><span style="color:#000000;">2.319</span></td></tr></tbody></table> 
<p style="text-align:center;">表1 “微笑宽容实验”各组的均值和方差</p> 
<h3 id="%E6%A0%B7%E6%9C%AC%E5%A4%A7%E5%B0%8F">4、样本大小</h3> 
<p>后续方差分析的前提是每组受试者的数量是相等的（不相等的分析不在本篇考虑内）。我们用n来表示每组的受试者数量，用N来表示所有的受试者数量。在“微笑宽容实验”中，受试者被分到了4个组别，每个组别都是34人，所以我们有n=34，N=136。</p> 
<h3 id="%E8%AE%A1%E7%AE%97MSE">5、计算MSE</h3> 
<p>我们前面做了方差齐性的假设，即假设每个组别的总体方差（<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/e3/9b/aSeF4ti4_o.png">）都是相等的。这个<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/18/d7/6aC998NO_o.png">就是MSE的估计值，我们可以通过计算样本方差的均值来得到：</p> 
<p><img alt="MSE= (3.338+2.825+2.113+2.319) / 4 = 2.649" class="mathcode" src="https://images2.imgbox.com/21/1d/IO4Pr5qu_o.png"></p> 
<h3 id="%E8%AE%A1%E7%AE%97MSB"><span style="color:#000000;">6、计算MSB</span></h3> 
<p><span style="color:#000000;">对于样本均值抽样分布的方差（<img alt="\sigma_M^2" class="mathcode" src="https://images2.imgbox.com/ad/7f/WbkarHmJ_o.png"></span><span style="color:#000000;">），有以下公式：</span></p> 
<p><img alt="\sigma_M^2=\frac{\sigma^2}{n}" class="mathcode left" src="https://images2.imgbox.com/86/d7/9Z8uSrCO_o.png"></p> 
<p><span style="color:#000000;">其中n是每组的样本数量。通过变换，可以得到：</span></p> 
<p><img alt="\sigma^2=n\sigma_M^2" class="mathcode left" src="https://images2.imgbox.com/0b/15/lXrbk6XD_o.png"></p> 
<p>因此，如果我们知道了<span style="color:#000000;"><img alt="\sigma_M^2" class="mathcode" src="https://images2.imgbox.com/85/77/MEYTTkjI_o.png"></span>，再乘以n就得到了总体方差<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/a6/f2/i8VtboMt_o.png">。尽管我们不知道样本均值抽样分布的方差<span style="color:#000000;"><img alt="\sigma_M^2" class="mathcode" src="https://images2.imgbox.com/88/93/JIyRd68q_o.png"></span>，我们可以通过样本均值的方差来估计它。对于“微笑宽容实验”，4个样本均值的方差为：</p> 
<p><img alt="\sigma_{M}^{2}= VAR.S(5.368,4.912,4.912,4.118) =0.270" class="mathcode" src="https://images2.imgbox.com/d4/2b/s8vCXdmj_o.png"></p> 
<p><img alt="\sigma^2=n\sigma_{M}^{2}= 34*0.270=9.178" class="mathcode" src="https://images2.imgbox.com/d8/03/eFnHuUdg_o.png"></p> 
<p><span style="color:#000000;">这里VAR.S()表示计算样本方差。</span></p> 
<p><strong>总结一下MSB的计算步骤：</strong></p> 
<p>    1）计算样本均值</p> 
<p>    2）计算样本均值的方差</p> 
<p>    3）样本均值的方差乘以n</p> 
<p id="%E6%89%BC%E8%A6%81%E9%87%8D%E8%BF%B0"><strong>扼要重述</strong></p> 
<p>如果总体均值是相等的，那么MSE和MSB都可以认为是<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/fb/47/PGhDmhyl_o.png">的准确估计，并且二者的值应当是相等的。当然，二者不会完全相等，因为他们是通过数据的不同角度计算得出的：MSB通过样本均值计算得出，而MSE通过样本方差计算得出。</p> 
<p>当总体均值不相等时，MSE仍可以有效的估计<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/a8/fe/tCfvCUWP_o.png">，因为MSE是通过样本方差计算得到的，而总体均值的差异不会影响样本方差。但是，总体均值的差异会影响MSB对<img alt="\sigma ^{2}" class="mathcode" src="https://images2.imgbox.com/6b/87/klJWhffx_o.png">的估计，因为总体均值的差异与样本均值之前的差异是相关的。因此，如果样本均值之间的差异越大，MSB也会越大。</p> 
<p><span style="color:#fe2c24;">简而言之，无论总体均值是否相等，MSE都可以用来估计<img alt="\sigma ^{2}" class="mathcode" height="16" src="https://images2.imgbox.com/36/ec/LYjWRQz8_o.png" width="17">。然而，只有在样本均值相等的条件下，MSB才可以用来估计<img alt="\sigma ^{2}" class="mathcode" height="16" src="https://images2.imgbox.com/41/fd/RXB3qLzo_o.png" width="17">，并且当总体均值不相等时，MSB的估计值会偏大。</span></p> 
<h3 id="%E6%AF%94%E8%BE%83MSE%E5%92%8CMSB"><span style="color:#0d0016;">7、比较MSE和MSB</span></h3> 
<p>比较MSE和MSB是方差分析中至关重要的一步。既然当总体均值不相等时，MSB会比MSE的估计值更大，那么当计算出的MSB值比MSE值更大时，也就说明了总体均值是不相等的。但是即使当总体均值是相等的时候，也会偶然地发生MSB比MSE要大的情况，所以想要得到可靠的结论，MSB必须比MSE大的足够多。但是多大的MSB才算大呢？对于“微笑宽容实验”的数据来说，MSB 和MSE分别为9.178和2.649，这个差异足够大吗？为了回答这一问题，我们需要知道如果总体均值是相等的，达到这一差距或更大差距的概率是多少。统计学家Fisher从数学上回答了这一问题。尽管与Fisher最初的公式形式略有不同，但是确定概率的标准方法是都是基于MSB与MSE的比率。这个比率以Fisher命名，称为 F ratio。</p> 
<p>对于“微笑宽容实验”的数据，F ratio为：</p> 
<p><img alt="F = 9.178/2.649 = 3.465" class="mathcode" src="https://images2.imgbox.com/8d/2b/Wcjf09F6_o.png"></p> 
<p>因此，MSB是MSE的3.465倍。如果所有组别的总体均值都是相等的，有可能得到这个结果吗？回答这个问题还要考虑样本数量。当样本数量很小时，得到这样的结果不足为奇，因为结果是不稳定的。可是，当样本数量很大时，MSB和MSE的值基本是不会改变的，所以F ratio为3.465或者更大是反常的。图1展示了“微笑宽容实验”的样本数量下，F的抽样分布。可以看到，分布是正偏态的。</p> 
<p class="img-center"><img alt="" height="438" src="https://images2.imgbox.com/ef/d9/0uPhFVm0_o.png" width="614"></p> 
<p style="text-align:center;">图1 F的分布</p> 
<p>从图1可以看出，3.465或更大的F ratio是反常现象。3.465右侧黑色区域的面积，代表得到此F或者更大F的概率，这个概率值为0.018。换句话说，零假设“总体均值是相等的”的概率值（p value）为0.018，所以我们可以拒绝零假设。于是，我们得到结论：至少有一个组的总体均值是不同于其他组的。</p> 
<p><span style="color:#fe2c24;">F分布的形状取决于样本数量。更准确地说，分布的形状取决于两个自由度（df）</span>：一个是分子的自由度（MSB），另一个是分母的自由度（MSE）。我们都知道方差估计值的自由度等于样本数量减一，MSB是k个均值的方差估计，所以它的自由度为k-1。MSE是k个方差的均值，每个方差的自由度都是n-1，所以MSE的自由度为k(n-1)=N-k，其中N代表总样本数量，n代表每组的样本数量，k代表组数。总结如下：</p> 
<p><img alt="df_{numerator}=k-1" class="mathcode left" src="https://images2.imgbox.com/fa/9e/C7e3QRVS_o.png"></p> 
<p><img alt="df_{denominator}=N-k" class="mathcode left" src="https://images2.imgbox.com/b3/b3/RxYNu5Vc_o.png"></p> 
<p>对于“微笑宽容实验”，我们有：</p> 
<p><img alt="df_{numerator}=k-1=4-1=3" class="mathcode left" src="https://images2.imgbox.com/80/05/HOk8y0qX_o.png"></p> 
<p><img alt="df_{denominator}=N-k=136-4=132" class="mathcode left" src="https://images2.imgbox.com/be/a9/9Rc9GubA_o.png"></p> 
<h3 id="%E5%8F%98%E5%BC%82%E7%9A%84%E6%9D%A5%E6%BA%90">8、分析差异的来源</h3> 
<p>为什么一个实验中受试者之间的打分是不同的？以“微笑宽容实验”中“False Smile”组和“Felt Smile”组的两名受试者为例。这两名受试者之所以打出不同的分数，第一个原因是，两名受试者看到的两组图片是不同类型的微笑。第二个原因是，这两名受试者可能本身对于他人的宽容程度就有所不同。第三个原因是，其中一名受试者在实验前的一次考试中获得了很低的分数，因此心情很低落。对于两名受试者为什么打出不同的分数，你可以想象出无数种其他的原因。但是除了第一个原因（受试者被区别对待），其他所有的原因都不是实验想去研究的，因此，这些原因导致的所有差异都无法解释。</p> 
<p>通常，我们称上面无法解释的差异为误差，但是这个称呼并不意味着真的发生了错误。差异的原因可以被归为两部分，要么是由于受试者被区别对待引起的，要么是由于误差（所有未被测量到的差异）。</p> 
<p>方差分析一个很重要的特性就是，它能够将差异分为不同的来源。在方差分析中，一般用平方和（ Sum of SQuares，SSQ）来表示差异。总差异被定义为每一个受试者的打分与所有受试者打分均值的平方差之和。所有受试者打分的均值被称为总均值（Grand Mean，GM）。当每组受试者的数量相等时，总均值等于各组均值的平均值。总平方和定义为：</p> 
<p><img alt="SSQ_{total}=\sum(X-GM)^2" class="mathcode" src="https://images2.imgbox.com/21/65/aWemTouo_o.png"></p> 
<p>上面公式意味着，取每个得分，减去总均值，将差值平方，然后将这些平方值相加。对于“微笑宽容实验”，<img alt="SSQ_{total}" class="mathcode" src="https://images2.imgbox.com/77/fe/zDfZd3Bm_o.png">=377.19</p> 
<p>条件平方和的计算方法如下式：</p> 
<p><img alt="SSQ_{condition}=n[(M_1-GM)^2+(M_2-GM)^2+...+(M_k-GM)^2]" class="mathcode" src="https://images2.imgbox.com/ff/0a/f5DkCwnQ_o.png"></p> 
<p>其中，n是每组样本的数量，k是组数，<img alt="M_1" class="mathcode" src="https://images2.imgbox.com/28/ec/ZkS8XeF6_o.png">是第一组的均值，<img alt="M_2" class="mathcode" src="https://images2.imgbox.com/32/fb/biG2f6jO_o.png">是第二组的均值，<img alt="M_k" class="mathcode" src="https://images2.imgbox.com/ce/2b/AEV8K1vN_o.png">是第k组的均值。对于“微笑宽容实验”，该值为：</p> 
<p><img alt="SSQ_{condition}=34[(5.37-4.83)^2+(4.91-4.83)^2+(4.91-4.83)^2+(4.12-4.83)^2=27.5" class="mathcode left" src="https://images2.imgbox.com/1e/a0/PopzYTi9_o.png"></p> 
<p>误差平方和是每个分数与其组内平均值的平方偏差之和，公式如下：</p> 
<p><img alt="SSQ_{error}=\sum(X_{i1}-M_1)^2+\sum(X_{i2}-M_2)^2+...+\sum(X_{ik}-M_k)^2" class="mathcode" src="https://images2.imgbox.com/a4/78/fS6Xj0zl_o.png"></p> 
<p>其中，<img alt="X_{i1}" class="mathcode" src="https://images2.imgbox.com/e5/ca/UpHYeUAm_o.png">是第一组第i名受试者的打分，<img alt="M_1" class="mathcode" src="https://images2.imgbox.com/5c/52/oMB90o10_o.png">是第一组打分的均值，<img alt="X_{i2}" class="mathcode" src="https://images2.imgbox.com/53/9f/GgQoA5YO_o.png">是第二组第i名受试者的打分，<img alt="M_2" class="mathcode" src="https://images2.imgbox.com/54/61/qYQvLJHZ_o.png">是第二组打分的均值，等等。对于“微笑宽容实验”，各组打分的均值分别是：5.368、4.912、4.912和4.118，因此<img alt="SSQ_{error}" class="mathcode" src="https://images2.imgbox.com/3c/db/a5hpzQ1N_o.png">为：</p> 
<p><img alt="(2.5-5.368)^2+(5.5-5.368)^2+...+(6.5-4.118)^2=349.65" class="mathcode" src="https://images2.imgbox.com/54/be/X6HzfHoj_o.png"></p> 
<p>误差平方和也可以通过减法得到：</p> 
<p><img alt="SSQ_{error}=SSQ_{total}-SSQ_{condition}" class="mathcode" src="https://images2.imgbox.com/5f/be/hAP4MyHU_o.png"></p> 
<p><img alt="SSQ_{error}=377.189-27.535=349.65" class="mathcode" src="https://images2.imgbox.com/27/3f/dQASW0E7_o.png"></p> 
<p>因此，总平方和377.19可以被分为<img alt="SSQ_{condition}(27.53)" class="mathcode" src="https://images2.imgbox.com/b9/28/8eRADQjs_o.png">和<img alt="SSQ_{error}(349.66)" class="mathcode" src="https://images2.imgbox.com/6a/b8/olJtYakt_o.png">。</p> 
<p>一旦平方和计算出来了，就可以很容易地计算均方（MSB和MSE）。计算公式如下：</p> 
<p><img alt="MSB=SSQ_{condition}/df_{n}" class="mathcode" src="https://images2.imgbox.com/2b/7f/1T4j7KPh_o.png"></p> 
<p><img alt="MSE=SSQ_{error}/df_{d}" class="mathcode" src="https://images2.imgbox.com/68/39/zmxWFHkn_o.png"></p> 
<p>其中，<img alt="df_{n}" class="mathcode" src="https://images2.imgbox.com/ef/d0/mzNf1QoT_o.png">​​​​​​​是分子，值为k-1=3。<img alt="df_d" class="mathcode" src="https://images2.imgbox.com/f8/2b/1t97YEnd_o.png">是分母自由度，值为N-k=136-4=132。需要注意的是，<img alt="df_d" class="mathcode" src="https://images2.imgbox.com/42/8a/LSdJQDBd_o.png">通常被称为<img alt="df_e" class="mathcode" src="https://images2.imgbox.com/e8/68/PEJmrXzx_o.png">，即误差自由度。</p> 
<p><img alt="MSB=27.535/3=9.18" class="mathcode" src="https://images2.imgbox.com/43/0f/mRv5FJfL_o.png"></p> 
<p><img alt="MSE=349.66/132=2.65" class="mathcode" src="https://images2.imgbox.com/a9/9d/5VjG5vNG_o.png"></p> 
<p>可以看到，按上面方法计算出的MSB和MSE与之前计算的值是一样的。</p> 
<p>下面列出的方差分析汇总表是分析方差的一种方便形式：</p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:479px;"><tbody><tr><td style="text-align:center;width:84px;"><strong>Source</strong></td><td style="text-align:center;width:70px;"><strong>df</strong></td><td style="text-align:center;width:87px;"><strong>SSQ</strong></td><td style="text-align:center;width:81px;"><strong>MS</strong></td><td style="text-align:center;width:79px;"><strong>F</strong></td><td style="text-align:center;width:78px;"><strong>p</strong></td></tr><tr><td style="text-align:center;width:84px;">Condition</td><td style="text-align:center;width:70px;">3</td><td style="text-align:center;width:87px;">27.535</td><td style="text-align:center;width:81px;">9.178</td><td style="text-align:center;width:79px;">3.465</td><td style="text-align:center;width:78px;">0.0182</td></tr><tr><td style="text-align:center;width:84px;">Error</td><td style="text-align:center;width:70px;">132</td><td style="text-align:center;width:87px;">349.654</td><td style="text-align:center;width:81px;">2.649</td><td style="text-align:center;width:79px;"></td><td style="text-align:center;width:78px;"></td></tr><tr><td style="text-align:center;width:84px;">Total</td><td style="text-align:center;width:70px;">135</td><td style="text-align:center;width:87px;">377.189</td><td style="text-align:center;width:81px;"></td><td style="text-align:center;width:79px;"></td><td style="text-align:center;width:78px;"></td></tr></tbody></table> 
<p style="text-align:center;">表2 方差分析汇总表</p> 
<p>第一列Source为变异的来源，第二列df为自由度，第三列SSQ为平方和，第四列MS为均方，第五列F为F ratio，最后一列p为概率值。需要指出的是，均方总是等于平方和除以自由度，F和p只与Condition相关。尽管均方和可以通过平方和除以自由度计算得出，但这样的计算方式没有什么意义，就省略了。 </p> 
<p>最后，总结一下<span style="color:#fe2c24;">单因素方差分析的基本步骤</span>：</p> 
<p>1）建立零假设</p> 
<p>2）计算MSE</p> 
<p>3）计算MSB</p> 
<p>4）计算两个自由度和F值</p> 
<p>5）计算SSQ，解释差异的原因</p> 
<p></p> 
<p>参考资料：<a href="https://onlinestatbook.com/2/analysis_of_variance/one-way.html" rel="nofollow" title="One-Factor ANOVA (Between Subjects)">One-Factor ANOVA (Between Subjects)</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/270f3e99d9343775bb02189d3b84a6d1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java 互相关联的实体无限递归问题的解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/62d0788f57877254cad7202a9bc6d620/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">查找可用串口(Windows&#43;Linux平台)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>