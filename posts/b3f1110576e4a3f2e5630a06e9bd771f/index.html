<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>李宏毅深度学习笔记——呕心整理版 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="李宏毅深度学习笔记——呕心整理版" />
<meta property="og:description" content="李宏毅深度学习笔记——呕心整理版 闲谈叨叨叨:
之前看过吴恩达的一部分课程，所以有一定理论基础，再看李宏毅的课程会有新的理解。我先以有基础的情况写完学习过程，后续再以零基础的角度补充细节概念（估计不会啦，因为懒~）。长篇预警！可以慢慢看。多数只是自己的笔记，不会太有语言的概念解释，建议自己看一遍视频（往后字可能会越来越多，听我慢慢叨咕吧）。笔记只是提供回忆、巩固理解的工具。若有问题，欢迎评论讨论，有时间我会改正哒！
经过我多年学习经验（没有啦~），预习真的很重要，其实更多是重复记忆，加深理解。我的建议是先看吴恩达的课程了解机器学习和深度学习的基本知识框架和概念，还有理论推导，理解就可以，这就相当于预习；然后看李宏毅的课程，换个思路，以实际应用加深理解，就会感觉吴恩达的课程缘由不太清楚的自然而然就通了；看李宏毅的课程同时，看刘二大人的pytorch课程，动手操作，学会后完成李宏毅的作业；pytorch需要线性代数和概率论（这些课上要好好学，忘了的可以速学一下考研课程）以及python基础，我会整理一些推荐课程和学习路线。
关于李宏毅课程的视频顺序，我大多是先看2021年，用2022年视频作为补充，快速过一遍，选修部分也看。视频链接还有一位大佬整理的资源我会附在正文的引入部分。
目录附上：
文章目录 李宏毅深度学习笔记——呕心整理版1 引入1.1 机器学习&amp;深度学习1.2 课程规划1.3 机器学习例子1.3.1 训练过程（training）1.3.2 改进（很牛逼，建议有基础后回看）1.3.3 激活函数1.3.4 神经网络Neural Network 1.4 深度学习简介1.4.1 反向传播（back propagation）1.4.2 回归 Regression1.4.3 分类（classification）1.4.4 逻辑回归（Logistic Regression） 1.5 Homework 2 优化分析2.1 局部最小值（local minima）与鞍点（saddle point）2.2 批次（Batch）与动量（Momentum）2.3 自动调整学习率 (Learning Rate)2.4 损失函数（Loss）也会有影响2.5 批次标准化（Batch Normalization）2.6 深度学习 3 卷积神经网络（CNN）3.1 卷积神经网络（CNN)3.2 Spatial Transformer Layer 4 自注意力机制（Self-attention）4.1 引入4.2 self-attention4.3 Multi-head Self-attention 5 Transformer 正片开始： 1 引入 视频资料整理：李宏毅2021&amp;2022机器学习视频：2022-机器学习相关规定 1.1 机器学习&amp;深度学习 机器学习就是寻找一个复杂函数。
深度学习的函数就是类神经网络。
函数的输入可以是向量、矩阵、序列等等；函数的输出可以是数值（称为regression 回归）、类别（classification 分类）、文本、图片等等 回归 regression：
分类 classification：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/b3f1110576e4a3f2e5630a06e9bd771f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-06T21:33:32+08:00" />
<meta property="article:modified_time" content="2022-12-06T21:33:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">李宏毅深度学习笔记——呕心整理版</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>李宏毅深度学习笔记——呕心整理版</h2> 
<p>闲谈叨叨叨:</p> 
<blockquote> 
 <p>之前看过吴恩达的一部分课程，所以<strong>有一定理论基础</strong>，再看李宏毅的课程会有新的理解。我先以有基础的情况写完学习过程，后续再以零基础的角度补充细节概念（估计不会啦，因为懒~）。<strong>长篇预警</strong>！可以慢慢看。<strong>多数只是自己的笔记</strong>，不会太有语言的概念解释，建议自己看一遍视频（往后字可能会越来越多，听我慢慢叨咕吧）。笔记只是提供回忆、巩固理解的工具。若有问题，欢迎评论讨论，有时间我会改正哒！</p> 
</blockquote> 
<blockquote> 
 <p>经过我多年学习经验（没有啦~），<strong>预习真的很重要</strong>，其实更多是重复记忆，加深理解。我的建议是先看吴恩达的课程了解机器学习和深度学习的基本知识框架和概念，还有理论推导，理解就可以，这就相当于预习；然后看李宏毅的课程，换个思路，以实际应用加深理解，就会感觉吴恩达的课程缘由不太清楚的自然而然就通了；看李宏毅的课程同时，看刘二大人的pytorch课程，<strong>动手操作</strong>，学会后完成李宏毅的作业；pytorch需要线性代数和概率论（这些课上要好好学，忘了的可以速学一下考研课程）以及python基础，我会整理一些推荐课程和学习路线。</p> 
</blockquote> 
<blockquote> 
 <p>关于李宏毅课程的视频顺序，我大多是先看2021年，用2022年视频作为补充，快速过一遍，选修部分也看。视频链接还有一位大佬整理的资源我会附在正文的引入部分。</p> 
</blockquote> 
<p>目录附上：</p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_0" rel="nofollow">李宏毅深度学习笔记——呕心整理版</a></li><li><ul><li><a href="#1__17" rel="nofollow">1 引入</a></li><li><ul><li><a href="#11__22" rel="nofollow">1.1 机器学习&amp;深度学习</a></li><li><a href="#12__45" rel="nofollow">1.2 课程规划</a></li><li><a href="#13__78" rel="nofollow">1.3 机器学习例子</a></li><li><ul><li><a href="#131_training_86" rel="nofollow">1.3.1 训练过程（training）</a></li><li><a href="#132__143" rel="nofollow">1.3.2 改进（很牛逼，建议有基础后回看）</a></li><li><a href="#133__241" rel="nofollow">1.3.3 激活函数</a></li><li><a href="#134_Neural_Network_264" rel="nofollow">1.3.4 神经网络Neural Network</a></li></ul> 
    </li><li><a href="#14__290" rel="nofollow">1.4 深度学习简介</a></li><li><ul><li><a href="#141_back_propagation_301" rel="nofollow">1.4.1 反向传播（back propagation）</a></li><li><a href="#142__Regression_367" rel="nofollow">1.4.2 回归 Regression</a></li><li><a href="#143_classification_399" rel="nofollow">1.4.3 分类（classification）</a></li><li><a href="#144_Logistic_Regression_491" rel="nofollow">1.4.4 逻辑回归（Logistic Regression）</a></li></ul> 
    </li><li><a href="#15_Homework_680" rel="nofollow">1.5 Homework</a></li></ul> 
   </li><li><a href="#2__692" rel="nofollow">2 优化分析</a></li><li><ul><li><a href="#21_local_minimasaddle_point_696" rel="nofollow">2.1 局部最小值（local minima）与鞍点（saddle point）</a></li><li><a href="#22_BatchMomentum_755" rel="nofollow">2.2 批次（Batch）与动量（Momentum）</a></li><li><a href="#23___Learning_Rate_808" rel="nofollow">2.3 自动调整学习率 (Learning Rate)</a></li><li><a href="#24_Loss_884" rel="nofollow">2.4 损失函数（Loss）也会有影响</a></li><li><a href="#25_Batch_Normalization_893" rel="nofollow">2.5 批次标准化（Batch Normalization）</a></li><li><a href="#26__936" rel="nofollow">2.6 深度学习</a></li></ul> 
   </li><li><a href="#3_CNN_974" rel="nofollow">3 卷积神经网络（CNN）</a></li><li><ul><li><a href="#31_CNN_978" rel="nofollow">3.1 卷积神经网络（CNN)</a></li><li><a href="#32_Spatial_Transformer_Layer_1104" rel="nofollow">3.2 Spatial Transformer Layer</a></li></ul> 
   </li><li><a href="#4_Selfattention_1110" rel="nofollow">4 自注意力机制（Self-attention）</a></li><li><ul><li><a href="#41__1116" rel="nofollow">4.1 引入</a></li><li><a href="#42_selfattention_1148" rel="nofollow">4.2 self-attention</a></li><li><a href="#43_Multihead_Selfattention_1195" rel="nofollow">4.3 Multi-head Self-attention</a></li></ul> 
   </li><li><a href="#5_Transformer_1215" rel="nofollow">5 Transformer</a></li></ul> 
 </li></ul> 
</div> 
<br> 正片开始： 
<p></p> 
<h3><a id="1__17"></a>1 引入</h3> 
<ul><li>视频资料整理：<a href="https://blog.csdn.net/zzh516451964zzh/article/details/123212671">李宏毅2021&amp;2022机器学习</a></li><li>视频：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=1" rel="nofollow">2022-机器学习相关规定</a></li></ul> 
<h4><a id="11__22"></a>1.1 机器学习&amp;深度学习</h4> 
<p>机器学习就是<strong>寻找一个复杂函数</strong>。</p> 
<p>深度学习的函数就是<strong>类神经网络</strong>。</p> 
<ul><li>函数的<strong>输入</strong>可以是向量、矩阵、序列等等；</li><li>函数的<strong>输出</strong>可以是数值（称为regression 回归）、类别（classification 分类）、文本、图片等等</li></ul> 
<p><img src="https://images2.imgbox.com/c3/e6/ko8LBUT7_o.png" alt="在这里插入图片描述"></p> 
<p><strong>回归 regression</strong>：</p> 
<p><img src="https://images2.imgbox.com/80/fc/cZt472sC_o.png" alt="在这里插入图片描述"></p> 
<p><strong>分类 classification</strong>：</p> 
<p><img src="https://images2.imgbox.com/e6/d4/Mw1Qggoi_o.png" alt="在这里插入图片描述"></p> 
<p><strong>structured learning</strong>：</p> 
<p><img src="https://images2.imgbox.com/d5/41/TsBmXWuO_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="12__45"></a>1.2 课程规划</h4> 
<p><strong>——————————先更新到前5章——————————</strong></p> 
<p>Lecture1-5： <strong>Supervised Learning</strong> 监督学习</p> 
<blockquote> 
 <p>训练数据要有标注，数据集要知道输出值</p> 
 <p>缺点：耗费人工</p> 
</blockquote> 
<p>Lecture 7： <strong>Self-supervised Learning</strong></p> 
<blockquote> 
 <p>无标注资料——Pre-train</p> 
</blockquote> 
<p>Lecture 6： Generative Adversarial Network（GAN）</p> 
<p>Lecture 12： Reinforcement Learning（RL）强化学习</p> 
<blockquote> 
 <p>不知道怎么标注</p> 
</blockquote> 
<p>Lecture 8： Anomaly detection 异常检测</p> 
<p>Lecture 9： Explainable AI 可解释性AI</p> 
<p>Lecture 10： Model attack 模型攻击</p> 
<p>Lecture 11： Domain adaptation 域适应</p> 
<p>Lecture 13： Network Compression</p> 
<p>Lecture 14： life-long learning</p> 
<p>Lecture 15： Meta learning</p> 
<h4><a id="13__78"></a>1.3 机器学习例子</h4> 
<ul><li>传送门： 
  <ul><li><a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=3" rel="nofollow">（上）机器学习基本概念简介</a></li><li><a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=4" rel="nofollow">（下）机器学习基本概念简介</a></li></ul> </li></ul> 
<p>根据过往观看次数预测明天的观看次数</p> 
<h5><a id="131_training_86"></a>1.3.1 训练过程（training）</h5> 
<ol><li> <p><strong>含有未知参数的函数</strong><br> <img src="https://images2.imgbox.com/50/c2/ewUXIp9q_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>定义损失函数</strong><br> <img src="https://images2.imgbox.com/f1/7d/hAA0rcGK_o.png" alt="在这里插入图片描述"></p> 
  <blockquote> 
   <p><strong>标签 label</strong>：已知的对应结果</p> 
  </blockquote> <p>求出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            e 
           
          
            1 
           
          
         
        
          e_1 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            e 
           
          
            N 
           
          
         
        
          e_N 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            L 
           
          
            o 
           
          
            s 
           
          
            s 
           
          
            : 
           
          
            L 
           
          
            = 
           
           
           
             1 
            
           
             N 
            
           
           
           
             ∑ 
            
           
             n 
            
           
           
           
             e 
            
           
             n 
            
           
          
         
           Loss: L=\frac{1}{N}\sum _ne_n 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.57144em; vertical-align: -1.25001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
  <blockquote> 
   <p>补充：<br> loss函数可自己定义，以下常见三类：MAE、MSE、交叉熵<br> <img src="https://images2.imgbox.com/eb/0c/jxtyYpuV_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/28/6d/Ae41me4X_o.png" alt="在这里插入图片描述"></p> 
  </blockquote> <p><strong>误差曲面（error surface）</strong>：</p> <p><img src="https://images2.imgbox.com/6c/62/SiEscAs8_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>优化</strong><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             w 
            
           
             ∗ 
            
           
          
            , 
           
           
           
             b 
            
           
             ∗ 
            
           
          
            = 
           
          
            a 
           
          
            r 
           
          
            g 
           
           
            
            
              min 
             
            
              ⁡ 
             
            
            
            
              w 
             
            
              , 
             
            
              b 
             
            
           
          
            L 
           
          
         
           w^*, b^* = arg \min_{w,b}L 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.933136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.57155em; vertical-align: -0.888216em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.04789em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.888216em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">L</span></span></span></span></span></span></p> 
  <blockquote> 
   <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            a 
           
          
            r 
           
          
            g 
           
          
            m 
           
          
            i 
           
          
            n 
           
          
         
           argmin 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span></span></span></span></span>：使后面的公式最小的参数</p> 
  </blockquote> <p><strong>梯度下降 gradient descent</strong></p> <p>假设只有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           w 
          
         
        
          w 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span></span></span></span></span>一个参数</p> <p><img src="https://images2.imgbox.com/75/3f/GZ5sFXCd_o.png" alt="在这里插入图片描述"></p> <p>带上<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           b 
          
         
        
          b 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span></span></span></span></span>嘞</p> <p><img src="https://images2.imgbox.com/4a/8d/cSlAVwwL_o.png" alt="在这里插入图片描述"></p> 
  <blockquote> 
   <p><strong>超参数（hyper parameter）</strong>：机器学习中，需要自己设定的参数</p> 
   <p><strong>学习率</strong></p> 
  </blockquote> 
  <blockquote> 
   <p>全局最小值与局部最小值的问题。后续补充，在2.1部分（手动跳转吧~ 无法页面内部跳转，气死我啦ヽ(*。&gt;Д&lt;)o゜）</p> 
   <p>这个问题并不是最主要的，最常见的。其实是学习率！</p> 
  </blockquote> <p>找到使loss最小的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           w 
          
         
           , 
          
         
           b 
          
         
        
          w,b 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span></span></span></span></span>的值</p> <p><img src="https://images2.imgbox.com/17/14/pIUEBIYk_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<h5><a id="132__143"></a>1.3.2 改进（很牛逼，建议有基础后回看）</h5> 
<p><img src="https://images2.imgbox.com/a4/f1/mmHUIMBP_o.png" alt="在这里插入图片描述"></p> 
<p>线性模型太过简单。</p> 
<blockquote> 
 <p><strong>model bias</strong>：线性模型具有很大的限制</p> 
</blockquote> 
<p>怎么避免model bias？需要更复杂的含有未知参数的函数。</p> 
<p>线性函数都可以用一段一段的函数组成，即可用常数+若干个蓝色函数表示。</p> 
<p><img src="https://images2.imgbox.com/36/03/HwK4Rgqc_o.png" alt="在这里插入图片描述"></p> 
<p>那怎么表示蓝色函数呢？</p> 
<p><strong>sigmoid function（S函数）：</strong><br> <span class="katex--display">KaTeX parse error: No such environment: align at position 8: \begin{̲a̲l̲i̲g̲n̲}̲ y &amp;= c\frac{1}…</span><br> <img src="https://images2.imgbox.com/05/d5/q7f82m1c_o.png" alt="在这里插入图片描述"></p> 
<p>调整sigmoid函数的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
         , 
        
       
         b 
        
       
         , 
        
       
         w 
        
       
      
        c, b, w 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span></span></span></span></span>制作各式各样的蓝色函数</p> 
<p><img src="https://images2.imgbox.com/d6/e5/FCXGEtB2_o.png" alt="在这里插入图片描述"></p> 
<p>所以…<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
        
          b 
         
        
          + 
         
         
         
           ∑ 
          
         
           i 
          
         
         
          
          
            c 
           
          
            i 
           
          
         
             
          
         
           s 
          
         
           i 
          
         
           g 
          
         
           m 
          
         
           o 
          
         
           i 
          
         
           d 
          
         
           ( 
          
          
          
            b 
           
          
            i 
           
          
         
           + 
          
          
          
            w 
           
          
            i 
           
          
          
          
            x 
           
          
            1 
           
          
         
           ) 
          
         
        
       
         y=b+\sum_i{c_i\ sigmoid(b_i+w_ix_1)} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.32767em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></span><br> <img src="https://images2.imgbox.com/99/1b/FTShWy9I_o.png" alt="在这里插入图片描述"></p> 
<p>延伸一下（前方高能！！！）：</p> 
<p>若<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
         = 
        
       
         b 
        
       
         + 
        
        
        
          ∑ 
         
        
          j 
         
        
        
         
         
           w 
          
         
           j 
          
         
         
         
           x 
          
         
           j 
          
         
        
       
      
        y=b+\sum_j{w_jx_j} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.18582em; vertical-align: -0.435818em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span>，则<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
         = 
        
       
         b 
        
       
         + 
        
        
        
          ∑ 
         
        
          i 
         
        
        
         
         
           c 
          
         
           i 
          
         
        
            
         
        
          s 
         
        
          i 
         
        
          g 
         
        
          m 
         
        
          o 
         
        
          i 
         
        
          d 
         
        
          ( 
         
         
         
           b 
          
         
           i 
          
         
        
          + 
         
         
         
           ∑ 
          
         
           j 
          
         
         
          
          
            w 
           
           
           
             i 
            
           
             j 
            
           
          
          
          
            x 
           
          
            j 
           
          
         
        
          ) 
         
        
       
      
        y=b+\sum_i{c_i\ sigmoid(b_i+\sum_j{w_{ij}x_j})} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.18582em; vertical-align: -0.435818em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.161954em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p> 
<p><img src="https://images2.imgbox.com/ce/e6/vEl5FXZJ_o.png" alt="在这里插入图片描述"></p> 
<p>绝了哇！！！这不就是神经网络的隐藏层计算嘛！！！</p> 
<p>用矩阵表示一下</p> 
<p><img src="https://images2.imgbox.com/35/48/khi69N6Y_o.png" alt="在这里插入图片描述"></p> 
<p>然后对每个<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         r 
        
       
      
        r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span></span></span></span></span>计算sigmoid<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          α 
         
        
          = 
         
        
          σ 
         
        
          ( 
         
        
          r 
         
        
          ) 
         
        
       
         \alpha=\sigma(r) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mclose">)</span></span></span></span></span></span><br> <img src="https://images2.imgbox.com/55/6d/m01iE1lG_o.png" alt="在这里插入图片描述"></p> 
<p>最后求y<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
        
          b 
         
        
          + 
         
         
         
           c 
          
         
           T 
          
         
        
          α 
         
        
       
         y=b+c^T\alpha 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.891331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span></span></span></span></span></span><br> <img src="https://images2.imgbox.com/a5/99/XnRJGyFc_o.png" alt="在这里插入图片描述"></p> 
<p>整理一下<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
        
          b 
         
        
          + 
         
         
         
           c 
          
         
           T 
          
         
        
          σ 
         
        
          ( 
         
        
          b 
         
        
          + 
         
        
          W 
         
        
          x 
         
        
          ) 
         
        
       
         y = b+c^T\sigma(b+Wx) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.14133em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">W</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span></span><br> <img src="https://images2.imgbox.com/3f/51/BJPTKN9d_o.png" alt="在这里插入图片描述"></p> 
<p>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>是<strong>特征向量（feature）</strong>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         W 
        
       
         , 
        
       
         b 
        
       
         , 
        
        
        
          c 
         
        
          T 
         
        
       
         , 
        
       
         b 
        
       
      
        W,b,c^T,b 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03577em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">W</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span></span></span></span></span>（注意两个b不是一个意思哦~）是未知参数 ，<strong>将未知参数列成一列，统称为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          θ 
         
        
       
         \theta 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span></span></span></span></span>.</strong></p> 
<p><img src="https://images2.imgbox.com/da/21/GBwul5cb_o.png" alt="在这里插入图片描述"></p> 
<p>完美，更新了训练过程的第一步！！！</p> 
<p>接下来，就是计算loss咯，没有什么变化，只是参数用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         θ 
        
       
      
        \theta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span></span></span></span></span>表示，因为参数太多啦。所以loss函数为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         L 
        
       
         ( 
        
       
         θ 
        
       
         ) 
        
       
      
        L(\theta) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span>.</p> 
<p>最后是优化，</p> 
<p><img src="https://images2.imgbox.com/89/94/ivY6Kjci_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/4a/d3/Vg87De96_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>梯度 gradient</strong>。一般不会有梯度为零的情况。</p> 
</blockquote> 
<p>可能数据很多，不方便训练，可以将数据分为几个<strong>batch</strong>（后续补充，为什么这样做，在<a href="#2.2-%E6%89%B9%E6%AC%A1%EF%BC%88Batch%EF%BC%89%E4%B8%8E%E5%8A%A8%E9%87%8F%EF%BC%88Momentum%EF%BC%89" rel="nofollow">2.2部分</a>），用一个batch计算损失值，然后**更新（update）**参数，再选下一个batch，继续更新，直到最后一个batch。</p> 
<p>把所有的batch看过一遍，称为一个<strong>epoch</strong>。</p> 
<h5><a id="133__241"></a>1.3.3 激活函数</h5> 
<p><strong>ReLU (Rectified Linear Unit)</strong><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
        
          c 
         
        
            
         
        
          m 
         
        
          a 
         
        
          x 
         
        
          ( 
         
        
          0 
         
        
          , 
         
        
          b 
         
        
          + 
         
        
          w 
         
         
         
           x 
          
         
           1 
          
         
        
          ) 
         
        
       
         y=c\ max(0,b+wx_1) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">c</span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> <img src="https://images2.imgbox.com/e0/12/QoSwMh3F_o.png" alt="在这里插入图片描述"></p> 
<p>Hard Sigmoid就可以用ReLU组合表示<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
        
          b 
         
        
          + 
         
         
         
           ∑ 
          
          
          
            2 
           
          
            i 
           
          
         
         
          
          
            c 
           
          
            i 
           
          
         
             
          
         
           m 
          
         
           a 
          
         
           x 
          
         
           ( 
          
         
           0 
          
         
           , 
          
          
          
            b 
           
          
            i 
           
          
         
           + 
          
          
          
            ∑ 
           
          
            j 
           
          
          
           
           
             w 
            
            
            
              i 
             
            
              j 
             
            
           
           
           
             x 
            
           
             j 
            
           
          
            ) 
           
          
         
        
       
         y=b+\sum_{2i}{c_i\ max(0,b_i+\sum_j{w_{ij}x_j)}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 2.46378em; vertical-align: -1.41378em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">i</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></span></span><br> ReLU、Sigmoid就称为<strong>激活函数（activation function）</strong></p> 
<p>还有很多激活函数，后续补充…</p> 
<p><strong>对于激活函数还有一种解释</strong>：</p> 
<blockquote> 
 <p>如果都是线性关系，无论有多少层，最后都会化简成一个线性关系式，那前面的那么多层有什么用嘞，所以用激活函数将线性关系转化为非线性关系，让每一层都可以起到提取特征的作用</p> 
</blockquote> 
<p>其实本质上都是让函数更加复杂。</p> 
<h5><a id="134_Neural_Network_264"></a>1.3.4 神经网络Neural Network</h5> 
<p>可以再经历一**层（layer）**计算，层数自己设定，为超参数。</p> 
<p><img src="https://images2.imgbox.com/1b/98/lCyuLp4m_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>Neuron 神经元</p> 
 <p>Neural network 神经网络</p> 
</blockquote> 
<p>换个高大上的名字</p> 
<blockquote> 
 <p>hidden layer 隐藏层</p> 
 <p>deep learning 深度学习</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/e5/b5/QFNa2PU5_o.png" alt="在这里插入图片描述"></p> 
<p>之后网络越来越深，贼多层。</p> 
<p>但是为什么要更深，而不是更宽呢，后续补充。</p> 
<p>越深就越好吗？不是，会出现<strong>过拟合（Overfitting）</strong>，简单来说就是，练习题都会做，全对，一到考试就不会，错的离谱。</p> 
<h4><a id="14__290"></a>1.4 深度学习简介</h4> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=13" rel="nofollow">深度学习简介</a></li></ul> 
<p><strong>全连接前向传播神经网络 Fully connect feedforward network</strong></p> 
<p><img src="https://images2.imgbox.com/89/c7/jkTN4YKD_o.png" alt="在这里插入图片描述"></p> 
<p>层数和神经元数的确定，嗯~，靠直觉（经验啦）。当然这个结构也是可以靠自动学习出来的（e.g. evolutionary artificial neural network）</p> 
<h5><a id="141_back_propagation_301"></a>1.4.1 反向传播（back propagation）</h5> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=14&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">反向传播</a></li></ul> 
<p>快速计算梯度的方法而已</p> 
<p>链式法则会吧？不会百度一下喽。</p> 
<p>接下来是反向传播求loss值对每个参数的偏导的过程：</p> 
<p><img src="https://images2.imgbox.com/cc/c8/HYBG905A_o.png" alt="在这里插入图片描述"></p> 
<p>局部放大</p> 
<p><img src="https://images2.imgbox.com/c4/e9/FBMiq1M5_o.png" alt="在这里插入图片描述"></p> 
<p>想求C对w的偏导，是不是可以用链式法则展开一下<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
            ∂ 
           
          
            C 
           
          
          
          
            ∂ 
           
          
            w 
           
          
         
        
          = 
         
         
          
          
            ∂ 
           
          
            z 
           
          
          
          
            ∂ 
           
          
            w 
           
          
         
         
          
          
            ∂ 
           
          
            C 
           
          
          
          
            ∂ 
           
          
            z 
           
          
         
        
       
         \frac{\partial C}{\partial w}=\frac{\partial z}{\partial w}\frac{\partial C}{\partial z} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 那就分步求呗，先求前面的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           ∂ 
          
         
           z 
          
         
         
         
           ∂ 
          
         
           w 
          
         
        
       
      
        \frac{\partial z}{\partial w} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>，用forward pass；再求后面的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           ∂ 
          
         
           C 
          
         
         
         
           ∂ 
          
         
           z 
          
         
        
       
      
        \frac{\partial C}{\partial z} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>，用backward pass。</p> 
<ul><li> <p><strong>Forward pass过程</strong></p> <p><img src="https://images2.imgbox.com/53/d5/qWdk4sSp_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>Backward pass过程</strong></p> <p><img src="https://images2.imgbox.com/41/bc/mwBKsG8A_o.png" alt="在这里插入图片描述"></p> <p>不要忘记中间z到a经历了sigmoid激励函数哦~<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
            
            
              ∂ 
             
            
              a 
             
            
            
            
              ∂ 
             
            
              z 
             
            
           
          
            = 
           
           
           
             σ 
            
           
             ′ 
            
           
          
            ( 
           
          
            z 
           
          
            ) 
           
          
         
           \frac{\partial a}{\partial z}=\sigma'(z) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.05744em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.37144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mclose">)</span></span></span></span></span></span><br> 函数图像是这个样子：</p> <p><img src="https://images2.imgbox.com/cf/aa/U530UgKW_o.png" alt="在这里插入图片描述"></p> <p>好，回到求偏导。那<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             ∂ 
            
           
             C 
            
           
           
           
             ∂ 
            
            
            
              z 
             
            
              ′ 
             
            
           
          
         
        
          \frac{\partial C}{\partial z'} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             ∂ 
            
           
             C 
            
           
           
           
             ∂ 
            
            
            
              z 
             
             
             
               ′ 
              
             
               ′ 
              
             
            
           
          
         
        
          \frac{\partial C}{\partial z''} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>怎么求呢？我们假设已经通过某种方法求出来了</p> <p><img src="https://images2.imgbox.com/41/7b/1HYTsQFF_o.png" alt="在这里插入图片描述"></p> <p>那<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             ∂ 
            
           
             C 
            
           
           
           
             ∂ 
            
            
            
              z 
             
            
              ′ 
             
            
           
          
         
        
          \frac{\partial C}{\partial z'} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             ∂ 
            
           
             C 
            
           
           
           
             ∂ 
            
            
            
              z 
             
             
             
               ′ 
              
             
               ′ 
              
             
            
           
          
         
        
          \frac{\partial C}{\partial z''} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>可以怎么求呢，主要分两种</p> 
  <ul><li> <p><strong>这两个之后就是输出结果</strong>，整个网络就结束了。那就很简单了</p> <p><img src="https://images2.imgbox.com/aa/00/gANPlJZW_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>这两个之后不是整个网络的输出</strong>。</p> <p><img src="https://images2.imgbox.com/5a/66/8NXGlbaV_o.png" alt="在这里插入图片描述"></p> </li></ul> <p>总结一下反向传播的两个计算过程：</p> 
  <ul><li>用forward pass计算<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
            
            
              ∂ 
             
            
              z 
             
            
            
            
              ∂ 
             
            
              w 
             
            
           
          
            = 
           
          
            α 
           
          
         
           \frac{\partial z}{\partial w}=\alpha 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span></span></span></span></span>;</li><li>用backward pass计算<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
            
            
              ∂ 
             
            
              C 
             
            
            
            
              ∂ 
             
            
              z 
             
            
           
          
         
           \frac{\partial C}{\partial z} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li>两者相乘，即<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
            
            
              ∂ 
             
            
              C 
             
            
            
            
              ∂ 
             
            
              w 
             
            
           
          
            = 
           
           
            
            
              ∂ 
             
            
              z 
             
            
            
            
              ∂ 
             
            
              w 
             
            
           
           
            
            
              ∂ 
             
            
              C 
             
            
            
            
              ∂ 
             
            
              z 
             
            
           
          
         
           \frac{\partial C}{\partial w}=\frac{\partial z}{\partial w}\frac{\partial C}{\partial z} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.22511em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.880108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.05556em;">∂</span><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li></ul> </li></ul> 
<h5><a id="142__Regression_367"></a>1.4.2 回归 Regression</h5> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=15&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">预测神奇宝贝</a></li></ul> 
<p>著名的宝可梦例子（虽然我不知道宝可梦到底是森么，但是老师举的这种可爱的例子真的很容易理解欸）</p> 
<p>基本内容与播放量的例子差不多，有几个补充的点。</p> 
<ul><li> <p>函数可以是多次式</p> <p><img src="https://images2.imgbox.com/be/07/jYbyVcNB_o.png" alt="在这里插入图片描述"></p> <p>但是注意【过拟合】的问题。</p> <p>函数不是越复杂越好，要适合恰当的函数</p> </li><li> <p>宝可梦的数据与它的种类有关系，意外发现！！！，加上</p> <p>也有可能存在其他因素对分数有影响，加上</p> <p>不断的修改函数…</p> <p>但是其他因素加上后发现，还是存在过拟合的情况，解决办法就是正则化…</p> </li><li> <p><strong>正则化（regularization）</strong></p> <p><img src="https://images2.imgbox.com/b0/80/x7jfqSgU_o.png" alt="在这里插入图片描述"></p> <p>这其实可以让函数变得平滑，因为w越小，输入的变化对函数的影像就越小，换句话说就是函数不会被输入值所含不确定的因素影响。我们希望得到一个平滑的函数，但是太平滑也不好，loss也会增加。</p> </li></ul> 
<h5><a id="143_classification_399"></a>1.4.3 分类（classification）</h5> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=16&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">分类神奇宝贝</a></li></ul> 
<p>又是宝可梦的例子啦~</p> 
<p>其实分类可以理解为回归，比如有两个类别：-1和1，更接近回归结果更接近-1为一类，更接近1为另一类。但不建议实际应用哈。（因为假如是1，2，3类别，1和2是比较像的，到底属于哪个类别并不是很好判断，1和3又不像，所以有时候行，有时候不行，就说明这种方法不建议使用啦。后面会提到如何避免这种情况，在<a href="#1.4.4" rel="nofollow">1.4.4</a>的多元分类会提到one-hot vector的方法）</p> 
<p>比较好的方法: perceptron；SVM；…（后续再说）</p> 
<p>那先用概率的方法研究一下这个问题：</p> 
<p><strong>二元分类</strong>：两种类别的情况（后续会有多类别分类的例子，在会补充到，不要着急，先把二分类了解个大概）</p> 
<ul><li>输入属于某一类别的概率：贝叶斯概率公式</li><li><strong>生成模型 Generative Model</strong>：全概率公式</li></ul> 
<p><img src="https://images2.imgbox.com/c6/f6/552r1sGp_o.png" alt="在这里插入图片描述"></p> 
<p>所以要想算这两个值，就得知道四个红框里面<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         P 
        
       
         ( 
        
        
        
          C 
         
        
          1 
         
        
       
         ) 
        
       
         , 
        
       
         P 
        
       
         ( 
        
        
        
          C 
         
        
          2 
         
        
       
         ) 
        
       
         , 
        
       
         P 
        
       
         ( 
        
       
         x 
        
       
         ∣ 
        
        
        
          C 
         
        
          1 
         
        
       
         ) 
        
       
         , 
        
       
         P 
        
       
         ( 
        
       
         x 
        
       
         ∣ 
        
        
        
          C 
         
        
          2 
         
        
       
         ) 
        
       
      
        P(C_1),P(C_2), P(x|C_1),P(x|C_2) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>的数值。</p> 
<ul><li> <p>首先是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           P 
          
         
           ( 
          
          
          
            C 
           
          
            1 
           
          
         
           ) 
          
         
           , 
          
         
           P 
          
         
           ( 
          
          
          
            C 
           
          
            2 
           
          
         
           ) 
          
         
        
          P(C_1),P(C_2) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>，这个机率叫做<strong>先验 Prior</strong></p> <p><img src="https://images2.imgbox.com/7f/4b/Q2KlEh3G_o.png" alt="在这里插入图片描述"></p> 
  <blockquote> 
   <p>特征值 feature</p> 
  </blockquote> </li><li> <p>然后是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           P 
          
         
           ( 
          
         
           x 
          
         
           ∣ 
          
          
          
            C 
           
          
            1 
           
          
         
           ) 
          
         
           , 
          
         
           P 
          
         
           ( 
          
         
           x 
          
         
           ∣ 
          
          
          
            C 
           
          
            2 
           
          
         
           ) 
          
         
        
          P(x|C_1),P(x|C_2) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p> <p>用<strong>高斯分布（正态分布） Gaussion distribution</strong></p> <p><img src="https://images2.imgbox.com/2a/5b/Urjnen6Z_o.png" alt="在这里插入图片描述"></p> <p>确定一个高斯分布的重点就是求出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           μ 
          
         
           , 
          
         
           σ 
          
         
        
          \mu,\sigma 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span></span></span></span></span>.</p> <p>怎么求呢，用<strong>极大似然法（maximum likelihood）</strong></p> <p><img src="https://images2.imgbox.com/ad/bb/rSoiJNQT_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<p>然后就可以求出属于那一类别的概率了</p> 
<p><img src="https://images2.imgbox.com/24/de/OTSQQKd7_o.png" alt="在这里插入图片描述"></p> 
<p>但是准确率非常低，把所有影响因素加上，也还是很低。</p> 
<p>同时，两个种类都有各自的高斯分布，这样参数还是蛮多的。那怎么让参数少一点？共用一个<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         σ 
        
       
      
        \sigma 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span></span></span></span></span></p> 
<p><img src="https://images2.imgbox.com/84/03/ozOaiPMu_o.png" alt="在这里插入图片描述"></p> 
<p>哦吼，然后把所有因素加上去之后，准确率提升了！！！</p> 
<p>好！这个部分就结束掉了。主要是用高斯分布求概率，用贝叶斯概率分类酱紫。</p> 
<p>补充一个非常高能的推导——<strong>后验概率（Posterior Probability）</strong></p> 
<p><img src="https://images2.imgbox.com/29/50/br9qTxuN_o.png" alt="在这里插入图片描述"></p> 
<p>没错！<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         P 
        
       
         ( 
        
        
        
          C 
         
        
          1 
         
        
       
         ∣ 
        
       
         x 
        
       
         ) 
        
       
      
        P(C_1|x) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span>化简之后竟然可以写成sigmoid函数。</p> 
<p>那我们再来化简以下z。</p> 
<p><img src="https://images2.imgbox.com/90/b8/GSy4QMlq_o.png" alt="在这里插入图片描述"></p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         l 
        
       
         n 
        
        
         
         
           P 
          
         
           ( 
          
         
           x 
          
         
           ∣ 
          
          
          
            C 
           
          
            1 
           
          
         
           ) 
          
         
         
         
           P 
          
         
           ( 
          
         
           x 
          
         
           ∣ 
          
          
          
            C 
           
          
            2 
           
          
         
           ) 
          
         
        
       
      
        ln\frac{P(x|C_1)}{P(x|C_2)} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.53em; vertical-align: -0.52em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.07153em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317314em;"><span class="" style="top: -2.357em; margin-left: -0.07153em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>咋求捏？</p> 
<p><img src="https://images2.imgbox.com/46/33/JdJzUamy_o.png" alt="在这里插入图片描述"></p> 
<p>然后，</p> 
<p><img src="https://images2.imgbox.com/4c/95/FwbsW1qh_o.png" alt="在这里插入图片描述"></p> 
<p>然后后，</p> 
<p><img src="https://images2.imgbox.com/4d/7d/9YLFpFSu_o.png" alt="在这里插入图片描述"></p> 
<p>惊不惊喜，意不意外！<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         z 
        
       
         = 
        
        
        
          w 
         
        
          T 
         
        
       
         x 
        
       
         + 
        
       
         b 
        
       
      
        z=w^Tx+b 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.924661em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span></span></span></span></span>了。回到<a href="#1.3.2-%E6%94%B9%E8%BF%9B%EF%BC%88%E5%BE%88%E7%89%9B%E9%80%BC%EF%BC%8C%E5%BB%BA%E8%AE%AE%E6%9C%89%E5%9F%BA%E7%A1%80%E5%90%8E%E5%9B%9E%E7%9C%8B%EF%BC%89" rel="nofollow">1.3.2</a>部分的sigmoid函数定义，你说巧不巧。过程看不懂没关系，记住结果就好。</p> 
<p>那这就可以解释为，x输入经过z这个函数后，再经历激活函数就得到了输出，即分类的概率。</p> 
<p>接下来就引出了逻辑回归的概念，跟上面的例子差不多了啦</p> 
<h5><a id="144_Logistic_Regression_491"></a>1.4.4 逻辑回归（Logistic Regression）</h5> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=17&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">逻辑回归</a></li></ul> 
<p>注意：这里先以二元分类为例，后续会提到多元分类哒</p> 
<p>三个步骤：</p> 
<ul><li> <p>第一步：建立函数集（function set）<br> <img src="https://images2.imgbox.com/48/1e/S8QOYeMG_o.png" alt="在这里插入图片描述"></p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            f 
           
           
           
             w 
            
           
             , 
            
           
             b 
            
           
          
         
           ( 
          
         
           x 
          
         
           ) 
          
         
           = 
          
          
          
            P 
           
           
           
             w 
            
           
             , 
            
           
             b 
            
           
          
         
           ( 
          
          
          
            C 
           
          
            1 
           
          
         
           ∣ 
          
         
           x 
          
         
           ) 
          
         
        
          f_{w,b}(x)=P_{w,b}(C_1|x) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span>其实就是后验概率。</p> <p>画个图理解一下</p> <p><img src="https://images2.imgbox.com/2a/75/fnI3RLmG_o.png" alt="在这里插入图片描述"></p> </li><li> <p>第二步：决定函数的好坏程度</p> <p><img src="https://images2.imgbox.com/aa/43/HNJcbnXv_o.png" alt="在这里插入图片描述"></p> <p>为了计算更容易一点<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
           
           
             w 
            
           
             ∗ 
            
           
          
            , 
           
           
           
             b 
            
           
             ∗ 
            
           
          
            = 
           
          
            a 
           
          
            r 
           
          
            g 
           
          
              
           
           
            
            
              max 
             
            
              ⁡ 
             
            
            
            
              w 
             
            
              , 
             
            
              b 
             
            
           
           
           
             L 
            
           
             ( 
            
           
             w 
            
           
             , 
            
           
             b 
            
           
             ) 
            
           
           
          
            ⇓ 
           
           
           
           
             w 
            
           
             ∗ 
            
           
          
            , 
           
           
           
             b 
            
           
             ∗ 
            
           
          
            = 
           
          
            a 
           
          
            r 
           
          
            g 
           
          
              
           
           
            
            
              min 
             
            
              ⁡ 
             
            
            
            
              w 
             
            
              , 
             
            
              b 
             
            
           
           
           
             − 
            
           
             l 
            
           
             n 
            
           
             L 
            
           
             ( 
            
           
             w 
            
           
             , 
            
           
             b 
            
           
             ) 
            
           
          
         
           w^*,b^*=arg\ \max_{w,b}{L(w,b)}\\ \Downarrow \\ w^*,b^*=arg\ \min_{w,b}{-lnL(w,b)} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.933136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.63822em; vertical-align: -0.888216em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace"> </span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.43056em;"><span class="" style="top: -2.04789em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.888216em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mrel">⇓</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.933136em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.63822em; vertical-align: -0.888216em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mspace"> </span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -2.04789em; margin-left: 0em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span></span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class=""><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.888216em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></span></span><br> 这里定义了<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             y 
            
           
             ^ 
            
           
          
            i 
           
          
         
        
          \hat{y}^i 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0191em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span>，就是对应的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            x 
           
          
            i 
           
          
         
        
          x^i 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span>属于哪个类别而已，然后重新表示了<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           − 
          
         
           l 
          
         
           n 
          
          
          
            f 
           
           
           
             w 
            
           
             , 
            
           
             b 
            
           
          
         
           ( 
          
          
          
            x 
           
          
            i 
           
          
         
           ) 
          
         
        
          -lnf_{w,b}(x^i) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.11077em; vertical-align: -0.286108em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.10764em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p> <p><img src="https://images2.imgbox.com/f7/92/WtVOWi0x_o.png" alt="在这里插入图片描述"></p> <p>整理一下：</p> <p><img src="https://images2.imgbox.com/1b/3d/scwpeKIJ_o.png" alt="在这里插入图片描述"></p> <p>重新定义一下这一大串<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            C 
           
          
            ( 
           
          
            f 
           
          
            ( 
           
           
           
             x 
            
           
             n 
            
           
          
            ) 
           
          
            , 
           
           
            
            
              y 
             
            
              ^ 
             
            
           
             n 
            
           
          
            ) 
           
          
            = 
           
          
            − 
           
          
            [ 
           
           
            
            
              y 
             
            
              ^ 
             
            
           
             n 
            
           
          
            l 
           
          
            n 
           
           
           
             f 
            
           
             ( 
            
            
            
              x 
             
            
              n 
             
            
           
             ) 
            
           
          
            + 
           
          
            ( 
           
          
            1 
           
          
            − 
           
           
            
            
              y 
             
            
              ^ 
             
            
           
             n 
            
           
          
            ) 
           
          
            l 
           
          
            n 
           
           
           
             ( 
            
           
             1 
            
           
             − 
            
           
             f 
            
           
             ( 
            
            
            
              x 
             
            
              n 
             
            
           
             ) 
            
           
             ) 
            
           
          
            ] 
           
          
         
           C(f(x^n),\hat{y}^n)=-[\hat{y}^nln{f(x^n)}+(1-\hat{y}^n)ln{(1-f(x^n))}] 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mopen">[</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span><span class="mclose">]</span></span></span></span></span></span><br> 所以<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            L 
           
          
            ( 
           
          
            f 
           
          
            ) 
           
          
            = 
           
           
           
             ∑ 
            
           
             n 
            
           
           
           
             C 
            
           
             ( 
            
           
             f 
            
           
             ( 
            
            
            
              x 
             
            
              n 
             
            
           
             ) 
            
           
             , 
            
            
             
             
               y 
              
             
               ^ 
              
             
            
              n 
             
            
           
             ) 
            
           
          
         
           L(f)=\sum_n{C(f(x^n),\hat{y}^n)} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.30001em; vertical-align: -1.25001em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.89999em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25001em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></span></p> 
  <blockquote> 
   <p>拓展：</p> 
   <p>符合伯努利分布的<strong>交叉熵（cross entropy）</strong></p> 
   <p><img src="https://images2.imgbox.com/e5/e7/7doO6WRH_o.png" alt="在这里插入图片描述"></p> 
  </blockquote> <p>如果之前学过吴恩达的课程的话，他的逻辑回归部分中的理论部分就可以理解通了，也清楚这个公式<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            c 
           
          
            o 
           
          
            s 
           
          
            t 
           
          
            ( 
           
           
           
             h 
            
           
             θ 
            
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
            , 
           
          
            y 
           
          
            ) 
           
          
            = 
           
          
            − 
           
          
            y 
           
          
            l 
           
          
            o 
           
          
            g 
           
          
            ( 
           
           
           
             h 
            
           
             θ 
            
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
            ) 
           
          
            − 
           
          
            ( 
           
          
            1 
           
          
            − 
           
          
            y 
           
          
            ) 
           
          
            l 
           
          
            o 
           
          
            g 
           
          
            ( 
           
          
            1 
           
          
            − 
           
           
           
             h 
            
           
             θ 
            
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
            ) 
           
          
         
           cost(h_\theta(x),y)=-ylog(h_\theta(x))-(1-y)log(1-h_\theta(x)) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span><br> 是怎么来的了.</p> </li><li> <p>第三步：找到最优秀的function</p> <p><img src="https://images2.imgbox.com/80/4b/u1Rwg2gT_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/35/5f/9dUHRlgm_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/32/0e/0dGKJFLR_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<p>好滴，那我们把逻辑回归与线性回归做个比较捏~</p> 
<p><img src="https://images2.imgbox.com/e8/ad/gTaOvVgd_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>补充：</p> 
 <p>为什么逻辑回归不用方差来做loss函数呢？</p> 
 <p>假如使用方差的话，求偏导后，无论输出值是1还是0，偏导都为0，对收敛起不到效果嘞，毛用没有。</p> 
 <p><img src="https://images2.imgbox.com/9a/fc/yE0IQfzX_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<blockquote> 
 <p>其实这两个是同一个意思：Minimizing cross-entropy is equivalent to maimizing likelihood.</p> 
 <p>但在分类中，还是建议使用交叉熵。</p> 
</blockquote> 
<p>好了，逻辑回归部分就结束了。</p> 
<p>接下来，补充一对概念——<strong>判别器（discriminative）<strong>和</strong>生成器（generative）</strong></p> 
<ul><li> <p>判别器：逻辑回归的方法，称为discriminative</p> 
  <blockquote> 
   <p>“判别式模型”是直接建模，并根据某一数据直接预测；</p> 
  </blockquote> </li><li> <p>生成器：用Gaussian来描述后验概率这件事，成为generative</p> 
  <blockquote> 
   <p>“生成式模型”是模型先对联合概率分布P(x,y)建模，能够学习出联合概率分布，然后由贝叶斯公式得出条件分布P(y|x)，进而进行判断。</p> 
  </blockquote> </li></ul> 
<p><img src="https://images2.imgbox.com/51/21/18Z0zA1M_o.png" alt="在这里插入图片描述"></p> 
<p>判别器和生成器所得参数值是不同的，因为生成器会有很多假设，比如使用的是高斯分布还是其他的概率模型等等。所以他们的回归结果是不同的。所以准确率会有所不同。</p> 
<p>很多文献会说判别器的准确率会高于生成器。原因的话，看下面的例子，这个例子是用生成器来判断检验数据是哪一类别。</p> 
<p><img src="https://images2.imgbox.com/fe/09/pVo4nI5v_o.png" alt="在这里插入图片描述"></p> 
<p>所得概率居然小于0.5，而实际上人眼判断肯定是class1.为什么会出现这一情况呢？是因为生成器假设这些data来自于一个概率模型，它假设了全1的情况会出现在class2——脑补。而且这个概率也受到data数量的影响。</p> 
<p>但其实有时候判别器也不总是高于生成器的：</p> 
<ul><li>训练数据比较少的时候</li><li>标签本来就有问题的时候，脑补会避免很多问题</li><li>先验概率（priors）和类别相关概率（class-dependent probabilities）可以用不同的数据来源预估（没太理解:( ）</li></ul> 
<p>这一部分，结束掉了。不要着急，还有。</p> 
<p>上面的分类都是二分类，那**多分类（multi-class classification）**该怎么办呐？那我们以三分类为例。这里了解过程就好，原理感兴趣就去搜【Bishop，P209-210】部分。</p> 
<p><img src="https://images2.imgbox.com/53/ea/2BMB5Lo8_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>softmax</strong>操作（归一化）：</p> 
 <ol><li>output会介于0~1之间</li><li>output之和为1</li></ol> 
</blockquote> 
<p><img src="https://images2.imgbox.com/4d/fd/STRXUZ84_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>这里<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           y 
          
         
           ^ 
          
         
        
       
         \hat{y} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span></span></span></span>用到了<strong>one hot（独热编码）</strong>，这样softmax后就可以判断属于哪个分类的概率了，因为在0-1之间嘛。</p> 
</blockquote> 
<p>然后是Loss函数，这里使用交叉熵，跟上面提到的有点子区别，也很好理解：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          e 
         
        
          = 
         
        
          − 
         
         
         
           ∑ 
          
         
           i 
          
         
         
          
           
           
             y 
            
           
             i 
            
           
          
            ^ 
           
          
         
           l 
          
         
           n 
          
          
          
            y 
           
          
            i 
           
          
            ′ 
           
          
         
        
       
         e=-\sum_i{\hat{y_i}ln{y_i'}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.32767em; vertical-align: -1.27767em;"></span><span class="mord">−</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></span><br> 这里不用考虑“1-…”</p> 
<p>好，多分类结束！！！</p> 
<p>我们再回到逻辑回归。逻辑回归有很强的限制。在某些情况下，普通的逻辑回归并不能做到分类要求，所以需要有所改变。举个例子：</p> 
<p><img src="https://images2.imgbox.com/1c/2c/gqxFosk8_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/18/67/p3JmV3U4_o.png" alt="在这里插入图片描述"></p> 
<p>像这样，无论怎样画直线，都不能分出来是class1还是class2. 那怎么办呢？</p> 
<p>有两个办法：</p> 
<ul><li> <p>Feature Transformation 特征转换</p> <p><img src="https://images2.imgbox.com/76/44/VXwPdfbl_o.png" alt="在这里插入图片描述"></p> <p>但是这要怎么进行转换呢？人工！所以这个转换并不能由机器自己产生。所以引出另一个办法<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ↓ 
          
         
        
          \downarrow 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mrel">↓</span></span></span></span></span></p> </li><li> <p>Cascading logistic regression models 级联逻辑回归模型</p> <p>前方高能！！！这也是神经网络的另一种理解：</p> <p><img src="https://images2.imgbox.com/ce/2e/QDQfPWi7_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/e6/9c/l2JievrY_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/7a/d3/ebyEfdwp_o.png" alt="在这里插入图片描述"></p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            x 
           
          
            2 
           
          
            ′ 
           
          
         
           , 
          
          
          
            x 
           
          
            1 
           
          
            ′ 
           
          
         
        
          x_2',x_1' 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.248108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -2.45189em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -2.45189em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>画反了，问题不大，理解怎么转换的就好。</p> <p>好！延伸一下。</p> <p>把一小个逻辑回归模型视为一个单元，即Neuron。那由多个neuron组成的网络，成为neural network。</p> <p><img src="https://images2.imgbox.com/30/42/7tEIPtad_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<p>逻辑回归结束！！！</p> 
<h4><a id="15_Homework_680"></a>1.5 Homework</h4> 
<ul><li> <p>HW1</p> <p><img src="https://images2.imgbox.com/70/49/Jehrsykm_o.png" alt="在这里插入图片描述"></p> </li><li> <p>HW2</p> <p><img src="https://images2.imgbox.com/c3/42/u5a8368c_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h3><a id="2__692"></a>2 优化分析</h3> 
<p>这一部分是讨论类神经网络训练得影响因素，训练不起来怎么办？</p> 
<h4><a id="21_local_minimasaddle_point_696"></a>2.1 局部最小值（local minima）与鞍点（saddle point）</h4> 
<ul><li>传送门： <a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=19" rel="nofollow">局部最小值 (local minima) 与鞍点 (saddle point)</a></li></ul> 
<p>这部分分析的问题是如何使梯度下降做得更好。</p> 
<p>当你训练的时候，很有可能会出现loss一直降不下去。出现这种情况，会发现梯度接近于0了，把这种现象称为<strong>梯度消失</strong>。好！梯度消失多半在什么位置呢？我们将这些点统称为<strong>临界点（critical point）</strong>，比如：</p> 
<ul><li> <p><strong>局部最小值（local minima）</strong></p> </li><li> <p><strong>鞍点（saddle point）</strong></p> 
  <blockquote> 
   <p>起码还有下降空间</p> 
  </blockquote> <p><img src="https://images2.imgbox.com/94/d3/LBrzrp2J_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<p>好！那怎么区分这两个临界点呢？</p> 
<p>这就涉及到泰勒展开，浅浅的回顾一下：</p> 
<p><img src="https://images2.imgbox.com/9f/2b/eMdg4q9C_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>Hessian 黑塞（完全没有听过…，问题不大！）</p> 
</blockquote> 
<p>好，当处于临界点时，它的梯度就为0了嘛，所以第二项就没了。那么第三项就是判断临界点种类的依据：</p> 
<p><img src="https://images2.imgbox.com/02/e3/1VagkhGv_o.png" alt="在这里插入图片描述"></p> 
<p>很简单，就是二阶导的问题嘛。把周围所有点带进去求第三项就好了。</p> 
<ul><li>若第三项都大于零，那就是局部最小值</li><li>若都小于零，那就是局部最大值</li><li>若有大于零的，有小于零的，那就是鞍点</li></ul> 
<p>但是有亿点麻烦。有个线性代数的方法，可以很快的判断。这涉及到正定矩阵（positive definite），还有特征值（eigen values）（忘记的快快去回忆下）。只要知道特征值的情况，求可以得到H是什么矩阵，继而推出第三项的正负情况。</p> 
<p><img src="https://images2.imgbox.com/b2/bb/A1ubDIsv_o.png" alt="在这里插入图片描述"></p> 
<p>看不懂？没关系。你只要记住</p> 
<ul><li>特征值全大于零，局部最小值</li><li>小于零，局部最大值</li><li>有正有负，鞍点</li></ul> 
<p>好！对于鞍点的情况，我们可以沿着特征向量的方向减小：</p> 
<p><img src="https://images2.imgbox.com/41/76/GR3XfYcU_o.png" alt="在这里插入图片描述"></p> 
<p>但实际上，并不会这么做，因为还要算二次微分，还有特征值之类的，计算量太大，至于还有什么方法去解决，后续会补充。</p> 
<p>这里补充一个问题：鞍点和局部最小值那个会更常见呢？</p> 
<p>多数的时候鞍点的情况会比较多，而且根据经验来看，得到局部最小值的概率才一半左右，大多数情况都是卡在了鞍点部分。</p> 
<h4><a id="22_BatchMomentum_755"></a>2.2 批次（Batch）与动量（Momentum）</h4> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN/?p=20&amp;spm_id_from=pageDriver&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">批次（Batch）与动量（Momentum）</a></li></ul> 
<p>之前有提到过batch，那我们回顾一下：</p> 
<p><img src="https://images2.imgbox.com/51/73/dnuzfVuy_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>Shuffle</strong>：就是每个epoch中batch的划分是不一样的</p> 
</blockquote> 
<p>接下来回答一下之前提出的问题：为甚么用batch，以及对training的帮助。</p> 
<p>实际操作一下，以两个极端的情况作为例子：没有batch还有batch大小为1</p> 
<ul><li>没有batch：因为数据太多，所以冷却时间很长，但是稳定</li><li>batch大小为1：因为一次只用1个数据，所以冷却时间短，但是不稳定，噪声很大</li></ul> 
<p>其实，大的batch不一定花的时间就多，因为考虑到平行计算的情况。所以时间对于batch大小的选择并不有明显的选择意义。</p> 
<p>然而噪声却对训练有所帮助</p> 
<p><img src="https://images2.imgbox.com/8c/fd/YZNmFYR3_o.png" alt="在这里插入图片描述"></p> 
<p>并且小的batch也会对testing有帮助。</p> 
<p>局部最小值有好坏之分，峡谷类型（右）就不太友好，因为testing与training的loss函数不一样，会有偏差，峡谷对应的值可能会变化很大，而盆地（左）变化就很小。大的batch很有可能会进入到峡谷当中，因为小的batch方向是不确定的，在遇到峡谷的时候可能会跳出去酱紫。所以小的batch会对testing比较友好。</p> 
<p><img src="https://images2.imgbox.com/d5/2b/ydtROGeB_o.png" alt="在这里插入图片描述"></p> 
<p>总结一下：</p> 
<p><img src="https://images2.imgbox.com/2b/e2/15HmZGzo_o.png" alt="在这里插入图片描述"></p> 
<p>就是说，batch的大小各有优缺点，是个超参数，调参侠上线！</p> 
<p>好！Batch部分就到这里。接下来是动量（momentum），他也可以处理saddle point或local minima</p> 
<p>其实就是，接下来的运动方向是梯度的反方向与刚刚运动方向的合方向，至于这个系数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         λ 
        
       
         , 
        
       
         η 
        
       
      
        \lambda,\eta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">λ</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">η</span></span></span></span></span>是需要自己去调的。</p> 
<p><img src="https://images2.imgbox.com/73/2c/tFEuUtnZ_o.png" alt="在这里插入图片描述"></p> 
<p>所以很有可能逃出局部最优解</p> 
<p><img src="https://images2.imgbox.com/7a/58/LEIvRIFT_o.png" alt="在这里插入图片描述"></p> 
<p>结束！接下来是学习率的问题。</p> 
<h4><a id="23___Learning_Rate_808"></a>2.3 自动调整学习率 (Learning Rate)</h4> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=21" rel="nofollow">自动调整学习率 (Learning Rate)</a></li><li>如果看不懂下面的公式，可以去看视频。反正建议看！视！频！</li></ul> 
<p>我们在<a href="#1.3.1-%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B%EF%BC%88training%EF%BC%89" rel="nofollow">1.3.1</a>的部分有提到过，局部最小值临界点什么的不是最常见的问题，最大的障碍其实是学习率。</p> 
<p>有的时候可能根本到不了局部最小值就会卡住，就会出现这种情况：</p> 
<p><img src="https://images2.imgbox.com/71/80/AwmaZx6f_o.png" alt="在这里插入图片描述"></p> 
<p>然而学习率如果只是一个固定的值，效果会不好，所以不同的参数需要不同的学习率。</p> 
<p>我们需要改变的是：当梯度较小的时候步子可以迈的大一点；而梯度较大的时候步子就迈的小一点。所以学习率就做出一点改变：（这里仅以一个参数为例，实际上每个参数都需要一个学习率的，做法是一样滴）</p> 
<p><img src="https://images2.imgbox.com/45/ca/6xndViro_o.png" alt="在这里插入图片描述"></p> 
<p>看一下<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          η 
         
         
         
           σ 
          
         
           i 
          
         
           t 
          
         
        
       
      
        \frac{\eta}{\sigma^t_i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.332em; vertical-align: -0.5845em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7475em;"><span class="" style="top: -2.6411em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.784143em;"><span class="" style="top: -2.17771em; margin-left: -0.03588em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -2.8448em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.322286em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.44611em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">η</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5845em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>具体的求法</p> 
<p><img src="https://images2.imgbox.com/0c/98/Cs2IV9zp_o.png" alt="在这里插入图片描述"></p> 
<p>至于为什么可以做到梯度不同步子不同，很好理解：当坡度较陡那<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          σ 
         
        
          i 
         
        
          t 
         
        
       
      
        \sigma^t_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.05222em; vertical-align: -0.258664em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -2.44134em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.258664em;"><span class=""></span></span></span></span></span></span></span></span></span></span>就大，从而<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          η 
         
         
         
           σ 
          
         
           i 
          
         
           t 
          
         
        
       
      
        \frac{\eta}{\sigma^t_i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.332em; vertical-align: -0.5845em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7475em;"><span class="" style="top: -2.6411em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.784143em;"><span class="" style="top: -2.17771em; margin-left: -0.03588em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -2.8448em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.322286em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.44611em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">η</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5845em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>就小。</p> 
<p><img src="https://images2.imgbox.com/18/70/JB6qClgn_o.png" alt="在这里插入图片描述"></p> 
<p>但是这个计算其实是对整体而言，loss的梯度变化比较统一的情况。然而实际上会存在一个loss函数的变化过于复杂，比如这个奇奇怪怪的图：</p> 
<p><img src="https://images2.imgbox.com/6c/4b/poT0F0lR_o.png" alt="在这里插入图片描述"></p> 
<p>所以我们需要这个学习率在同一个参数的情况下也可以动态的调整（这里可能会有理解上的矛盾，上面方法的学习率也是动态调整的啊？我的理解是上面的方法是对于整体而言的，整体的梯度小，对于学习率的改变会越大，至于如果有不太统一的变化的情况下，会对学习率不是能么有贡献性，所以我们要引入另外一种算法<strong>RMSProp</strong>，下面就会给出，看了就明白了）。</p> 
<p><img src="https://images2.imgbox.com/48/1c/BIVxKaMY_o.png" alt="在这里插入图片描述"></p> 
<p>由<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         α 
        
       
      
        \alpha 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span></span></span></span></span>来决定梯度的重要性。看个图总结一下：</p> 
<p><img src="https://images2.imgbox.com/ec/6d/fAdaiTPs_o.png" alt="在这里插入图片描述"></p> 
<p>目前比较流行的优化策略是<strong>Adam</strong>，久仰大名！其实就是RMSProp和动量的结合，具体的伪代码如下，感兴趣就自己看看吧（不是那么感兴趣hhh），pytorch会写好，直接用就好了。当然有一些参数需要调，但一般默认的就已经很好了。</p> 
<p><img src="https://images2.imgbox.com/71/35/suBX3xX2_o.png" alt="在这里插入图片描述"></p> 
<p>那我们来看一下不同的方法算学习率后训练的结果</p> 
<ul><li> <p>用Adagrad的方法</p> <p><img src="https://images2.imgbox.com/fd/32/wuCkXefR_o.png" alt="在这里插入图片描述"></p> <p>分母累加了太多，导致后面学习率变大，所以出现暴走的状态</p> </li><li> <p>用<strong>Learning Rate Scheduling</strong>解决暴走状态</p> <p>第一种方法：让<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           η 
          
         
        
          \eta 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">η</span></span></span></span></span>与时间有关（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            η 
           
          
            t 
           
          
         
        
          \eta^t 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.987996em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">η</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span></span>）就可以解决上面出现的暴走状态。怎么做到与时间有关呢？<strong>Learning Rate Scheduling（学习率衰减）</strong>。随着时间进行，让<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           η 
          
         
        
          \eta 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">η</span></span></span></span></span>不断减小：</p> <p><img src="https://images2.imgbox.com/96/61/OWKthQlj_o.png" alt="在这里插入图片描述"></p> <p>第二种方法：<strong>Warm UP</strong></p> <p>至于这个方法的理解，理论说服力没有那么大，个人认为经验至上吧</p> <p><img src="https://images2.imgbox.com/97/bd/9yJLpBVQ_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<p>好！这就是学习率优化的部分内容。</p> 
<p>那接下来我们要做什么呢？你看我们总会遇到移动不了的情况（不是最优的部分），除了优化学习率，让他走出去，我们可以考虑改变loss，让函数好求一点嘛。</p> 
<h4><a id="24_Loss_884"></a>2.4 损失函数（Loss）也会有影响</h4> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN/?p=22&amp;spm_id_from=pageDriver&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">损失函数（Loss）也会有影响</a></li></ul> 
<p>这个视频课程内容是重复内容，我会直接在前面完善，主要是知识点连上了，会明白为什么要用这个方法，捋清一下思路。可以回看之前的章节加深印象，给个链接：</p> 
<ul><li><a href="#1.4.3-%E5%88%86%E7%B1%BB%EF%BC%88classification%EF%BC%89" rel="nofollow">1.4.3</a>的分类</li><li>1.4.4的one-hot和交叉熵，主要是交叉熵啦</li></ul> 
<h4><a id="25_Batch_Normalization_893"></a>2.5 批次标准化（Batch Normalization）</h4> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=48&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">批次标准化（Batch Normalization）</a></li></ul> 
<p>建议看完卷积网络之后再看这一节，写到这里是为了“合并同类项”而已。可以先跳过，我会在后面提醒你回来的:)</p> 
<p>看论文，基本上最后都要跟一个BN，所以来听老师课学习一下。</p> 
<p>此处老师给了一个很形象的比喻，BN就是把山铲平的想法（我不是想翻山越岭找到最低点吗，那我给你山铲平咯（怒┗|｀O′|┛）</p> 
<p>好！我们一点一点来理解。</p> 
<p>首先，先引入一个概念<strong>Feature Normalization（特征归一化）</strong></p> 
<p><img src="https://images2.imgbox.com/3d/86/4c5aHKAQ_o.png" alt="在这里插入图片描述"></p> 
<p>看上面椭圆形的图，假如<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          1 
         
        
       
         , 
        
        
        
          w 
         
        
          2 
         
        
       
      
        w_1,w_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>斜率变化差别非常大，如果lr固定，那很难得到好的结果。看这张图下面的流程图，我们想要<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         w 
        
       
      
        w 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span></span></span></span></span>改变找到loss的最小值对不对，但是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          1 
         
        
       
         , 
        
        
        
          w 
         
        
          2 
         
        
       
      
        w_1,w_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的变化率差距很大。所以怎么样才能减小<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         w 
        
       
      
        w 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span></span></span></span></span>对loss变化的影响呢，或者说让loss变化更加平稳均匀呢？那么就和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>有关了，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>很小（大），那<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Δ 
        
       
         w 
        
       
         ∗ 
        
       
         x 
        
       
      
        \Delta w*x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Δ</span><span class="mord mathdefault" style="margin-right: 0.02691em;">w</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>就小（大），那<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Δ 
        
       
         L 
        
       
      
        \Delta L 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Δ</span><span class="mord mathdefault">L</span></span></span></span></span>就小（大），所以x的变化程度影响了loss的变化程度。那就让每个x规定在相同的数值范围不就好了嘛！</p> 
<p>怎么做到呢？方法有很多，统称为<strong>Feature Normalization（特征归一化）</strong>，下面举一个常用的例子：</p> 
<p><img src="https://images2.imgbox.com/23/f3/m9pgcMnf_o.png" alt="在这里插入图片描述"></p> 
<p>好！这是对输入进行特征归一化，但是要是有多层的学习呢，输入是不是也包括上一层的输出，输出的值是不是也会有范围的差距，那这是不是也可以归一化。</p> 
<p><img src="https://images2.imgbox.com/c0/bb/j1zKAoZX_o.png" alt="在这里插入图片描述"></p> 
<p>（这里激活之前之后都可以实验证明，结果差距不是很大，我们以激活前为例）</p> 
<p>求法还和上面一样，然后我们来分析一下变化情况，看下面的图，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          z 
         
        
          1 
         
        
       
      
        z^1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>变换，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         μ 
        
       
         , 
        
       
         σ 
        
       
      
        \mu,\sigma 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span></span></span></span></span>就变化，从而后面所有的值都会变化。换句话说，因为归一化，让输入的彼此又有了联系。是不是很妙啊！</p> 
<p><img src="https://images2.imgbox.com/2a/e0/iBB51Fw0_o.png" alt="在这里插入图片描述"></p> 
<p>接下来回收题目，Batch Normalization！</p> 
<p>假如数据非常庞大，前面讲过是不是可用Batch啊。那我们可以在每个Batch中做归 一化，这就是BN了。但是前提是Batch要够大，才能算<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         μ 
        
       
      
        \mu 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">μ</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         σ 
        
       
      
        \sigma 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">σ</span></span></span></span></span>，要是1那还算什么hhhh</p> 
<p><img src="https://images2.imgbox.com/76/f1/mvA4AQED_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="26__936"></a>2.6 深度学习</h4> 
<p>之前一直都是很简单的一层网络举例子，可能逻辑回归会涉及到一点多层网络。那接下来就理解一下深度学习，其实就是加了几个隐藏层而已，主要是理解为什么要增加层数。</p> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=23" rel="nofollow">2022-再探宝可梦、数码宝贝分类器 — 浅谈机器学习</a></li></ul> 
<p>模型的复杂性：</p> 
<blockquote> 
 <p>含有未知数的function里面的选择性很多，就叫复杂性很大</p> 
</blockquote> 
<p>想让训练的结果接近现实情况，那训练数据集的要求就是可以代表整个数据集，怎么做到呢</p> 
<ul><li>数据多一点</li><li>让参数的选择少一点</li></ul> 
<p>但是有了一个两难的境地，如何在数据量比较少的情况下，得到比较低的loss</p> 
<p><img src="https://images2.imgbox.com/ee/78/ZtEJ58Sh_o.png" alt="在这里插入图片描述"></p> 
<p>解决办法就是<strong>深度学习</strong></p> 
<p>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=33" rel="nofollow">鱼与熊掌可以兼得的机器学习</a></p> 
<p>这一节其实讲的就是deep要比shallow的function更有优势，所以深度学习同等条件下比浅层的网络效果更好。</p> 
<p>下面是我觉得是对深度学习理解很有帮助的截图，看不懂的建议去看一下视频里老师的讲解。</p> 
<p>我说一下我的理解，其实建立神经网络的过程就是想办法去拟合某一个复杂的函数。浅层的网络可以增加很多神经元去一部分一部分的构造，深层的网络可以以指数级的改变函数形状。</p> 
<p><img src="https://images2.imgbox.com/f9/d5/vajFRSDU_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b5/0f/rESFc6pp_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_CNN_974"></a>3 卷积神经网络（CNN）</h3> 
<p>重点啊！！！</p> 
<h4><a id="31_CNN_978"></a>3.1 卷积神经网络（CNN)</h4> 
<ul><li>传送门：<a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=31" rel="nofollow">卷积神经网络CNN</a></li></ul> 
<p><strong>卷积神经网咯（Convolutional Neural Network, CNN)</strong>，影像用的比较广泛。</p> 
<p>以影像分类为例</p> 
<p>将图片输入进网络，需要把它变成一维向量：</p> 
<p><img src="https://images2.imgbox.com/63/66/TTWGTEly_o.png" alt="在这里插入图片描述"></p> 
<p>好，这个一维向量就是网络的输入层，那看一下参数的数量级，真的非常大，参数越多当然可以增加模型的弹性和能力，但是也容易过拟合。</p> 
<p><img src="https://images2.imgbox.com/89/73/aa4X0SpG_o.png" alt="在这里插入图片描述"></p> 
<p>那这样参数太多肯定是不行的，所以我们要简化！</p> 
<ol><li> <p>简化1：接受域receptive field</p> <p>我们先想一想自己是怎么进行图片分类的。</p> <p>给你一张鸟的图片，你是怎么判断它是一只鸟呢？是不是你看到它有喙，有翅膀，有爪子等等，来判断。其实每一个神经元不需要整张图片的信息，只需要一小部分的输入就足以侦测某些特别关键的部分。</p> <p><img src="https://images2.imgbox.com/82/d3/JHfPtQ9O_o.png" alt="在这里插入图片描述"></p> <p>好，那怎么拿到这“一部分”呢，这就涉及到<strong>Receptive field（接受域，感受野）</strong></p> <p><img src="https://images2.imgbox.com/0d/d8/ML8iRBFD_o.png" alt="在这里插入图片描述"></p> <p>对于接受域的选择</p> 
  <ul><li>可以是不同地方，可以重合，可以相同</li><li>大小可以不同</li><li>可以只有某些个通道</li><li>可以不是正方形，而是其他形状</li></ul> <p><img src="https://images2.imgbox.com/3e/4b/n0JBrmy2_o.png" alt="在这里插入图片描述"></p> <p>常见的receptive field 会设置成3*3的<strong>kernel size</strong>，一个接受域都会有好多个神经元负责的，比如64、128。</p> <p><img src="https://images2.imgbox.com/e9/f7/98pdsWCL_o.png" alt="在这里插入图片描述"></p> 
  <blockquote> 
   <p>kernel size：核</p> 
   <p>stride: 步长</p> 
   <p>overlap：重叠部分</p> 
   <p>padding：要补全的地方</p> 
  </blockquote> <p>这是比较常见的接受域的设置，对整张图片都进行上面的接受域划分。</p> </li><li> <p>简化2：共享参数parameter sharing</p> <p>引入一下：你看这两张鸟，是不是都有喙这个部分，而且长得也差不多，但是是不同区域的，分别对应着各自的神经元。那既然是相同的图案，为何不将相对应的神经元的**参数共享（parameter sharing）**呢</p> <p><img src="https://images2.imgbox.com/02/37/IiLNH0Bt_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/37/5e/zFeYBg2Y_o.png" alt="在这里插入图片描述"></p> <p>之前不是说一个接受域有一组神经元嘛，那每组怎么参数共享呢，相同的**filter（滤波器）**之间是共享的</p> <p><img src="https://images2.imgbox.com/8e/ca/4Ka8wRqt_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<p>好！经过这几步的简化，我们成功的将全连接层转化为了<strong>卷积层（convolutional layer）</strong></p> 
<p><img src="https://images2.imgbox.com/e8/e8/ETc5Sdxs_o.png" alt="在这里插入图片描述"></p> 
<p>感觉有点模棱两可对吧，下一个例子保你说nb，因为我相信你之前有了解过卷积的计算。一个卷积层里面有一排的filter，我们需要对输出图片进行一系列的与卷积核的计算。</p> 
<p><img src="https://images2.imgbox.com/e1/b2/hHTE2B2i_o.png" alt="在这里插入图片描述"></p> 
<p>那我们假设channel是1，kernel也已经知道了（这个其实就是参数，需要训练的），比较方便。先进行filter1的计算，怎么计算的都会吧，就是对应值相乘然后加在一起（不会的呢，你可去查CNN，有很经典的动图，看一遍就会了）</p> 
<p><img src="https://images2.imgbox.com/8d/1d/SruieVsY_o.png" alt="在这里插入图片描述"></p> 
<p>这个图里面也表现了filter是如何侦察输入图像的信息的。接下来是filter2</p> 
<p><img src="https://images2.imgbox.com/f6/d7/TTkWr1zh_o.png" alt="在这里插入图片描述"></p> 
<p>以此类推，看你有多少filter，就有多少层啦。把这些层看成一个整体又名<strong>Feature map（特征图谱）</strong></p> 
<p>那假设还有一层卷积层，输入就是那个feature map，其实就可以把它看成一个图片，只不过他的通道是很多个的，假设是64个。那这一层的filter的channel数就得设为64了</p> 
<p><img src="https://images2.imgbox.com/41/34/H683fGKD_o.png" alt="在这里插入图片描述"></p> 
<p>有个问题，一般filter会设置成3*3的大小，会不会让network的视野很小，不会关注到大范围的图案？其实不会，因为你进行了好几层的学习，深度越深，关注覆盖的范围就越大</p> 
<p><img src="https://images2.imgbox.com/4e/bb/G1qBAnJD_o.png" alt="在这里插入图片描述"></p> 
<p>很好，之前我们提到过接受域和参数共享，接受域这点相信已经理解了，那参数共享再卷积层中是怎么体现的呢？其实就是filter扫过整张图片的操作，当然，需要设置步长什么的参数值了啦。这个操作其实就叫卷积（convolution）了（是不是连起来了！nb！！！）</p> 
<p>还没完，再补充一个比较常用的东西：<strong>pooling（池化）</strong></p> 
<p>池化只是一个图片操作而已，没有要学任何东西。</p> 
<p>pooling有很多种类，这里讲max pooling</p> 
<p><img src="https://images2.imgbox.com/ea/c8/sZLfkBkO_o.png" alt="在这里插入图片描述"></p> 
<p>使用pooling的最主要的理由就是为了减少运算量，所以基本上都是卷积层之后跟着池化操作，但是如果计算资源足够的话，也可以舍弃掉这一步骤。但是有缺点，池化操作回损失一些个细节，太精细的特征可能就无法提取到了。</p> 
<p>下面的图片是比较常见的CNN结构，经过几次卷积还有pooling操作之后，用flatten把矩阵的东西拉直，然后送进几个固定的全连接层然后再进行softmax操作什么的，最后输出你想要的输出值。</p> 
<p><img src="https://images2.imgbox.com/2a/00/yPIOtJej_o.png" alt="在这里插入图片描述"></p> 
<p>好！卷积大概就是这样！理解起来还蛮容易的叭。</p> 
<h4><a id="32_Spatial_Transformer_Layer_1104"></a>3.2 Spatial Transformer Layer</h4> 
<p>这节不太理解，大意是说怎么进行输入图片的感兴趣区域的稳定框选，用到了transformer。</p> 
<p>这节打算看看相关transformer的论文之后再写笔记叭。</p> 
<h3><a id="4_Selfattention_1110"></a>4 自注意力机制（Self-attention）</h3> 
<ul><li>传送门： 
  <ul><li><a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=38&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">自注意力机制（Self-attention）（上）</a></li><li><a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=39&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">自注意力机制（Self-attention）（下）</a></li></ul> </li></ul> 
<h4><a id="41__1116"></a>4.1 引入</h4> 
<p>之前我们举的例子都是输入一个东西，那如果输入一串东西（sequence）呢？比如一句话、一段语音、一个图（数据结构的图）等等，那相应的输出有哪些形式呢，比如多少个输入就有多少个输出、多入一出还有不知道输出什么让网络自己去判断。</p> 
<ul><li> <p>输出情况1：多少个输入就有多少个输出</p> <p><img src="https://images2.imgbox.com/ad/30/MU8OG7X8_o.png" alt="在这里插入图片描述"></p> </li><li> <p>输出情况2：多入一出</p> <p><img src="https://images2.imgbox.com/6a/2a/vGYzipe0_o.png" alt="在这里插入图片描述"></p> </li><li> <p>输出情况3：不知道输出什么，让网络自己去判断</p> <p><img src="https://images2.imgbox.com/5b/4a/iqfslsuy_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<p>那我们先看第一种情况。</p> 
<p>这里又来了一个新词：<strong>Sequence Labeling</strong>，其实就是把这个Sequence中的每一个向量都给它一个label。</p> 
<p>按照之前的思维，接下来就是把每个向量输入网络中，然后输出相应的值，对不对？但是你想一下，加入这个Sequence是个句子，这里面每个词对应一个向量，那向量和向量之间是不是存在这一定的关系，说人话就是上下文语义啊，那怎么做到结合上下文信息呢，看图说话。</p> 
<p><img src="https://images2.imgbox.com/20/57/lMlW2un6_o.png" alt="在这里插入图片描述"></p> 
<p>我可以让相邻的向量参与到网络中，或者更大一点，那就设置一个window，让window长度的向量作为输入。但是有个问题，这种方法还是有点局限，假如我想获得的是整个句子范围的信息呢，你是不是认为window设置成整个句子的长度不就好了？但是句子的长度是不固定，所以window的长度不能是定值了，而且window越长，网络所需要的参数就越多。</p> 
<p>有没有更好的方法呢？所以<strong>自适应Self-attention</strong>这个概念就被提出来了。</p> 
<h4><a id="42_selfattention_1148"></a>4.2 self-attention</h4> 
<p>先给出大致的框架，就是说输入几个vector就输出几个vector，输出的vector是考虑整个sequence之后的结果，也就是具有上下文语义的输出向量。而且可以不止一层，就像cnn一样可以叠加很多层。这里FC是指fully-connected network。怎么理解这个过程就是self-attention处理整个sequence的信息，FC专注于处理某一个位置的信息，然后交替使用。</p> 
<p><img src="https://images2.imgbox.com/57/3b/DQ2oYL4n_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/0b/84/SC2vwtu5_o.png" alt="在这里插入图片描述"></p> 
<p>之后会提到最近很火的transformer（<a href="#5-Transformer" rel="nofollow">5 Transformer</a>），它的主要结构就是self-attention。</p> 
<p>好！那里面具体是怎样实现的呢？</p> 
<p>输入是一个序列，输出的每一个向量都是输入向量相互学习过的</p> 
<p><img src="https://images2.imgbox.com/55/0a/1QxbuxvP_o.png" alt="在这里插入图片描述"></p> 
<p>所以下一步我们要解决输入向量之间的关联性（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         α 
        
       
      
        \alpha 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span></span></span></span></span>）怎么求，也就是其他哪个向量跟这个向量的关系最紧密或者是同一个level的。以下有几种求法，大部分采用的是左边的求法，之后举例子也是这个方法。</p> 
<p><img src="https://images2.imgbox.com/c1/fc/c9ICzUBp_o.png" alt="在这里插入图片描述"></p> 
<p>接下来以<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          1 
         
        
       
      
        a_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>为例，捋一下计算过程和代表的含义：</p> 
<p><img src="https://images2.imgbox.com/f7/ba/GxnUqmtB_o.png" alt="在这里插入图片描述"></p> 
<p>从下往上一行一行看哈，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
         , 
        
        
        
          k 
         
        
          1 
         
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
      
        q^1,k^1,... 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.00855em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></span>就是上面求<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         α 
        
       
      
        \alpha 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span></span></span></span></span>的需要的参数，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          1 
         
        
       
      
        a_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>跟<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          2 
         
        
       
         , 
        
        
        
          a 
         
        
          3 
         
        
       
         , 
        
        
        
          a 
         
        
          4 
         
        
       
      
        a_2,a_3,a_4 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>分别计算关联性，即<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          α 
         
         
         
           1 
          
         
           , 
          
         
           1 
          
         
        
       
         , 
        
        
        
          α 
         
         
         
           1 
          
         
           , 
          
         
           2 
          
         
        
       
         , 
        
        
        
          α 
         
         
         
           1 
          
         
           , 
          
         
           3 
          
         
        
       
         , 
        
        
        
          α 
         
         
         
           1 
          
         
           , 
          
         
           4 
          
         
        
       
      
        \alpha_{1,1},\alpha_{1,2},\alpha_{1,3},\alpha_{1,4} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.0037em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>然后soft-max一下得出带撇的那一行，也就是归一化了一下。这里的含义就是，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          2 
         
        
       
         , 
        
        
        
          a 
         
        
          3 
         
        
       
         , 
        
        
        
          a 
         
        
          4 
         
        
       
      
        a_2,a_3,a_4 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>中哪些向量与<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          1 
         
        
       
      
        a_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是最有关系的。当然关系越大attention得分<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         α 
        
       
      
        \alpha 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span></span></span></span></span>就越大啦</p> 
<p>接下来就是要求出关系背后重要的信息了。</p> 
<p><img src="https://images2.imgbox.com/34/42/ncMsCrkm_o.png" alt="在这里插入图片描述"></p> 
<p>从下往上。多了一个<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
      
        v 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span></span></span>对不对，代表就是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         a 
        
       
      
        a 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">a</span></span></span></span></span>向量中的信息了。然后让<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
      
        v 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span></span></span>乘上attention值<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          α 
         
        
          ′ 
         
        
       
      
        \alpha' 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>，然后四个加起来得到最终的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          b 
         
        
          1 
         
        
       
      
        b^1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>。这里如果一个向量的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          α 
         
        
          ′ 
         
        
       
      
        \alpha' 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>值越大，也就是与<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          1 
         
        
       
      
        a_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>关系最紧密，那么得到的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          b 
         
        
          1 
         
        
       
      
        b^1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>就越接近这个向量的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
      
        v 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span></span></span>，换句话说<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
      
        v 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span></span></span>在<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         b 
        
       
      
        b 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span></span></span></span></span>中占的比重就越大。</p> 
<p>好！那<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          b 
         
        
          2 
         
        
       
         , 
        
        
        
          b 
         
        
          3 
         
        
       
         , 
        
        
        
          b 
         
        
          4 
         
        
       
      
        b^2,b^3,b^4 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.00855em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span>是不是也就会求了呢，这就是self-attention的输出了哈。</p> 
<p>这里注意，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         b 
        
       
      
        b 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span></span></span></span></span>的求解不是按顺序产生的，是同时的。那如果要求有位置需求的话，那就需要<strong>Positional Encoding</strong>了。怎么操作呢？</p> 
<p>首先为每一个位置设定一个向量，叫positional vector，设为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          e 
         
        
          i 
         
        
       
      
        e^i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span>. 然后把<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          e 
         
        
          i 
         
        
       
      
        e^i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          i 
         
        
       
      
        a^i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span>相加就好了，也就是输入向量带了位置信息参与了attention的计算</p> 
<p><img src="https://images2.imgbox.com/db/7f/huWCdDju_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="43_Multihead_Selfattention_1195"></a>4.3 Multi-head Self-attention</h4> 
<p>最近看论文也有看到Muti-head Self-attention，来看视频学一下。</p> 
<p>首先head的数量是超参数，需要调参侠上线。</p> 
<p>那这个head是什么意思呢，就是不同的相关性，在不同方面每个向量信息的关联性也不一样，比如公主和皇后，两个都是女性，所以性别关联非常强，但是两者的地位是不一样的，那这方面的关系就不那么强。</p> 
<p>具体实现的话，以head = 2为例，看图</p> 
<p><img src="https://images2.imgbox.com/72/55/FLZBg83v_o.png" alt="在这里插入图片描述"></p> 
<p>1和2是分开算的，1算1，2算2，最后得到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          b 
         
         
         
           i 
          
         
           , 
          
         
           1 
          
         
        
       
         , 
        
        
        
          b 
         
         
         
           i 
          
         
           , 
          
         
           2 
          
         
        
       
      
        b^{i,1},b^{i,2} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0191em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>然后再transform以下得到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          b 
         
        
          i 
         
        
       
      
        b^i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span>送到下一层去</p> 
<p><img src="https://images2.imgbox.com/7c/5b/fHAbroBw_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5_Transformer_1215"></a>5 Transformer</h3> 
<p>我来提醒你回看[2.5 批次标准化（Batch Normalization）]</p> 
<p>接下来就是最近很火的变形金刚<strong>Transformer</strong>了。</p> 
<ul><li>传送门： 
  <ul><li><a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=49&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">Transformer（上）</a></li><li><a href="https://www.bilibili.com/video/BV1Wv411h7kN?p=50&amp;vd_source=569d9b70ebd164b8517c8074fe55d306" rel="nofollow">Transformer（下）</a></li></ul> </li></ul> 
<p>直接进入正题：</p> 
<p><img src="https://images2.imgbox.com/0b/71/ff59gU6a_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>这里补充一下<a href="https://blog.csdn.net/u010626937/article/details/104819570?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167029739616800184186200%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167029739616800184186200&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~top_positive~default-1-104819570-null-null.nonecase&amp;utm_term=encoder-decoder&amp;spm=1018.2226.3001.4450">encoder-decoder</a>的相关概念，老师没有讲这个结构的理念，所以在此百度学习</p> 
</blockquote> 
<ul><li> <p><strong>Encoder部分</strong></p> <p>实际就是输入一排向量，输出一排向量。右边是完整的流程图</p> <p><img src="https://images2.imgbox.com/c7/bf/BNZOwgll_o.png" alt="在这里插入图片描述"></p> <p>看不懂？没关系。换个图看。encoder里面分成很多得block，每个block都是输入一排向量输出一排向量，内部结构有好几层，就是右面大括号里的东东，self-attention一层，FC一层。</p> <p><img src="https://images2.imgbox.com/1b/53/b7OsV5JV_o.png" alt="在这里插入图片描述"></p> <p>但是其实transformer的block内部要比这个复杂一点</p> 
  <ol><li>residual：在每一层的输出到输入的时候做一个residual的结构，说人话就是这一层的输出加上这一层的输入，然后norm计算后再作为下一层输入去计算。</li><li>norm：residual之后要Layer Norm，然后再传到下一层。这里的归一化是指向量内部的归一化，跟之前是有区别的，注意一下。</li></ol> <p><img src="https://images2.imgbox.com/80/d5/oh1v1cu4_o.png" alt="在这里插入图片描述"></p> <p>好，简单的图看完，我们回到论文中给出的原版流程图，是不是大致可以看懂了，我们再唠叨一遍。</p> 
  <ul><li>输入一排向量，这里多了一个Positional Encoding，这个之前讲过，是增加了位置信息</li><li>经过Multi-Head Attention，获取全局信息，经过residual和Layer Norm之后，输出一排向量</li><li>在经过FC的feed forward network，然后再经过residual和Layer Norm之后，输出一排向量</li><li>上面两个步骤重复N遍，最后输出一排向量</li></ul> <p><img src="https://images2.imgbox.com/8f/b2/aS0FsGw2_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>Decoder部分</strong></p> <p>我们先大体了解一下decoder是怎么输入输出的，这对后续内部理解比较重要。</p> <p><img src="https://images2.imgbox.com/14/30/Z60B3HpJ_o.png" alt="在这里插入图片描述"></p> <p><sub>中间Encoder怎么到Decoder后面再说，我们先学习Decoder的结构</sub></p> <p>图的右边Decoder模块，从下往上，从左往右看。一开始有个<strong>BEGIN</strong>模块，这个向量代表一个特殊的符号（没听懂是什么意思，后面理解之后回来补充）。输入这个向量之后，decoder输出一个向量，假如是这样的</p> <p><img src="https://images2.imgbox.com/80/ce/vvx0C0zv_o.png" alt="在这里插入图片描述"></p> <p>然后，把黄色向量作为输入，得到蓝色向量，再把蓝色向量作为输入在输出绿色向量酱紫。所以注意输出会当成下次的输入，所以输入一个一个进行输入的，记住！</p> <p>好！接下来我们看一下decoder内部是什么样子，放图！！！</p> <p><img src="https://images2.imgbox.com/b3/b5/D1zGEal6_o.png" alt="在这里插入图片描述"></p> <p>hin复杂？没关系！我们对比一下，其实也还好对吧，除了decoder中间加了一层，其他是不是和encoder是差不多的</p> <p><img src="https://images2.imgbox.com/4a/e8/SdZ8TFLQ_o.png" alt="在这里插入图片描述"></p> <p>这里注意一下Multi-Head Attention部分有个<strong>Masked</strong>，这个是什么意思捏。原本情况self-attention的每一个输出向量都是考虑所有的输入的出来的嘛，但是masked是让每一个输出不能考虑它对应输入后面的输入值，只能考虑对应输入以及它之前的输入。怎么理解？就是只能看到已知序列的内容</p> <p><img src="https://images2.imgbox.com/b3/dc/sHTk6lnH_o.png" alt="在这里插入图片描述"></p> <p>为什么要这么做，理由是什么捏？decoder的输入是依次产生的，这和encoder的输入是不同，它是同时输入。所以decoder是不会知道当前输入的后续输入情况的，这一点我们开始的时候强调过（忘记的，回去ε=( o｀ω′)ノ）</p> <p>好！decoder部分特殊的部分就完事了，中间的那一层其实就和encoder与decoder之间的数据传输相关，我们待会就讲（歇会儿）</p> </li><li> <p><strong>Cross attention</strong>：Encoder与Decoder连接部分</p> <p>其实transformer原图是这样的：</p> <p><img src="https://images2.imgbox.com/d7/52/TIJy7bNO_o.png" alt="在这里插入图片描述"></p> <p>能看清哈，框起来的部分有三个输入，左边两个来自encoder，最右边来自decoder的attention，这个步骤就叫做<strong>Cross attention</strong>。具体是怎么实现的呢?</p> <p><img src="https://images2.imgbox.com/a7/3e/mjO2ZedN_o.png" alt="在这里插入图片描述"></p> <p>decoder这边产生q，然后与encoder的输出做self-attention计算这样。</p> <p>然后以此类推，就会了吧：</p> <p><img src="https://images2.imgbox.com/75/bc/Bdtd1kTd_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<p>在这，我们补充一个问题。你看你要学习内容然后输出一个序列对不对，那这个序列的长度是多长呢，怎么确定呢？注意并不是encoder输入多少decoder就要输出多少哈，不要被之前的图片误导。</p> 
<p>实际上，这个序列是可以无限延长下去，但是这不符合我们想要的结果，假如这个翻译的任务，那翻译出来的句子肯定会结束的。所以还要引入一个<strong>结束符END</strong>，还记得BEGIN嘛，和这个差不多。</p> 
<p>输出的长度不是固定的，长度如何确定，或者说END到底什么时候出现，这里放一张图，自己领悟吧ㄟ( ▔, ▔ )ㄏ</p> 
<p><img src="https://images2.imgbox.com/82/bd/4cM5YonR_o.png" alt="在这里插入图片描述"></p> 
<p>很好！是不是通畅了很多ヾ(≧▽≦*)o</p> 
<p>那我们简单看一下训练要怎么训练呢</p> 
<p><img src="https://images2.imgbox.com/cf/1e/vGIDLDWr_o.png" alt="在这里插入图片描述"></p> 
<p>交叉熵作为loss，算distribution和ground truth之间的loss就好了，让他们越接近越好，这里又来了个新名词叫<strong>Teacher Forcing</strong>，也就是把正确答案当作decoder的输入</p> 
<p><img src="https://images2.imgbox.com/53/44/Ymw0G0g2_o.png" alt="在这里插入图片描述"></p> 
<p>好！transformer到这里就差不多啦！</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2ea528d6f0572023c3609ca0d8a7e9f7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">celery介绍与使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/87f263610103311672727a1dcd1741ca/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Shell变量替换</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>