<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一步一步教你怎么编译GNU ARM GCC 交叉编译器arm-none-eabi-gcc - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一步一步教你怎么编译GNU ARM GCC 交叉编译器arm-none-eabi-gcc" />
<meta property="og:description" content="一步一步教你怎么编译GNU ARM GCC 交叉编译器arm-none-eabi-gcc
Step by step teaching you how to build a GNU ARM GCC cross compiler
首先，对于编译器这东西，我一向认为很高深，当然现在还是这么认为，呵，所以呢,一般都是用别人编译好的现成的编译好版本。可是最近因为要在windows下面编译u-boot的原因，因为找不到合适的arm编译器，故只能自己编译一个了。下面就是整个的编译过程，一步步来吧。
在开始之前，还要说明一点，这里所编译的gnu arm gcc 编译器，运行时是依赖于cygwin的，而且这也是我所需要的，至于为什么，请看我的另一篇：如何实现在windows下面编译u-boot，里面已经说了详细的原因。如果你不想依赖于cygwin，那请直接用yagarto，或其他的windows版本的gnu arm gcc吧。
1. 确定要编译arm编译器的类型和版本，下载合适的编译器源文件和库源文件
（1）类型：arm-none-eabi-gcc
（2）版本：Binutils-2.22，Newlib-1.20.0，GCC-4.7.1，GDB-7.4.1，insight-6.8.1
嘿嘿，这个版本的问题，我参考了yagarto 还有一些其他的版本，yagarto 用Eclipse &#43; CDT作为代码编辑和调试的前端，所有没有编insight-6.8.1，我这时是编了，如果你不需要用insight来作为调试的前端，你也不用编，只编前面四个就可以了。
（3）下载所要的源文件：
Binutils-2.22：
官网：http://www.gnu.org/software/binutils/
下载地址：http://ftp.gnu.org/gnu/binutils/binutils-2.22.tar.bz2
Newlib-1.20.0：
官网：http://sourceware.org/newlib/
下载地址：http://nchc.dl.sourceforge.net/project/devkitpro/sources/newlib/newlib-1.20.0.tar.gz
也可以通过CVS来获得：
cvs -z 9 -d :pserver:anoncvs@sources.redhat.com:/cvs/src login
{enter &#34;anoncvs&#34; as the password}
cvs -z 9 -d :pserver:anoncvs@sources.redhat.com:/cvs/src co newlib
GCC-4.7.1：
官网：http://gcc.gnu.org/
下载地址：http://www.netgull.com/gcc/releases/gcc-4.7.1/gcc-4.7.1.tar.bz2
GDB-7.4.1：
官网：http://www.gnu.org/software/gdb/
下载地址：http://ftp.gnu.org/gnu/gdb/gdb-7.4.1.tar.bz2
insight-6.8.1：
官网：http://sourceware.org/insight/
下载地址：ftp://sourceware.org/pub/insight/releases/insight-6.8-1.tar.bz2" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/c0406beb14eb56376bed59363dba0d5c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-01-23T11:18:05+08:00" />
<meta property="article:modified_time" content="2014-01-23T11:18:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一步一步教你怎么编译GNU ARM GCC 交叉编译器arm-none-eabi-gcc</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p class="p1"><span class="s1"><strong>一步一步教你怎么编译</strong></span><strong>GNU ARM GCC</strong><span class="s2"> </span><span class="s1"><strong>交叉编译器</strong></span><strong>arm-none-eabi-gcc</strong></p> 
<p class="p2"><strong>Step by step teaching you how to build a GNU ARM GCC cross compiler</strong></p> 
<p class="p3">首先，对于编译器这东西，我一向认为很高深，当然现在还是这么认为，呵，所以呢<span class="s2">,</span>一般都是用别人编译好的现成的编译好版本。可是最近因为要在<span class="s2">windows</span>下面编译<span class="s2">u-boot</span>的原因，因为找不到合适的<span class="s2">arm</span>编译器，故只能自己编译一个了。下面就是整个的编译过程，一步步来吧。</p> 
<p class="p3">在开始之前，还要说明一点，这里所编译的<span class="s2">gnu arm gcc </span>编译器，运行时是依赖于<span class="s2">cygwin</span>的，而且这也是我所需要的，至于为什么，请看我的另一篇：<strong>如何实现在</strong><span class="s2"><strong>windows</strong></span><strong>下面编译</strong><span class="s2"><strong>u-boot</strong></span><strong>，</strong>里面已经说了详细的原因。如果你不想依赖于<span class="s2">cygwin</span>，那请直接用<span class="s2">yagarto</span>，或其他的<span class="s2">windows</span>版本的<span class="s2">gnu arm gcc</span>吧。</p> 
<p class="p4"><span class="s2"><strong>1.</strong></span><span class="s3">      </span><span class="s2"> </span><strong>确定要编译</strong><span class="s2"><strong>arm</strong></span><strong>编译器的类型和版本，下载合适的编译器源文件和库源文件</strong></p> 
<p class="p5"><span class="s4">（</span>1<span class="s4">）类型：</span>arm-none-eabi-gcc</p> 
<p class="p5"><span class="s4">（</span>2<span class="s4">）版本：</span>Binutils-2.22<span class="s4">，</span>Newlib-1.20.0<span class="s4">，</span>GCC-4.7.1<span class="s4">，</span>GDB-7.4.1<span class="s4">，</span>insight-6.8.1</p> 
<p class="p6">嘿嘿，这个版本的问题，我参考了<span class="s2">yagarto </span>还有一些其他的版本，<span class="s2">yagarto </span>用<span class="s2">Eclipse + CDT</span>作为代码编辑和调试的前端，所有没有编<span class="s2">insight-6.8.1</span>，我这时是编了，如果你不需要用<span class="s2">insight</span>来作为调试的前端，你也不用编，只编前面四个就可以了。</p> 
<p class="p6">（<span class="s2">3</span>）下载所要的源文件：</p> 
<p class="p7">Binutils-2.22<span class="s4">：</span></p> 
<p class="p8"><span class="s5">官网：<a target="_blank" href="http://www.gnu.org/software/binutils/" rel="nofollow noopener noreferrer"><span class="s2">http://www.gnu.org/software/binutils/</span></a></span></p> 
<p class="p9"><span class="s5">下载地址：<a target="_blank" href="http://ftp.gnu.org/gnu/binutils/binutils-2.22.tar.bz2" rel="nofollow noopener noreferrer"><span class="s2">http://ftp.gnu.org/gnu/binutils/binutils-2.22.tar.bz2</span></a></span></p> 
<p class="p10">Newlib-1.20.0<span class="s4">：</span></p> 
<p class="p11"><span class="s5">官网：<a target="_blank" href="http://sourceware.org/newlib/" rel="nofollow noopener noreferrer"><span class="s2">http://sourceware.org/newlib/</span></a></span></p> 
<p class="p12"><span class="s5">下载地址：<a target="_blank" href="http://nchc.dl.sourceforge.net/project/devkitpro/sources/newlib/newlib-1.20.0.tar.gz" rel="nofollow noopener noreferrer"><span class="s2">http://nchc.dl.sourceforge.net/project/devkitpro/sources/newlib/newlib-1.20.0.tar.gz</span></a></span></p> 
<p class="p13">也可以通过<span class="s2">CVS</span>来获得：</p> 
<p class="p14">  cvs -z 9 -d :pserver:anoncvs@sources.redhat.com:/cvs/src login</p> 
<p class="p14">  {enter "anoncvs" as the password}</p> 
<p class="p14">  cvs -z 9 -d :pserver:anoncvs@sources.redhat.com:/cvs/src co newlib</p> 
<p class="p15">GCC-4.7.1<span class="s4">：</span></p> 
<p class="p9"><span class="s5">官网：<a target="_blank" href="http://gcc.gnu.org/" rel="nofollow noopener noreferrer"><span class="s2">http://gcc.gnu.org/</span></a></span></p> 
<p class="p16"><span class="s6">  </span><span class="s5">下载地址：<a target="_blank" href="http://www.netgull.com/gcc/releases/gcc-4.7.1/gcc-4.7.1.tar.bz2" rel="nofollow noopener noreferrer"><span class="s2">http://www.netgull.com/gcc/releases/gcc-4.7.1/gcc-4.7.1.tar.bz2</span></a></span></p> 
<p class="p15">GDB-7.4.1<span class="s4">：</span></p> 
<p class="p9"><span class="s5">官网：<a target="_blank" href="http://www.gnu.org/software/gdb/" rel="nofollow noopener noreferrer"><span class="s2">http://www.gnu.org/software/gdb/</span></a></span></p> 
<p class="p16"><span class="s6">  </span><span class="s5">下载地址：<a target="_blank" href="http://ftp.gnu.org/gnu/gdb/gdb-7.4.1.tar.bz2" rel="nofollow noopener noreferrer"><span class="s2">http://ftp.gnu.org/gnu/gdb/gdb-7.4.1.tar.bz2</span></a></span></p> 
<p class="p15">insight-6.8.1<span class="s4">：</span></p> 
<p class="p9"><span class="s5">官网：<a target="_blank" href="http://sourceware.org/insight/" rel="nofollow noopener noreferrer"><span class="s2">http://sourceware.org/insight/</span></a></span></p> 
<p class="p9"><span class="s5">下载地址：<a target="_blank" href="ftp://sourceware.org/pub/insight/releases/insight-6.8-1.tar.bz2" rel="nofollow noopener noreferrer"><span class="s2">ftp://sourceware.org/pub/insight/releases/insight-6.8-1.tar.bz2</span></a></span></p> 
<p class="p13">也可以通过<span class="s2">CVS</span>来获得：</p> 
<p class="p17">cvs -z9 -d :pserver:anoncvs@sourceware.org:/cvs/src login</p> 
<p class="p17">[enter "anoncvs" as the password]</p> 
<p class="p17">cvs -z9 -d :pserver:anoncvs@sourceware.org:/cvs/src co -r gdb_6_8-branch insight</p> 
<p class="p3">官网不变，下载地址这里只是给出参考，感觉随时会变，那时候就<span class="s2">google</span>或百度。</p> 
<p class="p18"> </p> 
<p class="p19"><span class="s2"><strong>2.</strong></span>      <span class="s2"> </span><span class="s4"><strong>编译前的准备</strong></span></p> 
<p class="p20">编译之前还要做几件事：</p> 
<p class="p21">（1）<span class="s3">      </span> <span class="s4">准备好</span>cygwin<span class="s4">，并且装好所需要的</span>Mingw gcc <span class="s4">等软件，主要是</span>devel<span class="s4">选项下的。</span></p> 
<p class="p22"><span class="s2">Cygwin</span>下载请到<a target="_blank" href="http://www.cygwin.com/" rel="nofollow noopener noreferrer"><span class="s7">http://www.cygwin.com/</span></a><span class="s2">  </span>这里我用的是<span class="s2">cygwin-</span><span class="s8">1.7.15-1</span>的版本，目前最新版<span class="s2">cygwin-</span><span class="s8">1.7.16-1</span><span class="s2"> </span>，差别不大。装好后，编译的时候如果提示要装什么，可以再装，如果你的空间够，把<span class="s8">devel</span>下全装了也行。</p> 
<p class="p23"><span class="s2">（2）</span><span class="s3">      </span><span class="s2"> </span>建好编译时所要的目录：</p> 
<p class="p24"><span class="s4">首先，建一个用来存入编译好的编译器的目录，建义在</span>cygwin<span class="s4">安装目录下建一下</span>opt<span class="s4">目录，里面建一个</span>arm-gnu-tools<span class="s4">目录，比如我的</span>cygwin<span class="s4">是装在：</span>d:\cygwin<span class="s4">，那么我就建</span>d:\cygwin\opt\arm-gnu-tools<span class="s4">，这样你就可以在</span>cygwin<span class="s4">下通过</span> /opt/arm-gnu-tools<span class="s4">来访问了</span></p> 
<p class="p24"><span class="s4">其次，再建一个目录</span>build-arm-tools<span class="s4">，然后在建立</span>build-binutils, build-gcc, build-gdb, build-newlib, <span class="s4">并且拷入源文件，解压缩。下面就是我建好目录结构：</span></p> 
<p class="p25"><strong>E:\build-arm-tools</strong></p> 
<p class="p26"><span class="s4">│</span>  binutils-2.22.tar.bz2</p> 
<p class="p27"><span class="s4">│</span>  build_arm_tools.bat</p> 
<p class="p26"><span class="s4">│</span>  gcc-4.7.1.tar.bz2</p> 
<p class="p26"><span class="s4">│</span>  gdb-7.4.1.tar.bz2</p> 
<p class="p26"><span class="s4">│</span>  insight-6.8-1.tar.bz2</p> 
<p class="p26"><span class="s4">│</span>  newlib-1.20.0.tar.gz</p> 
<p class="p24"><span class="s4">│</span> </p> 
<p class="p28"><span class="s4">├─</span>build-binutils</p> 
<p class="p28"><span class="s4">├─</span>build-gcc</p> 
<p class="p28"><span class="s4">├─</span>build-gdb</p> 
<p class="p28"><span class="s4">├─</span>build-insight</p> 
<p class="p28"><span class="s4">├─</span>build-newlib</p> 
<p class="p29"><span class="s4">├─</span>binutils-2.22</p> 
<p class="p29"><span class="s4">├─</span>gcc-4.7.1</p> 
<p class="p29"><span class="s4">├─</span>gdb-7.4.1</p> 
<p class="p29"><span class="s4">├─</span>insight-6.8-1</p> 
<p class="p29"><span class="s4">└─</span>newlib-1.20.0</p> 
<p class="p30"><br> </p> 
<p class="p31"><br> </p> 
<p class="p32">其中<span class="s9">build_arm_tools.bat</span>是我们要进行编译要用到的脚本，主要作用是设置一些环境变量，启动<span class="s2">cygwin</span>环境，具体内容如下：</p> 
<p class="p33">@echo off</p> 
<p class="p33"> set TARGET=arm-none-eabi</p> 
<p class="p33">set PREFIX=/opt/arm-gnu-tools</p> 
<p class="p33">set BIN_PATH=/opt/arm-gnu-tools/bin</p> 
<p class="p33"> set LANG=C.UTF-8</p> 
<p class="p33">set CYGWIN_DIR=d:\cygwin</p> 
<p class="p33">set PATH=%CYGWIN_DIR%\bin;%PATH%</p> 
<p class="p33">set HOME=e:\build-arm-tools\</p> 
<p class="p33"> bash --login –i</p> 
<p class="p32"><span class="s2">  </span>双击启动后显示：</p> 
<p class="p34"><br> </p> 
<p class="p31"><br> </p> 
<p class="p35"><span class="s2">（3）</span><span class="s3">  </span><span class="s2"> </span>确定编译参数</p> 
<p class="p36"><span class="s4">这部分内容的话，我是参考了</span>yagarto, GNUARM, WinARM, devkitARM, SysGcc_ARM<span class="s4">等，</span>CodeSourcery<span class="s4">和</span>Linaro<span class="s4">是基于</span>linux<span class="s4">库的，所以无可比性，最后觉得</span>yagarto<span class="s4">的参数最好的，然后又在它的基础上加了几个，具体的如下：</span></p> 
<p class="p18"> <strong>--target=arm-none-eabi</strong></p> 
<p class="p18"><strong>--prefix=/opt/arm-gnu-tools</strong></p> 
<p class="p18"><strong>--disable-nls</strong></p> 
<p class="p18"><strong>--disable-threads </strong></p> 
<p class="p18"><strong>--enable-languages=c,c++</strong></p> 
<p class="p18"><strong>--enable-interwork</strong></p> 
<p class="p18"><strong>--with-gcc</strong></p> 
<p class="p18"><strong>--with-gnu-ld</strong></p> 
<p class="p18"><strong>--with-gnu-as</strong></p> 
<p class="p18"><strong>--with-dwarf2</strong></p> 
<p class="p18"><strong>--with-float=soft</strong></p> 
<p class="p18"><strong>--disable-shared</strong></p> 
<p class="p18"><strong>--with-newlib</strong></p> 
<p class="p18"><strong>--enable-multilib</strong></p> 
<p class="p18"><strong>--disable-libssp</strong></p> 
<p class="p18"><strong>--disable-libstdcxx-pch</strong></p> 
<p class="p18"><strong>--disable-libmudflap</strong></p> 
<p class="p18"><strong>--disable-libgomp –v</strong></p> 
<p class="p18"><strong>--with-headers=../newlib-1.20.0/newlib/libc/include</strong></p> 
<p class="p18"><strong>--with-pkgversion='semilog_ARM release 01'</strong></p> 
<p class="p37"><strong>--enable-target-optspace</strong></p> 
<p class="p37"><strong>--with-cpu=cpu</strong></p> 
<p class="p37"><strong>--with-arch=armv7</strong></p> 
<p class="p38"><strong>下面就分别对（我知道的）参数说明一下吧：</strong></p> 
<p class="p18"><strong>--target=arm-none-eabi</strong></p> 
<p class="p18">  <span class="s4">所要生成的目标编译器，这里是</span> arm-none-eabi<span class="s4">，它的命名差不多是这样的</span> arch-vendor[-os]-eabi-gcc , <span class="s4">对于这里没有</span>os<span class="s4">，因为没有加入</span>linux<span class="s4">下的</span>glibc<span class="s4">，而是用的</span>newlib<span class="s4">，用于编</span>os<span class="s4">或者</span>bootloader<span class="s4">。</span></p> 
<p class="p18"><strong>--prefix=/opt/arm-gnu-tools</strong></p> 
<p class="p3">编译好生成的编译器存放的地方，比如，编好了，就会在<span class="s2"><strong>arm-gnu-tools</strong></span>目录下生成所要编译器。</p> 
<p class="p18"><strong>--disable-nls</strong></p> 
<p class="p14"><span class="s5">这个参数真他妈坑爹，网上找到的说法是“这个参数禁止了国际化”，我怎么看也不明白，结果在</span><span class="s6">gcc reference book </span><span class="s5">上找到原文：</span>Specifies that Native Language Support (NLS) be included as part of the compiler to allow for the display of warning and error messages in languages other than American English<span class="s4">，</span><span class="s5">这才明白，意思大概是：编译时只使用英语来作为提示警告和错误消息的语言，而不使用本地语言。比如我们编译时，提示也不会成中文。我真想抽那个第一个把它说成“禁止国际化的人”，这不是误人子弟麻</span><span class="s6">~~~</span></p> 
<p class="p18"><strong>--disable-threads</strong></p> 
<p class="p18"> <span class="s4">这个参数等价于</span>--enable-threads=single<span class="s4">，而可以看到</span>linux<span class="s4">下的</span>gcc<span class="s4">的参数中写差</span>—enable-threads=posix<span class="s4">，具体的我也不知道什么意思，多半是支持多线程。</span></p> 
<p class="p18"><strong>--enable-languages=c,c++</strong></p> 
<p class="p18">Gcc<span class="s4">的编译的语言只支持</span>c<span class="s4">和</span>c++<span class="s4">，我看到</span>codeSourcery<span class="s4">上面还支持</span>Fortran<span class="s4">，额</span>~~~<span class="s4">我长见识了。</span></p> 
<p class="p18"><strong>--enable-interwork</strong></p> 
<p class="p3">这个是支持<span class="s2">thumb</span>和<span class="s2">arm</span>代码的相互调用。</p> 
<p class="p18"><strong>--with-gnu-ld</strong></p> 
<p class="p18"><strong>--with-gnu-as</strong></p> 
<p class="p18"><strong>--with-dwarf2</strong></p> 
<p class="p3">上面四个参数是用来表明显示表明，用<span class="s2">gcc</span>编<span class="s2">c</span>语言，<span class="s2">gnu-as</span>编汇编，<span class="s2">gnu-ld</span>链接，调试文件格式是<span class="s2">dwarf2</span>的。</p> 
<p class="p39"><strong>--with-float=soft</strong></p> 
<p class="p3">这个是浮点运算用软件来实现，<span class="s2">ARM</span>中有的型号其实有还硬件浮点运逄单元的，因为很多库为了兼容，所以都使用软件实现，这样平台依赖没有那么强，便于移植。</p> 
<p class="p18"><strong>--disable-shared</strong></p> 
<p class="p40"><span class="s2">  </span><span class="s4">禁止共享库。</span><span class="s10">linux</span>下的库有两种：静态库和共享库（动态库）。二者的不同点在于代码被载入的时刻不同。静态库的代码在编译过程中已经被载入可执行程序，因此体积较大。共享库的代码是在可执行程序运行时才载入内存的，在编译过程中仅简单的引用，因此代码体积较小。</p> 
<p class="p18"><strong>--with-newlib</strong></p> 
<p class="p40"><span class="s4">使用</span><span class="s2">newlib</span><span class="s4">库，</span><span class="s11">Newlib</span>是一个面向嵌入式系统的<span class="s11">C</span>运行库。最初是由<span class="s11">Cygnus Solutions</span>收集组装的一个源代码集合，取名为<span class="s11">newlib</span>，现在由<span class="s11">Red Hat</span>维护。我们用它来作为我们的库，而不是<span class="s11">linux</span>的<span class="s11">glibc</span></p> 
<p class="p18"><strong>--enable-multilib</strong></p> 
<p class="p3">大部分系统上都是默认选项，这表明了针对目标的多种库都会被编译，这里是针对<span class="s2">ARM</span>。</p> 
<p class="p18"><strong>--disable-libssp</strong></p> 
<p class="p18"><strong>--disable-libstdcxx-pch</strong></p> 
<p class="p18"><strong>--disable-libmudflap</strong></p> 
<p class="p18"><strong>--disable-libgomp</strong></p> 
<p class="p3">上面的四个参数，就是用来<span class="s2">--enable-multilib</span>中的多种库中去掉这些列出来的，具体提这些库是做什么的，还没有去细究。</p> 
<p class="p18"><strong>--with-headers=../newlib-1.20.0/newlib/libc/include</strong></p> 
<p class="p3">嘿嘿，这人参数一看就明白了，我就不用多说了。</p> 
<p class="p18"><strong>--with-pkgversion='semilog_ARM release 01'</strong></p> 
<p class="p3">这个也是的，我把它改成我自己的名字了。哈。</p> 
<p class="p37"><strong>--enable-target-optspace</strong></p> 
<p class="p41">Specifies that the libraries should be optimized for size instead of speed<span class="s4">，这里我们不用，默认是用</span>O2<span class="s4">优化。</span></p> 
<p class="p37"><strong>--with-cpu=cpu</strong></p> 
<p class="p37"><strong>--with-arch=armv7</strong></p> 
<p class="p3">这个参数要说一下，如果你选了<span class="s2">—with-cpu=arm7tdmi</span>，那么会特别针对这个<span class="s2">arm7tdmi</span>来优化编译器。下面，你懂的，你也可以优化你想要的。这个参数和<span class="s2"> --with-arch=armv7</span>这样是差不多意思。</p> 
<p class="p3">好了准备工作基本上完了，下面来编译了。</p> 
<p class="p4"><strong>1.</strong><span class="s3">    </span><strong>编译GNU ARM GCC 编译器</strong></p> 
<p class="p42">双击建好的build_arm_tools.bat，</p> 
<p class="p42"><strong>（1）首先编译 binutils-2.22</strong></p> 
<p class="p42">在提示$符下分别输入：</p> 
<p class="p43"><span class="s12"><strong>$</strong></span><span class="s6"> </span>cd build-binutils</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>../binutils-2.22/configure --target=$TARGET --prefix=$PREFIX --enable-interwork --enable-multilib</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make all</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make install</p> 
<p class="p3">这一 步做完之后还用一件事要做：</p> 
<p class="p3">就是把<span class="s12">/opt/arm-gnu-tools/bin，</span>因为编gcc的时候，要用到里面的第一步已生成的程序，</p> 
<p class="p3">可以建个快捷方式：</p> 
<p class="p45"><span class="s12"><strong>$</strong></span><span class="s6"> </span>ln -s /opt/arm-gnu-tools/bin/* /usr/local/bin</p> 
<p class="p45">注意：以后每一步编译完都执行一次。</p> 
<p class="p45">主要是我是cygwin下面加入到$PATH下没有效果，所以就用上面的方法了。</p> 
<p class="p3"><strong>（2）第一遍编译gcc-4.7.1</strong></p> 
<p class="p3">这一次只是加入newlib的头文件，没有任何库文件，因为还没有生成</p> 
<p class="p43"><span class="s12"><strong>$</strong></span><span class="s6"> </span>cd ../build-gcc</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>../gcc-4.7.1/configure --target=$TARGET --prefix=$PREFIX --enable-interwork --enable-multilib --disable-nls --disable-threads --with-gcc --with-gnu-as --with-gnu-ld --with-dwarf2 --disable-shared --disable-libssp --disable-libstdcxx-pch --disable-libmudflap --disable-libgomp --with-newlib --with-headers=../newlib-1.20.0/newlib/libc/include/ --enable-languages="c,c++" --with-pkgversion='semilog ARM release 01'</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make all-gcc</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make install-gcc</p> 
<p class="p45"><span class="s12"><strong>$</strong></span><span class="s6"> </span>ln -s /opt/arm-gnu-tools/bin/* /usr/local/bin</p> 
<p class="p3"><strong>（3）编译newlib-1.20.0</strong></p> 
<p class="p3">现在就用新生成的gcc来编译newlib库</p> 
<p class="p43"><span class="s12"><strong>$</strong></span><span class="s6"> </span>cd ../build-newlib</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>../newlib-1.20.0/configure --target=$TARGET --prefix=$PREFIX --enable-interwork --enable-multilib</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make all</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make install</p> 
<p class="p3"><strong> （4）第二次编gcc-4.7.1</strong></p> 
<p class="p46">这次编译的时候是用新生成的newlib库来完成gcc带库的编译。</p> 
<p class="p47"><span class="s12"><strong>$</strong></span><span class="s6"> </span>cd ../build-gcc</p> 
<p class="p47"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make all</p> 
<p class="p47"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make install</p> 
<p class="p3"> <strong>（5）编译gdb-4.7.1</strong></p> 
<p class="p43"><span class="s12"><strong>$</strong></span><span class="s6"> </span>cd ../build-gdb</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>../ gdb-4.7.1/configure --target=$TARGET --prefix=$PREFIX --enable-interwork --enable-multilib </p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make all</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make install</p> 
<p class="p45"><span class="s12"><strong>$</strong></span><span class="s6"> </span>ln -s /opt/arm-gnu-tools/bin/* /usr/local/bin</p> 
<p class="p3"><strong>（6）编译 insight-6.8-1</strong></p> 
<p class="p43"><span class="s12"><strong>$</strong></span><span class="s6"> </span>cd ../build-insight</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>../<span class="s6"> </span>insight-6.8-1/configure --target=$TARGET --prefix=$PREFIX --enable-interwork --enable-multilib </p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make all</p> 
<p class="p44"><span class="s12"><strong>$</strong></span><span class="s6"> </span>make install</p> 
<p class="p48"><br> </p> 
<p class="p48"><br> </p> 
<p class="p49">不过在编译insight-6.8-1的时候可没有那么顺利啊，有一些错误要进行修改。具体的错误及修改如下：</p> 
<p class="p48"><br> </p> 
<p class="p50">【<span class="s13">1</span>】首先遇到的是</p> 
<p class="p51">HAVE_NO_SEH=1-DEXCEPTION_DISPOSITION=int -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1</p> 
<p class="p51">-DHAVE_SYS_STAT_H=1-DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE</p> 
<p class="p51">_STRINGS_H=1 -DHAVE_INTTYPES_H=1-DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1  -DBUILD_t</p> 
<p class="p51">cl../../../insight-6.8-1/tcl/win/../generic/tclAlloc.c -o tclAlloc.o</p> 
<p class="p51">In file included from ../../../insight-6.8-1/tcl/win/../generic/../win/tclWinPort.h:72:0,</p> 
<p class="p51">                 from../../../insight-6.8-1/tcl/win/../generic/tclPort.h:22,</p> 
<p class="p51">                 from../../../insight-6.8-1/tcl/win/../generic/tclAlloc.c:29:</p> 
<p class="p51">/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../include/w32api/winsock2.h:103:2:</p> 
<p class="p51">warning: #warning "fd_set andassociated macros have been defined in sys/types.</p> 
<p class="p51">This may cause runtime problemswith W32 sockets"</p> 
<p class="p52">/usr/lib/gcc/i686-pc-cygwin/4.5.3/../../../../include/w32api/winsock2.h:632:32:</p> 
<p class="p52">error: conflicting typesfor ‘select’</p> 
<p class="p52">/usr/include/sys/select.h:31:5:note: previous declaration of ‘select’ was here</p> 
<p class="p51">Makefile:423: recipe for target`tclAlloc.o' failed</p> 
<p class="p51">make[3]: *** [tclAlloc.o] Error 1</p> 
<p class="p51">make[3]: Leaving directory`/cygdrive/e/build-gcc/build-insight/tcl/win'</p> 
<p class="p51">Makefile:15: recipe for target`all' failed</p> 
<p class="p51">make[2]: *** [all] Error 2</p> 
<p class="p51">make[2]: Leaving directory`/cygdrive/e/build-gcc/build-insight/tcl'</p> 
<p class="p51">Makefile:6631: recipe for target`all-tcl' failed</p> 
<p class="p51">make[1]: *** [all-tcl] Error 2</p> 
<p class="p51">make[1]: Leaving directory`/cygdrive/e/build-gcc/build-insight'</p> 
<p class="p51">Makefile:705: recipe for target`all' failed</p> 
<p class="p51">make: *** [all] Error 2</p> 
<p class="p53"> </p> 
<p class="p54"><span class="s14">错误的地方我用红色标出来了，是因为</span><span class="s15">cygwin</span><span class="s14">下的</span>/usr/include/w32api/winsock2.h<span class="s14">里面的：</span></p> 
<p class="p55">WINSOCK_API_LINKAGE int PASCAL select(intnfds,fd_set*,fd_set*,fd_set*,const struct timeval*);</p> 
<p class="p54"><span class="s14">和</span>/usr/include/sys/select.h<span class="s14">里面的：</span></p> 
<p class="p55">int select __P ((int __n, fd_set *__readfds, fd_set *__writefds, fd_set *__exceptfds, struct timeval*__timeout));</p> 
<p class="p56">两个函数冲突，因为<span class="s13">select.h</span>下在的定义在系统下，且后面还要用到，故注掉<span class="s13">winsock2.h</span>里的<span class="s13">select</span>函数即可。</p> 
<p class="p56">【<span class="s13">2</span>】接下来会遇到这个错误</p> 
<p class="p53">tclWinChan.o:In function `Tcl_MakeFileChannel':</p> 
<p class="p54">/cygdrive/e/build-gcc/build-insight/tcl/win/../../../insight-6.8-1/tcl/win/tclWinChan.c:1052:undefined reference to `_ESP'</p> 
<p class="p54">/cygdrive/e/build-gcc/build-insight/tcl/win/../../../insight-6.8-1/tcl/win/tclWinChan.c:1052:undefined reference to `_EBP'</p> 
<p class="p54">/cygdrive/e/build-gcc/build-insight/tcl/win/../../../insight-6.8-1/tcl/win/tclWinChan.c:1067:undefined reference to `_ESP'</p> 
<p class="p54">/cygdrive/e/build-gcc/build-insight/tcl/win/../../../insight-6.8-1/tcl/win/tclWinChan.c:1067:undefined reference to `_EBP'</p> 
<p class="p53"> </p> 
<p class="p56">打开<span class="s13">tclwinChan.c </span>对应的<span class="s13"> 1052</span>代码如下，怎么看也不知道错在什么地方。</p> 
<p class="p53">    __asm__ __volatile__ (</p> 
<p class="p54">             "movl  %esp, _ESP" "\n\t"</p> 
<p class="p54">             "movl %ebp, _EBP");</p> 
<p class="p57"> </p> 
<p class="p53"><span class="s16">上网找</span>ESP<span class="s16">，</span>EBP<span class="s16">，突然看到</span> 124<span class="s16">行</span></p> 
<p class="p58">static void *ESP;</p> 
<p class="p58">static void *EBP;</p> 
<p class="p56">用的是<span class="s13">static </span>属性，想想可能是因为内嵌汇编无法引用指针引起的，于是去掉<span class="s13">static</span>，结果真是可以了，就是这个原因。然后在网上也找到<span class="s13">insight6.8</span>的<span class="s13">patch</span>，果然就这样改。<span class="s13">Patch</span>的网址：</p> 
<p class="p59"><a target="_blank" href="http://moaningmarmot.free.fr/?p=30" rel="nofollow noopener noreferrer">http://moaningmarmot.free.fr/?p=30</a></p> 
<p class="p60">Fix upInsight 6.8 to build up on a x86 host and a modern GCC toolchain</p> 
<p class="p53">arm-elf-*target debugger on a i686 host</p> 
<p class="p53">Insight6.8 and GDB need a serious code clean up to build without warnings and errorswith GCC 4.x series.</p> 
<p class="p53">Theproposed patch is a simple workaround so that Insight 6.8 (and previousreleases) builds OK on a x86 host. Note that would also needs to remove the-Werror option switch when gdb is built, as GCC 4.x emits tons of warnings whenGDB is built.</p> 
<p class="p53">----------------------------------------------------------------------------------------------</p> 
<p class="p61">diff -urinsight-6.8/tcl/win/tclWinChan.c insight-6.8.new/tcl/win/tclWinChan.c</p> 
<p class="p53">---insight-6.8/tcl/win/tclWinChan.c    2006-02-02 21:02:09.000000000 +0100</p> 
<p class="p53">+++insight-6.8.new/tcl/win/tclWinChan.c  2009-03-1622:07:40.711125000 +0100</p> 
<p class="p53">@@-122,8 +122,8 @@</p> 
<p class="p53"> };</p> 
<p class="p53"> </p> 
<p class="p53"> #ifdef HAVE_NO_SEH</p> 
<p class="p54">-static void *ESP;</p> 
<p class="p54">-static void *EBP;</p> 
<p class="p55">+void *ESP;</p> 
<p class="p55">+void *EBP;</p> 
<p class="p53"> #endif /* HAVE_NO_SEH */</p> 
<p class="p53"> </p> 
<p class="p61">diff -urinsight-6.8/tcl/win/tclWinDde.c insight-6.8.new/tcl/win/tclWinDde.c</p> 
<p class="p53">---insight-6.8/tcl/win/tclWinDde.c    2003-01-21 20:40:22.000000000 +0100</p> 
<p class="p53">+++insight-6.8.new/tcl/win/tclWinDde.c 2009-03-16 22:12:30.414250000 +0100</p> 
<p class="p53">@@-1175,7 +1175,7 @@</p> 
<p class="p53">        }</p> 
<p class="p53">        case DDE_EVAL: {<!-- --></p> 
<p class="p53">            objc -= (async + 3);</p> 
<p class="p54">-           ((Tcl_Obj **)objv) += (async + 3);</p> 
<p class="p55">+           objv =((Tcl_Obj **) objv) + (async + 3);</p> 
<p class="p53"> </p> 
<p class="p61">diff -ur insight-6.8/tcl/win/tclWinReg.cinsight-6.8.new/tcl/win/tclWinReg.c</p> 
<p class="p53">---insight-6.8/tcl/win/tclWinReg.c    2003-02-07 20:52:00.000000000 +0100</p> 
<p class="p53">+++insight-6.8.new/tcl/win/tclWinReg.c 2009-03-16 22:16:52.820500000 +0100</p> 
<p class="p53">@@-747,7 +747,9 @@</p> 
<p class="p53">                    Tcl_NewStringObj(Tcl_DStringValue(&amp;buf),</p> 
<p class="p53">                           Tcl_DStringLength(&amp;buf)));</p> 
<p class="p53">            if (regWinProcs-&gt;useWide) {<!-- --></p> 
<p class="p54"><span class="s15">-            </span>   while (*((Tcl_UniChar *)p)++ != 0) {}</p> 
<p class="p55">+               Tcl_UniChar * wp = (Tcl_UniChar *)p;</p> 
<p class="p55">+               while (*wp++ != 0) {}</p> 
<p class="p55">+                p = (char*)wp;</p> 
<p class="p53">            } else {<!-- --></p> 
<p class="p53">                while (*p++ != '\0') {}</p> 
<p class="p53">            }</p> 
<p class="p53">---------------------------------------------------------------------------------------------</p> 
<p class="p56">同样，还有另外两个文件要改<span class="s17">tclWinDde.c</span><span class="s18">，</span><span class="s17">tclWinReg.c</span>，把红的改成绿的就可以了。</p> 
<p class="p56">【<span class="s13">3</span>】接下来，又是一个与系统定义冲突的错误</p> 
<p class="p53">Infile included from ../../../insight-6.8-1/tk/win/../generic/tkPort.h:27:0,</p> 
<p class="p53">                 from../../../insight-6.8-1/tk/win/../generic/tkInt.h:27,</p> 
<p class="p53">                 from../../../insight-6.8-1/tk/win/../generic/tkConsole.c:19:</p> 
<p class="p53">../../../insight-6.8-1/tk/win/tkWinPort.h:126:8:error: redefinition of ‘struct timezone’</p> 
<p class="p53">/usr/include/sys/time.h:22:8:note: originally defined here</p> 
<p class="p53">Makefile:588:recipe for target `tkConsole.o' failed</p> 
<p class="p53"> </p> 
<p class="p53">/usr/include/sys/timer.h<span class="s16">和</span>insight-6.8-1/tk/win/tkWinPort.h<span class="s16">里面定义了重复的结构体</span></p> 
<p class="p61">struct  itimerval {<!-- --></p> 
<p class="p61">  struct  timeval it_interval;</p> 
<p class="p61">  struct  timeval it_value;</p> 
<p class="p61">};</p> 
<p class="p53"><span class="s16">注释掉</span>insight-6.8-1/tk/win/tkWinPort.h<span class="s16">里面的即可。</span></p> 
<p class="p50">【<span class="s13">4</span>】下面几个错误主要是因为新版的<span class="s13">cygwin </span>修改了几个路径转换的接口函数所引起的。</p> 
<p class="p54">../../insight-6.8-1/gdb/remote-fileio.c: In function‘remote_fileio_func_rename<span class="s16">’</span>:</p> 
<p class="p54">../../insight-6.8-1/gdb/remote-fileio.c:1007:5: error:‘cygwin_conv_to_full_posix_path’ is deprecated (declared at/usr/include/sys/cygwin.h:40)</p> 
<p class="p54">../../insight-6.8-1/gdb/remote-fileio.c:1008:5: error:‘cygwin_conv_to_full_posix_path’ is deprecated (declared at/usr/include/sys/cygwin.h:40)</p> 
<p class="p50">当然也是因为打开了<span class="s13">-Werror</span>，所以编译器把警告也当然错误来处理，不让编译通过。这个编译出错的地方是有提示的，如下：</p> 
<p class="p62">cc1: warnings being treated as errors</p> 
<p class="p50">修改有两种方法，第一去掉<span class="s13">-Werror</span>选项，第二用<span class="s13">cygwin</span>新定义的函数。下面就两种方法，分别介绍，先说使用新函数吧。</p> 
<p class="p63"><span class="s16">首先</span>Cygwin<span class="s16">这个升级位于</span>/usr/include/sys/cygwin.h</p> 
<p class="p59"><a target="_blank" href="http://cygwin.com/cygwin-api/func-cygwin-conv-path.html" rel="nofollow noopener noreferrer">http://cygwin.com/cygwin-api/func-cygwin-conv-path.html</a><span class="s19"> </span><span class="s14">官网上有用法</span></p> 
<p class="p64">/* DEPRECATEDINTERFACES.  These are restricted toMAX_PATH length. Don't use in modern applications. */</p> 
<p class="p65">extern intcygwin_win32_to_posix_path_list (const char *, char *)  __attribute__ ((deprecated));</p> 
<p class="p65">extern intcygwin_win32_to_posix_path_list_buf_size (const char *)  __attribute__ ((deprecated));</p> 
<p class="p65">extern intcygwin_posix_to_win32_path_list (const char *, char *)  __attribute__ ((deprecated));</p> 
<p class="p65">extern intcygwin_posix_to_win32_path_list_buf_size (const char *)  __attribute__ ((deprecated));</p> 
<p class="p65">extern intcygwin_conv_to_win32_path (const char *, char *)  __attribute__ ((deprecated));</p> 
<p class="p65">extern intcygwin_conv_to_full_win32_path (const char *, char *)  __attribute__ ((deprecated));</p> 
<p class="p65">extern intcygwin_conv_to_posix_path (const char *, char *)  __attribute__ ((deprecated));</p> 
<p class="p65">extern intcygwin_conv_to_full_posix_path (const char *, char *)  __attribute__ ((deprecated));</p> 
<p class="p53"> </p> 
<p class="p64">/* Use theseinterfaces in favor of the above. */</p> 
<p class="p64"> </p> 
<p class="p64">/* Possible 'what'values in calls to cygwin_conv_path/cygwin_create_path. */</p> 
<p class="p55">enum</p> 
<p class="p55">{<!-- --></p> 
<p class="p64"><span class="s20">  </span><span class="s12">CCP_POSIX_TO_WIN_A = 0,</span><span class="s21"> </span>/* from is char*, tois char*       */</p> 
<p class="p64"><span class="s20"> </span><span class="s12"> CCP_POSIX_TO_WIN_W,</span><span class="s20">      </span><span class="s21"> </span>/* from ischar*, to is wchar_t*    */</p> 
<p class="p64"><span class="s20">  </span><span class="s12">CCP_WIN_A_TO_POSIX,</span><span class="s20">        </span>/* from is char*, to is char*       */</p> 
<p class="p64"><span class="s20"> </span><span class="s12"> CCP_WIN_W_TO_POSIX,    </span><span class="s20"> </span><span class="s21"> </span>/* from iswchar_t*, to is char*    */</p> 
<p class="p54"><span class="s20"> </span> CCP_CONVTYPE_MASK = 3,</p> 
<p class="p64"><span class="s20"> </span> /* Or these valuesto the above as needed. */</p> 
<p class="p64"><span class="s12">  CCP_ABSOLUTE = 0,</span><span class="s20">      </span>/* Request absolute path (default). */</p> 
<p class="p64">  <span class="s12">CCP_RELATIVE = 0x100</span>    /* Request to keep path relative.   */</p> 
<p class="p55">};</p> 
<p class="p55">typedef unsigned int cygwin_conv_path_t;</p> 
<p class="p53"> </p> 
<p class="p64">/* If size is 0,cygwin_conv_path returns the required buffer size in bytes. Otherwise, itreturns 0 on success, or -1 on error and errno is set to one of the belowvalues:</p> 
<p class="p64">    EINVAL        what has an invalid value.</p> 
<p class="p64">    EFAULT        from or to point into nirvana.</p> 
<p class="p64">    ENAMETOOLONG  the resulting path is longer than 32K, or, incase</p> 
<p class="p64">                     of what == CCP_POSIX_TO_WIN_A, longer thanMAX_PATH.</p> 
<p class="p64">    ENOSPC        size is less than required for theconversion.</p> 
<p class="p64">*/</p> 
<p class="p55">extern ssize_t cygwin_conv_path (cygwin_conv_path_t what, constvoid *from,</p> 
<p class="p55">                                      void *to, size_t size);</p> 
<p class="p64">/* Same, but handlespath lists separated by colon or semicolon. */</p> 
<p class="p55">extern ssize_t cygwin_conv_path_list (cygwin_conv_path_t what,const void *from,</p> 
<p class="p55">                                      void *to, size_t size);</p> 
<p class="p53"> </p> 
<p class="p56">原先的函数后面都加了<span class="s22">deprecated </span>属性，所以才会有警告，又因为把警告当成错误处理，所以出错了。可以看出新版<span class="s13">cygwin</span>使用了<span class="s23">cygwin_conv_path</span><span class="s6">和</span><span class="s23">cygwin_conv_path_list</span><span class="s6">来代替原来的</span><span class="s23">8</span><span class="s6">个函数，通过</span><span class="s22">cygwin_conv_path_t</span>来进行区分。所以修改也是围绕这个来。</p> 
<p class="p56">一共要改三个文件，分别如下：</p> 
<p class="p61">1<span class="s16">）</span>insight-6.8-1/gdb/gdbtk/generic/gdbtk.c</p> 
<p class="p53"> </p> 
<p class="p53">          const char **lib_path;</p> 
<p class="p53">          Tcl_DString lib_dstring;</p> 
<p class="p53">          <span class="s20"> int len;</span></p> 
<p class="p53">          Tcl_DStringInit (&amp;lib_dstring);</p> 
<p class="p53"> </p> 
<p class="p53">#ifdef__CYGWIN__</p> 
<p class="p53">          /* SRC_DIR from configure is a posix path. Tcl really needs a</p> 
<p class="p53">             windows path. */</p> 
<p class="p54">//        src_dir = (char *) alloca(cygwin_posix_to_win32_path_list_buf_size (SRC_DIR));</p> 
<p class="p54">//        cygwin_posix_to_win32_path_list (SRC_DIR,src_dir);</p> 
<p class="p53"> </p> 
<p class="p55">      len = cygwin_conv_path_list(CCP_WIN_A_TO_POSIX,SRC_DIR, NULL, 0);</p> 
<p class="p55">           src_dir = (char *) alloca (len);</p> 
<p class="p55">           cygwin_conv_path_list(CCP_WIN_A_TO_POSIX,SRC_DIR, src_dir, len);</p> 
<p class="p53"> </p> 
<p class="p53">#endif</p> 
<p class="p53">          Cygwin<span class="s12">32</span>_attach_handle_to_fd("/dev/conin", 0,</p> 
<p class="p53">                                               GetStdHandle(STD_INPUT_HANDLE),</p> 
<p class="p53">                                               1,GENERIC_READ);</p> 
<p class="p53">          Cygwin<span class="s12">32</span>_attach_handle_to_fd("/dev/conout", 1,</p> 
<p class="p53">                                               GetStdHandle(STD_OUTPUT_HANDLE),</p> 
<p class="p53">                                               0,GENERIC_WRITE);</p> 
<p class="p53">          Cygwin<span class="s12">32</span>_attach_handle_to_fd("/dev/conout", 2,</p> 
<p class="p53">                                               GetStdHandle(STD_ERROR_HANDLE),</p> 
<p class="p53">                                               0,GENERIC_WRITE);</p> 
<p class="p53"> </p> 
<p class="p61">2<span class="s16">）</span>insight-6.8-1/gdb/gdbtk/generic/gdbtk-cmds.c</p> 
<p class="p53">staticint gdb_path_conv (ClientData clientData, Tcl_Interp *interp, int objc, Tcl_Obj*CONST objv[])</p> 
<p class="p53">{<!-- --></p> 
<p class="p55"><span class="s15">         </span>int len =0;</p> 
<p class="p53">  if (objc != 2)</p> 
<p class="p53">    {<!-- --></p> 
<p class="p53">      Tcl_WrongNumArgs (interp, 1, objv, NULL);</p> 
<p class="p53">      return TCL_ERROR;</p> 
<p class="p53">    }</p> 
<p class="p53">#ifdef__CYGWIN__</p> 
<p class="p53">  {<!-- --></p> 
<p class="p53">    char pathname[256], *ptr;</p> 
<p class="p54">//  cygwin_conv_to_full_win32_path (Tcl_GetStringFromObj (objv[1], NULL),pathname);</p> 
<p class="p55">         len =cygwin_conv_path(CCP_POSIX_TO_WIN_A,Tcl_GetStringFromObj (objv[1], NULL),NULL,0);</p> 
<p class="p55">         cygwin_conv_path(CCP_POSIX_TO_WIN_A,Tcl_GetStringFromObj(objv[1], NULL), pathname, len);</p> 
<p class="p53"> </p> 
<p class="p61">3<span class="s16">）</span>insight-6.8-1/gdb/remote-fileio.c</p> 
<p class="p53"> </p> 
<p class="p54">//                 cygwin_conv_to_full_posix_path (oldpath,oldfullpath);</p> 
<p class="p54">//                 cygwin_conv_to_full_posix_path (newpath,newfullpath);</p> 
<p class="p55">                     len = cygwin_conv_path(CCP_WIN_A_TO_POSIX,oldpath, NULL, 0);</p> 
<p class="p55">                     cygwin_conv_path(CCP_WIN_A_TO_POSIX, oldpath,oldfullpath, len);</p> 
<p class="p55">                     len = cygwin_conv_path(CCP_WIN_A_TO_POSIX,newpath, NULL, 0);</p> 
<p class="p55">                     cygwin_conv_path(CCP_WIN_A_TO_POSIX, newpath,newfullpath, len);</p> 
<p class="p53"> </p> 
<p class="p56">这几个文件修改方法是，删掉<span class="s12">红色</span>部分，增加<span class="s20">绿色</span>部分，保留下黑色部分。</p> 
<p class="p56">第二修改方法和下面的部分一起讲。</p> 
<p class="p56">【<span class="s13">5</span>】下面是几个错误，也是因为打开了<span class="s13">-Werror </span>选项引起的</p> 
<p class="p53"> </p> 
<p class="p54">cc1: warnings being treated as errors</p> 
<p class="p54">cp-name-parser.y: In function ‘cp_comp_to_string’:</p> 
<p class="p54">cp-name-parser.y:1980:20: error: comparison between ‘enumdemangle_component_type’ and ‘enum &lt;anonymous&gt;’</p> 
<p class="p54">cp-name-parser.y:1985:25: error: comparison between ‘enumdemangle_component_type’ and ‘enum &lt;anonymous&gt;’</p> 
<p class="p54">Makefile:1103: recipe for target `cp-name-parser.o' failed</p> 
<p class="p54"> </p> 
<p class="p54">iteral -Wno-pointer-sign -Wno-unused -Wno-switch -Wno-char-subscripts-Werror ../../insight-6.8-1/gdb/ada-lang.c</p> 
<p class="p54">cc1: warnings being treated as errors</p> 
<p class="p54">../../insight-6.8-1/gdb/ada-lang.c: In function‘ada_attribute_name’:</p> 
<p class="p54">../../insight-6.8-1/gdb/ada-lang.c:7686:9: error: comparison between‘enum exp_opcode’ and ‘enum ada_operator’</p> 
<p class="p54">../../insight-6.8-1/gdb/ada-lang.c: In function ‘assign_component’:</p> 
<p class="p54">../../insight-6.8-1/gdb/ada-lang.c:8186:30: error: comparisonbetween ‘enum exp_opcode’ and ‘enum ada_operator’</p> 
<p class="p54">../../insight-6.8-1/gdb/ada-lang.c: In function ‘aggregate_assign_from_choices<span class="s16">’</span>:</p> 
<p class="p54">../../insight-6.8-1/gdb/ada-lang.c:8341:14: error: comparisonbetween ‘enum exp_opcode’ and ‘enum ada_operator’</p> 
<p class="p54">../../insight-6.8-1/gdb/ada-lang.c: In function‘ada_evaluate_subexp’:</p> 
<p class="p54">../../insight-6.8-1/gdb/ada-lang.c:8540:34: error: comparisonbetween ‘enum exp_opcode’ and ‘enum ada_operator’</p> 
<p class="p54">../../insight-6.8-1/gdb/ada-lang.c:9099:32: error: comparisonbetween ‘enum exp_opcode’ and ‘enum ada_operator’</p> 
<p class="p54">Makefile:1103: recipe for target `ada-lang.o' failed</p> 
<p class="p53"> </p> 
<p class="p53"> </p> 
<p class="p66">1）<span class="s3"> </span>insight-6.8-1/gdb/cp-name-parser.c<span class="s16">和</span>insight-6.8-1/gdb/cp-name-parse.y</p> 
<p class="p67">这两个文件都要改。</p> 
<p class="p53">  if (result-&gt;type ==<span class="s20"> (enum demangle_component_type)</span>GLOBAL_DESTRUCTORS)</p> 
<p class="p53">    {<!-- --></p> 
<p class="p53">      result = d_left (result);</p> 
<p class="p53">      prefix = "global destructors keyedto ";</p> 
<p class="p53">    }</p> 
<p class="p53">  else if (result-&gt;type == <span class="s20">(enum demangle_component_type)</span>GLOBAL_CONSTRUCTORS)</p> 
<p class="p53">    {<!-- --></p> 
<p class="p53">      result = d_left (result);</p> 
<p class="p53">      prefix = "global constructors keyedto ";</p> 
<p class="p53">    }</p> 
<p class="p61">2<span class="s16">）</span>insight-6.8-1/gdb/cp-name-parser.c</p> 
<p class="p53"> Line: 7686   if (<span class="s20">(int)</span>n&gt;= OP_ATR_FIRST &amp;&amp; <span class="s20">(int)</span>n &lt;=(int) OP_ATR_VAL)</p> 
<p class="p53"> Line: 8186   if (<span class="s20">(int)</span>exp-&gt;elts[*pos].opcode== OP_AGGREGATE)</p> 
<p class="p53"> Line: 8341   if (<span class="s20">(int)</span>op == OP_DISCRETE_RANGE)</p> 
<p class="p68">Line:8540   if (<span class="s20">(int)</span>exp-&gt;elts[*pos].opcode== OP_AGGREGATE)</p> 
<p class="p53"> Line: 9099 <span class="s20">  (int)</span>op== OP_ATR_MIN ? BINOP_MIN : BINOP_MAX);</p> 
<p class="p53"> </p> 
<p class="p56">到这里编译<span class="s13"> insight-6.8-1</span>的所有错误都改完了。编完之后，就可以在<span class="s13">bin</span>目录找到<span class="s13">insight</span>了。</p> 
<p class="p53"> </p> 
<p class="p53"><span class="s16">下面来说第二种方法，就是如何去掉</span><span class="s12">–Werror</span><span class="s16">编译选项。找到</span> insight-6.8-1/gdb/makefile.in</p> 
<p class="p56">在<span class="s13">147</span>行的下一行加上：</p> 
<p class="p53">Line:147: GDB_WERROR_CFLAGS = $(WERROR_CFLAGS)</p> 
<p class="p55">Line: 148: GDB_WERROR_CFLAGS =</p> 
<p class="p56">就可以了</p> 
<p class="p53"><span class="s16">到这里，所有的编译都完成了，</span>arm-none-eabi-gcc<span class="s16">已生成，并还</span>gdb<span class="s16">和</span>insight<span class="s16">。</span></p> 
<p class="p69">最后，本文写给和我一样的对<span class="s2">gcc</span>和<span class="s2">linux</span>是菜鸟的同志们，欢迎给出意见<span class="s2">~~~~</span></p> 
<p class="p70"><br> </p> 
<p class="p59"><a target="_blank" href="http://www.yagarto.de/" rel="nofollow noopener noreferrer">http://www.yagarto.de/</a></p> 
<p class="p59"><a target="_blank" href="http://www.oliverbehr.de/index.php?option=com_content&amp;view=article&amp;id=50:building-a-gnu-arm-toolchain&amp;catid=39&amp;Itemid=73" rel="nofollow noopener noreferrer">http://www.oliverbehr.de/index.php?option=com_content&amp;view=article&amp;id=50:building-a-gnu-arm-toolchain&amp;catid=39&amp;Itemid=73</a></p> 
<p class="p59"><a target="_blank" href="http://www.kunen.org/uC/gnu_tool.html" rel="nofollow noopener noreferrer">http://www.kunen.org/uC/gnu_tool.html</a></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d3de0e218002ebca36f9214ea99c3581/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【D3相关资料整理】持续更新中......</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aa73ffada440cea380f0eec5d0e7bbc0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">c&#43;&#43; 多线程编程基础</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>