<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>微服务理解、Nacos与Eureka、Feign和Gateway - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="微服务理解、Nacos与Eureka、Feign和Gateway" />
<meta property="og:description" content="目录
分布式架构
微服务是一种经过良好架构设计的分布式架构方案
SpringCloud是目前国内使用最广泛的微服务框架
服务拆分原则
Eureka
Ribbon负载均衡
Ribbon负载均衡的原理
Ribbon负载均衡策略IRule
Ribbon饥饿加载
Nacos注册中心
Nacos同集群优先的负载均衡
权重配置
环境隔离
Nacos与Eureka的区别
Nacos除了可以做注册中心，同样可以做配置管理来使用
配置热更新
配置共享的优先级
Feign远程调用
如何使用
自定义配置
Feign使用优化
最佳实践
Gateway服务网关
网关作用
断言
过滤器工厂
路由过滤器的种类
过滤器的作用是什么？
全局过滤器
过滤器执行顺序
Gateway解决跨域问题
解决跨域问题
分布式架构 根据业务功能对系统做拆分，每个业务功能模块作为独立项目开发，称为一个服务。
分布式架构的优缺点：
优点：1.降低服务耦合2.有利于服务升级和拓展
缺点：服务调用关系错综复杂
微服务是一种经过良好架构设计的分布式架构方案 微服务的架构特征：
单一职责：微服务拆分粒度更小，每一个服务都对应唯一的业务能力，做到单一职责
自治：团队独立、技术独立、数据独立，独立部署和交付
面向服务：服务提供统一标准的接口，与语言和技术无关
隔离性强：服务调用做好隔离、容错、降级，避免出现级联问题
微服务的上述特性其实是在给分布式架构制定一个标准
SpringCloud是目前国内使用最广泛的微服务框架 集成了各种优秀微服务功能组件
服务拆分原则 不同微服务，不要重复开发相同业务
微服务数据独立，不要访问其它微服务的数据库
微服务可以将自己的业务暴露为接口，供其它微服务调用
Eureka 1.搭建注册中心
2.服务注册，把服务注册eureka
3.服务发现，通过负载均衡挑选一个服务，实现远程调用
Ribbon负载均衡 SpringCloud底层其实是利用了一个名为Ribbon的组件，来实现负载均衡功能的
为什么我们只输入了service名称就可以访问了呢？之前还要获取ip和端口。
显然有人帮我们根据service名称，获取到了服务实例的ip和端口。它就是LoadBalancerInterceptor，这个类会在对RestTemplate的请求进行拦截，然后从Eureka根据服务id获取服务列表，随后利用负载均衡算法得到真实的服务地址信息，替换服务id
Ribbon负载均衡的原理 SpringCloudRibbon的底层采用了一个拦截器，拦截了RestTemplate发出的请求，对地址做了修改。用一幅图来总结一下：
基本流程如下：
拦截我们的RestTemplate请求http://userservice/user/1
RibbonLoadBalancerClient会从请求url中获取服务名称，也就是user-service
DynamicServerListLoadBalancer根据user-service到eureka拉取服务列表
eureka返回列表，localhost:8081、localhost:8082
IRule利用内置负载均衡规则，从列表中选择一个，例如localhost:8081
RibbonLoadBalancerClient修改请求地址，用localhost:8081替代userservice，得到http://localhost:8081/user/1，发起真实请求
Ribbon负载均衡策略IRule 默认的实现就是ZoneAvoidanceRule，是一种轮询方案" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/dedf74c97d0287196109d2ba31488b62/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-08T14:36:49+08:00" />
<meta property="article:modified_time" content="2023-02-08T14:36:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">微服务理解、Nacos与Eureka、Feign和Gateway</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%84-toc" style="margin-left:40px;"><a href="#%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%84" rel="nofollow">分布式架构</a></p> 
<p id="%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%98%AF%E4%B8%80%E7%A7%8D%E7%BB%8F%E8%BF%87%E8%89%AF%E5%A5%BD%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88-toc" style="margin-left:40px;"><a href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%98%AF%E4%B8%80%E7%A7%8D%E7%BB%8F%E8%BF%87%E8%89%AF%E5%A5%BD%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88" rel="nofollow">微服务是一种经过良好架构设计的分布式架构方案</a></p> 
<p id="SpringCloud%E6%98%AF%E7%9B%AE%E5%89%8D%E5%9B%BD%E5%86%85%E4%BD%BF%E7%94%A8%E6%9C%80%E5%B9%BF%E6%B3%9B%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6-toc" style="margin-left:40px;"><a href="#SpringCloud%E6%98%AF%E7%9B%AE%E5%89%8D%E5%9B%BD%E5%86%85%E4%BD%BF%E7%94%A8%E6%9C%80%E5%B9%BF%E6%B3%9B%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6" rel="nofollow">SpringCloud是目前国内使用最广泛的微服务框架</a></p> 
<p id="%E6%9C%8D%E5%8A%A1%E6%8B%86%E5%88%86%E5%8E%9F%E5%88%99-toc" style="margin-left:40px;"><a href="#%E6%9C%8D%E5%8A%A1%E6%8B%86%E5%88%86%E5%8E%9F%E5%88%99" rel="nofollow">服务拆分原则</a></p> 
<p id="Eureka-toc" style="margin-left:40px;"><a href="#Eureka" rel="nofollow">Eureka</a></p> 
<p id="Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1-toc" style="margin-left:40px;"><a href="#Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1" rel="nofollow">Ribbon负载均衡</a></p> 
<p id="Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E5%8E%9F%E7%90%86-toc" style="margin-left:80px;"><a href="#Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E5%8E%9F%E7%90%86" rel="nofollow">Ribbon负载均衡的原理</a></p> 
<p id="Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AD%96%E7%95%A5IRule-toc" style="margin-left:80px;"><a href="#Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AD%96%E7%95%A5IRule" rel="nofollow">Ribbon负载均衡策略IRule</a></p> 
<p id="Ribbon%E9%A5%A5%E9%A5%BF%E5%8A%A0%E8%BD%BD-toc" style="margin-left:80px;"><a href="#Ribbon%E9%A5%A5%E9%A5%BF%E5%8A%A0%E8%BD%BD" rel="nofollow">Ribbon饥饿加载</a></p> 
<p id="Nacos%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83-toc" style="margin-left:40px;"><a href="#Nacos%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83" rel="nofollow">Nacos注册中心</a></p> 
<p id="Nacos%E5%90%8C%E9%9B%86%E7%BE%A4%E4%BC%98%E5%85%88%E7%9A%84%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1-toc" style="margin-left:80px;"><a href="#Nacos%E5%90%8C%E9%9B%86%E7%BE%A4%E4%BC%98%E5%85%88%E7%9A%84%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1" rel="nofollow">Nacos同集群优先的负载均衡</a></p> 
<p id="%E6%9D%83%E9%87%8D%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#%E6%9D%83%E9%87%8D%E9%85%8D%E7%BD%AE" rel="nofollow">权重配置</a></p> 
<p id="%E7%8E%AF%E5%A2%83%E9%9A%94%E7%A6%BB-toc" style="margin-left:80px;"><a href="#%E7%8E%AF%E5%A2%83%E9%9A%94%E7%A6%BB" rel="nofollow">环境隔离</a></p> 
<p id="Nacos%E4%B8%8EEureka%E7%9A%84%E5%8C%BA%E5%88%AB-toc" style="margin-left:40px;"><a href="#Nacos%E4%B8%8EEureka%E7%9A%84%E5%8C%BA%E5%88%AB" rel="nofollow">Nacos与Eureka的区别</a></p> 
<p id="Nacos%E9%99%A4%E4%BA%86%E5%8F%AF%E4%BB%A5%E5%81%9A%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%EF%BC%8C%E5%90%8C%E6%A0%B7%E5%8F%AF%E4%BB%A5%E5%81%9A%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E6%9D%A5%E4%BD%BF%E7%94%A8-toc" style="margin-left:40px;"><a href="#Nacos%E9%99%A4%E4%BA%86%E5%8F%AF%E4%BB%A5%E5%81%9A%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%EF%BC%8C%E5%90%8C%E6%A0%B7%E5%8F%AF%E4%BB%A5%E5%81%9A%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E6%9D%A5%E4%BD%BF%E7%94%A8" rel="nofollow">Nacos除了可以做注册中心，同样可以做配置管理来使用</a></p> 
<p id="%E9%85%8D%E7%BD%AE%E7%83%AD%E6%9B%B4%E6%96%B0-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AE%E7%83%AD%E6%9B%B4%E6%96%B0" rel="nofollow">配置热更新</a></p> 
<p id="%E9%85%8D%E7%BD%AE%E5%85%B1%E4%BA%AB%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AE%E5%85%B1%E4%BA%AB%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7" rel="nofollow">配置共享的优先级</a></p> 
<p id="Feign%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8-toc" style="margin-left:40px;"><a href="#Feign%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8" rel="nofollow">Feign远程调用</a></p> 
<p id="%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px;"><a href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8" rel="nofollow">如何使用</a></p> 
<p id="%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE" rel="nofollow">自定义配置</a></p> 
<p id="Feign%E4%BD%BF%E7%94%A8%E4%BC%98%E5%8C%96-toc" style="margin-left:80px;"><a href="#Feign%E4%BD%BF%E7%94%A8%E4%BC%98%E5%8C%96" rel="nofollow">Feign使用优化</a></p> 
<p id="%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-toc" style="margin-left:80px;"><a href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" rel="nofollow">最佳实践</a></p> 
<p id="Gateway%E6%9C%8D%E5%8A%A1%E7%BD%91%E5%85%B3-toc" style="margin-left:40px;"><a href="#Gateway%E6%9C%8D%E5%8A%A1%E7%BD%91%E5%85%B3" rel="nofollow">Gateway服务网关</a></p> 
<p id="%E7%BD%91%E5%85%B3%E4%BD%9C%E7%94%A8-toc" style="margin-left:80px;"><a href="#%E7%BD%91%E5%85%B3%E4%BD%9C%E7%94%A8" rel="nofollow">网关作用</a></p> 
<p id="%E6%96%AD%E8%A8%80-toc" style="margin-left:80px;"><a href="#%E6%96%AD%E8%A8%80" rel="nofollow">断言</a></p> 
<p id="%E8%BF%87%E6%BB%A4%E5%99%A8%E5%B7%A5%E5%8E%82-toc" style="margin-left:80px;"><a href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E5%B7%A5%E5%8E%82" rel="nofollow">过滤器工厂</a></p> 
<p id="%E8%B7%AF%E7%94%B1%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E7%A7%8D%E7%B1%BB-toc" style="margin-left:80px;"><a href="#%E8%B7%AF%E7%94%B1%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E7%A7%8D%E7%B1%BB" rel="nofollow">路由过滤器的种类</a></p> 
<p id="%C2%A0%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F-toc" style="margin-left:80px;"><a href="#%C2%A0%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F" rel="nofollow"> 过滤器的作用是什么？</a></p> 
<p id="%E5%85%A8%E5%B1%80%E8%BF%87%E6%BB%A4%E5%99%A8-toc" style="margin-left:80px;"><a href="#%E5%85%A8%E5%B1%80%E8%BF%87%E6%BB%A4%E5%99%A8" rel="nofollow">全局过滤器</a></p> 
<p id="%E8%BF%87%E6%BB%A4%E5%99%A8%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F-toc" style="margin-left:80px;"><a href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F" rel="nofollow">过滤器执行顺序</a></p> 
<p id="%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98-toc" style="margin-left:40px;"><a href="#%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98" rel="nofollow">Gateway解决跨域问题</a></p> 
<p id="%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98-toc" style="margin-left:80px;"><a href="#%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98" rel="nofollow">解决跨域问题</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h3 id="%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%84">分布式架构</h3> 
<p>根据业务功能对系统做拆分，每个业务功能模块作为独立项目开发，称为一个服务。</p> 
<p>分布式架构的优缺点：</p> 
<p>优点：1.降低服务耦合2.有利于服务升级和拓展</p> 
<p>缺点：服务调用关系错综复杂</p> 
<p></p> 
<h3 id="%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%98%AF%E4%B8%80%E7%A7%8D%E7%BB%8F%E8%BF%87%E8%89%AF%E5%A5%BD%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88"><strong>微服务</strong>是一种经过良好架构设计的<strong>分布式架构方案</strong></h3> 
<p>微服务的架构特征：</p> 
<ul><li> <p><strong>单一职责</strong>：微服务拆分粒度更小，每一个服务都对应唯一的业务能力，做到单一职责</p> </li><li> <p><strong>自治</strong>：团队独立、技术独立、数据独立，独立部署和交付</p> </li><li> <p><strong>面向服务</strong>：服务提供统一标准的接口，与语言和技术无关</p> </li><li> <p><strong>隔离性强：</strong>服务调用做好隔离、容错、降级，避免出现级联问题</p> </li></ul> 
<p>微服务的上述特性其实是在给分布式架构制定一个标准</p> 
<p></p> 
<h3 id="SpringCloud%E6%98%AF%E7%9B%AE%E5%89%8D%E5%9B%BD%E5%86%85%E4%BD%BF%E7%94%A8%E6%9C%80%E5%B9%BF%E6%B3%9B%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6">SpringCloud是目前国内使用最广泛的微服务框架</h3> 
<p>集成了各种优秀微服务功能组件</p> 
<p><img alt="" height="337" src="https://images2.imgbox.com/17/b3/xaIa8xr7_o.png" width="807"></p> 
<p> </p> 
<h3 id="%E6%9C%8D%E5%8A%A1%E6%8B%86%E5%88%86%E5%8E%9F%E5%88%99">服务拆分原则</h3> 
<ul><li> <p>不同微服务，不要重复开发相同业务</p> </li><li> <p>微服务数据独立，不要访问其它微服务的数据库</p> </li><li> <p>微服务可以将自己的业务暴露为接口，供其它微服务调用</p> </li></ul> 
<p></p> 
<h3 id="Eureka">Eureka</h3> 
<p>1.搭建注册中心</p> 
<p>2.服务注册，把服务注册eureka</p> 
<p>3.服务发现，通过负载均衡挑选一个服务，实现远程调用</p> 
<p></p> 
<h3 id="Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1">Ribbon负载均衡</h3> 
<p>SpringCloud底层其实是利用了一个名为Ribbon的组件，来实现负载均衡功能的</p> 
<p><strong>为什么我们只输入了service名称就可以访问了呢？</strong>之前还要获取ip和端口。</p> 
<p>显然有人帮我们根据service名称，获取到了服务实例的ip和端口。它就是<code>LoadBalancerInterceptor</code>，这个类会在对RestTemplate的请求进行拦截，然后从Eureka根据服务id获取服务列表，随后利用负载均衡算法得到真实的服务地址信息，替换服务id</p> 
<h4 id="Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E5%8E%9F%E7%90%86">Ribbon负载均衡的原理</h4> 
<p>SpringCloudRibbon的底层采用了一个拦截器，拦截了RestTemplate发出的请求，对地址做了修改。用一幅图来总结一下：</p> 
<p></p> 
<p><img alt="" height="722" src="https://images2.imgbox.com/5f/34/HXVLtF2K_o.png" width="1200"></p> 
<p></p> 
<p>基本流程如下：</p> 
<ul><li> <p>拦截我们的RestTemplate请求<a href="http://userservice/user/1" rel="nofollow" title="http://userservice/user/1">http://userservice/user/1</a></p> </li><li> <p>RibbonLoadBalancerClient会从请求url中获取服务名称，也就是user-service</p> </li><li> <p>DynamicServerListLoadBalancer根据user-service到eureka拉取服务列表</p> </li><li> <p>eureka返回列表，localhost:8081、localhost:8082</p> </li><li> <p>IRule利用内置负载均衡规则，从列表中选择一个，例如localhost:8081</p> </li><li> <p>RibbonLoadBalancerClient修改请求地址，用localhost:8081替代userservice，得到<a href="http://localhost:8081/user/1" rel="nofollow" title="http://localhost:8081/user/1">http://localhost:8081/user/1</a>，发起真实请求</p> </li></ul> 
<h4 id="Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AD%96%E7%95%A5IRule">Ribbon负载均衡策略IRule</h4> 
<p>默认的实现就是ZoneAvoidanceRule，是一种轮询方案</p> 
<h4 id="Ribbon%E9%A5%A5%E9%A5%BF%E5%8A%A0%E8%BD%BD">Ribbon饥饿加载</h4> 
<p>Ribbon默认是采用懒加载，即第一次访问时才会去创建LoadBalanceClient，请求时间会很长。</p> 
<p>而饥饿加载则会在项目启动时创建，降低第一次访问的耗时，可以通过配置开启饥饿加载</p> 
<p></p> 
<h3 id="Nacos%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83">Nacos注册中心</h3> 
<p><a href="https://nacos.io/" rel="nofollow" title="Nacos">Nacos</a>是阿里巴巴的产品，现在是<a href="https://spring.io/projects/spring-cloud" rel="nofollow" title="SpringCloud">SpringCloud</a>中的一个组件。相比<a href="https://github.com/Netflix/eureka" title="Eureka">Eureka</a>功能更加丰富，在国内受欢迎程度较高。</p> 
<p>Nacos就将同一机房内的实例 划分为一个<strong>集群</strong>。</p> 
<p>user-service是服务，一个服务可以包含多个集群，如杭州、上海，每个集群下可以有多个实例，形成分级模型。</p> 
<h4 id="Nacos%E5%90%8C%E9%9B%86%E7%BE%A4%E4%BC%98%E5%85%88%E7%9A%84%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1">Nacos同集群优先的负载均衡</h4> 
<p>默认的<code>ZoneAvoidanceRule</code>并不能实现根据同集群优先来实现负载均衡。</p> 
<p>因此Nacos中提供了一个<code>NacosRule</code>的实现，可以优先从同集群中挑选实例。</p> 
<h4 id="%E6%9D%83%E9%87%8D%E9%85%8D%E7%BD%AE">权重配置</h4> 
<p>服务器设备性能有差异，部分实例所在机器性能较好，另一些较差，我们希望性能好的机器承担更多的用户请求。</p> 
<p>但默认情况下NacosRule是同集群内随机挑选，不会考虑机器的性能问题。</p> 
<p>因此，Nacos提供了权重配置来控制访问频率，权重越大则访问频率越高。</p> 
<p><strong>注意</strong>：如果权重修改为0，则该实例永远不会被访问</p> 
<h4 id="%E7%8E%AF%E5%A2%83%E9%9A%94%E7%A6%BB">环境隔离</h4> 
<p>Nacos提供了namespace来实现环境隔离功能。</p> 
<ul><li>nacos中可以有多个namespace</li><li>namespace下可以有group、service等</li><li>不同namespace之间相互隔离，例如不同namespace的服务互相不可见</li></ul> 
<p></p> 
<h3 id="Nacos%E4%B8%8EEureka%E7%9A%84%E5%8C%BA%E5%88%AB">Nacos与Eureka的区别</h3> 
<ul><li>Nacos的服务实例分为两种类型： 
  <ul><li>临时实例：如果实例宕机超过一定时间，会从服务列表剔除，默认的类型。</li><li> <p>非临时实例：如果实例宕机，不会从服务列表剔除，也可以叫永久实例。</p> </li></ul></li><li>Nacos与eureka的共同点 
  <ul><li>都支持服务注册和服务拉取</li><li>都支持服务提供者心跳方式做健康检测</li></ul></li><li>Nacos与Eureka的区别 
  <ul><li>Nacos支持服务端主动检测提供者状态：临时实例采用心跳模式，非临时实例采用主动检测模式</li><li>临时实例心跳不正常会被剔除，非临时实例则不会被剔除</li><li>Nacos支持服务列表变更的消息推送模式，服务列表更新更及时</li><li>Nacos集群默认采用AP方式，当集群中存在非临时实例时，采用CP模式；Eureka采用AP方式</li></ul></li></ul> 
<hr> 
<h3 id="Nacos%E9%99%A4%E4%BA%86%E5%8F%AF%E4%BB%A5%E5%81%9A%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%EF%BC%8C%E5%90%8C%E6%A0%B7%E5%8F%AF%E4%BB%A5%E5%81%9A%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E6%9D%A5%E4%BD%BF%E7%94%A8">Nacos除了可以做注册中心，同样可以做配置管理来使用</h3> 
<p>当微服务部署的实例越来越多，达到数十、数百时，逐个修改微服务配置就会让人抓狂，而且很容易出 错。我们需要一种统一配置管理方案，可以集中管理所有实例的配置。</p> 
<p>Nacos一方面可以将配置集中管理，另一方可以在配置变更时，及时通知微服务，实现配置的热更新。</p> 
<h4 id="%E9%85%8D%E7%BD%AE%E7%83%AD%E6%9B%B4%E6%96%B0">配置热更新</h4> 
<p>方式一：在@Value注入的变量所在类上添加注解@RefreshScope</p> 
<p>方式二：使用@ConfigurationProperties注解代替@Value注解。 在user-service服务中，添加一个类，读取patterrn.dateformat属性</p> 
<h4 id="%E9%85%8D%E7%BD%AE%E5%85%B1%E4%BA%AB%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7">配置共享的优先级</h4> 
<p><img alt="" height="267" src="https://images2.imgbox.com/57/fa/Hgx8VjkJ_o.png" width="607"></p> 
<p></p> 
<p></p> 
<h3 id="Feign%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8">Feign远程调用</h3> 
<p>Feign是一个声明式的http客户端，官方地址：https://github.com/OpenFeign/feign</p> 
<p>其作用就是帮助我们优雅的实现http请求的发送，解决RestTemplate的代码可读性差，编程体验不统一 ，参数复杂URL难以维护。 </p> 
<h4 id="%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8">如何使用</h4> 
<p>使用Feign的步骤： ① 引入依赖 ② 添加@EnableFeignClients注解 ③ 编写FeignClient接口 ④ 使用FeignClient中定义的方法代替RestTemplate</p> 
<h4 id="%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE">自定义配置</h4> 
<p>Feign可以支持很多的自定义配置，如下表所示：</p> 
<table><thead><tr><th>类型</th><th>作用</th><th>说明</th></tr></thead><tbody><tr><td><strong>feign.Logger.Level</strong></td><td>修改日志级别</td><td>包含四种不同的级别：NONE、BASIC、HEADERS、FULL</td></tr><tr><td>feign.codec.Decoder</td><td>响应结果的解析器</td><td>http远程调用的结果做解析，例如解析json字符串为java对象</td></tr><tr><td>feign.codec.Encoder</td><td>请求参数编码</td><td>将请求参数编码，便于通过http请求发送</td></tr><tr><td>feign. Contract</td><td>支持的注解格式</td><td>默认是SpringMVC的注解</td></tr><tr><td>feign. Retryer</td><td>失败重试机制</td><td>请求失败的重试机制，默认是没有，不过会使用Ribbon的重试</td></tr></tbody></table> 
<p>一般情况下，默认值就能满足我们使用，如果要自定义时，只需要创建自定义的@Bean覆盖默认Bean即可。或使用配置文件方式配置。</p> 
<h4 id="Feign%E4%BD%BF%E7%94%A8%E4%BC%98%E5%8C%96">Feign使用优化</h4> 
<p>1.日志级别尽量用basic</p> 
<p>2.提高Feign的性能主要手段就是使用<strong>连接池</strong>代替默认的URLConnection。</p> 
<p>Feign底层发起http请求，依赖于其它的框架。其底层客户端实现包括：</p> 
<p>•URLConnection：默认实现，不支持连接池</p> 
<p>•Apache HttpClient ：支持连接池</p> 
<p>•OKHttp：支持连接池</p> 
<h4 id="%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">最佳实践</h4> 
<p>1、继承方式</p> 
<p>简化这种重复的代码编写</p> 
<p><img alt="" height="405" src="https://images2.imgbox.com/d9/c1/TPEtnDoz_o.png" width="1200"></p> 
<p></p> 
<p>2、抽取方式</p> 
<p>将Feign的Client抽取为独立模块，并且把接口有关的POJO、默认的Feign配置都放到这个模块中，提供给所有消费者使用。</p> 
<p>例如，将UserClient、User、Feign的默认配置都抽取到一个feign-api包中，所有微服务引用该依赖包，即可直接使用。</p> 
<h3 id="Gateway%E6%9C%8D%E5%8A%A1%E7%BD%91%E5%85%B3">Gateway服务网关</h3> 
<p>Spring Cloud Gateway 是 Spring Cloud 的一个全新项目，该项目是基于 Spring 5.0，Spring Boot 2.0 和 Project Reactor 等响应式编程和事件流技术开发的网关，它旨在为微服务架构提供一种简单有效的统一的 API 路由管理方式。</p> 
<p>Gateway网关是我们服务的守门神，所有微服务的统一入口。</p> 
<h4 id="%E7%BD%91%E5%85%B3%E4%BD%9C%E7%94%A8">网关作用</h4> 
<p>网关的<strong>核心功能特性</strong>：</p> 
<ul><li> <p>请求路由</p> </li><li> <p>权限控制</p> </li><li> <p>限流</p> </li></ul> 
<p>架构图：</p> 
<p><img alt="" height="669" src="https://images2.imgbox.com/d4/fd/NsfosWoc_o.png" width="1200"></p> 
<p><strong>权限控制</strong>：网关作为微服务入口，需要校验用户是是否有请求资格，如果没有则进行拦截。</p> 
<p><strong>路由和负载均衡</strong>：一切请求都必须先经过gateway，但网关不处理业务，而是根据某种规则，把请求转发到某个微服务，这个过程叫做路由。当然路由的目标服务有多个时，还需要做负载均衡。</p> 
<p><strong>限流</strong>：当请求流量过高时，在网关中按照下流的微服务能够接受的速度来放行请求，避免服务压力过大。</p> 
<p>在SpringCloud中网关的实现包括两种：</p> 
<ul><li> <p>gateway</p> </li><li> <p>zuul</p> </li></ul> 
<p>Zuul是基于Servlet的实现，属于阻塞式编程。而SpringCloudGateway则是基于Spring5中提供的WebFlux，属于响应式编程的实现，具备更好的性能。</p> 
<p></p> 
<h4 id="%E6%96%AD%E8%A8%80">断言</h4> 
<blockquote> 
 <pre>server:
  port: 10010 # 网关端口
spring:
  application:
    name: gateway # 服务名称
    gateway:
      routes: # 网关路由配置
        - id: user-service # 路由id，自定义，只要唯一即可
          # uri: http://127.0.0.1:8081 # 路由的目标地址 http就是固定地址
          uri: lb://userservice # 路由的目标地址 lb就是负载均衡，后面跟服务名称
          predicates: # 路由断言，也就是判断请求是否符合路由规则的条件
            - Path=/user/** # 这个是按照路径匹配，只要以/user/开头就符合要求
</pre> 
</blockquote> 
<p>我们在配置文件中写的断言规则只是字符串，这些字符串会被Predicate Factory读取并处理，转变为路由判断的条件</p> 
<p>例如Path=/user/**是按照路径匹配，这个规则是由</p> 
<p><code>org.springframework.cloud.gateway.handler.predicate.PathRoutePredicateFactory</code>类来</p> 
<p>处理的，像这样的断言工厂在SpringCloudGateway还有十几个</p> 
<h4 id="%E8%BF%87%E6%BB%A4%E5%99%A8%E5%B7%A5%E5%8E%82">过滤器工厂</h4> 
<p>GatewayFilter是网关中提供的一种过滤器，可以对进入网关的请求和微服务返回的响应做处理</p> 
<p><img alt="" height="415" src="https://images2.imgbox.com/fa/6d/DFPBpESR_o.png" width="1129"></p> 
<h4 id="%E8%B7%AF%E7%94%B1%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E7%A7%8D%E7%B1%BB">路由过滤器的种类</h4> 
<p>Spring提供了31种不同的路由过滤器工厂。例如：</p> 
<table><thead><tr><th><strong>名称</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>AddRequestHeader</td><td>给当前请求添加一个请求头</td></tr><tr><td>RemoveRequestHeader</td><td>移除请求中的一个请求头</td></tr><tr><td>AddResponseHeader</td><td>给响应结果中添加一个响应头</td></tr><tr><td>RemoveResponseHeader</td><td>从响应结果中移除有一个响应头</td></tr><tr><td>RequestRateLimiter</td><td>限制请求的流量</td></tr></tbody></table> 
<h4 id="%C2%A0%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"> 过滤器的作用是什么？</h4> 
<p>① 对路由的请求或响应做加工处理，比如添加请求头</p> 
<p>② 配置在路由下的过滤器只对当前路由的请求生效</p> 
<p>defaultFilters的作用是什么？</p> 
<p>① 对所有路由都生效的过滤器</p> 
<h4 id="%E5%85%A8%E5%B1%80%E8%BF%87%E6%BB%A4%E5%99%A8">全局过滤器</h4> 
<p>全局过滤器的作用也是处理一切进入网关的请求和微服务响应，与GatewayFilter的作用一样。区别在于GatewayFilter通过配置定义，处理逻辑是固定的；而GlobalFilter的逻辑需要自己写代码实现。</p> 
<h4 id="%E8%BF%87%E6%BB%A4%E5%99%A8%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F">过滤器执行顺序</h4> 
<p>请求进入网关会碰到三类过滤器：当前路由的过滤器、DefaultFilter、GlobalFilter</p> 
<p></p> 
<p><img alt="" height="475" src="https://images2.imgbox.com/92/99/WL3RiFGy_o.png" width="1200"></p> 
<p></p> 
<p>排序的规则是什么呢？</p> 
<ul><li> <p>每一个过滤器都必须指定一个int类型的order值，<strong>order值越小，优先级越高，执行顺序越靠前</strong>。</p> </li><li> <p>GlobalFilter通过实现Ordered接口，或者添加@Order注解来指定order值，由我们自己指定</p> </li><li> <p>路由过滤器和defaultFilter的order由Spring指定，默认是按照声明顺序从1递增。</p> </li><li> <p>当过滤器的order值一样时，会按照 defaultFilter &gt; 路由过滤器 &gt; GlobalFilter的顺序执行。</p> </li></ul> 
<h3 id="%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98">Gateway解决跨域问题</h3> 
<p>跨域：域名不一致就是跨域，主要包括：</p> 
<ul><li> <p>域名不同： <a href="www.taobao.com" rel="nofollow">www.taobao.com</a> 和 <a href="www.taobao.org" rel="nofollow">www.taobao.org</a> 和 <a href="www.jd.com" rel="nofollow">www.jd.com</a> 和 miaosha.jd.com</p> </li><li> <p>域名相同，端口不同：localhost:8080和localhost8081</p> </li></ul> 
<p>跨域问题：浏览器禁止请求的发起者与服务端发生跨域ajax请求，请求被浏览器拦截的问题</p> 
<h4 id="%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98">解决跨域问题</h4> 
<p>在gateway服务的application.yml文件中，添加下面的配置：</p> 
<blockquote> 
 <pre>spring:
  cloud:
    gateway:
      # 。。。
      globalcors: # 全局的跨域处理
        add-to-simple-url-handler-mapping: true # 解决options请求被拦截问题
        corsConfigurations:
          '[/**]':
            allowedOrigins: # 允许哪些网站的跨域请求 
              - "http://localhost:8090"
            allowedMethods: # 允许的跨域ajax的请求方式
              - "GET"
              - "POST"
              - "DELETE"
              - "PUT"
              - "OPTIONS"
            allowedHeaders: "*" # 允许在请求中携带的头信息
            allowCredentials: true # 是否允许携带cookie
            maxAge: 360000 # 这次跨域检测的有效期</pre> 
</blockquote> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d7d5a5c1b15bc090cceb3dc27986e277/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">对称加密和非对称加密、公钥和私钥、单向认证和双向认证、数字签名、数字证书、根证书</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3925bce4c7355016b00acaa16a865dde/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Matlab：索引超出数组范围</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>