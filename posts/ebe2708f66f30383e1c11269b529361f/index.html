<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring Boot IO官方文档中文版 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Spring Boot IO官方文档中文版" />
<meta property="og:description" content="本文为官方文档直译版本。原文链接
Spring Boot IO官方文档中文版 引言缓存支持的缓存提供程序GenericJCache (JSR-107)HazelcastInfinispanCouchbaseRedisCaffeineCache2kSimpleNone HazelcastQuartz Scheduler发送邮件Validation调用 REST 服务WebClientWebClient Runtime自定义 WebClientWebClient SSL 支持 RestClient自定义 RestClientRestClient SSL 支持 RestTemplate自定义 RestTemplateRestTemplate SSL 支持 检测 RestClient 和 RestTemplate 的 HTTP 客户端 Web Services使用 WebServiceTemplate 调用网络服务 使用 JTA 进行分布式事务处理使用 Jakarta EE 托管事务管理器混合 XA 和非 XA JMS 连接支持嵌入式事务管理器 引言 大多数应用程序都需要处理输入和输出问题。当您需要 IO 功能时，Spring Boot 提供了实用工具并与一系列技术集成。本节将介绍缓存和验证等标准 IO 功能，以及调度和分布式事务等更高级的主题。我们还将介绍调用远程 REST 或 SOAP 服务和发送电子邮件。
缓存 Spring Framework 支持在应用程序中透明地添加缓存。该抽象的核心是将缓存应用于方法，从而根据缓存中的可用信息减少执行次数。缓存逻辑的应用是透明的，不会对调用者造成任何干扰。只要使用 @EnableCaching 注解启用了缓存支持，Spring Boot 就会自动配置缓存基础架构。
详情请查看 Spring Framework 参考资料的相关章节。
简而言之，要在服务的操作中添加缓存，请在其方法中添加相关注解，如下例所示：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/ebe2708f66f30383e1c11269b529361f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-30T14:43:21+08:00" />
<meta property="article:modified_time" content="2023-12-30T14:43:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring Boot IO官方文档中文版</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>本文为官方文档直译版本。<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io" rel="nofollow">原文链接</a></p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>Spring Boot IO官方文档中文版</h4> 
 <ul><li><ul><li><a href="#_3" rel="nofollow">引言</a></li><li><a href="#_5" rel="nofollow">缓存</a></li><li><ul><li><a href="#_30" rel="nofollow">支持的缓存提供程序</a></li><li><ul><li><a href="#Generic_68" rel="nofollow">Generic</a></li><li><a href="#JCache_JSR107_70" rel="nofollow">JCache (JSR-107)</a></li><li><a href="#Hazelcast_91" rel="nofollow">Hazelcast</a></li><li><a href="#Infinispan_95" rel="nofollow">Infinispan</a></li><li><a href="#Couchbase_105" rel="nofollow">Couchbase</a></li><li><a href="#Redis_138" rel="nofollow">Redis</a></li><li><a href="#Caffeine_175" rel="nofollow">Caffeine</a></li><li><a href="#Cache2k_191" rel="nofollow">Cache2k</a></li><li><a href="#Simple_212" rel="nofollow">Simple</a></li><li><a href="#None_220" rel="nofollow">None</a></li></ul> 
   </li></ul> 
   </li><li><a href="#Hazelcast_228" rel="nofollow">Hazelcast</a></li><li><a href="#Quartz_Scheduler_250" rel="nofollow">Quartz Scheduler</a></li><li><a href="#_308" rel="nofollow">发送邮件</a></li><li><a href="#Validation_329" rel="nofollow">Validation</a></li><li><a href="#_REST__350" rel="nofollow">调用 REST 服务</a></li><li><ul><li><a href="#WebClient_352" rel="nofollow">WebClient</a></li><li><ul><li><a href="#WebClient_Runtime_379" rel="nofollow">WebClient Runtime</a></li><li><a href="#_WebClient_392" rel="nofollow">自定义 WebClient</a></li><li><a href="#WebClient_SSL__397" rel="nofollow">WebClient SSL 支持</a></li></ul> 
    </li><li><a href="#RestClient_423" rel="nofollow">RestClient</a></li><li><ul><li><a href="#_RestClient_447" rel="nofollow">自定义 RestClient</a></li><li><a href="#RestClient_SSL__452" rel="nofollow">RestClient SSL 支持</a></li></ul> 
    </li><li><a href="#RestTemplate_506" rel="nofollow">RestTemplate</a></li><li><ul><li><a href="#_RestTemplate_531" rel="nofollow">自定义 RestTemplate</a></li><li><a href="#RestTemplate_SSL__598" rel="nofollow">RestTemplate SSL 支持</a></li></ul> 
    </li><li><a href="#_RestClient__RestTemplate__HTTP__622" rel="nofollow">检测 RestClient 和 RestTemplate 的 HTTP 客户端</a></li></ul> 
   </li><li><a href="#Web_Services_631" rel="nofollow">Web Services</a></li><li><ul><li><a href="#_WebServiceTemplate__640" rel="nofollow">使用 WebServiceTemplate 调用网络服务</a></li></ul> 
   </li><li><a href="#_JTA__690" rel="nofollow">使用 JTA 进行分布式事务处理</a></li><li><ul><li><a href="#_Jakarta_EE__693" rel="nofollow">使用 Jakarta EE 托管事务管理器</a></li><li><a href="#_XA__XA_JMS__695" rel="nofollow">混合 XA 和非 XA JMS 连接</a></li><li><a href="#_715" rel="nofollow">支持嵌入式事务管理器</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_3"></a>引言</h3> 
<p>大多数应用程序都需要处理输入和输出问题。当您需要 IO 功能时，Spring Boot 提供了实用工具并与一系列技术集成。本节将介绍缓存和验证等标准 IO 功能，以及调度和分布式事务等更高级的主题。我们还将介绍调用远程 REST 或 SOAP 服务和发送电子邮件。</p> 
<h3><a id="_5"></a>缓存</h3> 
<p>Spring Framework 支持在应用程序中透明地添加缓存。该抽象的核心是将缓存应用于方法，从而根据缓存中的可用信息减少执行次数。缓存逻辑的应用是透明的，不会对调用者造成任何干扰。只要使用 <code>@EnableCaching</code> 注解启用了缓存支持，Spring Boot 就会自动配置缓存基础架构。</p> 
<blockquote> 
 <p>详情请查看 Spring Framework 参考资料的<a href="https://docs.spring.io/spring-framework/reference/6.1/integration/cache.html" rel="nofollow">相关章节</a>。</p> 
</blockquote> 
<p>简而言之，要在服务的操作中添加缓存，请在其方法中添加相关注解，如下例所示：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Cacheable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMathService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span><span class="token string">"piDecimals"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">computePiDecimal</span><span class="token punctuation">(</span><span class="token keyword">int</span> precision<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>本例演示了如何在一个可能代价高昂的操作中使用缓存。在调用 <code>computePiDecimal</code> 之前，抽象会在 <code>piDecimals</code> 缓存中查找与 <code>i</code> 参数匹配的条目。如果找到条目，缓存中的内容会立即返回给调用者，并且不会调用该方法。否则，将调用该方法，并在返回值之前更新缓存。</p> 
<blockquote> 
 <p>您也可以透明地使用标准 JSR-107 (JCache) 注解（如 <code>@CacheResult</code>）。不过，我们强烈建议您不要混用 Spring Cache 和 JCache 注释。</p> 
</blockquote> 
<p>如果不添加任何特定的缓存库，Spring Boot 会自动配置一个使用内存中并发映射的简单提供程序。当需要缓存时（如上例中的 <code>piDecimals</code>），该提供程序会为您创建缓存。我们不建议在生产中使用简单提供程序，但它非常适合入门和确保您了解其功能。在决定使用哪种缓存提供程序后，请务必阅读其文档，了解如何配置应用程序使用的缓存。几乎所有提供商都要求您明确配置应用程序中使用的每一个缓存。有些提供商提供了自定义由 <code>spring.cache.cache-names</code> 属性定义的默认缓存的方法。</p> 
<blockquote> 
 <p>还可以透明地更新或删除缓存中的数据。</p> 
</blockquote> 
<h4><a id="_30"></a>支持的缓存提供程序</h4> 
<p>缓存抽象不提供实际存储，而是依赖于由 <code>org.springframework.cache.Cache</code> 和 <code>org.springframework.cache.CacheManager</code> 接口具体化的抽象。<br> 如果您没有定义 <code>CacheManager</code> 类型的 Bean 或名为 <code>cacheResolver</code> 的 <code>CacheResolver</code>（请参阅 <a href="https://docs.spring.io/spring-framework/docs/6.1.1/javadoc-api/org/springframework/cache/annotation/CachingConfigurer.html" rel="nofollow">CachingConfigurer</a>），Spring Boot 会尝试检测以下提供程序（按指定顺序）：</p> 
<ol><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching.provider.generic" rel="nofollow">Generic</a></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching.provider.jcache" rel="nofollow">JCache (JSR-107)</a>(EhCache 3、Hazelcast、Infinispan 等）。</li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching.provider.hazelcast" rel="nofollow">Hazelcast</a></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching.provider.infinispan" rel="nofollow">Infinispan</a></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching.provider.couchbase" rel="nofollow">Couchbase</a></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching.provider.redis" rel="nofollow">Redis</a></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching.provider.caffeine" rel="nofollow">Caffeine</a></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching.provider.cache2k" rel="nofollow">Cache2k</a></li><li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/io.html#io.caching.provider.simple" rel="nofollow">Simple</a></li></ol> 
<p>此外，<a href="https://github.com/spring-projects/spring-boot-data-geode">Spring Boot for Apache Geode</a> 还提供<a href="https://docs.spring.io/spring-boot-data-geode-build/2.0.x/reference/html5/#geode-caching-provider" rel="nofollow">将 Apache Geode 用作缓存提供程序的自动配置功能</a>。</p> 
<blockquote> 
 <p>如果 <code>CacheManager</code> 是由 Spring Boot 自动配置的，则可以通过设置 <code>spring.cache.type</code> 属性来强制使用特定的缓存提供程序。如果需要在某些环境（如测试）中使用免操作缓存，请使用此属性。</p> 
</blockquote> 
<blockquote> 
 <p>使用 <code>spring-boot-starter-cache</code> “Starter” 可快速添加基本的缓存依赖项。启动器引入了 <code>spring-context-support</code>。如果手动添加依赖项，则必须包含 <code>spring-context-support</code> 才能使用 JCache 或 Caffeine 支持。</p> 
</blockquote> 
<p>如果 <code>CacheManager</code> 是由 Spring Boot 自动配置的，那么在完全初始化之前，您可以通过公开一个实现 <code>CacheManagerCustomizer</code> 接口的 Bean 来进一步调整其配置。下面的示例设置了一个标志，表示不应将<code>null</code>值传递给底层映射：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">CacheManagerCustomizer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ConcurrentMapCacheManager</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCacheManagerConfiguration</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CacheManagerCustomizer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConcurrentMapCacheManager</span><span class="token punctuation">&gt;</span></span> <span class="token function">cacheManagerCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>cacheManager<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> cacheManager<span class="token punctuation">.</span><span class="token function">setAllowNullValues</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>在前面的示例中，预计会使用自动配置的 <code>ConcurrentMapCacheManager</code>。如果不是这种情况（要么是您提供了自己的配置，要么是自动配置了不同的缓存提供者），自定义器根本不会被调用。您可以拥有任意多个自定义器，也可以使用 <code>@Order</code> 或 <code>Ordered</code> 对它们进行排序。</p> 
</blockquote> 
<h5><a id="Generic_68"></a>Generic</h5> 
<p>如果上下文至少定义了一个 <code>org.springframework.cache.Cache</code> Bean，就会使用通用缓存。会创建一个封装所有该类型 Bean 的 <code>CacheManager</code>。</p> 
<h5><a id="JCache_JSR107_70"></a>JCache (JSR-107)</h5> 
<p><a href="https://jcp.org/en/jsr/detail?id=107" rel="nofollow">JCache</a> 通过类路径上的 <code>javax.cache.spi.CachingProvider</code> 进行引导（即类路径上存在符合 JSR-107 标准的缓存库），<code>JCacheCacheManager</code> 由 <code>spring-boot-starter-cache</code> “Starter” 提供。Spring Boot 为 Ehcache 3、Hazelcast 和 Infinispan 提供了依赖关系管理。也可以添加任何其他兼容库。<br> 在这种情况下，必须明确指定提供程序。即使 JSR-107 标准没有强制规定定义配置文件位置的标准化方法，Spring Boot 也会尽最大努力通过实施细节来设置缓存，如下例所示：</p> 
<pre><code class="prism language-yaml"><span class="token comment"># Only necessary if more than one provider is present</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">jcache</span><span class="token punctuation">:</span>
      <span class="token key atrule">provider</span><span class="token punctuation">:</span> <span class="token string">"com.example.MyCachingProvider"</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span> <span class="token string">"classpath:example.xml"</span>
</code></pre> 
<blockquote> 
 <p>当缓存库同时提供本地实现和 JSR-107 支持时，Spring Boot 会优先选择 JSR-107 支持，这样即使您切换到不同的 JSR-107 实现，也能获得相同的功能。</p> 
</blockquote> 
<blockquote> 
 <p>Spring Boot 普遍支持 Hazelcast。如果单个 <code>HazelcastInstance</code> 可用，除非指定了 <code>spring.cache.jcache.config</code> 属性，否则 <code>CacheManager</code> 也会自动重用该 <code>HazelcastInstance</code>。</p> 
</blockquote> 
<p>自定义底层 <code>javax.cache.cacheManager</code> 有两种方法：</p> 
<ul><li>可以通过设置 s<code>pring.cache.cache-names</code> 属性在启动时创建缓存。如果定义了自定义 <code>javax.cache.configuration.Configuration</code> Bean，则可使用该 Bean 对缓存进行自定义。</li><li><code>org.springframework.boot.autoconfigure.cache.JCacheManagerCustomizerBean</code> 会调用 <code>CacheManager</code> 的引用进行完全自定义。</li></ul> 
<blockquote> 
 <p>如果定义了标准的 <code>javax.cache.CacheManager</code> Bean，它将被自动封装在抽象所期望的 <code>org.springframework.cache.CacheManager</code> 实现中。不会对其进行进一步的定制。</p> 
</blockquote> 
<h5><a id="Hazelcast_91"></a>Hazelcast</h5> 
<p>Spring Boot 普遍支持 Hazelcast。如果 <code>HazelcastInstance</code> 已被自动配置，且 <code>com.hazelcast:hazelcast-spring</code> 位于类路径上，它将自动被封装在 <code>CacheManager</code> 中。</p> 
<blockquote> 
 <p>Hazelcast 可用作兼容 JCache 的缓存或兼容 Spring <code>CacheManager</code> 的缓存。将 <code>spring.cache.type</code> 设置为 <code>hazelcast</code> 时，Spring Boot 将使用基于 <code>CacheManager</code> 的实现。如果要将 Hazelcast 用作符合 JCache 标准的缓存，请将 <code>spring.cache.type</code> 设置为 <code>jcache</code>。如果您有多个兼容 JCache 的缓存提供程序，并希望强制使用 Hazelcast，则必须显式设置 JCache 提供程序。</p> 
</blockquote> 
<h5><a id="Infinispan_95"></a>Infinispan</h5> 
<p><a href="https://infinispan.org/" rel="nofollow">Infinispan</a> 没有默认的配置文件位置，因此必须明确指定。否则，将使用默认的引导文件。</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">infinispan</span><span class="token punctuation">:</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span> <span class="token string">"infinispan.xml"</span>
</code></pre> 
<p>缓存可通过设置 <code>spring.cache.cache-names</code> 属性在启动时创建。如果定义了自定义 <code>ConfigurationBuilder</code> Bean，则可使用它来自定义缓存。<br> 为了与 Spring Boot 的 Jakarta EE 9 基线兼容，必须使用 <code>Infinispan</code> 的 <code>-jakarta</code> 模块。对于每个带有 <code>-jakarta</code> 变体的模块，必须使用该变体来代替标准模块。例如，必须分别使用 <code>infinispan-core-jakarta</code> 和 <code>infinispan-commons-jakarta</code> 来代替 <code>infinispan-core</code> 和 <code>infinispan-commons</code>。</p> 
<h5><a id="Couchbase_105"></a>Couchbase</h5> 
<p>如果 Spring Data Couchbase 可用且<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/data.html#data.nosql.couchbase" rel="nofollow">已配置</a> Couchbase，则会自动配置 <code>CouchbaseCacheManager</code>。通过设置 <code>spring.cache.cache-names</code> 属性，可以在启动时创建附加缓存，使用 <code>spring.cache.couchbase.*</code> 属性可以配置缓存默认值。例如，以下配置创建了条目有效期为 10 分钟的 <code>cache1</code> 和 <code>cache2</code> 缓存：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">cache-names</span><span class="token punctuation">:</span> <span class="token string">"cache1,cache2"</span>
    <span class="token key atrule">couchbase</span><span class="token punctuation">:</span>
      <span class="token key atrule">expiration</span><span class="token punctuation">:</span> <span class="token string">"10m"</span>
</code></pre> 
<p>如果您需要对配置进行更多控制，可以考虑注册一个 <code>CouchbaseCacheManagerBuilderCustomizer</code> Bean。下面的示例展示了一个自定义器，用于为 <code>cache1</code> 和 <code>cache2</code> 配置特定的条目过期时间：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">CouchbaseCacheManagerBuilderCustomizer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>couchbase<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">CouchbaseCacheConfiguration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCouchbaseCacheManagerConfiguration</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CouchbaseCacheManagerBuilderCustomizer</span> <span class="token function">myCouchbaseCacheManagerBuilderCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>builder<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> builder
                <span class="token punctuation">.</span><span class="token function">withCacheConfiguration</span><span class="token punctuation">(</span><span class="token string">"cache1"</span><span class="token punctuation">,</span> <span class="token class-name">CouchbaseCacheConfiguration</span>
                        <span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">entryExpiry</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withCacheConfiguration</span><span class="token punctuation">(</span><span class="token string">"cache2"</span><span class="token punctuation">,</span> <span class="token class-name">CouchbaseCacheConfiguration</span>
                        <span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">entryExpiry</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMinutes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="Redis_138"></a>Redis</h5> 
<p>如果 <a href="https://redis.io/" rel="nofollow">Redis</a> 可用并已配置，则会自动配置 <code>RedisCacheManager</code>。通过设置 <code>spring.cache.cache-names</code> 属性，可以在启动时创建附加缓存，使用 <code>spring.cache.redis.*</code> 属性可以配置缓存默认值。例如，下面的配置创建了 <code>cache1</code> 和 <code>cache2</code> 缓存，其生存时间为 10 分钟：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">cache-names</span><span class="token punctuation">:</span> <span class="token string">"cache1,cache2"</span>
    <span class="token key atrule">redis</span><span class="token punctuation">:</span>
      <span class="token key atrule">time-to-live</span><span class="token punctuation">:</span> <span class="token string">"10m"</span>
</code></pre> 
<blockquote> 
 <p>默认情况下，Redis 会添加键前缀，这样如果两个独立缓存使用相同的键，Redis 就不会出现键重叠的情况，也就不会返回无效值。如果你创建了自己的 <code>RedisCacheManager</code>，我们强烈建议你保持启用此设置。</p> 
</blockquote> 
<blockquote> 
 <p>你可以通过添加自己的 <code>RedisCacheConfiguration</code> <code>@Bean</code> 来完全控制默认配置。如果需要自定义默认序列化策略，这将非常有用。</p> 
</blockquote> 
<p>如果您需要对配置进行更多控制，可以考虑注册 <code>RedisCacheManagerBuilderCustomizer</code> Bean。下面的示例展示了一个自定义器，用于为 <code>cache1</code> 和 <code>cache2</code> 配置特定的存活时间：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">RedisCacheManagerBuilderCustomizer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">RedisCacheConfiguration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRedisCacheManagerConfiguration</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisCacheManagerBuilderCustomizer</span> <span class="token function">myRedisCacheManagerBuilderCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>builder<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> builder
                <span class="token punctuation">.</span><span class="token function">withCacheConfiguration</span><span class="token punctuation">(</span><span class="token string">"cache1"</span><span class="token punctuation">,</span> <span class="token class-name">RedisCacheConfiguration</span>
                        <span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">entryTtl</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withCacheConfiguration</span><span class="token punctuation">(</span><span class="token string">"cache2"</span><span class="token punctuation">,</span> <span class="token class-name">RedisCacheConfiguration</span>
                        <span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">entryTtl</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMinutes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="Caffeine_175"></a>Caffeine</h5> 
<p><a href="https://github.com/ben-manes/caffeine">Caffeine</a> 是 Java 8 对 Guava 缓存的重写，取代了对 Guava 的支持。如果存在 Caffeine，就会自动配置 <code>CaffeineCacheManager</code>（由 <code>spring-boot-starter-cache</code> "Starter "提供）。缓存可通过设置 <code>spring.cache.cache-names</code> 属性在启动时创建，并可通过以下方式之一进行自定义（按指定顺序）：</p> 
<ol><li>由 <code>spring.cache.caffeine.spec</code> 定义的缓存规范</li><li>定义了一个 <code>com.github.benmanes.caffeine.cache.CaffeineSpec</code> Bean</li><li>定义了一个 <code>com.github.benmanes.caffeine.cache.Caffeine</code> Bean</li></ol> 
<p>例如，以下配置创建了<code>cache1</code> 和<code>cache2</code>，缓存的最大容量为 500，有效时间为 10 分钟</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">cache-names</span><span class="token punctuation">:</span> <span class="token string">"cache1,cache2"</span>
    <span class="token key atrule">caffeine</span><span class="token punctuation">:</span>
      <span class="token key atrule">spec</span><span class="token punctuation">:</span> <span class="token string">"maximumSize=500,expireAfterAccess=600s"</span>
</code></pre> 
<p>如果定义了 <code>com.github.benmanes.caffeine.cache.CacheLoader</code> Bean，它将自动与 <code>CaffeineCacheManager</code> 关联。由于 <code>CacheLoader</code> 将与缓存管理器管理的所有缓存相关联，因此必须将其定义为 <code>CacheLoader&lt;Object，Object&gt;</code>。自动配置会忽略任何其他通用类型。</p> 
<h5><a id="Cache2k_191"></a>Cache2k</h5> 
<p><a href="https://cache2k.org/" rel="nofollow">Cache2k</a> 是一种内存缓存。如果存在 Cache2k Spring 集成，就会自动配置一个 <code>SpringCache2kCacheManager</code>。<br> 缓存可通过设置 <code>spring.cache.cache-names</code> 属性在启动时创建。缓存默认值可使用 <code>Cache2kBuilderCustomizer</code> Bean 进行自定义。下面的示例显示了一个自定义器，它将缓存容量配置为 200 个条目，过期时间为 5 分钟：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">Cache2kBuilderCustomizer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCache2kDefaultsConfiguration</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Cache2kBuilderCustomizer</span> <span class="token function">myCache2kDefaultsCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>builder<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> builder<span class="token punctuation">.</span><span class="token function">entryCapacity</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">expireAfterWrite</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MINUTES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="Simple_212"></a>Simple</h5> 
<p>如果找不到其他提供程序，则会配置使用 <code>ConcurrentHashMap</code> 作为缓存存储的简单实现。如果应用程序中没有缓存库，则默认使用此方法。默认情况下，会根据需要创建缓存，但可以通过设置缓存名称属性来限制可用缓存列表。例如，如果只想使用 <code>cache1</code> 和 <code>cache2</code> 缓存，可将 cache-names 属性设置如下：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">cache-names</span><span class="token punctuation">:</span> <span class="token string">"cache1,cache2"</span>
</code></pre> 
<p>如果您这样做了，而您的应用程序使用了未列出的缓存，那么在运行时需要缓存时就会失败，但启动时不会。这与 “真正的” 缓存提供者在使用未声明缓存时的行为类似。</p> 
<h5><a id="None_220"></a>None</h5> 
<p>当 <code>@EnableCaching</code> 出现在配置中时，预计也会出现合适的缓存配置。如果您有自定义的 <code>CacheManager</code>，请考虑在单独的 <code>@Configuration</code> 类中定义它，以便在必要时覆盖它。在测试中，None 使用的是无操作实现，切片测试默认通过 <code>@AutoConfigureCache</code> 使用该实现。<br> 如果需要在特定环境中使用无操作缓存而不是自动配置的缓存管理器，请将缓存类型设置为 <code>none</code>，如下例所示：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cache</span><span class="token punctuation">:</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"none"</span>
</code></pre> 
<h3><a id="Hazelcast_228"></a>Hazelcast</h3> 
<p>如果 <a href="https://hazelcast.com/" rel="nofollow">Hazelcast</a> 位于类路径上，并且找到了合适的配置，Spring Boot 就会自动配置一个 <code>HazelcastInstance</code>，您可以将其注入应用程序中。<br> Spring Boot 会首先检查以下配置选项，尝试创建客户端：</p> 
<ul><li><code>com.hazelcast.client.config.ClientConfig</code> Bean 的存在。</li><li>有 <code>spring.hazelcast.config</code> 属性定义的配置文件。</li><li>存在 <code>hazelcast.client.config</code> 系统属性。</li><li>工作目录或类路径根目录中的 <code>hazelcast-client.xml</code>。</li><li>工作目录下或类路径根目录下的 <code>hazelcast-client.yml</code>（或 <code>hazelcast-client.yml</code>）。</li></ul> 
<p>如果无法创建客户端，Spring Boot 会尝试配置嵌入式服务器。如果您定义了 <code>com.hazelcast.config.Config</code> Bean，Spring Boot 就会使用该 Bean。如果您的配置定义了实例名称，Spring Boot 会尝试查找现有实例，而不是创建新实例。<br> 您还可以通过配置指定要使用的 Hazelcast 配置文件，如下例所示：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">hazelcast</span><span class="token punctuation">:</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span> <span class="token string">"classpath:config/my-hazelcast.xml"</span>
</code></pre> 
<p>否则，Spring Boot 会尝试从默认位置找到 Hazelcast 配置：工作目录或类路径根目录中的 <code>hazelcast.xml</code>，或相同位置的 YAML 对应文件。我们还会检查是否设置了 <code>hazelcast.config</code> 系统属性。更多详情，请参阅 <a href="https://docs.hazelcast.org/docs/latest/manual/html-single/" rel="nofollow">Hazelcast 文档</a>。</p> 
<blockquote> 
 <p>默认情况下，支持 Hazelcast 组件上的 <code>@SpringAware</code>。可以通过声明一个 <code>@Order</code> 大于 <code>0</code> 的 <code>HazelcastConfigCustomizer</code> Bean 来重写 <code>ManagementContext</code>。</p> 
</blockquote> 
<blockquote> 
 <p>Spring Boot 还为 Hazelcast 提供了显式缓存支持。如果启用了缓存，<code>HazelcastInstance</code> 会自动封装在 <code>CacheManager</code> 实现中。</p> 
</blockquote> 
<h3><a id="Quartz_Scheduler_250"></a>Quartz Scheduler</h3> 
<p>Spring Boot 为使用 <a href="https://www.quartz-scheduler.org/" rel="nofollow">Quartz scheduler</a>提供了多种便利，包括 <code>spring-boot-starter-quartz</code> “Starter”。如果 Quartz 可用，Scheduler 就会自动配置（通过 <code>SchedulerFactoryBean</code> 抽象）。<br> 以下类型的 Bean 会被自动提取并与调度器关联：</p> 
<ul><li><code>JobDetail</code>：定义一个特定的作业。<code>JobDetail</code> 实例可通过 <code>JobBuilder</code> API 生成。</li><li><code>Calendar</code>。</li><li><code>Trigger</code>：定义特定作业的触发时间。</li></ul> 
<p>默认情况下，使用的是内存中的 <code>JobStore</code>。不过，如果应用程序中有 <code>DataSource</code> Bean，并且相应配置了 <code>spring.quartz.job-store-type</code> 属性，也可以配置基于 JDBC 的存储，如下例所示：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">quartz</span><span class="token punctuation">:</span>
    <span class="token key atrule">job-store-type</span><span class="token punctuation">:</span> <span class="token string">"jdbc"</span>
</code></pre> 
<p>使用 JDBC 存储时，可在启动时初始化数据库（schema），如下例所示：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">quartz</span><span class="token punctuation">:</span>
    <span class="token key atrule">jdbc</span><span class="token punctuation">:</span>
      <span class="token key atrule">initialize-schema</span><span class="token punctuation">:</span> <span class="token string">"always"</span>
</code></pre> 
<blockquote> 
 <p>默认情况下，数据库通过使用 Quartz 库提供的标准脚本进行检测和初始化。这些脚本会删除现有表格，并在每次重启时删除所有触发器。也可以通过设置 <code>spring.quartz.jdbc.schema</code> 属性来提供自定义脚本。</p> 
</blockquote> 
<p>要让 Quartz 使用应用程序主<code>DataSource</code>以外的<code>DataSource</code>，可声明一个<code>DataSource</code> Bean，并用 <code>@QuartzDataSource</code> 对其 <code>@Bean</code> 方法进行注解。这样做可以确保 <code>SchedulerFactoryBean</code> 和数据库初始化都使用特定于 Quartz 的<code>DataSource</code>。同样，若要让 Quartz 使用应用程序主事务管理器（<code>TransactionManager</code>）以外的事务管理器（<code>TransactionManager</code>），可声明一个 <code>TransactionManager</code> Bean，并用 <code>@QuartzTransactionManager</code> 对其 <code>@Bean</code> 方法进行注解。<br> 默认情况下，通过配置创建的作业不会覆盖已从持久作业存储区读取的已注册作业。要启用覆盖现有作业定义，请设置 <code>spring.quartz.overwrite-existing-jobs</code> 属性。<br> Quartz Scheduler 配置可使用 <code>spring.quartz</code> 属性和 <code>SchedulerFactoryBeanCustomizer</code> Bean 进行自定义，后者允许对 <code>SchedulerFactoryBean</code> 进行编程式自定义。高级 Quartz 配置属性可使用 <code>spring.quartz.properties.*</code> Quartz 属性来定制。</p> 
<blockquote> 
 <p>特别是，由于 Quartz 提供了一种通过 <code>spring.quartz.properties</code> 配置调度器的方法，因此 <code>Executor</code> Bean 与调度器无关。如果您需要自定义任务执行器，请考虑实现 <code>SchedulerFactoryBeanCustomizer</code>。</p> 
</blockquote> 
<p>工作可以定义设置器来注入数据映射属性。常规 bean 也可以类似的方式注入，如下例所示：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>quartz<span class="token punctuation">.</span></span><span class="token class-name">JobExecutionContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>quartz<span class="token punctuation">.</span></span><span class="token class-name">JobExecutionException</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>quartz<span class="token punctuation">.</span></span><span class="token class-name">QuartzJobBean</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySampleJob</span> <span class="token keyword">extends</span> <span class="token class-name">QuartzJobBean</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">MyService</span> myService<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token comment">// Inject "MyService" bean</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMyService</span><span class="token punctuation">(</span><span class="token class-name">MyService</span> myService<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myService <span class="token operator">=</span> myService<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Inject the "name" job data property</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">executeInternal</span><span class="token punctuation">(</span><span class="token class-name">JobExecutionContext</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">JobExecutionException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>myService<span class="token punctuation">.</span><span class="token function">someMethod</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getFireTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_308"></a>发送邮件</h3> 
<p>Spring Framework 通过使用 <code>JavaMailSender</code> 接口为发送电子邮件提供了一个抽象，Spring Boot 还为其提供了自动配置和启动模块。</p> 
<blockquote> 
 <p>有关如何使用 JavaMailSender 的详细说明，请参阅<a href="https://docs.spring.io/spring-framework/reference/6.1/integration/email.html" rel="nofollow">参考文档</a>。</p> 
</blockquote> 
<p>如果 <code>spring.mail.host</code> 和相关库（由 <code>spring-boot-starter-mail</code> 定义）可用，则会创建一个缺省的 <code>JavaMailSender</code>。发件人可通过 <code>spring.mail</code> 命名空间中的配置项进一步自定义。详情请参阅 <a href="https://github.com/spring-projects/spring-boot/tree/v3.2.0/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/mail/MailProperties.java">MailProperties</a>。<br> 特别是，某些默认超时值是无限的，你可能想更改超时值，以避免线程被无响应的邮件服务器阻塞，如下例所示：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">mail</span><span class="token punctuation">:</span>
    <span class="token key atrule">properties</span><span class="token punctuation">:</span>
      <span class="token key atrule">"[mail.smtp.connectiontimeout]"</span><span class="token punctuation">:</span> <span class="token number">5000</span>
      <span class="token key atrule">"[mail.smtp.timeout]"</span><span class="token punctuation">:</span> <span class="token number">3000</span>
      <span class="token key atrule">"[mail.smtp.writetimeout]"</span><span class="token punctuation">:</span> <span class="token number">5000</span>
</code></pre> 
<p>也可以使用 JNDI 中的现有会话配置 <code>JavaMailSender</code>：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">mail</span><span class="token punctuation">:</span>
    <span class="token key atrule">jndi-name</span><span class="token punctuation">:</span> <span class="token string">"mail/Session"</span>
</code></pre> 
<p>设置 <code>jndi-name</code> 时，它优先于所有其他会话相关设置。</p> 
<h3><a id="Validation_329"></a>Validation</h3> 
<p>只要类路径上有 JSR-303 实现（如 Hibernate 验证器），Bean Validation 1.1 支持的方法验证功能就会自动启用。这样，Bean 方法就可以在其参数和/或返回值上注释 <code>jakarta.validation</code> 约束。带有此类注解方法的目标类需要在类型级注解 <code>@Validated</code> 注解，以便在其方法中搜索内联约束注解。<br> 例如，以下服务会触发第一个参数的验证，确保其大小在 8 和 10 之间：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">jakarta<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints<span class="token punctuation">.</span></span><span class="token class-name">Size</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Validated</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Validated</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBean</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token class-name">Archive</span> <span class="token function">findByCodeAndAuthor</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token class-name">String</span> code<span class="token punctuation">,</span> <span class="token class-name">Author</span> author<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>在解析约束消息中的 <code>{parameters}</code> 时，会使用应用程序的 <code>MessageSource</code>。这样，您就可以在 Bean 验证消息中使用<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.internationalization" rel="nofollow">应用程序的 messages.properties 文件</a>。解析参数后，将使用 Bean 验证的默认插值器完成消息插值。<br> 要自定义用于构建 <code>ValidatorFactory</code> 的配置，请定义 <code>ValidationConfigurationCustomizer</code> Bean。当定义了多个定制器 Bean 时，将根据它们的 <code>@Order</code> 注解或 <code>Ordered</code> 实现依次调用它们。</p> 
<h3><a id="_REST__350"></a>调用 REST 服务</h3> 
<p>Spring Boot 提供了多种方便的方法来调用远程 REST 服务。如果您正在开发一个非阻塞的反应式应用程序，并且正在使用 Spring WebFlux，那么您可以使用 <code>WebClient</code>。如果您喜欢阻塞式 API，则可以使用 <code>RestClient</code> 或 <code>RestTemplate</code>。</p> 
<h4><a id="WebClient_352"></a>WebClient</h4> 
<p>如果您的类路径上有 Spring WebFlux，我们建议您使用 WebClient 来调用远程 REST 服务。WebClient 接口提供了功能型 API，并且是完全反应式的。有关 WebClient 的更多信息，请参阅 <a href="https://docs.spring.io/spring-framework/reference/6.1/web/webflux-webclient.html" rel="nofollow">Spring Framework 文档中的专门章节</a>。</p> 
<blockquote> 
 <p>如果您编写的不是反应式 Spring WebFlux 应用程序，您可以使用 <code>RestClient</code> 代替 <code>WebClient</code>。它提供了类似的功能 API，但却是阻塞式而非反应式的。</p> 
</blockquote> 
<p>Spring Boot 会为您创建并预先配置 <code>WebClient.Builder</code> Bean 原型。强烈建议将其注入到您的组件中并用于创建 <code>WebClient</code> 实例。Spring Boot 将对该构建器进行配置，以共享 HTTP 资源，并以与服务器相同的方式反映编解码器设置（请参阅 <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/web.html#web.reactive.webflux.httpcodecs" rel="nofollow">WebFlux HTTP 编解码器自动配置</a>）等。<br> 以下代码展示了一个典型示例：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">reactor<span class="token punctuation">.</span>core<span class="token punctuation">.</span>publisher<span class="token punctuation">.</span></span><span class="token class-name">Mono</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">WebClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">WebClient</span> webClient<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">WebClient<span class="token punctuation">.</span>Builder</span> webClientBuilder<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>webClient <span class="token operator">=</span> webClientBuilder<span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">"https://example.org"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Details</span><span class="token punctuation">&gt;</span></span> <span class="token function">someRestCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>webClient<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">"/{name}/details"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">retrieve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bodyToMono</span><span class="token punctuation">(</span><span class="token class-name">Details</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="WebClient_Runtime_379"></a>WebClient Runtime</h5> 
<p>Spring Boot 会根据应用程序类路径上可用的库，自动检测使用哪个 <code>ClientHttpConnector</code> 来驱动 <code>WebClient</code>。按优先级排序，支持以下客户端：</p> 
<ol><li>Reactor Netty</li><li>Jetty RS client</li><li>Apache HttpClient</li><li>JDK HttpClient</li></ol> 
<p>如果类路径上有多个客户端，则会使用最优先的客户端。<br> <code>spring-boot-starter-webflux</code> 启动器默认依赖 <code>io.projectreactor.netty:reactor-netty</code>，它同时提供服务器和客户端实现。如果选择将 Jetty 用作反应式服务器，则应添加对 Jetty Reactive HTTP 客户端库 <code>org.eclipse.jetty:jetty-reactive-httpclient</code> 的依赖。服务器和客户端使用相同的技术有其优势，因为它会在客户端和服务器之间自动共享 HTTP 资源。<br> 开发人员可以通过提供自定义的 <code>ReactorResourceFactory</code> 或 <code>JettyResourceFactory</code> Bean 来覆盖 Jetty 和 Reactor Netty 的资源配置，这将同时应用于客户端和服务器。<br> 如果您想覆盖客户端的选择，您可以定义自己的 <code>ClientHttpConnector</code> Bean，并完全控制客户端配置。<br> 有关<a href="https://docs.spring.io/spring-framework/reference/6.1/web/webflux-webclient/client-builder.html" rel="nofollow">WebClient 配置选项的更多信息</a>，请参阅 Spring Framework 参考文档。</p> 
<h5><a id="_WebClient_392"></a>自定义 WebClient</h5> 
<p>WebClient 自定义有三种主要方法，这取决于您希望自定义应用的范围有多大。<br> 要尽可能缩小自定义的范围，可注入自动配置的 <code>WebClient.Builder</code> 并根据需要调用其方法。<code>WebClient.Builder</code> 实例是有状态的： 对生成器的任何更改都会反映在随后用它创建的所有客户端中。如果想用同一个创建器创建多个客户端，也可以考虑用 <code>WebClient.Builder other = builder.clone();</code> 克隆创建器。<br> 要在整个应用程序中对所有 <code>WebClient.Builder</code> 实例进行添加式自定义，可以声明 <code>WebClientCustomizer</code> Bean，并在注入点本地更改 <code>WebClient.Builder</code>。<br> 最后，您可以回到原始 API，使用 <code>WebClient.create()</code>。在这种情况下，不会应用自动配置或 <code>WebClientCustomizer</code>。</p> 
<h5><a id="WebClient_SSL__397"></a>WebClient SSL 支持</h5> 
<p>如果需要在 <code>WebClient</code> 使用的 <code>ClientHttpConnector</code> 上自定义 SSL 配置，可以注入一个 <code>WebClientSsl</code> 实例，该实例可与构建器的应用方法一起使用。<br> <code>WebClientSsl</code> 接口可访问在 <code>application.properties</code> 或 <code>application.yaml</code> 文件中定义的任何 <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.ssl.bundles" rel="nofollow">SSL bundles</a>。<br> 以下代码展示了一个典型示例：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">reactor<span class="token punctuation">.</span>core<span class="token punctuation">.</span>publisher<span class="token punctuation">.</span></span><span class="token class-name">Mono</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">WebClientSsl</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>reactive<span class="token punctuation">.</span>function<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">WebClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">WebClient</span> webClient<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">WebClient<span class="token punctuation">.</span>Builder</span> webClientBuilder<span class="token punctuation">,</span> <span class="token class-name">WebClientSsl</span> ssl<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>webClient <span class="token operator">=</span> webClientBuilder<span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">"https://example.org"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>ssl<span class="token punctuation">.</span><span class="token function">fromBundle</span><span class="token punctuation">(</span><span class="token string">"mybundle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Details</span><span class="token punctuation">&gt;</span></span> <span class="token function">someRestCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>webClient<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">"/{name}/details"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">retrieve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bodyToMono</span><span class="token punctuation">(</span><span class="token class-name">Details</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="RestClient_423"></a>RestClient</h4> 
<p>如果您没有在应用程序中使用 Spring WebFlux 或 Project Reactor，我们建议您使用 <code>RestClient</code> 来调用远程 REST 服务。<br> <code>RestClient</code> 接口提供了功能型阻塞 API。<br> Spring Boot 会为您创建并预先配置一个 <code>RestClient.Builder</code> Bean 原型。强烈建议在您的组件中注入它，并用它来创建 <code>RestClient</code> 实例。Spring Boot 将使用 <code>HttpMessageConverters</code> 和适当的 <code>ClientHttpRequestFactory</code> 配置该构建器。<br> 以下代码展示了一个典型示例：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestClient</span> restClient<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">RestClient<span class="token punctuation">.</span>Builder</span> restClientBuilder<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restClient <span class="token operator">=</span> restClientBuilder<span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">"https://example.org"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Details</span> <span class="token function">someRestCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>restClient<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">"/{name}/details"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">retrieve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">Details</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_RestClient_447"></a>自定义 RestClient</h5> 
<p>对 <code>RestClient</code> 进行自定义有三种主要方法，这取决于您希望自定义应用的范围有多广。<br> 为了尽可能缩小定制的范围，可以注入自动配置的 <code>RestClient.Builder</code> 并根据需要调用它的方法。<code>RestClient.Builder</code> 实例是有状态的： 对生成器的任何更改都会反映在随后用它创建的所有客户端中。如果想用同一个创建器创建多个客户端，也可以考虑用 <code>RestClient.Builder other = builder.clone();</code> 克隆创建器。<br> 要在整个应用程序中对所有 <code>RestClient.Builder</code> 实例进行添加式自定义，可以声明 <code>RestClientCustomizer</code> Bean，并在注入时本地更改 <code>RestClient.Builder</code> 。<br> 最后，您可以回到原始 API，使用 <code>RestClient.create()</code>。在这种情况下，不会应用自动配置或 <code>RestClientCustomizer</code>。</p> 
<h5><a id="RestClient_SSL__452"></a>RestClient SSL 支持</h5> 
<p>如果需要在 <code>RestClient</code> 使用的 <code>ClientHttpRequestFactory</code> 上自定义 SSL 配置，可以注入一个 <code>RestClientSsl</code> 实例，该实例可与构建器的 apply 方法一起使用。<br> 通过 <code>RestClientSsl</code> 接口，可以访问在 <code>application.properties</code> 或 <code>application.yaml</code> 文件中定义的任何 <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.ssl.bundles" rel="nofollow">SSL bundles</a>。<br> 以下代码展示了一个典型示例：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClientSsl</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestClient</span> restClient<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">RestClient<span class="token punctuation">.</span>Builder</span> restClientBuilder<span class="token punctuation">,</span> <span class="token class-name">RestClientSsl</span> ssl<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restClient <span class="token operator">=</span> restClientBuilder<span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">"https://example.org"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>ssl<span class="token punctuation">.</span><span class="token function">fromBundle</span><span class="token punctuation">(</span><span class="token string">"mybundle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Details</span> <span class="token function">someRestCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>restClient<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">"/{name}/details"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">retrieve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">Details</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>如果除了 SSL bundle还需要应用其他自定义功能，可以使用 <code>ClientHttpRequestFactorySettings</code> 类和 <code>ClientHttpRequestFactories</code>：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">SslBundles</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">ClientHttpRequestFactories</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">ClientHttpRequestFactorySettings</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">ClientHttpRequestFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestClient</span> restClient<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">RestClient<span class="token punctuation">.</span>Builder</span> restClientBuilder<span class="token punctuation">,</span> <span class="token class-name">SslBundles</span> sslBundles<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ClientHttpRequestFactorySettings</span> settings <span class="token operator">=</span> <span class="token class-name">ClientHttpRequestFactorySettings</span><span class="token punctuation">.</span><span class="token constant">DEFAULTS</span>
            <span class="token punctuation">.</span><span class="token function">withReadTimeout</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMinutes</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withSslBundle</span><span class="token punctuation">(</span>sslBundles<span class="token punctuation">.</span><span class="token function">getBundle</span><span class="token punctuation">(</span><span class="token string">"mybundle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ClientHttpRequestFactory</span> requestFactory <span class="token operator">=</span> <span class="token class-name">ClientHttpRequestFactories</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restClient <span class="token operator">=</span> restClientBuilder<span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">"https://example.org"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">requestFactory</span><span class="token punctuation">(</span>requestFactory<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Details</span> <span class="token function">someRestCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>restClient<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">"/{name}/details"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">retrieve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">Details</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="RestTemplate_506"></a>RestTemplate</h4> 
<p>Spring Framework 的 <a href="https://docs.spring.io/spring-framework/docs/6.1.1/javadoc-api/org/springframework/web/client/RestTemplate.html" rel="nofollow">RestTemplate</a> 类早于 <code>RestClient</code>，是许多应用程序用来调用远程 REST 服务的经典方式。当你有不想迁移到 <code>RestClient</code> 的现有代码时，或者因为你已经熟悉了 <code>RestTemplate</code> API，你可能会选择使用 <code>RestTemplate</code>。<br> 由于 <code>RestTemplate</code> 实例在使用前通常需要自定义，因此 Spring Boot 并不提供任何单一的自动配置 <code>RestTemplate</code> Bean。不过，它确实自动配置了一个 <code>RestTemplateBuilder</code>，在需要时可用于创建 <code>RestTemplate</code> 实例。自动配置的 <code>RestTemplateBuilder</code> 可确保合理的 <code>HttpMessageConverters</code> 和适当的 <code>ClientHttpRequestFactory</code> 应用于 <code>RestTemplate</code> 实例。<br> 下面的代码展示了一个典型示例：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplateBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">RestTemplateBuilder</span> restTemplateBuilder<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restTemplate <span class="token operator">=</span> restTemplateBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Details</span> <span class="token function">someRestCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">"/{name}/details"</span><span class="token punctuation">,</span> <span class="token class-name">Details</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><code>RestTemplateBuilder</code> 包含许多有用的方法，可用于快速配置 <code>RestTemplate</code>。例如，要添加 BASIC 身份验证支持，可以使用 <code>builder.basicAuthentication("user", "password").build()</code>。</p> 
<h5><a id="_RestTemplate_531"></a>自定义 RestTemplate</h5> 
<p><code>RestTemplate</code> 定制有三种主要方法，这取决于您希望定制应用的范围有多大。<br> 为了尽可能缩小定制的范围，可以注入自动配置的 <code>RestTemplateBuilder</code>，然后根据需要调用它的方法。每次方法调用都会返回一个新的 <code>RestTemplateBuilder</code> 实例，因此定制只会影响到生成器的这次使用。<br> 要在整个应用程序中进行添加式自定义，请使用 <code>RestTemplateCustomizer</code> Bean。所有此类 Bean 都会自动注册到自动配置的 <code>RestTemplateBuilder</code> 中，并应用到使用它构建的任何模板中。<br> 下面的示例展示了一个自定义器，该自定义器可配置除 <code>192.168.0.5</code> 以外的所有主机使用代理：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hc<span class="token punctuation">.</span>client5<span class="token punctuation">.</span>http<span class="token punctuation">.</span>classic<span class="token punctuation">.</span></span><span class="token class-name">HttpClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hc<span class="token punctuation">.</span>client5<span class="token punctuation">.</span>http<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>classic<span class="token punctuation">.</span></span><span class="token class-name">HttpClientBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hc<span class="token punctuation">.</span>client5<span class="token punctuation">.</span>http<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>routing<span class="token punctuation">.</span></span><span class="token class-name">DefaultProxyRoutePlanner</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hc<span class="token punctuation">.</span>client5<span class="token punctuation">.</span>http<span class="token punctuation">.</span>routing<span class="token punctuation">.</span></span><span class="token class-name">HttpRoutePlanner</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hc<span class="token punctuation">.</span>core5<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hc<span class="token punctuation">.</span>core5<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hc<span class="token punctuation">.</span>core5<span class="token punctuation">.</span>http<span class="token punctuation">.</span>protocol<span class="token punctuation">.</span></span><span class="token class-name">HttpContext</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplateCustomizer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>http<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">HttpComponentsClientHttpRequestFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRestTemplateCustomizer</span> <span class="token keyword">implements</span> <span class="token class-name">RestTemplateCustomizer</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">customize</span><span class="token punctuation">(</span><span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HttpRoutePlanner</span> routePlanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CustomRoutePlanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">"proxy.example.com"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HttpClient</span> httpClient <span class="token operator">=</span> <span class="token class-name">HttpClientBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setRoutePlanner</span><span class="token punctuation">(</span>routePlanner<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        restTemplate<span class="token punctuation">.</span><span class="token function">setRequestFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpComponentsClientHttpRequestFactory</span><span class="token punctuation">(</span>httpClient<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">CustomRoutePlanner</span> <span class="token keyword">extends</span> <span class="token class-name">DefaultProxyRoutePlanner</span> <span class="token punctuation">{<!-- --></span>

        <span class="token class-name">CustomRoutePlanner</span><span class="token punctuation">(</span><span class="token class-name">HttpHost</span> proxy<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token class-name">HttpHost</span> <span class="token function">determineProxy</span><span class="token punctuation">(</span><span class="token class-name">HttpHost</span> target<span class="token punctuation">,</span> <span class="token class-name">HttpContext</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">HttpException</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"192.168.0.5"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">determineProxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>最后，您可以定义自己的 <code>RestTemplateBuilder</code> Bean。这样做将取代自动配置的生成器。如果你希望任何 <code>RestTemplateCustomizer</code> Bean 都能应用到你的自定义生成器，就像自动配置一样，请使用 <code>RestTemplateBuilderConfigurer</code> 对其进行配置。下面的示例展示了一个与 Spring Boot 自动配置相似的 <code>RestTemplateBuilder</code>，只不过还指定了自定义连接和读取超时：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplateBuilderConfigurer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplateBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRestTemplateBuilderConfiguration</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplateBuilder</span> <span class="token function">restTemplateBuilder</span><span class="token punctuation">(</span><span class="token class-name">RestTemplateBuilderConfigurer</span> configurer<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> configurer<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RestTemplateBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setReadTimeout</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>最极端（也很少使用）的选择是创建自己的 <code>RestTemplateBuilder</code> Bean，而不使用配置器。除了替换自动配置的生成器外，这还会阻止使用任何 <code>RestTemplateCustomizer</code> Bean。</p> 
<h5><a id="RestTemplate_SSL__598"></a>RestTemplate SSL 支持</h5> 
<p>如果需要在 <code>RestTemplate</code> 上自定义 SSL 配置，可以将 <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.ssl.bundles" rel="nofollow">SSL bundle</a>应用到 <code>RestTemplateBuilder</code>，如本示例所示：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>docs<span class="token punctuation">.</span>io<span class="token punctuation">.</span>restclient<span class="token punctuation">.</span>resttemplate<span class="token punctuation">.</span></span><span class="token class-name">Details</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">SslBundles</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplateBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">RestTemplateBuilder</span> restTemplateBuilder<span class="token punctuation">,</span> <span class="token class-name">SslBundles</span> sslBundles<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restTemplate <span class="token operator">=</span> restTemplateBuilder<span class="token punctuation">.</span><span class="token function">setSslBundle</span><span class="token punctuation">(</span>sslBundles<span class="token punctuation">.</span><span class="token function">getBundle</span><span class="token punctuation">(</span><span class="token string">"mybundle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Details</span> <span class="token function">someRestCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">"/{name}/details"</span><span class="token punctuation">,</span> <span class="token class-name">Details</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_RestClient__RestTemplate__HTTP__622"></a>检测 RestClient 和 RestTemplate 的 HTTP 客户端</h4> 
<p>Spring Boot 会根据应用程序类路径上可用的库，自动检测要与 <code>RestClient</code> 和 <code>RestTemplate</code> 一起使用的 HTTP 客户端。按优先级排序，支持以下客户端：</p> 
<ol><li>Apache HttpClient</li><li>Jetty HttpClient</li><li>OkHttp (deprecated)</li><li>Simple JDK client (HttpURLConnection)</li></ol> 
<p>如果类路径上有多个客户端，将使用最优先的客户端。</p> 
<h3><a id="Web_Services_631"></a>Web Services</h3> 
<p>Spring Boot 提供 Web 服务自动配置功能，因此只需定义端点即可。<br> 使用 <code>spring-boot-starter-webservices</code> 模块可以轻松访问 <a href="https://docs.spring.io/spring-ws/docs/4.0.8/reference/html/" rel="nofollow">Spring Web 服务功能</a>。<br> 可以分别为 WSDL 和 XSD 自动创建 <code>SimpleWsdl11Definition</code> 和 <code>SimpleXsdSchema</code> Bean。为此，请配置它们的位置，如下例所示：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">webservices</span><span class="token punctuation">:</span>
    <span class="token key atrule">wsdl-locations</span><span class="token punctuation">:</span> <span class="token string">"classpath:/wsdl"</span>
</code></pre> 
<h4><a id="_WebServiceTemplate__640"></a>使用 WebServiceTemplate 调用网络服务</h4> 
<p>如果需要从应用程序中调用远程 Web 服务，可以使用 <a href="https://docs.spring.io/spring-ws/docs/4.0.8/reference/html/#client-web-service-template" rel="nofollow">WebServiceTemplate</a> 类。由于 <code>WebServiceTemplate</code> 实例在使用前通常需要自定义，因此 Spring Boot 并不提供任何单一的自动配置 <code>WebServiceTemplate</code> Bean。不过，它确实自动配置了一个 <code>WebServiceTemplateBuilder</code>，可用于在需要时创建 <code>WebServiceTemplate</code> 实例。<br> 下面的代码展示了一个典型示例：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>webservices<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">WebServiceTemplateBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>client<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">WebServiceTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>soap<span class="token punctuation">.</span>client<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">SoapActionCallback</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">WebServiceTemplate</span> webServiceTemplate<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token class-name">WebServiceTemplateBuilder</span> webServiceTemplateBuilder<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>webServiceTemplate <span class="token operator">=</span> webServiceTemplateBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">SomeResponse</span> <span class="token function">someWsCall</span><span class="token punctuation">(</span><span class="token class-name">SomeRequest</span> detailsReq<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">SomeResponse</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>webServiceTemplate<span class="token punctuation">.</span><span class="token function">marshalSendAndReceive</span><span class="token punctuation">(</span>detailsReq<span class="token punctuation">,</span>
                                                                            <span class="token keyword">new</span> <span class="token class-name">SoapActionCallback</span><span class="token punctuation">(</span><span class="token string">"https://ws.example.com/action"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>默认情况下，<code>WebServiceTemplateBuilder</code> 会使用类路径上可用的 HTTP 客户端库检测合适的基于 HTTP 的 <code>WebServiceMessageSender</code>。您还可以按如下方式自定义读取和连接超时：</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>webservices<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">HttpWebServiceMessageSenderBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>webservices<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">WebServiceTemplateBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>client<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">WebServiceTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>transport<span class="token punctuation">.</span></span><span class="token class-name">WebServiceMessageSender</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyWebServiceTemplateConfiguration</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">WebServiceTemplate</span> <span class="token function">webServiceTemplate</span><span class="token punctuation">(</span><span class="token class-name">WebServiceTemplateBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">WebServiceMessageSender</span> sender <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpWebServiceMessageSenderBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setReadTimeout</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">messageSenders</span><span class="token punctuation">(</span>sender<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_JTA__690"></a>使用 JTA 进行分布式事务处理</h3> 
<p>Spring Boot 通过使用从 JNDI 获取的事务管理器，支持跨多个 XA 资源的分布式 JTA 事务。<br> 检测到 JTA 环境时，Spring 的 <code>JtaTransactionManager</code> 将用于管理事务。自动配置的 JMS、DataSource 和 JPA Bean 会升级以支持 XA 事务。您可以使用 <code>@Transactional</code> 等标准 Spring 惯用语参与分布式事务。如果您在 JTA 环境中，但仍想使用本地事务，可以将 <code>spring.jta.enabled</code> 属性设置为 <code>false</code>，以禁用 JTA 自动配置。</p> 
<h4><a id="_Jakarta_EE__693"></a>使用 Jakarta EE 托管事务管理器</h4> 
<p>如果将 Spring Boot 应用程序打包为 war 或 ear 文件并部署到 Jakarta EE 应用程序服务器，就可以使用应用程序服务器的内置事务管理器。Spring Boot 会通过查看常见的 JNDI 位置（<code>java:comp/UserTransaction</code>、<code>java:comp/TransactionManager</code> 等）来自动配置事务管理器。在使用应用服务器提供的事务服务时，您通常还希望确保所有资源都由服务器管理并通过 JNDI 公开。Spring Boot 会尝试通过在 JNDI 路径（<code>java:/JmsXA</code> 或 <code>java:/XAConnectionFactory</code>）中查找 <code>ConnectionFactory</code> 来自动配置 JMS，您可以使用 <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/data.html#data.sql.datasource.jndi" rel="nofollow">spring.datasource.jndi-name 属性</a>来配置您的数据源。</p> 
<h4><a id="_XA__XA_JMS__695"></a>混合 XA 和非 XA JMS 连接</h4> 
<p>使用 JTA 时，主 JMS <code>ConnectionFactory</code> Bean 是 XA 感知的，并参与分布式事务。您无需使用任何 <code>@Qualifier</code> 即可注入您的 Bean：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">MyBean</span><span class="token punctuation">(</span><span class="token class-name">ConnectionFactory</span> connectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在某些情况下，您可能希望使用非 XA <code>ConnectionFactory</code> 来处理某些 JMS 消息。例如，您的 JMS 处理逻辑可能需要比 XA 超时更长的时间。<br> 如果您想使用非 XA <code>ConnectionFactory</code>，可以使用 <code>nonXaJmsConnectionFactory</code> Bean：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">MyBean</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"nonXaJmsConnectionFactory"</span><span class="token punctuation">)</span> <span class="token class-name">ConnectionFactory</span> connectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>为保持一致性，还使用 bean 别名 <code>xaJmsConnectionFactory</code> 来提供 <code>jmsConnectionFactory</code> bean：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">MyBean</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"xaJmsConnectionFactory"</span><span class="token punctuation">)</span> <span class="token class-name">ConnectionFactory</span> connectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_715"></a>支持嵌入式事务管理器</h4> 
<p><a href="https://github.com/spring-projects/spring-boot/tree/v3.2.0/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jms/XAConnectionFactoryWrapper.java">XAConnectionFactoryWrapper</a> 和 <a href="https://github.com/spring-projects/spring-boot/tree/v3.2.0/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jdbc/XADataSourceWrapper.java">XADataSourceWrapper</a> 接口可用于支持嵌入式事务管理器。这些接口负责封装 <code>XAConnectionFactory</code> 和 <code>XADataSource</code> Bean，并将它们作为常规 <code>ConnectionFactory</code> 和 <code>DataSource</code> Bean 公开，这些 Bean 会以透明方式加入分布式事务。数据源和 JMS 自动配置使用 JTA 变体，前提是您在 <code>ApplicationContext</code> 中注册了 <code>JtaTransactionManager</code> Bean 和适当的 XA 封装 Bean。</p>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/25c5aa6da41f771354b027f70fb11421/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">swift-碰到的问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e7175d57fd7f6dc95abffc6da83efe41/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">互联网加竞赛 基于Django与深度学习的股票预测系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>