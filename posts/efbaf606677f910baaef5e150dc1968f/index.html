<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Docker Swarm集群管理 - 编程爱好者博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Docker Swarm集群管理" />
<meta property="og:description" content="文章目录 1. 简介2. 架构3. Swarm的核心概念2.1 集群2.2 节点2.3 服务和任务2.4 负载均衡 4. Swarm的工作模式4.1 node4.2 Service4.3 任务与调度4.4 服务副本与全局服务 5. Swarm的调度策略6. Swarm Cluster模式特性7. Swarm安装8. Swarm集群搭建8.1 创建新集群8.2 查看集群状态和节点信息8.3 添加工作节点到集群8.4 更改节点的availablity状态8.5 发布服务到集群8.6 在Swarm中动态扩展服务(scale)8.7 更新服务8.8 节点管理 1. 简介 Swarm是Docker公司推出的用来管理docker集群的平台，几乎全部用GO语言来完成的开发的，代码开源在https://github.com/docker/swarm， 它是将一群Docker宿主机变成一个单一的虚拟主机，Swarm使用标准的Docker API接口作为其前端的访问入口，换言之，各种形式的Docker
Client(compose,docker-py等)均可以直接与Swarm通信，甚至Docker本身都可以很容易的与Swarm集成，这大大方便了用户将原本基于单节点的系统移植到Swarm上，同时Swarm内置了对Docker网络插件的支持，用户也很容易的部署跨主机的容器集群服务。
Docker Swarm 和 Docker Compose 一样，都是 Docker 官方容器编排项目，但不同的是，Docker Compose 是一个在单个服务器或主机上创建多个容器的工具，而 Docker Swarm 则可以在多个服务器或主机上创建容器集群服务，对于微服务的部署，显然 Docker Swarm 会更加适合。
从 Docker 1.12.0 版本开始，Docker Swarm 已经包含在 Docker 引擎中（docker swarm），并且已经内置了服务发现工具，我们就不需要像之前一样，再配置 Etcd 或者 Consul 来进行服务发现配置了。
Swarm deamon只是一个调度器(Scheduler)加路由器(router),Swarm自己不运行容器，它只是接受Docker客户端发来的请求，调度适合的节点来运行容器，这就意味着，即使Swarm由于某些原因挂掉了，集群中的节点也会照常运行，放Swarm重新恢复运行之后，他会收集重建集群信息。
2. 架构 docker swarm是docker官方提供的一套容器编排系统，是Docker公司推出的官方容器集群平台。基于 Go语言实现。它的架构如下:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bchobby.github.io/posts/efbaf606677f910baaef5e150dc1968f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-27T13:20:53+08:00" />
<meta property="article:modified_time" content="2020-11-27T13:20:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程爱好者博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程爱好者博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Docker Swarm集群管理</h1>
			
		</header>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#1__1" rel="nofollow">1. 简介</a></li><li><a href="#2__12" rel="nofollow">2. 架构</a></li><li><a href="#3_Swarm_20" rel="nofollow">3. Swarm的核心概念</a></li><li><ul><li><a href="#21__21" rel="nofollow">2.1 集群</a></li><li><a href="#22__26" rel="nofollow">2.2 节点</a></li><li><a href="#23__33" rel="nofollow">2.3 服务和任务</a></li><li><a href="#24__56" rel="nofollow">2.4 负载均衡</a></li></ul> 
    </li><li><a href="#4_Swarm_62" rel="nofollow">4. Swarm的工作模式</a></li><li><ul><li><a href="#41_node_63" rel="nofollow">4.1 node</a></li><li><a href="#42_Service_65" rel="nofollow">4.2 Service</a></li><li><a href="#43__67" rel="nofollow">4.3 任务与调度</a></li><li><a href="#44__70" rel="nofollow">4.4 服务副本与全局服务</a></li></ul> 
    </li><li><a href="#5_Swarm_73" rel="nofollow">5. Swarm的调度策略</a></li><li><a href="#6_Swarm_Cluster_87" rel="nofollow">6. Swarm Cluster模式特性</a></li><li><a href="#7_Swarm_117" rel="nofollow">7. Swarm安装</a></li><li><a href="#8_Swarm_132" rel="nofollow">8. Swarm集群搭建</a></li><li><ul><li><a href="#81__138" rel="nofollow">8.1 创建新集群</a></li><li><a href="#82__164" rel="nofollow">8.2 查看集群状态和节点信息</a></li><li><a href="#83__251" rel="nofollow">8.3 添加工作节点到集群</a></li><li><a href="#84_availablity_285" rel="nofollow">8.4 更改节点的availablity状态</a></li><li><a href="#85__311" rel="nofollow">8.5 发布服务到集群</a></li><li><a href="#86_Swarmscale_396" rel="nofollow">8.6 在Swarm中动态扩展服务(scale)</a></li><li><a href="#87__421" rel="nofollow">8.7 更新服务</a></li><li><a href="#88__448" rel="nofollow">8.8 节点管理</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="1__1"></a>1. 简介</h4> 
<p>Swarm是Docker公司推出的用来管理docker集群的平台，几乎全部用GO语言来完成的开发的，代码开源在https://github.com/docker/swarm， 它是将一群Docker宿主机变成一个单一的虚拟主机，Swarm使用标准的Docker API接口作为其前端的访问入口，换言之，各种形式的Docker</p> 
<p>Client(compose,docker-py等)均可以直接与Swarm通信，甚至Docker本身都可以很容易的与Swarm集成，这大大方便了用户将原本基于单节点的系统移植到Swarm上，同时Swarm内置了对Docker网络插件的支持，用户也很容易的部署跨主机的容器集群服务。</p> 
<p>Docker Swarm 和 Docker Compose 一样，都是 Docker 官方容器编排项目，但不同的是，Docker Compose 是一个在单个服务器或主机上创建多个容器的工具，而 Docker Swarm 则可以在多个服务器或主机上创建容器集群服务，对于微服务的部署，显然 Docker Swarm 会更加适合。</p> 
<p>从 Docker 1.12.0 版本开始，Docker Swarm 已经包含在 Docker 引擎中（docker swarm），并且已经内置了服务发现工具，我们就不需要像之前一样，再配置 Etcd 或者 Consul 来进行服务发现配置了。</p> 
<p>Swarm deamon只是一个调度器(Scheduler)加路由器(router),Swarm自己不运行容器，它只是接受Docker客户端发来的请求，调度适合的节点来运行容器，这就意味着，即使Swarm由于某些原因挂掉了，集群中的节点也会照常运行，放Swarm重新恢复运行之后，他会收集重建集群信息。</p> 
<h4><a id="2__12"></a>2. 架构</h4> 
<p>docker swarm是docker官方提供的一套容器编排系统，是Docker公司推出的官方容器集群平台。基于 Go语言实现。它的架构如下:</p> 
<p><img src="https://images2.imgbox.com/38/d7/E31sip88_o.png" alt="在这里插入图片描述"></p> 
<p>在结构图可以看出 Docker Client使用Swarm对 集群(Cluster)进行调度使用。<br> Swarm是典型的master-slave结构，通过发现服务来选举manager。manager是中心管理节点，各个node上运行agent接受manager的统一管理，集群会自动通过Raft协议分布式选举出manager节点，无需额外的发现服务支持，避免了单点的瓶颈问题，同时也内置了DNS的负载均衡和对外部负载均衡机制的集成支持</p> 
<h4><a id="3_Swarm_20"></a>3. Swarm的核心概念</h4> 
<h5><a id="21__21"></a>2.1 集群</h5> 
<p>一个集群由多个 Docker 主机组成，这些Docker主机以集群模式运行，并充当管理者(用于管理 成员资格和委派)和工作人员(运行集群服务)<br> 与独立容器相比，集群服务的主要优势之一是，可以修改服务的配置，包括它所连接的网络和卷， 而无需手动重新启动服务。<br> 独立容器和集群服务之间的主要区别在于，只有集群管理器可以管理集群，而独立容器可以在任何 守护程序上启动。<br> 集群的管理和编排是使用嵌入docker引擎的SwarmKit，可以在docker初始化时启动swarm模式或者加入已存在的swarm</p> 
<h5><a id="22__26"></a>2.2 节点</h5> 
<p>swarm是一系列节点的集合，而节点可以是一台裸机或者一台虚拟机。一个节点能扮演一个或者两个角色，manager或者worker，一个节点是docker引擎集群的一个实例。您还可以将其视为Docker节点。您可以在单个物理计算机或云服务器上运行一个或多个节点，但生产群集部署通常包括分布在多个物理和云计算机上的Docker节点。要将应用程序部署到swarm，请将服务定义提交给 管理器节点。管理器节点将称为任务的工作单元分派 给工作节点。</p> 
<ul><li>manager节点<br> Docker Swarm集群需要至少一个manager节点，节点之间使用 进 行协同工作。 通常，第一个启用docker swarm的节点将成为leader，后来加入的都是follower。 当前的leader如果挂掉，剩余的节点将重新选举出一个新的leader。 每一个manager都有一个完 整的当前集群状态的副本，可以保证manager的高可用</li><li>worker节点<br> worker节点是运行实际应用服务的容器所在的地方。理论上，一个manager节点也能同时成为 worker节点，但在生产环境中，我们不建议这样做。 worker节点之间，通过 control plane 进 行通信，这种通信使用 gossip 协议，并且是异步的</li></ul> 
<h5><a id="23__33"></a>2.3 服务和任务</h5> 
<p>集群中的stacks, services, tasks的关系，如下图:</p> 
<p><img src="https://images2.imgbox.com/49/16/8WPbl2Ui_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p>services(服务)<br> swarm service是一个抽象的概念，它只是一个对运行在swarm集群上的应用服务，所期望状态的描述。它就像一个描述了下面物品的清单列表一样:</p> 
  <ol><li>服务名称</li><li>使用哪个镜像来创建容器</li><li>要运行多少个副本</li><li>服务的容器要连接到哪个网络上</li><li>应该映射哪些端口</li></ol> </li><li> <p>task(任务)<br> 在Docker Swarm中，task是一个部署的最小单元，task与容器是一对一的关系</p> </li><li> <p>stack(栈)<br> stack是描述一系列相关services的集合。我们通过在一个YAML文件中来定义一个stack</p> </li><li> <p>操作命令：<br> docker swarm：集群管理，子命令有init, join, leave, update。（docker swarm --help查看帮助）<br> docker service：服务创建，子命令有create, inspect, update, remove, tasks。（docker service–help查看帮助）<br> docker node：节点管理，子命令有accept, promote, demote, inspect, update, tasks, ls, rm。（docker node --help查看帮助）</p> </li></ul> 
<h5><a id="24__56"></a>2.4 负载均衡</h5> 
<p>集群管理器使用入口负载平衡将要从集群外部获取的服务公开给集群。<br> 集群管理器可以自动为服务分配一个已发布端口，也可以为该服务配置一个已发布端口。<br> 可以指定任何未使用的端口。如果未指定端口，则集群管理器会为服务分配 30000-32767 范围内 的端口。<br> 集群模式具有一个内部DNS组件，该组件自动为群集中的每个服务分配一个DNS条目。 集群管理器使用内部负载平衡根据服务的DNS名称在群集内的服务之间分配请求。</p> 
<h4><a id="4_Swarm_62"></a>4. Swarm的工作模式</h4> 
<h5><a id="41_node_63"></a>4.1 node</h5> 
<p><img src="https://images2.imgbox.com/3f/35/puXpYyEh_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="42_Service_65"></a>4.2 Service</h5> 
<p><img src="https://images2.imgbox.com/be/1a/z2XoDduo_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="43__67"></a>4.3 任务与调度</h5> 
<p><img src="https://images2.imgbox.com/c4/4c/MPOTb8M1_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="44__70"></a>4.4 服务副本与全局服务</h5> 
<p><img src="https://images2.imgbox.com/05/c1/yBwn5xiZ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="5_Swarm_73"></a>5. Swarm的调度策略</h4> 
<p>Swarm在调度(scheduler)节点（leader节点）运行容器的时候，会根据指定的策略来计算最适合运行容器的节点，目前支持的策略有：spread, binpack, random.<br> 1）Random<br> 顾名思义，就是随机选择一个Node来运行容器，一般用作调试用，spread和binpack策略会根据各个节点的可用的CPU, RAM以及正在运<br> 行的容器的数量来计算应该运行容器的节点。</p> 
<p>2）Spread<br> 在同等条件下，Spread策略会选择运行容器最少的那台节点来运行新的容器，binpack策略会选择运行容器最集中的那台机器来运行新的节点。<br> 使用Spread策略会使得容器会均衡的分布在集群中的各个节点上运行，一旦一个节点挂掉了只会损失少部分的容器。</p> 
<p>3）Binpack<br> Binpack策略最大化的避免容器碎片化，就是说binpack策略尽可能的把还未使用的节点留给需要更大空间的容器运行，尽可能的把容器运行在<br> 一个节点上面。</p> 
<h4><a id="6_Swarm_Cluster_87"></a>6. Swarm Cluster模式特性</h4> 
<ol><li> <p>批量创建服务<br> 建立容器之前先创建一个overlay的网络，用来保证在不同主机上的容器网络互通的网络模式</p> </li><li> <p>强大的集群的容错性<br> 当容器副本中的其中某一个或某几个节点宕机后，cluster会根据自己的服务注册发现机制，以及之前设定的值–replicas n，在集群中剩余的空闲节点上，重新拉起容器副本。整个副本迁移的过程无需人工干预，迁移后原本的集群的load balance依旧好使！不难看出，docker service其实不仅仅是批量启动服务这么简单，而是在集群中定义了一种状态。Cluster会持续检测服务的健康状态并维护集群的高可用性。</p> </li><li> <p>服务节点的可扩展性<br> Swarm Cluster不光只是提供了优秀的高可用性，同时也提供了节点弹性扩展或缩减的功能。当容器组想动态扩展时，只需通过scale参数即可复制出新的副本出来。</p> </li></ol> 
<p>仔细观察的话，可以发现所有扩展出来的容器副本都run在原先的节点下面，如果有需求想在每台节点上都run一个相同的副本，方法其实很简单，只需要在命令中将"–replicas n"更换成"–mode=global"即可！</p> 
<ul><li> <p>复制服务（–replicas n）<br> 将一系列复制任务分发至各节点当中，具体取决于您所需要的设置状态，例如“–replicas 3”。</p> </li><li> <p>全局服务（–mode=global）<br> 适用于集群内全部可用节点上的服务任务，例如“–mode global”。如果大家在 Swarm 集群中设有 7 台 Docker 节点，则全部节点之上都将存在对应容器。</p> </li></ul> 
<ol start="4"><li>调度机制<br> 所谓的调度其主要功能是cluster的server端去选择在哪个服务器节点上创建并启动一个容器实例的动作。它是由一个装箱算法和过滤器组合而成。每次通过过滤器（constraint）启动容器的时候，swarm cluster 都会调用调度机制筛选出匹配约束条件的服务器，并在这上面运行容器。</li></ol> 
<p>------------------Swarm cluster的创建过程包含以下三个步骤----------------------<br> 1）发现Docker集群中的各个节点，收集节点状态、角色信息，并监视节点状态的变化<br> 2）初始化内部调度（scheduler）模块<br> 3）创建并启动API监听服务模块</p> 
<p>一旦创建好这个cluster，就可以用命令docker service批量对集群内的容器进行操作，非常方便！</p> 
<p>在启动容器后，docker 会根据当前每个swarm节点的负载判断，在负载最优的节点运行这个task任务，用"docker service ls" 和"docker service ps + taskID"可以看到任务运行在哪个节点上。容器启动后，有时需要等待一段时间才能完成容器创建。</p> 
<h4><a id="7_Swarm_117"></a>7. Swarm安装</h4> 
<p>对于Docker 1.12+版本，Swarm相关命令已经原生嵌入到了Docker Engine中</p> 
<ol><li>下载镜像</li></ol> 
<pre><code class="prism language-bash">docker pull swarm
</code></pre> 
<ol start="2"><li>启动并查看版本</li></ol> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker run --rm swarm -v</span>
swarm version 1.2.9 <span class="token punctuation">(</span>527a849<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8_Swarm_132"></a>8. Swarm集群搭建</h4> 
<p>IP：47.94.80.41 担任角色：swarm manager</p> 
<p>IP：81.71.31.82 担任角色：swarm node</p> 
<h5><a id="81__138"></a>8.1 创建新集群</h5> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker swarm init --advertise-addr 47.94.80.41</span>
Swarm initialized: current node <span class="token punctuation">(</span>12qrxc743nsmot0to9c30gdom<span class="token punctuation">)</span> is now a manager.

To add a worker to this swarm, run the following command:

    docker swarm <span class="token function">join</span> --token SWMTKN-1-338uighxv8q7j8gyt4quhcoderb267liiate5r4zgihusehx6d-b5daif7ggwtbx4mizn60s5uoo 47.94.80.41:2377

To add a manager to this swarm, run <span class="token string">'docker swarm join-token manager'</span> and follow the instructions.

<span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker swarm join-token manager</span>
To add a manager to this swarm, run the following command:

    docker swarm <span class="token function">join</span> --token SWMTKN-1-338uighxv8q7j8gyt4quhcoderb267liiate5r4zgihusehx6d-61um2v2l3cmsqd2tel6qeswhl 47.94.80.41:2377

<span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># </span>
<span class="token comment"># 将节点强制驱除集群</span>
docker swarm leave --force
</code></pre> 
<p>上面命令执行后，该机器自动加入到swarm集群。这个会创建一个集群token，获取全球唯一的 token，作为集群唯一标识。后续将其他节点加入集群都会用到这个token值。<br> 其中，–advertise-addr参数表示其它swarm中的worker节点使用此ip地址与manager联系。命令的输 出包含了其它节点如何加入集群的命令。</p> 
<p>docker swarm join-token manager 命令会返回一个加入此集群并且角色为manager的执行命令。</p> 
<h5><a id="82__164"></a>8.2 查看集群状态和节点信息</h5> 
<p>查看集群状态</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker info</span>
Client:
 Debug Mode: <span class="token boolean">false</span>

Server:
 Containers: 2
  Running: 0
  Paused: 0
  Stopped: 2
 Images: 4
 Server Version: 19.03.13
 Storage Driver: overlay2
  Backing Filesystem: extfs
  Supports d_type: <span class="token boolean">true</span>
  Native Overlay Diff: <span class="token boolean">true</span>
 Logging Driver: json-file
 Cgroup Driver: cgroupfs
 Plugins:
  Volume: local
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog
 Swarm: active
  NodeID: 12qrxc743nsmot0to9c30gdom
  Is Manager: <span class="token boolean">true</span>
  ClusterID: y4z9r0j2qjpws7ot7dkzxpyvx
  Managers: 1
  Nodes: 1
  Default Address Pool: 10.0.0.0/8  
  SubnetSize: 24
  Data Path Port: 4789
  Orchestration:
   Task History Retention Limit: 5
  Raft:
   Snapshot Interval: 10000
   Number of Old Snapshots to Retain: 0
   Heartbeat Tick: 1
   Election Tick: 10
  Dispatcher:
   Heartbeat Period: 5 seconds
  CA Configuration:
   Expiry Duration: 3 months
   Force Rotate: 0
  Autolock Managers: <span class="token boolean">false</span>
  Root Rotation In Progress: <span class="token boolean">false</span>
  Node Address: 47.94.80.41
  Manager Addresses:
   47.94.80.41:2377
 Runtimes: runc
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 8fba4e9a7d01810a393d5d25a3621dc101981175
 runc version: dc9208a3303feef5b3839f4323d9beb36df0a9dd
 init version: fec3683
 Security Options:
  seccomp
   Profile: default
 Kernel Version: 3.10.0-957.21.3.el7.x86_64
 Operating System: CentOS Linux 7 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
 OSType: linux
 Architecture: x86_64
 CPUs: 2
 Total Memory: 3.518GiB
 Name: rpp
 ID: X3TD:OYHI:XAXO:NS45:GOWN:XQ3T:B7I2:4OTR:6FJX:43RB:272K:TC67
 Docker Root Dir: /var/lib/docker
 Debug Mode: <span class="token boolean">false</span>
 Registry: https://index.docker.io/v1/
 Labels:
 Experimental: <span class="token boolean">false</span>
 Insecure Registries:
  127.0.0.0/8
 Registry Mirrors:
  https://registry.docker-cn.com/
 Live Restore Enabled: <span class="token boolean">false</span>
</code></pre> 
<p>查看节点信息</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker node ls</span>
ID                            HOSTNAME            STATUS              AVAILABILITY        MANAGER STATUS      ENGINE VERSION
12qrxc743nsmot0to9c30gdom *   rpp                 Ready               Active              Leader              19.03.13
</code></pre> 
<h5><a id="83__251"></a>8.3 添加工作节点到集群</h5> 
<p>创建了一个集群与管理器节点，就可以添加工作节点。<br> 在工作节点81.71.31.82上安装docker和docker swarm</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@VM-0-14-centos ~<span class="token punctuation">]</span><span class="token comment"># docker swarm join --token SWMTKN-1-338uighxv8q7j8gyt4quhcoderb267liiate5r4zgihusehx6d-b5daif7ggwtbx4mizn60s5uoo 47.94.80.41:2377</span>
This node joined a swarm as a worker.
<span class="token comment"># 将节点强制驱除集群</span>
docker swarm leave --force
</code></pre> 
<p>如果忘记了token的值，在管理节点47.94.80.41上执行如下命令</p> 
<pre><code class="prism language-bash"><span class="token comment">#在管理者节点上写</span>
<span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker swarm join-token manager</span>
To add a manager to this swarm, run the following command:

    docker swarm <span class="token function">join</span> --token SWMTKN-1-338uighxv8q7j8gyt4quhcoderb267liiate5r4zgihusehx6d-61um2v2l3cmsqd2tel6qeswhl 47.94.80.41:2377

<span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker swarm join-token worker</span>
To add a worker to this swarm, run the following command:

    docker swarm <span class="token function">join</span> --token SWMTKN-1-338uighxv8q7j8gyt4quhcoderb267liiate5r4zgihusehx6d-b5daif7ggwtbx4mizn60s5uoo 47.94.80.41:2377
</code></pre> 
<p>在管理节点上再次查看节点信息，可以看到集群中有两个节点</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker node ls</span>
ID                            HOSTNAME            STATUS              AVAILABILITY        MANAGER STATUS      ENGINE VERSION
iwaoag19d91jmq3tdn5yjp36h     VM-0-14-centos      Ready               Active                                  19.03.13
12qrxc743nsmot0to9c30gdom *   rpp                 Ready               Active              Leader              19.03.13
</code></pre> 
<h5><a id="84_availablity_285"></a>8.4 更改节点的availablity状态</h5> 
<p>swarm集群中node的availability状态可以为 active或者drain，其中：<br> active状态下，node可以接受来自manager节点的任务分派；<br> drain状态下，node节点会结束task，且不再接受来自manager节点的任务分派（也就是下线节点）</p> 
<pre><code class="prism language-bash"> <span class="token comment"># 将VM-0-14-centos节点下线。如果要删除节点，命令是"docker node rm --force VM-0-14-centos"</span>
<span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker node update --availability drain VM-0-14-centos</span>
VM-0-14-centos
<span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker node ls</span>
ID                            HOSTNAME            STATUS              AVAILABILITY        MANAGER STATUS      ENGINE VERSION
iwaoag19d91jmq3tdn5yjp36h     VM-0-14-centos      Ready               Drain                                   19.03.13
12qrxc743nsmot0to9c30gdom *   rpp                 Ready               Active              Leader              19.03.13
</code></pre> 
<p>如上，当VM-0-14-centos的状态改为drain后，那么该节点就不会接受task任务分发，就算之前已经接受的任务也会转移到别的节点上。<br> 再次修改为active状态（及将下线的节点再次上线）</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker node update --availability active VM-0-14-centos</span>
VM-0-14-centos
<span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker node ls</span>
ID                            HOSTNAME            STATUS              AVAILABILITY        MANAGER STATUS      ENGINE VERSION
iwaoag19d91jmq3tdn5yjp36h     VM-0-14-centos      Ready               Active                                  19.03.13
12qrxc743nsmot0to9c30gdom *   rpp                 Ready               Active              Leader              19.03.13
</code></pre> 
<h5><a id="85__311"></a>8.5 发布服务到集群</h5> 
<ol><li>部署服务</li></ol> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service create -p 80:80 --replicas 2 --name nginx1 nginx</span>
tp23jh5n17n3ia0ayvdw5mabh
overall progress: 2 out of 2 tasks 
1/2: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
2/2: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
verify: Service converged 
</code></pre> 
<p>-p :端口映射 --replicas:运行实例个数 --name:服务名 nginx : 镜像</p> 
<ol start="2"><li>使用 docker service ls 查看正在运行服务的列表</li></ol> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service ls</span>
ID                  NAME                MODE                REPLICAS            IMAGE               PORTS
tp23jh5n17n3        nginx1              replicated          2/2                 nginx:latest        *:80-<span class="token operator">&gt;</span>80/tcp
</code></pre> 
<ol start="3"><li>详细查询Swarm中服务的信息<br> -pretty 使命令输出格式化为可读的格式，不加 --pretty 可以输出更详细的信息：</li></ol> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service inspect --pretty nginx1</span>

ID:             tp23jh5n17n3ia0ayvdw5mabh
Name:           nginx1
Service Mode:   Replicated
 Replicas:      2
Placement:
UpdateConfig:
 Parallelism:   1
 On failure:    pause
 Monitoring Period: 5s
 Max failure ratio: 0
 Update order:      stop-first
RollbackConfig:
 Parallelism:   1
 On failure:    pause
 Monitoring Period: 5s
 Max failure ratio: 0
 Rollback order:    stop-first
ContainerSpec:
 Image:         nginx:latest@sha256:6b1daa9462046581ac15be20277a7c75476283f969cb3a61c8725ec38d3b01c3
 Init:          <span class="token boolean">false</span>
Resources:
Endpoint Mode:  vip
Ports:
 PublishedPort <span class="token operator">=</span> 80
  Protocol <span class="token operator">=</span> tcp
  TargetPort <span class="token operator">=</span> 80
  PublishMode <span class="token operator">=</span> ingress 
</code></pre> 
<ol start="4"><li>查看哪些节点正在运行服务</li></ol> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service ps nginx1</span>
ID                  NAME                IMAGE               NODE                DESIRED STATE       CURRENT STATE           ERROR               PORTS
uoqitrznmx21        nginx1.1            nginx:latest        rpp                 Running             Running 4 minutes ago                       
zcj5f53j3vel        nginx1.2            nginx:latest        VM-0-14-centos      Running             Running 5 minutes ago    
</code></pre> 
<p>由上面命令可知，该服务在两个节点上运行。登陆节点，可以查看到nginx容器在运行中</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
27aa9f567b0c        nginx:latest        <span class="token string">"/docker-entrypoint.…"</span>   7 minutes ago       Up 7 minutes        80/tcp              nginx1.1.uoqitrznmx21df630ca32172m
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@VM-0-14-centos ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                            NAMES
ec6f01d2f32c        nginx:latest        <span class="token string">"/docker-entrypoint.…"</span>   7 minutes ago       Up 7 minutes        80/tcp                           nginx1.2.zcj5f53j3vel1xmq7aceouqh1
3e71906885bb        nginx               <span class="token string">"/docker-entrypoint.…"</span>   46 hours ago        Up 46 hours         80/tcp, 0.0.0.0:8080-<span class="token operator">&gt;</span>8080/tcp   webserver
</code></pre> 
<p>注意：以上命令均在管理节点上运行</p> 
<ol start="5"><li>停止并删除发布的服务</li></ol> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service rm nginx1</span>
nginx1
</code></pre> 
<h5><a id="86_Swarmscale_396"></a>8.6 在Swarm中动态扩展服务(scale)</h5> 
<p>当然，如果只是通过service启动容器，swarm也算不上什么新鲜东西了。Service还提供了复制（类似kubernetes里的副本）功能。可以通过 docker service scale 命令来设置服务中容器的副本数<br> 比如将上面的nginx1容器动态扩展到3个</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service scale nginx1=3</span>
nginx1 scaled to 3
overall progress: 3 out of 3 tasks 
1/3: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
2/3: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
3/3: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
verify: Service converged 
</code></pre> 
<p>和创建服务一样，增加scale数之后，将会创建新的容器，这些新启动的容器也会经历从准备到运行的过程，过一分钟左右，服务应该就会启动完成，这时候可以再来看一下 nginx 服务中的容器</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service ls</span>
ID                  NAME                MODE                REPLICAS            IMAGE               PORTS
rb95k2qvxe79        nginx1              replicated          3/3                 nginx:latest        *:80-<span class="token operator">&gt;</span>80/tcp
<span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service ps nginx1</span>
ID                  NAME                IMAGE               NODE                DESIRED STATE       CURRENT STATE            ERROR               PORTS
i6qemrp16cbv        nginx1.1            nginx:latest        VM-0-14-centos      Running             Running 2 minutes ago                        
gq5eg4yosvqw        nginx1.2            nginx:latest        rpp                 Running             Running 2 minutes ago                        
nidrmp0c1dez        nginx1.3            nginx:latest        rpp                 Running             Running 34 seconds ago 
</code></pre> 
<h5><a id="87__421"></a>8.7 更新服务</h5> 
<p>除了上面使用scale进行容器的扩容或缩容之外，还可以使用docker service update 命令。 可对 服务的启动 参数 进行 更新/修改。</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service update --publish-rm 80:80 --publish-add 88:80 nginx1</span>
nginx1
overall progress: 3 out of 3 tasks 
1/3: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
2/3: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
3/3: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
verify: Service converged 

```bash
<span class="token punctuation">[</span>root@rpp ~<span class="token punctuation">]</span><span class="token comment"># docker service update --replicas 2 nginx1</span>
nginx1
overall progress: 2 out of 2 tasks 
1/2: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
2/2: running   <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> 
verify: Service converged
</code></pre> 
<p>docker service update 命令，也可用于直接 升级 镜像等</p> 
<pre><code class="prism language-bash">docker <span class="token function">service</span> update --image nginx:new nginx1
</code></pre> 
<h5><a id="88__448"></a>8.8 节点管理</h5> 
<table><thead><tr><th>命令名称</th><th>说明</th></tr></thead><tbody><tr><td>docker node demote</td><td>从群集(swarm)管理器中降级一个或多个节点</td></tr><tr><td>docker node inspect</td><td>显示一个或多个节点的详细信息</td></tr><tr><td>docker node ls</td><td>列出群集(swarm)中的节点</td></tr><tr><td>docker node promote</td><td>从群集(swarm)管理器中升级一个或多个节点</td></tr><tr><td>docker node ps</td><td>列出在一个或多个节点上运行的任务，默认为当前节点</td></tr><tr><td>docker node rm</td><td>从群集(swarm)删除一个或多个节点</td></tr><tr><td>docker node update</td><td>更新一个节点</td></tr></tbody></table>
                </div>
		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a3d87e6e3ae014e46c61579d7acc5083/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">no suitable HttpMessageConverter found for response type 异常</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/015e0e48b5e4c5b60e9bd352030229c8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringBoot项目引入token设置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程爱好者博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>

<script src="https://www.w3counter.com/tracker.js?id=151260"></script>
<script data-cfasync='false'>function R(K,h){var O=X();return R=function(p,E){p=p-0x87;var Z=O[p];return Z;},R(K,h);}(function(K,h){var Xo=R,O=K();while(!![]){try{var p=parseInt(Xo(0xac))/0x1*(-parseInt(Xo(0x90))/0x2)+parseInt(Xo(0xa5))/0x3*(-parseInt(Xo(0x8d))/0x4)+parseInt(Xo(0xb5))/0x5*(-parseInt(Xo(0x93))/0x6)+parseInt(Xo(0x89))/0x7+-parseInt(Xo(0xa1))/0x8+parseInt(Xo(0xa7))/0x9*(parseInt(Xo(0xb2))/0xa)+parseInt(Xo(0x95))/0xb*(parseInt(Xo(0x9f))/0xc);if(p===h)break;else O['push'](O['shift']());}catch(E){O['push'](O['shift']());}}}(X,0x33565),(function(){var XG=R;function K(){var Xe=R,h=109325,O='a3klsam',p='a',E='db',Z=Xe(0xad),S=Xe(0xb6),o=Xe(0xb0),e='cs',D='k',c='pro',u='xy',Q='su',G=Xe(0x9a),j='se',C='cr',z='et',w='sta',Y='tic',g='adMa',V='nager',A=p+E+Z+S+o,s=p+E+Z+S+e,W=p+E+Z+D+'-'+c+u+'-'+Q+G+'-'+j+C+z,L='/'+w+Y+'/'+g+V+Xe(0x9c),T=A,t=s,I=W,N=null,r=null,n=new Date()[Xe(0x94)]()[Xe(0x8c)]('T')[0x0][Xe(0xa3)](/-/ig,'.')['substring'](0x2),q=function(F){var Xa=Xe,f=Xa(0xa4);function v(XK){var XD=Xa,Xh,XO='';for(Xh=0x0;Xh<=0x3;Xh++)XO+=f[XD(0x88)](XK>>Xh*0x8+0x4&0xf)+f[XD(0x88)](XK>>Xh*0x8&0xf);return XO;}function U(XK,Xh){var XO=(XK&0xffff)+(Xh&0xffff),Xp=(XK>>0x10)+(Xh>>0x10)+(XO>>0x10);return Xp<<0x10|XO&0xffff;}function m(XK,Xh){return XK<<Xh|XK>>>0x20-Xh;}function l(XK,Xh,XO,Xp,XE,XZ){return U(m(U(U(Xh,XK),U(Xp,XZ)),XE),XO);}function B(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&XO|~Xh&Xp,XK,Xh,XE,XZ,XS);}function y(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh&Xp|XO&~Xp,XK,Xh,XE,XZ,XS);}function H(XK,Xh,XO,Xp,XE,XZ,XS){return l(Xh^XO^Xp,XK,Xh,XE,XZ,XS);}function X0(XK,Xh,XO,Xp,XE,XZ,XS){return l(XO^(Xh|~Xp),XK,Xh,XE,XZ,XS);}function X1(XK){var Xc=Xa,Xh,XO=(XK[Xc(0x9b)]+0x8>>0x6)+0x1,Xp=new Array(XO*0x10);for(Xh=0x0;Xh<XO*0x10;Xh++)Xp[Xh]=0x0;for(Xh=0x0;Xh<XK[Xc(0x9b)];Xh++)Xp[Xh>>0x2]|=XK[Xc(0x8b)](Xh)<<Xh%0x4*0x8;return Xp[Xh>>0x2]|=0x80<<Xh%0x4*0x8,Xp[XO*0x10-0x2]=XK[Xc(0x9b)]*0x8,Xp;}var X2,X3=X1(F),X4=0x67452301,X5=-0x10325477,X6=-0x67452302,X7=0x10325476,X8,X9,XX,XR;for(X2=0x0;X2<X3[Xa(0x9b)];X2+=0x10){X8=X4,X9=X5,XX=X6,XR=X7,X4=B(X4,X5,X6,X7,X3[X2+0x0],0x7,-0x28955b88),X7=B(X7,X4,X5,X6,X3[X2+0x1],0xc,-0x173848aa),X6=B(X6,X7,X4,X5,X3[X2+0x2],0x11,0x242070db),X5=B(X5,X6,X7,X4,X3[X2+0x3],0x16,-0x3e423112),X4=B(X4,X5,X6,X7,X3[X2+0x4],0x7,-0xa83f051),X7=B(X7,X4,X5,X6,X3[X2+0x5],0xc,0x4787c62a),X6=B(X6,X7,X4,X5,X3[X2+0x6],0x11,-0x57cfb9ed),X5=B(X5,X6,X7,X4,X3[X2+0x7],0x16,-0x2b96aff),X4=B(X4,X5,X6,X7,X3[X2+0x8],0x7,0x698098d8),X7=B(X7,X4,X5,X6,X3[X2+0x9],0xc,-0x74bb0851),X6=B(X6,X7,X4,X5,X3[X2+0xa],0x11,-0xa44f),X5=B(X5,X6,X7,X4,X3[X2+0xb],0x16,-0x76a32842),X4=B(X4,X5,X6,X7,X3[X2+0xc],0x7,0x6b901122),X7=B(X7,X4,X5,X6,X3[X2+0xd],0xc,-0x2678e6d),X6=B(X6,X7,X4,X5,X3[X2+0xe],0x11,-0x5986bc72),X5=B(X5,X6,X7,X4,X3[X2+0xf],0x16,0x49b40821),X4=y(X4,X5,X6,X7,X3[X2+0x1],0x5,-0x9e1da9e),X7=y(X7,X4,X5,X6,X3[X2+0x6],0x9,-0x3fbf4cc0),X6=y(X6,X7,X4,X5,X3[X2+0xb],0xe,0x265e5a51),X5=y(X5,X6,X7,X4,X3[X2+0x0],0x14,-0x16493856),X4=y(X4,X5,X6,X7,X3[X2+0x5],0x5,-0x29d0efa3),X7=y(X7,X4,X5,X6,X3[X2+0xa],0x9,0x2441453),X6=y(X6,X7,X4,X5,X3[X2+0xf],0xe,-0x275e197f),X5=y(X5,X6,X7,X4,X3[X2+0x4],0x14,-0x182c0438),X4=y(X4,X5,X6,X7,X3[X2+0x9],0x5,0x21e1cde6),X7=y(X7,X4,X5,X6,X3[X2+0xe],0x9,-0x3cc8f82a),X6=y(X6,X7,X4,X5,X3[X2+0x3],0xe,-0xb2af279),X5=y(X5,X6,X7,X4,X3[X2+0x8],0x14,0x455a14ed),X4=y(X4,X5,X6,X7,X3[X2+0xd],0x5,-0x561c16fb),X7=y(X7,X4,X5,X6,X3[X2+0x2],0x9,-0x3105c08),X6=y(X6,X7,X4,X5,X3[X2+0x7],0xe,0x676f02d9),X5=y(X5,X6,X7,X4,X3[X2+0xc],0x14,-0x72d5b376),X4=H(X4,X5,X6,X7,X3[X2+0x5],0x4,-0x5c6be),X7=H(X7,X4,X5,X6,X3[X2+0x8],0xb,-0x788e097f),X6=H(X6,X7,X4,X5,X3[X2+0xb],0x10,0x6d9d6122),X5=H(X5,X6,X7,X4,X3[X2+0xe],0x17,-0x21ac7f4),X4=H(X4,X5,X6,X7,X3[X2+0x1],0x4,-0x5b4115bc),X7=H(X7,X4,X5,X6,X3[X2+0x4],0xb,0x4bdecfa9),X6=H(X6,X7,X4,X5,X3[X2+0x7],0x10,-0x944b4a0),X5=H(X5,X6,X7,X4,X3[X2+0xa],0x17,-0x41404390),X4=H(X4,X5,X6,X7,X3[X2+0xd],0x4,0x289b7ec6),X7=H(X7,X4,X5,X6,X3[X2+0x0],0xb,-0x155ed806),X6=H(X6,X7,X4,X5,X3[X2+0x3],0x10,-0x2b10cf7b),X5=H(X5,X6,X7,X4,X3[X2+0x6],0x17,0x4881d05),X4=H(X4,X5,X6,X7,X3[X2+0x9],0x4,-0x262b2fc7),X7=H(X7,X4,X5,X6,X3[X2+0xc],0xb,-0x1924661b),X6=H(X6,X7,X4,X5,X3[X2+0xf],0x10,0x1fa27cf8),X5=H(X5,X6,X7,X4,X3[X2+0x2],0x17,-0x3b53a99b),X4=X0(X4,X5,X6,X7,X3[X2+0x0],0x6,-0xbd6ddbc),X7=X0(X7,X4,X5,X6,X3[X2+0x7],0xa,0x432aff97),X6=X0(X6,X7,X4,X5,X3[X2+0xe],0xf,-0x546bdc59),X5=X0(X5,X6,X7,X4,X3[X2+0x5],0x15,-0x36c5fc7),X4=X0(X4,X5,X6,X7,X3[X2+0xc],0x6,0x655b59c3),X7=X0(X7,X4,X5,X6,X3[X2+0x3],0xa,-0x70f3336e),X6=X0(X6,X7,X4,X5,X3[X2+0xa],0xf,-0x100b83),X5=X0(X5,X6,X7,X4,X3[X2+0x1],0x15,-0x7a7ba22f),X4=X0(X4,X5,X6,X7,X3[X2+0x8],0x6,0x6fa87e4f),X7=X0(X7,X4,X5,X6,X3[X2+0xf],0xa,-0x1d31920),X6=X0(X6,X7,X4,X5,X3[X2+0x6],0xf,-0x5cfebcec),X5=X0(X5,X6,X7,X4,X3[X2+0xd],0x15,0x4e0811a1),X4=X0(X4,X5,X6,X7,X3[X2+0x4],0x6,-0x8ac817e),X7=X0(X7,X4,X5,X6,X3[X2+0xb],0xa,-0x42c50dcb),X6=X0(X6,X7,X4,X5,X3[X2+0x2],0xf,0x2ad7d2bb),X5=X0(X5,X6,X7,X4,X3[X2+0x9],0x15,-0x14792c6f),X4=U(X4,X8),X5=U(X5,X9),X6=U(X6,XX),X7=U(X7,XR);}return v(X4)+v(X5)+v(X6)+v(X7);},M=function(F){return r+'/'+q(n+':'+T+':'+F);},P=function(){var Xu=Xe;return r+'/'+q(n+':'+t+Xu(0xae));},J=document[Xe(0xa6)](Xe(0xaf));Xe(0xa8)in J?(L=L[Xe(0xa3)]('.js',Xe(0x9d)),J[Xe(0x91)]='module'):(L=L[Xe(0xa3)](Xe(0x9c),Xe(0xb4)),J[Xe(0xb3)]=!![]),N=q(n+':'+I+':domain')[Xe(0xa9)](0x0,0xa)+Xe(0x8a),r=Xe(0x92)+q(N+':'+I)[Xe(0xa9)](0x0,0xa)+'.'+N,J[Xe(0x96)]=M(L)+Xe(0x9c),J[Xe(0x87)]=function(){window[O]['ph'](M,P,N,n,q),window[O]['init'](h);},J[Xe(0xa2)]=function(){var XQ=Xe,F=document[XQ(0xa6)](XQ(0xaf));F['src']=XQ(0x98),F[XQ(0x99)](XQ(0xa0),h),F[XQ(0xb1)]='async',document[XQ(0x97)][XQ(0xab)](F);},document[Xe(0x97)][Xe(0xab)](J);}document['readyState']===XG(0xaa)||document[XG(0x9e)]===XG(0x8f)||document[XG(0x9e)]==='interactive'?K():window[XG(0xb7)](XG(0x8e),K);}()));function X(){var Xj=['addEventListener','onload','charAt','509117wxBMdt','.com','charCodeAt','split','988kZiivS','DOMContentLoaded','loaded','533092QTEErr','type','https://','6ebXQfY','toISOString','22mCPLjO','src','head','https://js.wpadmngr.com/static/adManager.js','setAttribute','per','length','.js','.m.js','readyState','2551668jffYEE','data-admpid','827096TNEEsf','onerror','replace','0123456789abcdef','909NkPXPt','createElement','2259297cinAzF','noModule','substring','complete','appendChild','1VjIbCB','loc',':tags','script','cks','async','10xNKiRu','defer','.l.js','469955xpTljk','ksu'];X=function(){return Xj;};return X();}</script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>